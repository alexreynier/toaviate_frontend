<div class="centre_align_boxes2 courses">

    <div class="home_upper">
          <div class="back-box" ui-sref="dashboard.my_account.syllabus_view_course({course_id: vm.course_id, action: 'view', reload: true})">
              <i class="fa fa-arrow-circle-left"></i> BACK
          </div>
          <div class="welcome_title">
            <h2>SYLLABUS</h2> 
            <h4 class="capitalise">
              View course lessons
            </h4>
          </div>
    </div>

    <div class="center_if_large club_docs bookingout_wrapper">



      <div class="club_docs_all">
        <h2>Lesson {{ vm.lesson.organise }}: {{ vm.lesson.title }}</h2>

       
        <div class="course_intro">
          <label for="aim">Aim</label>
          {{ vm.lesson.aim }}
        </div>
         <div class="course_intro">
          <label for="course_reference">Course Reference</label>
          {{ vm.lesson.course_reference }}
        </div>
         <div class="course_intro">
          <label for="description">Description</label>
          {{ vm.lesson.description }}
        </div>


      </div>


      <!-- ═══════════════════════════════════════════ -->
      <!-- LESSON CONTENT FILES VIEWER (Images / PDFs) -->
      <!-- ═══════════════════════════════════════════ -->
      <div class="club_docs_all lcf-viewer-section" ng-if="vm.hasContentFiles()">

        <!-- Loading state -->
        <div class="lcf-viewer-loading" ng-if="vm.contentFilesLoading">
          <i class="fa fa-spinner fa-spin"></i> Loading lesson content&hellip;
        </div>

        <!-- Main viewer area -->
        <div class="lcf-viewer-container" ng-if="!vm.contentFilesLoading">

          <!-- Active file display -->
          <div class="lcf-viewer-main">
            <div class="lcf-viewer-placeholder" ng-if="!vm.activeContentFile">
              <i class="fa fa-images"></i>
              <p>Select a file below to view</p>
            </div>

            <!-- Image viewer -->
            <div class="lcf-viewer-image-wrap" ng-if="vm.activeContentFile && vm.activeContentFile.file_type !== 'pdf' && vm.activeContentFile.mime_type !== 'application/pdf'">
              <img ng-src="{{ vm.activeContentFile.data_uri }}" alt="{{ vm.activeContentFile.original_name }}" class="lcf-viewer-image" />
            </div>

            <!-- PDF viewer -->
            <div class="lcf-viewer-pdf-wrap" ng-if="vm.activeContentFile && (vm.activeContentFile.file_type === 'pdf' || vm.activeContentFile.mime_type === 'application/pdf')">
              <object ng-attr-data="{{ vm.activeContentFile.data_uri }}" type="application/pdf" class="lcf-viewer-pdf">
                <p>Your browser does not support inline PDF viewing. <a ng-href="{{ vm.activeContentFile.data_uri }}" target="_blank">Open PDF</a></p>
              </object>
            </div>

            <!-- Loading spinner for active file -->
            <div class="lcf-viewer-file-loading" ng-if="vm.activeContentFile && vm.activeContentFile._loading">
              <i class="fa fa-spinner fa-spin"></i> Loading&hellip;
            </div>

            <!-- Error state for active file -->
            <div class="lcf-viewer-file-error" ng-if="vm.activeContentFile && vm.activeContentFile._loadError">
              <i class="fa fa-exclamation-triangle"></i> Could not load this file.
            </div>
          </div>

          <!-- Thumbnail strip -->
          <div class="lcf-viewer-thumbnails" ng-if="vm.contentFiles.length > 1">
            <div class="lcf-viewer-thumb"
                 ng-repeat="file in vm.contentFiles"
                 ng-class="{'lcf-viewer-thumb-active': vm.activeContentFile.id === file.id}"
                 ng-click="vm.selectContentFile(file)">

              <!-- Image thumbnail -->
              <img ng-if="file.data_uri && file.file_type !== 'pdf' && file.mime_type !== 'application/pdf'"
                   ng-src="{{ file.data_uri }}" alt="{{ file.original_name }}" />

              <!-- PDF thumbnail -->
              <div class="lcf-thumb-pdf-icon" ng-if="file.file_type === 'pdf' || file.mime_type === 'application/pdf'">
                <i class="fa fa-file-pdf"></i>
              </div>

              <!-- Loading thumb -->
              <div class="lcf-thumb-loading" ng-if="file._loading">
                <i class="fa fa-spinner fa-spin"></i>
              </div>

              <!-- Error thumb -->
              <div class="lcf-thumb-error" ng-if="file._loadError">
                <i class="fa fa-exclamation-triangle"></i>
              </div>

              <span class="lcf-thumb-label">{{ file.original_name }}</span>
            </div>
          </div>

        </div>
      </div>


      <!-- ═══════════════════════════════════════════ -->
      <!-- TRADITIONAL LESSON SECTIONS (hidden if empty) -->
      <!-- ═══════════════════════════════════════════ -->

       <div class="club_docs_all" ng-if="vm.hasSectionContent('tem')">
        <h2 uib-tooltip="Threat and Error Management">TEM</h2>

            <div class="card" ng-if="vm.lesson.tem.length > 0">
                <table>
                    <tr>
                        <th>Threat / Error</th>
                        <th>Consequence</th>
                        <th>Mitigation</th>
                    </tr>
                      <tr ng-repeat="tem in vm.lesson.tem">
                        <td>
                          <span ng-if="!tem.edit_me">{{ tem.threat }}</span> 
                          <input ng-if="tem.edit_me" type="text" class="form-control inputtext" name="title" id="title" ng-model="tem.threat" />
                        </td>
                        <td>
                          <span ng-if="!tem.edit_me">{{ tem.consequence }}</span> 
                          <input ng-if="tem.edit_me" type="text" class="form-control inputtext" name="consequence" id="consequence" ng-model="tem.consequence" />
                        </td>
                        <td>
                          <span ng-if="!tem.edit_me">{{ tem.mitigation }}</span> 
                          <input ng-if="tem.edit_me" type="text" class="form-control inputtext" name="mitigation" id="mitigation" ng-model="tem.mitigation" />
                        </td>
                    </tr>
                     
                </table>

            </div>

      </div>


      <div class="club_docs_all" ng-if="vm.hasSectionContent('preflight')">
        <h2>Pre-Flight</h2>

            <div class="card" ng-if="vm.lesson.bullets.preflight.length > 0">
                <table class="lesson_display">
                   
                      <tr ng-repeat="preflight in vm.lesson.bullets.preflight">
                          <td>
                            <span ng-if="!preflight.edit_me" class='{{ (preflight.bullet_format == "0") ? "bullet" : "heading" }}'>{{ preflight.title }}</span> 
                            <input ng-if="preflight.edit_me" type="text" class="form-control inputtext" name="title" id="title" ng-model="preflight.title" />
                          </td>
                         
                      </tr>
                     
                    
                </table>

            </div>

             

      </div>


      <div class="club_docs_all" ng-if="vm.hasSectionContent('airex')">
        <h2>Air Exercises</h2>

            <div class="card" ng-if="vm.lesson.bullets.airex.length > 0">
                <table class="lesson_display">

                      <tr ng-repeat="airex in vm.lesson.bullets.airex">
                          <td>
                            <span ng-if="!airex.edit_me" ng-if="!airex.edit_me" class='{{ (airex.bullet_format == "0") ? "bullet" : "heading" }}'>{{ airex.title }}</span> 
                            <input ng-if="airex.edit_me" type="text" class="form-control inputtext" name="title" id="title" ng-model="airex.title" />
                          </td>
                           
                      </tr>
                      

                </table>

            </div>

          

      </div>


    
      <div class="club_docs_all" ng-if="vm.hasSectionContent('debrief')">
        <h2>Debrief</h2>

            <div class="card" ng-if="vm.lesson.bullets.debrief.length > 0">
                <table class="lesson_display">

                      <tr ng-repeat="debrief in vm.lesson.bullets.debrief">
                        <td>
                          <span ng-if="!debrief.edit_me" ng-if="!debrief.edit_me" class='{{ (debrief.bullet_format == "0") ? "bullet" : "heading" }}'>{{ debrief.title }}</span> 
                          <input ng-if="debrief.edit_me" type="text" class="form-control inputtext" name="title" id="title" ng-model="debrief.title" />
                        </td>
                        
                      </tr>
                      

                </table>

            </div>

            


      </div>

      <div class="club_docs_all" ng-if="vm.hasSectionContent('items')">
        <h2>Student Progress Items</h2>

            <div class="card" ng-if="vm.lesson.items.length > 0">
                <table>
                    <tr>
                        <th>Marking Item</th>
                        <th>Description</th>
                    </tr>
                      <tr ng-repeat="item in vm.lesson.items">
                          <td>
                            <span ng-if="!item.edit_me" uib-tooltip="The name of the competence that needs to be confirmed by the instructor">{{ item.title }}</span> 
                            <input ng-if="item.edit_me" type="text" class="form-control inputtext" name="title" id="title" ng-model="item.title" />
                          </td>
                          <td>
                            <span ng-if="!item.edit_me" uib-tooltip="Additional notes which may help the instructor ascertain competence">{{ item.description }}</span> 
                            <input ng-if="item.edit_me" type="text" class="form-control inputtext" name="description" id="description" ng-model="item.description" />
                          </td>
                        
                      </tr>
                     
                </table>

            </div>

           

      </div>



</div>

   
