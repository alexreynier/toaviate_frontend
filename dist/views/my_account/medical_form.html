 <form name="medical" ng-submit="save_medical(medical.$valid)">


<div class="club_docs_all">

    <h2>Medical Images</h2>
    
    <div class="center_if_large">
    <div class="form-group">

      <a class="btn btn-primary" ng-if="vm.medical.images.length > 0 && vm.blurred" ng-click="getDecrypted()">DECRYPT IMAGES</a>
        <br /><br />

        <div class="logbook_images">
            <div flow-init
               flow-files-submitted="$flow.upload()"
               flow-file-success="$file.file_return = $message"
               flow-complete="processFiles($flow.files)"
               flow-file-added="!!{png:1,gif:1,jpg:1,jpeg:1}[$file.getExtension()]"
               class="flow_upload_box"
               >
                
                <div class="drop gallery-box" flow-btn flow-drop ng-class="dropClass">   
                  <div class="upload_middle_align">  
                    Click To Add
                    <br />OR<br /> 
                    Drag And Drop
                    <br />
                    Medical Image
                  </div>
                </div>


                 <div ng-repeat="file in $flow.files" class="gallery-box">
                  <span class="title">{{file.name}}</span>
                  <div class="thumbnail" ng-show="$flow.files.length">
                    <img flow-img="file" />
                  </div>
                  <div class="progress progress-striped" ng-class="{active: file.isUploading()}" ng-if="(file.progress() * 100) < 100">
                    <div class="progress-bar" role="progressbar"
                         aria-valuenow="{{file.progress() * 100}}"
                         aria-valuemin="0"
                         aria-valuemax="100"
                         ng-style="{width: (file.progress() * 100) + '%'}">
                      <span class="sr-only">{{file.progress()}}% Complete</span>
                    </div>
                  </div>
                  <div class="btn-group center">
                    <a class="btn btn-xs btn-danger" ng-click="file.cancel(); remove_file(file, $flow.files);"  ng-if="(file.progress() * 100) == 100">
                      Delete
                    </a>
                  </div>
                </div>




                  <div ng-repeat="file in vm.medical.images" class="gallery-box">
                      <span class="title">{{file.name}}</span>
                      <div class="thumbnail {{ (vm.blurred) ? 'image_blur' : '' }}">
                        <img src="{{file.data_uri}}" />
                      </div>
                      <div class="btn-group center">
                        <a class="btn btn-xs btn-danger" ng-click="remove_real_file(file);">
                          Delete
                        </a>
                      </div>
                  </div>


            </div>
        </div>






         


          <div class="clear"></div>
        </div>


</div>
</div>


     <!-- <div class="form-group">
        

        
      
        <h5>Medical Images Both Sides</h5>

      
      <a class="btn btn-primary" ng-if="vm.medical.images.length > 0 && vm.blurred" ng-click="getDecrypted()">LOAD IMAGES</a>





        <div class="logbook_images">
            <div flow-init
               flow-files-submitted="$flow.upload()"
               flow-file-success="$file.file_return = $message"
               flow-complete="processFiles($flow.files)"
               flow-file-added="!!{png:1,gif:1,jpg:1,jpeg:1}[$file.getExtension()]"
               class="gallery-box"
               >
                <div class="drop" flow-btn flow-drop ng-class="dropClass">     
                    Click To Add
                    <br />OR<br /> 
                    Drag And Drop
                    <br />
                    Licence Image
                </div>

            </div>


            <div ng-repeat="file in vm.medical.images" class="gallery-box" >
                <span class="title">{{file.name}}</span>
                <div class="thumbnail {{ (vm.blurred) ? 'image_blur' : '' }}">
                  <img src="{{file.data_uri}}" />
                </div>
                <div class="btn-group center">
                  <a class="btn btn-xs btn-danger" ng-click="remove_real_file(file);">
                    Delete
                  </a>
                </div>
            </div>


            <div ng-repeat="file in $flow.files" class="gallery-box">
              <span class="title">{{file.name}}</span>
              <div class="thumbnail" ng-show="$flow.files.length">
                <img flow-img="file" />
              </div>
              <div class="progress progress-striped" ng-class="{active: file.isUploading()}" ng-if="(file.progress() * 100) < 100">
                <div class="progress-bar" role="progressbar"
                     aria-valuenow="{{file.progress() * 100}}"
                     aria-valuemin="0"
                     aria-valuemax="100"
                     ng-style="{width: (file.progress() * 100) + '%'}">
                  <span class="sr-only">{{file.progress()}}% Complete</span>
                </div>
              </div>
              <div class="btn-group center">
                <a class="btn btn-xs btn-danger" ng-click="file.cancel(); remove_file(file, $flow.files);"  ng-if="(file.progress() * 100) == 100">
                  Delete
                </a>
              </div>
            </div>

        </div> -->

<div class="club_docs_all">

    <h2>Medical Details</h2>
    
    <div class="center_if_large">
    <div class="form-group">
        <label for="state_of_issue">State of Issue</label>
        <br />
        <ui-select ng-model="vm.medical.state_of_issue" theme="bootstrap" ng-disabled="disabled" style="min-width: 500px;" title="What is the state of issue of your medical?" append-to-body="true" required>

          <ui-select-match placeholder="Please select your medical state of issue...">
            {{ vm.medical.state_of_issue.country }}
          </ui-select-match>
          <ui-select-choices repeat="state in vm.authority | propsFilterA: {title: $select.search, id: $select.search, country: $select.search, abbreviation: $select.search}">
            <div ng-bind-html="state.country | highlight: $select.search"></div>
             <small>
                <span ng-bind-html="state.abbreviation | highlight: $select.search"></span>
                (<span ng-bind-html="state.title | highlight: $select.search"></span>)
            </small>
          </ui-select-choices>
        </ui-select>             
    </div>

    <div class="form-group">
        <label for="medical_number">Certificate Number</label>
        <input type="text" class="form-control" name="medical_number" ng-model="vm.medical.certificate_number" required>
    </div>


    <div class="form-group">
        <label for="medical_expiry">Medical Examination Date</label>
      
             <p class="input-group">
                <input type="text" class="form-control date start" uib-datepicker-popup="{{format}}" ng-model="vm.medical.examination_date" is-open="popup[0].opened" datepicker-options="datePickerOptions" ng-click="open(0, $event)"  placeholder="dd/mm/yyyy" close-text="Close" required />
                <span class="input-group-btn">
                    <button type="button" class="btn btn-default" ng-click="open(0, $event)"><i class="glyphicon glyphicon-calendar"></i></button>
                </span>
            </p>
    </div>
</div>
</div>

  <!--   <div class="form-group">
        <label for="components">Your Medical Components</label>

        <br />
        <ui-select id="components" ng-model="vm.selected_component" theme="bootstrap" style="min-width: 500px;" title="What components do you have on this medical?" append-to-body="true">

          <ui-select-match placeholder="Please select a component to add to your medical...">
            {{ vm.selected_component.title }}
          </ui-select-match>
          <ui-select-choices repeat="component in vm.components | propsFilter: {title: $select.search, description: $select.search, id: $select.search}">
            <div ng-bind-html="component.title | highlight: $select.search"></div>
            <small>
                <span ng-bind-html="component.description | highlight: $select.search"></span>
            </small>
          </ui-select-choices>
        </ui-select>

        <button type="button" class="btn btn-info" ng-click="add_component();">ADD COMPONENT</button>
    </div> -->
  <div class="club_docs_all">

    <h2>Medical Components</h2>
    
    <div class="center_if_large">

   

    <div>

        <table ng-if="vm.medical.components.length > 0">
            <tr>
                <th>
                    Component Name
                </th>
                <th>
                    Component Expiry
                </th>
                <th>
                    Remove
                </th>
            </tr>
            <tr ng-repeat="component in vm.medical.components">
                <td>
                    {{ component.title }}
                </td>
                <td>
                    <p class="input-group">
                        <input type="text" class="form-control date start" uib-datepicker-popup="{{format}}" ng-model="vm.medical.components[$index].expiry_date" is-open="popup['component_expiry_'+$index].opened" datepicker-options="datePickerOptions" ng-click="open('component_expiry_'+$index, $event)" close-text="Close" placeholder="dd/mm/yyyy" required/>
                        <span class="input-group-btn">
                            <button type="button" class="btn btn-default" ng-click="open('component_expiry_'+$index, $event)"><i class="glyphicon glyphicon-calendar"></i></button>
                        </span>
                    </p>

                 </td>
                <td>
                    <a ng-click="remove_component($index)">Delete</a>
                </td>
            </tr>
        </table>

    </div>
      <div class="form-group add_dif">

          <table class="vertical_1 no_lines">
          <tr>
            <td>
              <label for="components">Medical Components</label>
            </td>
            <td>
              <ui-select id="components" ng-model="vm.selected_component" theme="bootstrap" style="min-width: 500px;" title="What components do you have on this medical?" append-to-body="true">

                <ui-select-match placeholder="Please select a component to add to your medical...">
                  {{ vm.selected_component.title }}
                </ui-select-match>
               <ui-select-choices repeat="component in vm.components | propsFilterA: {title: $select.search, description: $select.search, id: $select.search}">
                  <div ng-bind-html="component.title | highlight: $select.search"></div>
                  <small>
                      <span ng-bind-html="component.description | highlight: $select.search"></span>
                  </small>
                </ui-select-choices>
              </ui-select>
            </td>
            <td>
              <button type="button" class="btn btn-info add_diff_btn2" ng-click="add_component();">ADD COMPONENT</button>
            </td>
          </tr>
        </table>

    </div>

</div>
</div>


        <div class="bottom_btn_diff btns_bottom">
        <button type="button" ui-sref="dashboard.my_account.medical" class="btn btn-danger btn_bigger">CANCEL CHANGES</button>
        <button type="submit" class="btn btn-info btn_bigger">SAVE MEDICAL</button>

</div>
    </form>


<div ng-if="vm.show_loading" class="positioning-container">
  <div class="airplane_center_loading">Loading...</div>
  <div class="spinning-container">
  <div class="airplane-container">
    <span class="fa fa-plane fa-2x"></span>
  </div>
  </div>
</div><!--vm.show_loading = false; //-->

<div ng-if="vm.show_temp_login" class="positioning-container">
  <div class="centre_password">
    <p>
      It appears that you have been inactive for more than 5 minutes. In order to ensure you are legitimately requesting access to these resources, we need to confirm that you are who you say you are. Please enter your password below.
    </p>
    <input type="password" name="pwd" class="pwd" value="" ng-model="vm.re_login_pass" />

    <a class="btn btn-danger confirm_btn" ng-click="vm.show_temp_login=false">CLOSE</a>
    <a class="btn btn-primary confirm_btn" ng-click="re_login()">CONFIRM LOGIN</a>
  </div>
                            

</div>
