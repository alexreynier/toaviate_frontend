{"version":3,"sources":["controllers.js"],"names":["app","controller","AccountController","$inject","UserService","$rootScope","$location","vm","user","globals","currentUser","AddLicenceController","MemberService","InstructorService","MembershipService","HolidayService","$scope","$state","$stateParams","$uibModal","$log","$window","$compile","$timeout","uiCalendarConfig","BookingService","LicenceService","licence_images","licence","images","ratings","GetLicenceTypes","then","data","licence_types","GetRatings","i","length","id","selected_rating","add_rating","GetAuthority","authority","$","grep","e","push","remove_rating","index","splice","popup","open","$event","opened","preventDefault","stopPropagation","formats","format","datePickerOptions","showWeeks","remove_file","file","current_files","j","JSON","parse","file_return","DeleteTmp","saved_url","success","processFiles","files","temp_path","save_licence","isValid","focus","alert","licence_type","state_of_issue","licence_id","authority_id","user_id","Create","message","AircraftJourneyLogsController","ClubDocumentService","PlaneDocumentService","$http","PlaneService","$sce","clubs","looking_for","registration","my_search2","defect_severity","defect_severities","title","GetAircraftJourneyLogs","plane_id","logs","aircraft","current_offset","loaded_per_batch","all_loaded","load_more","forEach","log","get_initial","text","charAt","clean_times","time","substring","round_brake_times","first","second","start_end","round_brake_times_end","input","earlier_input","indexOf","split","x","min_nearest_five","parseInt","esplit","ehour","emin","etot","hr","mn","tot","round_brake_times_start","filter_detail","show_all","status","get_icon","ft","name","pop","icon_name","get_icon2","search","row","angular","lowercase","my_search","convert_string_to_date","date","d","rtn","test_date","parsed_date","b","moment","search_type","c","c2","test_name","fname","lname","search2","toLowerCase","fullname","test_aircraft","replace","test_airfield","code","name2","code2","flight_date","first_name","last_name","departure_airport","departure_airport_code","destination_airport","destination_airport_code","getMySearchCount","str","docs","documents","total","getMySearchCount2","charges","get_hours_from_decimal","sign","hour","Math","floor","abs","min","round","downloadDocument","doc","type","param","ddd","get","responseType","headers","zipName","processArrayBufferToBlob","error","downloadClubDocument","list_pilots","p1","put","get_pic","get_put","getTrustedHtml","pic_first_name","pic_last_name","instructor_first_name","instructor_last_name","instructor_id","put_first_name","put_last_name","octetStreamMime","filename","contentType","blob","Blob","navigator","msSaveBlob","saveBlob","webkitSaveBlob","mozSaveBlob","undefined","ex","info","urlCreator","window","URL","webkitURL","mozURL","msURL","link","document","createElement","url","createObjectURL","setAttribute","event","createEvent","initMouseEvent","dispatchEvent","location","httpPath","AircraftStatusController","GetByUserMaintenance","add_defect","club_id","obj","defect","severity","AddDefect","item","can_delete","find","club","planes","plane","defects","delete_defect","DeleteDefect","GetOpenIssues","bookout","reported_defects","count_defects","counter","show_receipt_image","receipt","show_receipt","receipt_image","image","get_icon3","titlepath","path","prntWin","write","close","fileURL","AllDocumentsController","GetByUserId","membership_terms","updated_at","membership_updated","privacy_terms","privacy_updated","passenger_terms","passenger_updated","search3","membership_name","AllInvoicesController","PaymentService","show_pay_now","show_loading","last_invoice_opened","iconBank","iconCard","iconNew","iconTerm","donConfirm","methodLabel","paymentIntent","complete_invoice","default_payment","methods","subtitle","iconSvg","trustAsHtml","visible","savedCards","method","invoice_id","ProcessPayment","GetInvoices","invoices","console","close_pay_now","get_package_html","pack_obj","used_on","plane_type","validity","created_at","add","intro","show_payment_option","invoice","show_payment","send","GetMandate","cards","machine","convert_decimal_to_hours","number","decpart","minute","GetUpcoming","upcoming","invoice_number","plane_registration","club_title","toString","parseFloat","toFixed","show_more","process_payment_bits","payments","get_human_status","returned","downloadInvoice","AllPaymentsController","GetPayments","amount","get_human_method","ArtpiecesController","CategoryService","ArtpiecesService","FlashService","$routeParams","artpiece","categories","GetAll","artpieceId","GetById","artpieces","tempAddCategory","category","tempDeleteCategory","cat","AddCategory","DeleteCategory","category_id","addArtpiece","editArtpiece","Update","deleteArtpiece","Delete","addCategory","add_one","new_category","cats","deleteCategory","BookinController","FoxService","$interval","BookoutService","$filter","InstructorCharges","InvoicesService","PackageService","CourseService","$anchorScroll","smoothScroll","booking","wgs_n","wgs_e","split_flight","show_takeoff_landing_times","change_booking","show_change_plane","start","passengers","pic","this_pls_id_raw","instructors","pics","instructor_charges","club_courses","can_authorise","dateFormat","setting_new_member","flight_times_complete","calculated_invoice","scroll","previous_invoice","claim_a_flight","claimed_flight","auto_claim","ignore_next_tuition_change","get_currency","iso_code","currencies","get_airfields","GetAirfieldsByCode","airfields","GetAirfields","original_bookout","reset_claim_my_flight","different_date_warning","calculate_invoice_for_flight","has_used_claimed_flight","where_to","payer_id","pic_id","split_flight_confirmation","book_in_flight","claim_my_flight","force","this_claim_was_instructional","this_was_instructional_claim","Object","assign","from_airfield","from_airport","to_airfield","to_airport","touch_and_go","selected_detail_type","flight_types","flight_type","brakes_off_rounded","brakes_on_rounded","brakes_off","brakes_on","landings","full_stop_landings","stops","fox_log_id","fox_claimed","takeoff_time","landing_time","takeoff_rounded","landing_rounded","claimed_fox_plane_log_sheet_id","flight_units","brakes_to_brakes","brakes_time","airborne_times","airborne_time","flight_time","brakes_times_rounded","plane_charges","charge_type","booking_id","update_pic","selected_pic","GetPackagesByUserId","packages","items","GetUpdatedCharges","put_id","instructor","complete_flight","complete_this_flight","update_put","selected_put","update_instructor","selected_instructor","biggin_hill","routes","parking","flight_rules","split_this_flight","split_send","split_flight_time","this_pls_id","HypotheticalFlightSplit","split_one","first_flight","split_two","second_flight","cancel_split","process_bookout_to_bookin","update_split","pls_id","which","compared_to","compare_date","this_date","Date","split_time","setHours","setMinutes","setSeconds","isAfter","disabled","start_times","all_times","k","currency_days","dateTimeRangePickerOptions","hour_step","minute_step","min_date","business_hours","from","to","dateTimeRangePickerOptions2","options","lubricant_type","who_paid","quantity","price","reimbursement","update_course","course","GetByCourseId","tuition_required","update_tuition_charges","GetByClubId","tuition_charges","tuition_id","delete_receipt","DeleteReceipt","rcpt","GetAllSheetReceipts","lubricant_receipts","check_reimbursement","currency","CheckReimbursement","reimbursed_amount","reimburse","reimbursed_currency","reimbursed_rate","rate","reimbursed_datetime","datetime","add_receipt","plane_log_sheet_id","AddReceipt","check_business_hours","this_step_disabled","split2","end_times","takeoff_times","landing_times","figure_out_steps","duration","copy","init_times","get_duration_str","seconds","days","hours","minutes","string","calculate_my_brakes_duration","start_date","start_datetime","start_time","end_datetime","end_date","end_time","difference","startOf","diff","human_str","calculate_duration","calculate_airborne_duration","calculate_after_landing_duration","meter_units","end_tacho","start_tacho","confirm_split","try_split","before_split_bookout","tng","remote_landings","course_id","authorised_solo","brakes_times","calculate_my_airborne_duration","asHours","bstart_datetime","bstart_time","bend_datetime","bend_time","update_dateTime","check_relative_date","relative","isSame","check_times","a","getHours","getMinutes","future","start_after_end","some","booking_today","add_hour_to_end","which_update","setTimeout","pre_select_value_id","current","action","GetForBookIn","booked_in","go","reload","unclaimed","GetAllByPicsBookinout","GetAllByClubInstructor","GetPackagesForBookout","this_was_a_supervised_solo","this_was_supervised_solo","preselect_course_and_tuition","applyFilter","model","filter","pieces","filterName","params","slice","join","concat","apply","tacho_error_highlight","check_tacho_bigger","free_flight","charge_rate_unit","surcharge_fee","landing_fee","touch_and_go_fee","plane_units","package_removed","package_used","remaining_hours_dual","rem","solo_dual","member_packages_id","hours_dual_before","hours_dual_spent","hours_dual_remaining_after","hours_solo_remaining_after","remaining_hours_solo","package_id","hours_solo_before","hours_solo_spent","plane_total","surcharge_units","surcharge_type","surcharge_total","landing_units","landings_total","tg_units","tng_total","tuition_charge_type","tuition_price","tuition_total","tuition_units","total_to_remove","receipts","Number","invoice_totals","previous_total","plane_charge_type","plane_unit_price","surcharge_charge_type","surcharge_unit_price","landing_unit_price","landing_total","tng_units","tng_unit_price","tuition_unit_price","NaN","club_id_confirmed","user_id_confirmed","membership_id","GetMemberCards","compile_invoice","uuint","hours_type","unit_price","organise","unit","org","payment","flag_flight","oil","fuel","total_landings","confirm","start_tacho_orig","is_dual_flight","authorised_by","bookout_user_id","bookout_instructor_id","to_airport_id","pay_with","method_name","plane_log_sheet","dual_flight","detail_type_id","from_airport_id","tacho_start","tacho_end","oil_uplift_litres","fuel_uplift_litres","original_id","booked_in_by","paying_now","new_to_airport","new_from_airport","airborne_rounded","pilot_in_command","home_airport_id","last_tacho","is_split_flight","is_split_complete","BookInFlight","after_where_to","after_data","paymentID","payment_id","show_cardmachine","poll_check_payment","result","stop_polling","after_success_bookin","check_payment","card_processor","stripe","Stripe","confirmCardPayment","client_secret","payment_method","return_url","card_url","CheckPayment","close_machine_popup","ClearMachine","show_after_bookedin","cancel_machine","close_bookedin","reset_card_machine","RetryPaymentMachine","maxAttempts","finalCallback","attempts","attempt","get_update_on_cardmachine","retry","limit","callback2","callback","split_next_id","split_booking_id","selected_course","GetCurrencies","club_currency","access","manager","maintenance_flight","GetAllByBooking","keys","flights","key","flight","plane_details","location_default","has_requested_to_change_times","GetCoursesByClubId","toTop","Bookings2Controller","defaultStartTime","defaultEndTime","va1","allUsers","page_title","member","imported_new_headers","see_booking","is_current","currency_type","booking_self","times_clean_type","club_timezone","is_edit_show_all","return_to","no_show_cols","newDate","h_start","i_start","h_end","i_end","defaultStart","getFullYear","getMonth","getDate","defaultEnd","default_date","datepickerOptions","customClass","getDayClass","today","datepicker","minDate","whole_day_booking","cancellation","reasons","notes","end","datepicker_today","new_booking","free_seats","toggle","whentimechangedata","overridePicker","update_bookings","GetEdit","show_self_option","edit_booking","toDate","after_booking_end","$parent","fullCalendar","w","css","width","offsetEvent","animate","scrollLeft","$apply","generate_datetimes","courses","prepare_add_edit","rental_items","free_places","show_no_membership_message","hide_dropdown","GetUserClubs","getAllPlaneUpdate","back","history","test","updateEvents","all_events","events","all_resources","resources","eventRender","element","view","attr","alertOnClicked","calEvent","jsEvent","toUTCString","close_details","changeLang","uiConfig","calendar","dayNames","dayNamesShort","changed","check_plane_availability","j_changed","getA","toISOString","start_dt","end_dt","GetAllPlanes","reset_chosen","check_rental_items","mode","dayToCheck","currentDay","addOne","add_booking_event","cancel_changes","GetRentalItems","found","clean_type","unix","getPlaneInstructors","booking_start","s_date","s_time","n_start","e_date","e_time","n_end","new_event","already_added_temp","times","decline_new_booking_error","new_booking_errors","override_new_booking_errors","admin_override","make_booking","update_booking","valid","jQuery","extend","constructor","Array","isBefore","resourceId","changed_to_waiting_list","override","check_before_changing_event","update_club","change_club","alertOnEventClick","alertMessage","alertOnDrop","delta","revertFunc","ui","resourceIds","alertOnResize","override_booking_change","error_event","override_booking_change2","decline_booking_change","booking_errors","err","evnt","_start","_end","_id","source","_allDay","allDay","className","editable","update_rental_items","original_event","p","updateBooking","errors","api","can_override","button","check_user","wholeDay","myDatetimeRange","changeView","calendars","renderCalender","add_rental_item","rental_item","add_to_list","delete_this","rental_item_remove","booking_admin","GetPlaneInstructors","GetPlaneInstructorsEdit","GetIfCurrent","requirements","seats","clear_booking","submitted","seats_in_plane","no_seats","invite_new_passenger","new_pax","email","is_member","invited_by","AddPassenger","update_passenger_list","show_new_passenger_invitation","add_new_passenger","not_found","close_passenger_invitation","set_new_member","get_pax_class","new_passenger_invite_ready","email_regex","remove_passenger","cancel_booking","prompt","DeleteBooking","get_all_members","GetAllByClub","members","all_members","invite_passenger","passenger_membership_id","refresh_passenger","GetInvite","invitation_token","GetPassengers","resend_invitation","to_resend","ResendInvitation","refresh_all_passenger","next","get_passenger_status","cid","bed","bed2","GetAllActiveByClub","get_members","remove_invite","init_passengers","pax_invited","pax","get_passenger_status_edit","GetAllByClubAndName","filtered_array","ar","rm","splits","save","create","update","mytime","select_plane","val","start_split","end_split","get_times","tofrom","m","y","h","default_end","luxon","DateTime","fromISO","plus","toISO","calendarOptions","initialView","calendarEvents","booked_by_admin_instructor","booked_by","more","addon","allow_override","reason","popup2","popup3","popup4","open2","open3","open4","member_id","modalInstance","animation","templateUrl","size","resolve","warning","warning_msg","BookingsController","toIsoString","adding_a_member","no_of_seats","to_remove","DeleteInvitation","BookoutController","$cookieStore","AuthenticationService","current_tacho","estimated_fuel","consumption","last_position","amend_booking","accept_defects","reject_defects","user_obj","ChangeInvitation","InvitePassenger","invite","extra_information_required","filing_flightplan","GetForBookout","GetByIdMaintenance","process_booking_to_bookout","licence_issue_date","licence_expiry_date","rating_id","expiry_date","user_licences","licences","base64ToBlob","base64","binaryString","atob","len","bytes","Uint8Array","charCodeAt","show_file_now","show_file_url","show_file","close_file","insurance","certificate","radio_licence","maintenance","days_remaining","hours_remaining","days_to_expiry","GetChargesByCourseId","selected_location","selected_airfield_check","bookout_plane","bookout_obj","is_pilot_current","booked_out","endurance_time","endurance","estimated_enroute_time","en_route","flight_rule","flight_notes","additional_details","parking_note","estimated_departure","departure","routing_via_id","routing_via","SendBookout","remove_real_file","delete_licence","data_uri","logout","Logout","ClearCredentials","remove","go_flying","CategoriesController","myModel","myUpdateHandler","ClaimAFlightController","initController","GetFoxEntries","difference_times","to_datetime","from_datetime","difference_times_decimal","airborne_decimal","airborne_to_hours","ClubDocumentsController","current_club_admin","uploaded_document","document_id","club_documents","save_name","extension","the_file","to_send","my_file","description","doc_id","ClubPaymentsController","PoidService","poid_images","poid","customer_token","get_addresses","GetAddresses","postcode","addresses","card_id","ClubSignupController","ClubService","GoCardService","$cookies","companies","selected_company","selected_phone","verified_mobile","text_verification","check_id","prefix","countries","loc","last","pre","Verify","response","mid","bid","SetupGoCard","go_to_login","verify_mobile","VerifyPhone","get_companies","GetCompany","prefix_length","set_prefix","set_company","GetCompanyDetail","company_number","company","sort_company_data","formData","is_company","phone","officers","officer","company_details","user_is_named_on_company_selected","matched","company_name","trading_as","date_of_creation","address_line_1","registered_office_address","address_line_2","city","locality","post_code","postal_code","dob_year","date_of_birth","year","dob_month","month","role","officer_role","setup_direct_debit","checkValid","password","password2","removeClass","addClass","strongPassword","RegExp","checkValidity","not","CountryCode","mobile","tnc","processForm","html","defaults","common","CreateGalleryController","ImagesService","KeywordsService","LocalDataService","GalleryService","gallery","is_protected","download_low","download_medium","download_high","gallery_link","fullscreen","all_galleries","selected_images","remove_image","SetSelectedImages","check_link_unique","generate_gallery","DashboardClubAirframeLogbookController","MedicalService","DifferencesService","GetByIdMaintenance2","this_plane_id","next_check","next_maintenance","check_date","extension_granted","prop_no","getAge","dateString","birthDate","age","GetAirframeLogs","update_logbooks","UpdateAircraftLogbooks","update_this_file","plane_documents","radio","cert","processFile","fft","set_title","delete_poid","save_plane_documents","change_file_name","club_plane_id","entry_date","DashboardClubCourseController","course_document","course_documents","course_certificate","course_noise","course_radio","course_maintenance","course_insurance","lessons","exams","tags","editing","edit_course","GetCourseById","GetLessonsByCourseId","refresh_exams","refresh_tags","refresh_charges","GetExamsByCourseId","GetTagsByCourseId","save_lesson_order","update_order","me","UpdateLessonOrder","delete_lesson","DeleteLesson","update_exam","exam","edit_me","UpdateExam","update_cancel","edit_exam","delete_exam","DeleteExam","add_exam","new_exam","CreateExam","update_tag","tag","UpdateTags","update_cancel_tag","edit_tag","delete_tag","DeleteTags","add_tag","new_tag","CreateTags","update_charge","charge","UpdateCharge","update_cancel_charge","edit_charge","delete_charge","DeleteCharge","add_charge","new_charge","CreateCharge","delete_course","DeleteCourse","CreateCourse","get_update_docs","UpdateCourse","containsObject","list","count_success","add_item","temporary","rating","add_licence","licence_title","abbreviation","rating_title","medical_authority","medical_component","add_medical","authority_title","medical_component_id","medical_component_title","medical","add_difference","difference_id","difference_title","differences","noise","DashboardClubEngineLogbookController","GetEngineLogs","engine_id","engine","DashboardClubExperienceDiscountsController","ExperiencesService","plane_document","experiences","GetDiscountsByClubId","check_code","experience_id","experience","CreateDiscount","DeleteDiscount","UpdateDiscount","check_all","remove_item","DashboardClubExperiencesController","DashboardClubFlightsController","currency_types","gear_types","certificates","value","classes","to_date","from_date","setMonth","GetAllFlightsByClub","selected_aircraft","totals","airframe_hours","vp","rg","tb","plane_engine_1","engine_1","plane_engine_2","engine_2","plane_propeller_1","propeller_1","plane_propeller_2","propeller_2","my_return","set_aircraft_details","GetAddAircraft","plane_search","processNewAircraft","manufacturer","serial_no","serial_number","icao_type","type_name","year_built","aircraft_id","mtow","noise_level","regex","plane_noise","match","map","v","noise_cert_issue","aircraft_class","is_propeller","engine_name","plane_class","number_of_engines","gear_type","plane_maintenance","cofa_category","certificate_expiry","cofa_expiry","make","propeller_manufacturer","propeller_name","number_of_engine","update_ac","search_for_flights","add_documents","maintenance_type","plane_radio","plane_insurance","noise_cert","update_documents","save_new_aircraft_bit","num","comb","comb2","item_update","removed_date","old_item","new_item","no","UpdateAircraftBit","plane_to_add","get_aircraft","toUpperCase","DashboardClubFlyingController","payment_now","sortType","sortReverse","searchTool","memberships","GetIncompleteClub","bookouts","get_pax_html","flight_obj","nok","relationship","phone_number","email_address","telephone_number","nok2","instructor_nok","noks","nok1","user_nok","load_adsb","icao_hex","cancel_bookout","CancelBookout","DashboardClubInstructorBookings","edit_instructor","rgbaToHex","rgba","inParts","r","trim","g","outParts","part","hexToRGBA","hex","opacity","save_instructor","new_colour","instructor_colour","new_booking_colour","booking_colour","edit","UpdateInstructor","save_instructor_order","display_order","UpdateOrder","colour","bg_colour","DashboardClubInstructorChargesController","DashboardClubInvoicesController","GetClubInvoices","quick_select","base_date","yesterday","sevendaysago","thirtydaysago","setDate","getMonday","day","getDay","getSunday","sunday","firstDay","lastDay","lm_firstDay","lm_lastDay","quick_selects","update_qs","update_date_range","DashboardClubItemsController","ItemService","item_id","DashboardClubLessonController","lesson","lesson_document","lesson_documents","lesson_certificate","lesson_noise","lesson_radio","lesson_maintenance","lesson_insurance","new_tem","threat","consequence","mitigation","preflight","bullet_format","airex","debrief","GetLessonById","lesson_id","refresh_tem","refresh_bullets","refresh_items","GetBulletsByLessonId","bullets","GetTemByLessonId","tem","add_tem","CreateTem","update_tem","UpdateTem","edit_tem","delete_tem","DeleteTem","add_bullet","send_me","bullet_type","CreateBullet","update_bullet","bullet","UpdateBullet","update_cancel_bullet","edit_bullet","delete_bullet","DeleteBullet","save_bullet_order","UpdateBulletOrder","save_items_order","UpdateItemsOrder","save_tem_order","UpdateTemOrder","GetItemsByLessonId","CreateItem","update_item","UpdateItem","update_cancel_item","edit_item","delete_item","DeleteItem","CreateLesson","UpdateLesson","DashboardClubMaintenanceController","show_overlay","show_cert","show_maintenance","show_radio","show_noise","show_insurance","show_offline","issues","issue_confirmation","maintenance_types","GetAllByClubMaintenance","reset_aeroplane","ResetOneClubPlane","selected_type","send_obj","close_overlay","save_overlay","send_update","one_ticked","resolved","radio_expiry","expiry","date_issued","certificate_issue","insurance_expiry","noise_date","check_time","extension_hours","extension_days","offline_until","offline_notes","offline","AddMaintenance","check_ticked","count","close_cert","save_cert","close_insurance","save_insurance","close_radio","save_radio","close_noise","save_noise","close_maintenance","save_maintenance","getColours","DashboardClubMemberRequestsController","NokService","requests","auto_renew","update_requests","GetRequestsByClub","show_memberships","accept_request","ClubAcceptRequest","decline_request","ClubDeclineRequest","this_req","delete_request","DeleteRequest","resend_request","ResendRequest","request_id","DashboardClubMembersController","GetInvoicesUserClub","current_invoice_offset","add_credit_amount","add_credit_note","show_add_credit","is_manager","approved","GetByUserIdClub","poids","medicals","sign_off_date","night","vfr","ifr","differences_images","GetPackagesByUserIdAndClubId","change_package","calculate_change","new_percent","slider_val","slider_value","dual_percent","dual_hours","remaining_price","initial_dual_price","dual_price","remaining_solo_hours","initial_solo_price","solo_number","dual_number","solo_price","show_package_change","show_package_popup","slider","getElementById","hours_dual","hours_solo","solo_hours","hours_dual_remaining","hours_solo_remaining","base","remaining_ratio","percent","hide_package_change","refund_package_to_credit","check","RefundPackageToAccount","save_package_change","SwapPackageHours","change_numbers","add_credit","close_credit","apply_credit","obj_to_send","vat","is_credit_from_admin","direct_debit","credit_only","CreateCustom","all_invoices_loaded","GetUserJourneyLogs","load_more_invoices","membership_start","GetMemberPlanes","checkAll","selectedAll","selected","csvToJSON","content","lines","csv","columnCount","separator","header","imported_headers","currentline","apply_default_memberships","imported_users","membership","default_membership","parseLooseDate","opts","prefer","useUTC","utc","prototype","call","isNaN","getTime","isFinite","dNum","s","String","looksAmbiguousSlash","native","parts","datePart","timePart","every","n","normalizeYear","hh","mm","ss","mTime","dt","UTC","y2","getUTCFullYear","m2","getUTCMonth","d2","getUTCDate","change_header","parse_me","apply_default_start","stripDoubleQuotes","processData","tobesorter","import_users","test_mode","test_e","test_mail","matching","user_columns","dob","membership_number","matching_email","import_column","member_check","check_member_requirements","update_verification","verify","to_import_users","CreateMany","sa_dual","sa_solo","sa_instruct","select_all","select_all_what","book_dual","book_solo","instruct","deselect_all","invite_member","send_invite_by_club","process_member_start_dt","SaveMemberPlanes","refresh_members","select_member_approval","selected_members","update_membership","actually_open","document_type","verified","action_name","show_temp_login","create_sample","characters","charactersLength","random","re_login","Login3","re_login_pass","openDocument","maybe","doc_type","fail","DashboardClubMembershipsController","account_currency","passenger_only","passenger_only_default","GetAllMembershipPlanes","club_planes","membership_planes","plane_access","send_planes","tacho_hour_fee","membership_tacho_hour_fee","membership_landing_fee","membership_touch_and_go_fee","UpdateMembershipPlanes","previous_price","update_price","payment_term","DashboardClubPackagesController","planes_original","stringify","GetPackageById","available","GetPackagePlanesByPackageId","clean_aircraft_selection","GetPackagesByClubId","refresh_aircraft","delete_aircraft","DeletePackagePlane","new_aircraft2","new_aircraft","add_aircraft","CreatePackagePlane","decimal_time","temp","DeletePackage","CreatePackage","UpdatePackage","DashboardClubPaymentsController","ClubPaymentService","GetPaymentsByClub","get_payment_description","refund","to_refund","amount_refunded","Refund","DashboardClubPlanesController","plane_certificate","plane_engine_1_replace","plane_engine_2_replace","plane_propeller_1_replace","plane_propeller_2_replace","show_replace_engine_1","show_replace_engine_2","show_replace_prop_1","show_replace_prop_2","medical_authorities","GetComponents","medical_components","GetDifferences","save_planes_order","disable_reset","disable_reset2","fix_uncombined","FixUncombinedLogs","reset_all_club_logs","ResetAllClubPlanes","DashboardClubPropellerLogbookController","GetPropLogs","prop_id","propeller","DashboardClubReceiptsApprovalController","GetReceiptsApproval","verify_reimbursement","modified_price","UpdateReceipt","modified_currency","modified_reimbursed_amount","modified_reimbursed_difference","requested_at","modified_reimbursed_rate","modified_reimbursement_tooltip","added_currency","reimbursing","update_currency","update_invoice_no","update_qty","modified_quantity","approve_receipt_final","ApproveReceipt","findIndex","show_popup","current_receipt","reject_receipt_final","RejectReceipt","approve_receipt","reject_receipt","close_popup","DashboardClubReceiptsController","GetReceiptsClub","loaded_per_batc","DashboardClubSettingsController","settings","vat_registered","tpc_aircraft_surchages","vat_rate","stripe_id","SaveStripeLink","RefreshStripeLink","update_text","update_logo","logo","update_invoice_logo","invoice_logo","privacy_file","membership_file","passenger_file","gcl","salt","pepper","called_stripe_setup","generate_stripe_link","GenerateStripeLink","onboarding_link","term_documents","processFiles2","delete_file","filetype","to_delete","DashboardClubShopItemsController","ShopItemService","DashboardClubShopSaleController","club_settings","new_client","selected_client","selected_card","selected_voucher","show_direct_debit_details","custom_item","complete_now","shop_items","vouchers","discounts","unshift","calculate_charges","card_selected","member_selected","account_ending","selected_item","item_selected","package_selected","selected_package","new_item_qty","add_selected_voucher","voucher_id","add_me","selected_discount","discount_id","GetDiscountsByClubIdAndExperienceId","add_selected_discount","new_price","discount_type","discount","percentage","discount_code","add_selected_item","add_selected_package","item_sent","the_vat","this_vat","the_total","CompleteCustom","ok","cancel","DashboardClubVouchersAddController","VoucherService","show_paid","GetUniqueCode","elements","card_options","hidePostalCode","style","iconColor","color","lineHeight","fontWeight","fontFamily","fontSize","card","form","timeout","run","run2","setupStripe","clearTimeout","mount","addEventListener","createToken","$on","stripeTokenHandler","token","hiddenInput","appendChild","already_paid","price_paid","experience_title","address_zip","errorElement","textContent","brand","last4","hash","exp_month","exp_year","funding","address_postcode","client_ip","update_experience","valid_for","update_discount","DashboardClubVouchersController","DashboardClubVouchersEditController","CancelVoucher","DashboardController","CheckLoggedIn","bookings","to_pay","to_complete_split","force_show_admins","GetAdminClubs","load_bookings","GetTodayBookingsUser","GetBookoutsToComplete","DashboardCourseSyllabusController","load_course","load_lesson","GetCoursesByUserId","DashboardCourseSyllabusViewController","DashboardInstructorBriefController","current_club_instructor","selected_lesson","GetBookingsToBrief","briefings","GetBookingsToDebrief","show_split","GetForForDebriefPls","competences","record_club_id","all_items","student","log_sheet","all_lessons","all_tags","selected_flight_tags","GetForForDebrief","show_whole_lesson","show_all_lessons","tag_full_flight","update_flight_tag","update_flight_full_flight","tag_flight_time","show_whole_course","set_updated_search","save_progress","compiled_items","remarks","general_remarks","next_lesson","lesson_completed","compiled_save","completed_by","next_lesson_id","completed","flight_tags","CreateTrainingRecord","flight_tag","logging_time","tag_time_to_five","save_edit_record","show_dropdown","change_lesson","go_book_out","set_briefed","briefed","SetBookingToBriefed","DashboardStudentRecordsController","GetAllByClubStudents","student_id","GetAllForUser","update_club_selector","show_record","show_add_exam","load_records","GetStudentTrainingRecords","training_records","exam_records","course_totals","course_hours","log_sheets","my_search3","load_records_user","load_selected_flight","flight_id","add_exam_record","CreateExamRecord","get_remarks","record","object","lesson_item_id","get_result","grade_name","get_result3","get_competence","icons","icons2","grade_colour","grade_icon","get_competence2","get_flight_date","user_can_edit","get_record_details","record_details","completed_by_first_name","completed_by_last_name","get_record_details2","get_exam","exam_id","open_training_detail","show_edit_training_record","show_popup_name","flight_detail_id","user_can_edit_record","selected_flight","selected_record","selected_record_remarks","GetStudentTrainingRecordsForFlight","this_entry","show_edit_record","flight_tag_id","tag_time","is_lesson_completed","entry","update_record_id","edited_by","edit_reason","UpdateTrainingRecord","DashboardUserInstructorController","hstep","mstep","from_variable","to_variable","disabled_variable","timezone","from_default","to_default","GetAvailability","available_times","setZone","toHTTP","selected_club","selected_now","available_time","ismeridian","toggleMode","update_time","changed_time","disable_time","save_club_times","SetAvailability","allText","DashboardUserInstructorHolidayController","step","minRange","hours24","myDatetimeLabels","toggleDirective","whenTimeChange","timeRangePicker","dateRangePicker","_today","_yesterday","datePickerWithRange","max","addRemoveEventSource","sources","canAdd","addEvent","myFrom","myTo","delete_id","schedulerLicenseKey","height","left","center","right","slotEventOverlap","eventClick","eventDrop","eventResize","eventSources","FinishAndPayController","getShort","complete","GetAllByPics","PayBooking","show_add_card","GalleriesController","galleries","SetAllGalleries","selecting_for","fadeIn","edit_gallery_images","SetSelectingFor","save_images","images_to_save","fadeOut","save_gallery","check_gallery_link","generate_gallery_link","link2","duplicate_gallery","new_gallery","downloaded","delete_gallery","HomeController","deleteUser","loadCurrentUser","loadAllUsers","users","ImagesController","filters","all_artpieces","imageId","GetOne","one_image","keywords","keyword","all_keywords","init","select","update_selected_state","update_image_list","get_tags","filtering","filter_array","multi_level_filter","loop_content","$emit","current_category","change_category","all","artpieces_array","artpiece_filter","update_list","state","add_image","save_btn_text","url_save","editImage","loadClasses","loadTags","query","ab","startsWith","text_to_lower","deleteImage","InvitationsSignupController","sendVerification","total_invite","first_payment","redirect_flow_id","mandate","session","member_accepted","SetupMandate","add_element","bit_type","license","add_to","remove_element","Boolean","check_user_is_valid","membership_request_id","invitation","InviteSignup","uisref","gonext","VerifyInvitedUser","VerifyPhoneInvite","KeywordController","JSTagsCollection","jsTagOptions","suggestions","Bloodhound","datumTokenizer","tokenizers","whitespace","identify","queryTokenizer","prefetch","initialize","exampleData","displayKey","ttAdapter","exampleOptions","hint","highlight","CheckContent","KeywordsController","addKeyword","new_keyword","deleteKeyword","LoginController","login","login_session","login_key","Login0","dataLoading","Login1","Login2","SetCredentials2","ManageAccountController","avatar","address","address_line1","show_addresses","show_address","show_search","update_avatar","show_form","set_address","line1","address_line2","line2","address_line3","line3","address_line4","line4","address_locality","address_city","address_county","county","address_country","country","save_user","new_password","new_password2","show_error","ManageDifferencesController","all_differences","clean_differences_list","el","differences_id","add_differences","selected_differences","remove_differences","save_differences","ManageLicenceController","blurred","getDecrypted","ManageMedicalController","medical_images","components","GetMedicalTypes","medical_types","medical_id","examination_date","component_id","user_medicals","add_component","selected_component","remove_component","delete_medical","save_medical","medical_type","ManageMyMembershipsController","GetOneForUser","membership_now","default_card","GetRequestsById","request","GetUserMemberships","GetRequestsByUser","set_club","GetAllByClubAvailable","set_default_payment_method","default_payment_method","UpdateOneByUser","make_default_card","UpdateDefaultCard","delete_member_card","DeleteMemberCard","set_membership","show_confirmation","set_card","accept_it","club_tnc","AcceptRequest","update_it","edit_membership","create_direct_debit","update_request","change_direct_debit","update_mandate_details","GenerateUpdateLink","add_card","CreateNewCustomer","clientSecret","secret","appearance","paymentElementOptions","layout","paymentElement","confirmSetup","confirmParams","href","messageContainer","querySelector","try_charge_default_card","CreatePaymentIntent","save_added_card","card_tnc","requested_by","paid","SendRequest","ManageMyMembershipsDirectDebitController","ManageNokController","nok_id","delete_nok","save_nok","ManagePaymentsAddController","iframe_url","prefill_details","delete_card","get_paybase_token","GetUserForPayment","trustAsResourceUrl","ev","Create2","data2","ManagePaymentsController","change_address","billing_address","flatNumber","houseNameNumber","townCity","region","postalCode","countryISO","change_address_for","GetCardDetails","billingAddress","save_address","UpdateCard","decline_change","changePrimary","ChangePrimary","ManagePoidController","poid_id","user_poids","save_poid","ModalInstanceCtrl","$uibModalInstance","dismiss","MyAccountController","MyJourneyLogsController","GetMyJourneyLogs","user_totals","NewChargeModalInstanceCtrl","card_obj","create_invoice","PassengerSignupCompleteController","checked_identity","is_already_user","submit_button","gotologin","formcode","checkedcode","goToNextInput","no_len","keyCode","thecode","combine","GetPaxSecureInvite2","submit_user_for_signup","SignupUserFromPassenger","PassengerSignupController","calculate_age","birthday","ageDifMs","now","ageDate","guardian","validate_age","checking_validity","next_of_kin","check_nok","submit_passenger","guardianship","self_dob","ConfirmPaxInvite","GetPaxSecureInvite","PasswordResetController","show_error2","show_thankyou","password_reset","ResetPassword","go_login","password_reset2","ResetPassword2","thank_you","RefundModalInstanceCtrl","remaining","RegisterController","verify_status","register","Success","Error","userId","ReviewBookingsController","get_the_approval_list","GetBookingsToReview","approve_booking","AcceptBooking","decline_booking","DeclineBooking","view_booking","GetAllInstructor","can_be_edited","GetAllUserClub","ShowGalleryController","GetByUrl","is_disabled","password_protected","load_image","change_image","show_fullscreen","hide","hide_fullscreen","show","fullscreen_next","fullscreen_previous","prev","download","DownloadZip","gallery_id","quality","zip_url","click","UpdateMyMembershipDirectDebitController","return_id","UpdateMandate","UploadController","ImageUploadService","CheckData","images_array","tmp_name","compiled_send","artpiece_id","artme","UsersController","this_user","default_pwd","UserSignupController","licenses","person","selectedSingle","selectedSingleKey","people","$valid"],"mappings":"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cI,OAAd,CAAwB,KAAxB,CACH,CAEDhT,EAAE,CAACgS,YAAH,CAAkB,IAAlB,CACAhS,EAAE,CAACiS,YAAH,CAAkB,KAAlB,CACH,CAEJ,CAhCL,EAwCF;AACH,CA3DD,IA2DO,CACH;AACA;AACAjS,EAAE,CAACiS,YAAH,CAAkB,KAAlB,CAEH,CAEJ,CApED,EA4EF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AAIA;AAEA;AACA;AAEA;AAEA;AAEA;AAGA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AAQA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AAMA;AAMD,CAhTD,CAkTAxR,MAAM,CAACg+D,MAAP,CAAgB,UAAY,CAEV/9D,MAAM,CAACqmB,EAAP,CAAU,uBAAV,CAAmC,EAAnC,CAAuC,CAAEC,MAAM,CAAE,IAAV,CAAvC,EAEjB,CAJD,CAeA;AAGF;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AAEA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AAIA;AACA;AACA;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AX,CAAmBC,WAA7B,CACAH,EAAE,CAAC0E,OAAH,CAAa1E,EAAE,CAACC,IAAH,CAAQ8B,EAArB,CAEA/B,EAAE,CAAC2pC,cAAH,CAAoB,EAApB,CACAlpC,MAAM,CAAC06E,UAAP,CAAoB,EAApB,CAEAn7E,EAAE,CAAC67E,cAAH,CAAoB,KAApB,CAGA77E,EAAE,CAAC87E,eAAH,CAAqB,CACjBC,UAAU,CAAE,EADK,CAEjBC,eAAe,CAAE,EAFA,CAGjBC,QAAQ,CAAE,EAHO,CAIjBC,MAAM,CAAE,EAJS,CAKjBC,UAAU,CAAE,EALK,CAMjBC,UAAU,CAAE,EANK,CAArB,CAaA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAGA;AACA;AACA;AAGA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AAIA;AAEA;AACA;AACA;AAEAp8E,EAAE,CAACq8E,kBAAH,CAAwB,EAAxB,CAGA57E,MAAM,CAACo7E,cAAP,CAAwB,SAAS7xC,OAAT,CAAiB,CAErChqC,EAAE,CAACq8E,kBAAH,CAAwBryC,OAAxB,CAEAj4B,cAAc,CAACuqE,cAAf,CAA8BtyC,OAA9B,EACKvoC,IADL,CACU,SAAUC,IAAV,CAAgB,CAClB,GAAGA,IAAH,CAAQ,CAEJ;AACA1B,EAAE,CAAC87E,eAAH,CAAqBp6E,IAAI,CAAC66E,cAA1B,CACA;AACAv8E,EAAE,CAAC67E,cAAH,CA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FD,IAEO,CACNkK,QAAQ,CAACi9C,cAAT,CAAwB,SAAS92C,MAAM,CAAG,CAAlB,CAAxB,EAA+C2jC,KAA/C,CAAuD,EAAvD,CACA9pC,QAAQ,CAACi9C,cAAT,CAAwB,SAAS92C,MAAM,CAAG,CAAlB,CAAxB,EAA8CrQ,KAA9C,GACA,MAAO,MAAP,CACA,CAEF,CAlIA,CA0IC;AACA;AAEA;AAEA;AACA;AACA;AACA;AAYH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAMA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;A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","sourcesContent":["/*! ToAviate - v4.0.1 - 2026-02-06 */ app.controller('AccountController', AccountController);\n\n    AccountController.$inject = ['UserService', '$rootScope', '$location'];\n    function AccountController(UserService, $rootScope, $location) {\n        var vm = this;\n        //not much happening here...\n        vm.user = $rootScope.globals.currentUser;\n\n        // UserService.GetById($rootScope.globals.currentUser.id)\n        //         .then(function (data) {\n        //             vm.user = data.user;\n        //         });\n\n    }\n app.controller('AddLicenceController', AddLicenceController);\n\n    AddLicenceController.$inject = ['UserService', 'MemberService', 'InstructorService', 'MembershipService', 'HolidayService', '$rootScope', '$location', '$scope', '$state', '$stateParams', '$uibModal', '$log', '$window', '$compile', '$timeout', 'uiCalendarConfig', 'BookingService', 'LicenceService'];\n    function AddLicenceController(UserService, MemberService, InstructorService, MembershipService, HolidayService, $rootScope, $location, $scope, $state, $stateParams, $uibModal, $log, $window, $compile, $timeout, uiCalendarConfig, BookingService, LicenceService) {\n        \n        var vm = this;\n        vm.licence_images = [];\n        vm.licence = {\n                images: [],\n                ratings: []\n        };\n        //vm.user_id = 59;\n\n        // //console.log(\"THIS GETS CALLED ALEX\");\n\n        LicenceService.GetLicenceTypes()\n                .then(function (data) {\n                    vm.licence_types = data;\n                    // //console.log(\"licence_types: \", vm.licence_types);\n                });\n\n        LicenceService.GetRatings()\n            .then(function (data) {\n                vm.ratings = data;\n                // //console.log(\"ratings: \", vm.ratings);\n                    // //console.log(\"THIS GETS EXECUTED\");\n                    //got to set this as we're only adding here\n                    for(var i=0;i<vm.ratings.length; i++){\n                        // //console.log(\"LOOP\", vm.ratings[i]);\n                        if(vm.ratings[i].id == 7){\n                            vm.selected_rating = vm.ratings[i];\n                            // //console.log(\"FOUND\", vm.selected_rating);\n                            $scope.add_rating();\n                            break;\n                        }\n                    }\n            });\n\n        LicenceService.GetAuthority()\n            .then(function (data) {\n                vm.authority = data;\n                // //console.log(\"authority: \", vm.authority);\n            });\n\n\n\n\n            $scope.add_rating = function(){\n\n                //remove from first array\n                vm.ratings = $.grep(vm.ratings, function(e){ \n                    return e.id != vm.selected_rating.id; \n                });\n\n                vm.licence.ratings.push(vm.selected_rating);\n\n                //clear selected\n                delete vm.selected_rating;\n                \n                //clean the array to show what we want to show :)\n                //delete $scope.formData.license.add_to[bit_type];\n\n            }\n\n            $scope.remove_rating = function(index){\n\n                //add to dropdown\n                vm.ratings.push(vm.licence.ratings[index]);\n                vm.licence.ratings.splice(index,1)\n\n            }\n\n\n            $scope.popup = [];\n\n            $scope.open = function(id, $event) {\n                // //console.log(\"THIS\", id);\n                //this comment would allow the event not to be affect by clicking it again... not sure this is a good idea\n                if($scope.popup[id] && $scope.popup[id].opened == true){\n                    $event.preventDefault();\n                    $event.stopPropagation();\n                } else {\n                    $scope.popup[id] = {opened: true};\n                }\n            };\n\n            $scope.formats = ['dd/MM/yyyy', 'yyyy/MM/dd', 'dd.MM.yyyy', 'shortDate'];\n            $scope.format = $scope.formats[0];\n\n            $scope.datePickerOptions = {\n                                        format: 'dd/MM/yyyy',\n                                        showWeeks: false\n                                    };\n\n           \n          \n          $scope.remove_file = function(file, current_files){\n\n            //remove_file\n            var j = JSON.parse(file.file_return);\n            // //console.log(\"REMOVE: \", j);\n            // //console.log(\"REMOVE: \", j.saved_url);\n\n            //to delete the temp file created: j.saved_url\n            //tmp_rm.php POST tmp = filename\n            \n            LicenceService.DeleteTmp(j.saved_url)\n                .then(function (data) {\n                    // //console.log(data);\n                    if(data.success){\n                        // //console.log(\"HUZZAH\", current_files);\n                        //then we need to remove this from the list of files...\n                        //clear files\n                        vm.licence_images = [];\n                        //and re-process available files\n                        $scope.processFiles(current_files);\n\n                    } else {\n                        // //console.log(\"WOOOPSIES...\");\n                        //this should be very very rare...\n                    }\n\n                });\n\n          }\n          \n\n            $scope.processFiles = function(files){\n                // //console.log(\"files\", files);\n\n                for(var i=0; i<files.length; i++){\n                    // //console.log(\"JSON\", files[i].file_return);\n                    var j = JSON.parse(files[i].file_return);\n                    // //console.log(\"PARSED\", j);\n                    files[i].file.temp_path = j.saved_url;\n                    // //console.log(\"file\", files[i].file);\n                    vm.licence_images.push(files[i].file);\n                }\n               \n            }\n\n\n\n\n\n\n\n\n            $scope.save_licence = function(isValid){\n\n                if(vm.licence_images.length < 1 && vm.licence.images.length < 1){\n\n                    $(\".drop\").focus();\n                    alert(\"You must at least have 1 image of your licence!\");\n\n                    return false;   \n                }\n\n\n                if(!vm.licence.licence_type){\n                    $(\"#licence_type\").focus();\n                    alert(\"You must select a licence type\");\n\n                    return false;\n                }\n\n\n                if(!vm.licence.state_of_issue){\n                    $(\"#state_of_issue\").focus();\n                    alert(\"You must select a licence state of issue\");\n\n                    return false;\n                }\n\n\n                if(vm.licence.ratings.length < 1){\n\n                    $(\"#ratings\").focus();\n                    alert(\"You must at least have 1 rating!\");\n                    \n                    return false;   \n                }\n\n                // //console.log(\"FLOW: \", vm.licence_images);\n\n\n\n                //compile the required elements YAY\n\n                // //console.log(\"LICENCE GOOD TO GO \", vm.licence);\n\n                if(vm.licence.id){\n                    //then its an udpate\n\n                    //merge the images left?\n\n\n                } else {\n\n\n                    //clean shizzle before sending\n                    vm.licence.images = vm.licence_images;\n                    vm.licence.licence_id = vm.licence.licence_type.id;\n                    vm.licence.authority_id = vm.licence.state_of_issue.id;\n                    vm.licence.user_id = vm.user_id;\n\n                    delete vm.licence.licence_type;\n                    delete vm.licence.state_of_issue;\n\n\n                    //then its a create\n                    // //console.log(vm.licence);\n\n                    LicenceService.Create(vm.licence)\n                        .then(function (data) {\n                            //console.log(data);\n                            if(data.success){\n                                // //console.log(\"HUZZAH\", vm.licence);\n                                // //console.log(\"HUZZAH\", data);\n                                //then we need to remove this from the list of files...\n                                \n                                \n                                //move somewhere?\n\n\n\n\n\n                            } else {\n\n                                alert(\"Something went terribly wrong... \\n\\n \"+data.message);\n\n                            }\n\n                        });\n\n\n                }\n\n\n\n            };\n\n\n        \n        \n\n\n    }\n app.controller('AircraftJourneyLogsController', AircraftJourneyLogsController);\n\n    AircraftJourneyLogsController.$inject = ['UserService', 'MemberService', 'InstructorService', 'MembershipService', 'HolidayService', '$rootScope', '$location', '$scope', '$state', '$stateParams', '$uibModal', '$log', '$window', '$compile', '$timeout', 'uiCalendarConfig', 'BookingService', 'LicenceService', 'ClubDocumentService', 'PlaneDocumentService', '$http', 'PlaneService', '$sce'];\n    function AircraftJourneyLogsController(UserService, MemberService, InstructorService, MembershipService, HolidayService, $rootScope, $location, $scope, $state, $stateParams, $uibModal, $log, $window, $compile, $timeout, uiCalendarConfig, BookingService, LicenceService, ClubDocumentService, PlaneDocumentService, $http, PlaneService, $sce) {\n        \n        var vm = this;\n\n        vm.clubs = [];\n        vm.user = $rootScope.globals.currentUser;\n        vm.user_id = vm.user.id;\n\n\n        vm.looking_for = $stateParams.registration;\n        if(vm.looking_for){\n            $scope.my_search2 = vm.looking_for;\n        }\n\n\n        vm.defect_severity;\n        vm.defect_severities = [\n            { title: \"No Fly Item - Ground the plane\"},\n            { title: \"Flyable - needs to be checked at next maintenance\"},\n            { title: \"Not urgent - but needs noting\"},\n            { title: \"Unsure of severity\"}\n        ]; \n\n\n        // //console.log(\"MAIN PLANE id: \", $stateParams.plane_id);\n\n\n        ////console.log(\"REG: \"+$stateParams.registration);\n\n\n         PlaneService.GetAircraftJourneyLogs($stateParams.plane_id, 0, 25)\n            .then(function (data) {\n                    // //console.log(\"ALL is : \", data);\n                   vm.logs = data.logs;\n                   vm.aircraft = data.aircraft;\n\n\n                });\n\n            vm.current_offset = 0;\n            vm.loaded_per_batch = 25;\n            vm.all_loaded = false;\n\n            vm.load_more = function(){\n                vm.current_offset = vm.current_offset + vm.loaded_per_batch;\n                PlaneService.GetAircraftJourneyLogs($stateParams.plane_id, vm.current_offset, vm.loaded_per_batch)\n                .then(function (data) {\n                        // //console.log(\"ALL is : \", data);\n                        if(data.logs.length > 0){\n                            data.logs.forEach(log => vm.logs.push(log));\n                        } else {\n                            vm.all_loaded = true;\n                        }\n                       //vm.logs = data.logs;\n\n\n                    });\n\n            }\n\n\n\n            vm.get_initial = function(text){\n                return (!!text) ? text.charAt(0) : '';\n            }\n\n\n            vm.clean_times = function(time){\n                if(time == \"00:00:00\"){\n                    return \" - \";\n                }\n                return time.substring(0,5);\n            }\n\n            vm.round_brake_times = function(first, second, start_end){\n                if(start_end == 0){\n                    //first = brakes_off\n                    //second = takeoff\n                    if(second < first){\n                        \n                    }\n\n                } else {\n                    //first = landing\n                    //second = takeoff\n\n                }\n            }\n\n\n            vm.round_brake_times_end = function(input, earlier_input=null){\n            \n                if(input){\n                  if(input.indexOf(\":\") > -1){\n                    var split = input.split(\":\");\n                    var x = split[1];\n\n\n\n                    var min_nearest_five = ((x % 5) >= 2.5 ? parseInt(x / 5) * 5 + 5 : parseInt(x / 5) * 5);\n                    \n\n\n                    if(min_nearest_five < 10){\n                      min_nearest_five = \"0\"+min_nearest_five;\n                    } else if(min_nearest_five == 60){\n                      split[0]++;\n                      min_nearest_five = \"00\";\n                    } else if(min_nearest_five > 60){\n                      split[0]++;\n                      min_nearest_five = (min_nearest_five - 60);\n                    }\n\n\n                    if(earlier_input && earlier_input.indexOf(\":\") > -1){\n                            // console.log(\"total calculated?\");\n                            // console.log(\"earlier_input: \", earlier_input);\n                            // console.log(\"input: \", input);\n                            var esplit = earlier_input.split(\":\");\n                            var ehour = esplit[0];\n                            var emin = esplit[1];\n                            var etot = (parseInt(ehour)*60) + parseInt(emin); \n                            // console.log(\"etot: \", etot);\n                            var hr = split[0];\n                            var mn = min_nearest_five;\n                            var tot = (parseInt(hr)*60) + parseInt(mn);\n                            // console.log(\"tot: \", tot);\n\n                            if(etot > tot){\n                                //the earlier time is after the end time\n                                // console.log(\"etot > tot\");\n                                min_nearest_five = parseInt(min_nearest_five) + 5;\n                                if(min_nearest_five == 60){\n                                    split[0]++; \n                                    min_nearest_five = \"00\";\n                                } else if(min_nearest_five > 60){\n                                    split[0]++;\n                                    min_nearest_five = (min_nearest_five - 60);\n                                    if(min_nearest_five < 10 ){\n                                      min_nearest_five = \"0\"+min_nearest_five;\n                                    }\n                                }\n                                // console.log(\"split: \", split[0]);\n                                // console.log(\"min_nearest_five: \", min_nearest_five);\n                            }\n\n                    }\n                    //essentially we add 5 in case something happens over the limit\n\n                    return split[0] + \":\" + min_nearest_five;\n                  } else {\n                    return input;\n                  }\n                } else {\n                  return '';\n                }\n          \n\n          }\n\n\n\n\n          vm.round_brake_times_start = function(input, earlier_input=null){\n            \n                if(input){\n                  if(input.indexOf(\":\") > -1){\n                    var split = input.split(\":\");\n                    var x = split[1];\n\n\n\n                    var min_nearest_five = ((x % 5) >= 2.5 ? parseInt(x / 5) * 5 + 5 : parseInt(x / 5) * 5);\n                    \n\n\n                    if(min_nearest_five < 10){\n                      min_nearest_five = \"0\"+min_nearest_five;\n                    } else if(min_nearest_five == 60){\n                      split[0]++;\n                      min_nearest_five = \"00\";\n                    } else if(min_nearest_five > 60){\n                      split[0]++;\n                      min_nearest_five = (min_nearest_five - 60);\n                    }\n\n\n                    if(earlier_input && earlier_input.indexOf(\":\") > -1){\n                            // console.log(\"total calculated?\");\n                            // console.log(\"earlier_input: \", earlier_input);\n                            // console.log(\"input: \", input);\n                            var esplit = earlier_input.split(\":\");\n                            var ehour = esplit[0];\n                            var emin = esplit[1];\n                            var etot = (parseInt(ehour)*60) + parseInt(emin); \n                            // console.log(\"etot: \", etot);\n                            var hr = split[0];\n                            var mn = min_nearest_five;\n                            var tot = (parseInt(hr)*60) + parseInt(mn);\n                            // console.log(\"tot: \", tot);\n\n                            if(etot < tot){\n                                //the earlier time is after the end time\n                                // console.log(\"etot < tot\");\n                                min_nearest_five = parseInt(min_nearest_five) - 5;\n                                if(min_nearest_five == 60){\n                                    split[0]++; \n                                    min_nearest_five = \"00\";\n                                } else if(min_nearest_five > 60){\n                                    split[0]++;\n                                    min_nearest_five = (min_nearest_five - 60);\n                                    if(min_nearest_five < 10 ){\n                                      min_nearest_five = \"0\"+min_nearest_five;\n                                    }\n                                } else if(min_nearest_five < 0){\n                                    split[0]--;\n                                    min_nearest_five = (60 + parseInt(min_nearest_five));\n                                }\n                                // console.log(\"split: \", split[0]);\n                                // console.log(\"min_nearest_five: \", min_nearest_five);\n                            }\n\n                    }\n                    //essentially we add 5 in case something happens over the limit\n\n                    return split[0] + \":\" + min_nearest_five;\n                  } else {\n                    return input;\n                  }\n                } else {\n                  return '';\n                }\n          \n\n          }\n\n\n\n            $scope.filter_detail = function(show_all = 0){\n                return (show_all == 0) ? {status: \"open\"} : {};\n            }\n\n           \n          \n            $scope.get_icon = function(file){\n\n                var ft = file.name;\n                ft = ft.split('.').pop();\n                var icon_name = \"\";\n\n                // //console.log(\"FILE:\", ft);\n                // //console.log(\"index : \", ft.indexOf(\"pdf\"));\n                switch(true){\n                    case (ft.indexOf(\"pdf\") > -1):\n                        icon_name = \"pdf.png\";\n                    break;\n                    case (ft.indexOf(\"doc\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"docx\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"xls\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"xlsx\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"ppt\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"pptx\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"jpg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"jpeg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"png\") > -1):\n                        icon_name = \"png.png\";\n                    break;\n                    case (ft.indexOf(\"gif\") > -1):\n                        icon_name = \"gif.png\";\n                    break;\n                    case (ft.indexOf(\"zip\") > -1):\n                        icon_name = \"zip.png\";\n                    break;\n                    case (ft.indexOf(\"avi\") > -1):\n                        icon_name = \"avi.png\";\n                    break;\n                    case (ft.indexOf(\"mp4\") > -1):\n                        icon_name = \"mp4.png\";\n                    break;\n                    default:\n                        icon_name = \"file.png\";\n                    break;\n                }\n\n                // //console.log(\"FILE:\", icon_name);\n\n                return \"images/file_icons/\"+icon_name;\n            }\n\n\n            vm.get_icon2 = function(file){\n\n                var ft = file.split('.').pop();\n                // //console.log(\"ICON 2 : \", ft);\n                var icon_name = \"\";\n\n                // //console.log(\"FILE:\", ft);\n                // //console.log(\"index : \", ft.indexOf(\"pdf\"));\n                switch(true){\n                    case (ft.indexOf(\"pdf\") > -1):\n                        icon_name = \"pdf.png\";\n                    break;\n                    case (ft.indexOf(\"doc\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"docx\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"xls\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"xlsx\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"ppt\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"pptx\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"jpg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"jpeg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"png\") > -1):\n                        icon_name = \"png.png\";\n                    break;\n                    case (ft.indexOf(\"gif\") > -1):\n                        icon_name = \"gif.png\";\n                    break;\n                    case (ft.indexOf(\"zip\") > -1):\n                        icon_name = \"zip.png\";\n                    break;\n                    case (ft.indexOf(\"avi\") > -1):\n                        icon_name = \"avi.png\";\n                    break;\n                    case (ft.indexOf(\"mp4\") > -1):\n                        icon_name = \"mp4.png\";\n                    break;\n                    default:\n                        icon_name = \"file.png\";\n                    break;\n                }\n\n                // //console.log(\"FILE:\", icon_name);\n\n                return \"images/file_icons/\"+icon_name;\n            }\n\n        \n        $scope.search = function(row){\n            ////console.log(\"hi\", (angular.lowercase(row.title).indexOf(angular.lowercase($scope.my_search) || '') !== -1));\n            return (angular.lowercase(row.title).indexOf(angular.lowercase($scope.my_search) || '') !== -1);\n        };\n\n        function convert_string_to_date(date){\n            if(date && date.indexOf(\"/\") > -1){\n                //then we prob have a date:::\n                    var d = date.split(\"/\");\n                    var rtn = d[2]+\"-\"+d[1]+\"-\"+d[0];\n                    //console.log(\"D\", rtn);\n                    return rtn;\n            }\n        }\n\n        // function check_if_month(input) {\n        //     var months = [\"jan\", \"feb\", \"mar\", \"apr\", \"may\", \"jun\", \"jul\", \"aug\", \"sep\", \"oct\", \"nov\", \"dec\"];\n\n        //     var monthPartOfInput = input.substring(0, 3).toLowerCase();                         \n\n        //     // if (months.indexOf(monthPartOfInput) == -1){\n        //     //     // TODO: Show validation error\n        //     // }\n        // }\n\n        function test_date(search, date){\n\n\n            if(search.length < 2){\n                return false;\n            }\n\n            if(search && search.length <= 3){\n                if(date.indexOf(search) > -1){\n                    return true;\n                }\n            } else {\n                var parsed_date = \"\";\n                var b = moment(search);\n                if(b.isValid() && b.format(\"YYYY\") != \"2001\"){\n                    parsed_date = b.format(\"YYYY-MM-DD\");\n                } else if(b.isValid()){\n                    parsed_date = b.format(\"MM-DD\");\n                }\n\n\n                var search_type = 0;\n\n                if(parsed_date !== \"\" && date.indexOf(parsed_date) > -1){\n                    // //console.log(\"found\");\n                    return true;\n                } else {\n\n                    //backup in case of wrong parsing data::;\n                    //european method\n\n                    if(search.length <= 5 && search.length >= 4){\n\n                        var c = moment(search, \"DDMM\");\n                        // //console.log(\"C is : \", c);\n                        if(c.isValid()){\n                            var c2 = c.format(\"MM-DD\");\n                            if(date.indexOf(c2) > -1){\n                                return true;\n                            }\n                        }\n\n                    } else if(search.length == 8 || search.length == 10){\n                        \n                        var c = moment(search, \"DDMMYYYY\");\n                        // //console.log(\"C is : \", c);\n                        if(c.isValid()){\n                            var c2 = c.format(\"YYYY-MM-DD\");\n                            if(date.indexOf(c2) > -1){\n                                return true;\n                            }\n                        }\n\n                    }\n\n                    // //console.log(\"not found\");\n                    return false;\n                }\n            }\n\n        }\n\n\n        function test_name(fname, lname, search){\n\n            var search2 = search.toLowerCase();\n            var fullname = fname+\" \"+lname;\n            fullname = fullname.toLowerCase();    \n            // //console.log(\"fullname: \", fullname);\n            // //console.log(\"search: \", search2);\n            // //console.log(\"match: \", (fullname.indexOf(search2) > -1));\n            if(search.length > 2 && (fullname.indexOf(search2) > -1) ){\n                return true;\n            } else {\n                return false;\n            }\n\n        }\n\n        function test_aircraft(registration, search){\n\n            var search2 = search.toLowerCase();\n            var fullname = registration.replace(\"-\", \"\");\n            fullname = fullname.toLowerCase();    \n             ////console.log(\"fullname: \", fullname);\n            // //console.log(\"search: \", search2);\n            // //console.log(\"match: \", (fullname.indexOf(search2) > -1));\n            if(search.length > 2 && (fullname.indexOf(search2) > -1) ){\n                return true;\n            } else {\n                return false;\n            }\n\n        }\n\n        function test_airfield(search, name, code){\n            var name2 = name.toLowerCase();\n            var code2 = code.toLowerCase();\n            var search2 = search.toLowerCase();\n\n            if(search2.length > 2 && (name2.indexOf(search2) > -1)){\n                return true;\n            } else if(search2.length > 2 && (code2.indexOf(search2) > -1)){\n                return true;\n            } else {\n                return false;\n            }\n\n\n\n        }\n\n        $scope.search2 = function(row){\n            //(angular.lowercase(row.first_name).indexOf(angular.lowercase($scope.my_search2) || '') !== -1)  || (angular.lowercase(row.last_name).indexOf(angular.lowercase($scope.my_search2) || '') !== -1)\n            ////console.log(\"answer\", (angular.lowercase(row.flight_date).indexOf(angular.lowercase($scope.my_search2) || '') !== -1));\n            // return ((angular.lowercase(row.flight_date).indexOf(angular.lowercase($scope.my_search2) || (angular.lowercase(row.flight_time).indexOf(angular.lowercase($scope.my_search2)) || '') !== -1)));\n            //(angular.lowercase(row.flight_date).indexOf(angular.lowercase($scope.my_search2) || '') !== -1)\n           \n            // if( (test_date($scope.my_search2, row.flight_date)) || (angular.lowercase(row.destination_airport).indexOf(angular.lowercase($scope.my_search2) || '') !== -1) || (angular.lowercase(row.departure_airport).indexOf(angular.lowercase($scope.my_search2) || '') !== -1) || (angular.lowercase(row.destination_airport_code).indexOf(angular.lowercase($scope.my_search2) || '') !== -1) || (angular.lowercase(row.departure_airport_code).indexOf(angular.lowercase($scope.my_search2) || '') !== -1)){\n            //     return true;\n            // } else {\n            //     return false;\n            // }test_aircraft\n            ////console.log($scope.my_search2);\n            if(!$scope.my_search2 || ($scope.my_search2 == \"\")){\n                return true;\n            }else if(test_date($scope.my_search2, row.flight_date)){\n                return true;\n            } else if(test_name(row.first_name, row.last_name, $scope.my_search2 )){\n                return true;\n            } else if(test_airfield($scope.my_search2, row.departure_airport, row.departure_airport_code)){\n                return true;\n            } else if(test_airfield($scope.my_search2, row.destination_airport, row.destination_airport_code)){\n                return true;\n            }else {\n                return false;\n            }\n\n            // we are testing for the date, the pilot, the departure and destination.\n\n            // return (angular.lowercase(row.flight_date).indexOf(angular.lowercase($scope.my_search2) || '') !== -1); // ? (angular.lowercase(row.flight_date).indexOf(angular.lowercase($scope.my_search2) || '') !== -1) : (angular.lowercase(row.flight_time).indexOf(angular.lowercase($scope.my_search2) || '') !== -1);\n\n        };\n\n        $scope.getMySearchCount = function(str){\n            var docs = str.documents;\n            var total = 0;\n            for(var i=0;i<docs.length;i++){\n                if($scope.search(docs[i])){\n                    total++;\n                }\n            }\n            return total;\n        }\n\n        $scope.getMySearchCount2 = function(str){\n            var charges = str.charges;\n            var total = 0;\n            for(var i=0;i<charges.length;i++){\n                if($scope.search(charges[i])){\n                    total++;\n                }\n            }\n            return total;\n        }\n\n        //  $scope.get_hours_from_decimal = function(time){\n\n        //     if(time){\n        //         var n = new Date(0,0);\n        //         n.setMinutes(+time * 60);\n        //         return n.toTimeString().slice(0,5);\n        //     } else {\n        //         return \"N/A\";\n        //     }\n\n        // }\n\n        $scope.get_hours_from_decimal = function(time){\n\n            if(time){\n                 var sign = time < 0 ? \"-\" : \"\";\n                 var hour = Math.floor(Math.abs(time));\n                 var min = Math.round((Math.abs(time) * 60) % 60);\n                 if(min == 60){\n                     hour++;\n                     min = 0;\n                 }\n                 return sign + (hour < 10 ? \"0\" : \"\") + hour + \":\" + (min < 10 ? \"0\" : \"\") + min;\n             } else {\n                 return \"N/A\";\n             }\n        }\n\n\n\n\n\n        $scope.downloadDocument = function(doc, type) {\n            var data = $.param({\n                id: doc\n            });\n\n            //alert(\"type\", type);\n\n            var controller = \"plane_documents\";\n\n            switch(type){\n                 case \"radio\": \n                    controller = \"plane_radio_licence\";\n                break;\n                 case \"insurance\": \n                    controller = \"plane_insurance\";\n                break;\n                 case \"certificate\": \n                    controller = \"plane_certificate\";\n                break;\n                case \"noise\": \n                    controller = \"plane_documents\";\n                break;\n                case \"docs\": \n                    controller = \"plane_documents\";\n                break;\n                default:\n                    controller = \"plane_documents\";\n                break;\n            }\n\n            var ddd = doc.replace(/^.*[\\\\\\/]/, '');\n\n            $http.get('api/v1/'+controller+'/show_file/'+ddd, {\n                    responseType: 'arraybuffer'\n                })\n                .success(function(data, status, headers) {\n                    var zipName = processArrayBufferToBlob(data, headers);\n\n                    //Delete file from temp folder in server - file needs to remain open until blob is created\n                    //deleteFileFromServerTemp(zipName);\n                }).error(function(data, status) {\n                    alert(\"There was an error downloading the selected document(s).\");\n                })\n        };\n\n        $scope.downloadClubDocument = function(doc) {\n            var data = $.param({\n                id: doc\n            });\n\n            var ddd = doc.replace(/^.*[\\\\\\/]/, '');\n\n            $http.get('api/v1/club_documents/show_file/'+ddd, {\n                    responseType: 'arraybuffer'\n                })\n                .success(function(data, status, headers) {\n                    var zipName = processArrayBufferToBlob(data, headers);\n\n                    //Delete file from temp folder in server - file needs to remain open until blob is created\n                    //deleteFileFromServerTemp(zipName);\n                }).error(function(data, status) {\n                    alert(\"There was an error downloading the selected document(s).\");\n                })\n        };\n\n        // vm.list_pilots = function(row){\n\n        //     var p1 = \"\";\n        //     var put = \"\";\n\n        //     if(row.instructor_first_name && row.instructor_first_name !== null){\n        //         p1 = \"PIC: \"+row.instructor_first_name+\" \"+row.instructor_last_name;\n        //         put = \"<br />PUT: \"+row.first_name+\" \"+row.last_name;\n        //     } else {\n        //         if(row.first_name && row.first_name !== null){\n        //             p1 = \"PIC: \"+row.first_name+\" \"+row.last_name;\n        //         } else {\n        //             p1 = \"PIC not yet set!\";\n        //         }\n        //     }\n\n        //     return $sce.getTrustedHtml('<div>'+p1+' '+put+'</div>');\n\n        // }\n\n        vm.list_pilots = function(row){\n\n            var p1 = \"\";\n            var put = \"\";\n\n            // if(row.instructor_first_name && row.instructor_first_name !== null){\n            //     p1 = \"PIC: \"+row.instructor_first_name+\" \"+row.instructor_last_name;\n            //     put = \"<br />PUT: \"+row.first_name+\" \"+row.last_name;\n            // } else {\n            //     if(row.first_name && row.first_name !== null){\n            //         p1 = \"PIC: \"+row.first_name+\" \"+row.last_name;\n            //     } else {\n            //         p1 = \"PIC not yet set!\";\n            //     }\n            // }\n\n            p1 = \"PIC: \"+ vm.get_pic(row);\n            put = vm.get_put(row);\n            if(put && put !== \"\"){\n                put = \"<br />PUT: \" + put;\n            }\n\n            if(p1 && p1 == \"\"){\n                p1 = \"No PIC set yet!\";\n            }\n\n            return $sce.getTrustedHtml('<div>'+p1+' '+put+'</div>');\n\n        }\n\n        vm.get_pic = function(log){\n\n            var p1 = \"\";\n\n            if(log.pic_first_name && log.pic_first_name !== null){\n                p1 = vm.get_initial(log.pic_first_name) + \". \" + log.pic_last_name;\n            } else if(log.instructor_first_name && log.instructor_first_name !== \"\"){\n                p1 = vm.get_initial(log.instructor_first_name) + \". \" + log.instructor_last_name;\n            } else if(log.instructor_id == 0 && log.first_name && log.first_name !== \"\"){\n                p1 = vm.get_initial(log.first_name) + \". \" + log.last_name;\n            }\n\n            return p1;\n\n        }\n\n        vm.get_put = function(log){\n\n            var put = \"\";\n\n            if(log.put_first_name && log.put_first_name !== null){\n                put = vm.get_initial(log.put_first_name) + \". \" + log.put_last_name;\n            } else if(log.instructor_id > 0 && log.first_name && log.first_name !== \"\"){\n                put = vm.get_initial(log.first_name) + \". \" + log.last_name;\n            } \n\n            return put;\n\n        }\n\n        function processArrayBufferToBlob(data, headers) {\n            var octetStreamMime = 'application/octet-stream';\n            var success = false;\n\n            // Get the headers\n            headers = headers();\n            //var ttt = title.toLowerCase().replace(/\\W/g, '_');\n            // Get the filename from the x-filename header or default to \"download.bin\"\n            var filename = headers['x-filename'] || 'download.zip';\n\n            // Determine the content type from the header or default to \"application/octet-stream\"\n            var contentType = headers['content-type'] || octetStreamMime;\n\n            try {\n                // Try using msSaveBlob if supported\n                var blob = new Blob([data], {\n                    type: contentType\n                });\n                if (navigator.msSaveBlob)\n                    navigator.msSaveBlob(blob, filename);\n                else {\n                    // Try using other saveBlob implementations, if available\n                    var saveBlob = navigator.webkitSaveBlob || navigator.mozSaveBlob || navigator.saveBlob;\n                    if (saveBlob === undefined) throw \"Not supported\";\n                    saveBlob(blob, filename);\n                }\n                success = true;\n            } catch (ex) {\n                $log.info(\"saveBlob method failed with the following exception:\");\n                $log.info(ex);\n            }\n\n            if (!success) {\n                // Get the blob url creator\n                var urlCreator = window.URL || window.webkitURL || window.mozURL || window.msURL;\n                if (urlCreator) {\n                    // Try to use a download link\n                    var link = document.createElement('a');\n                    if ('download' in link) {\n                        // Try to simulate a click\n                        try {\n                            // Prepare a blob URL\n                            var blob = new Blob([data], {\n                                type: contentType\n                            });\n                            var url = urlCreator.createObjectURL(blob);\n                            link.setAttribute('href', url);\n\n                            // Set the download attribute (Supported in Chrome 14+ / Firefox 20+)\n                            link.setAttribute(\"download\", filename);\n\n                            // Simulate clicking the download link\n                            var event = document.createEvent('MouseEvents');\n                            event.initMouseEvent('click', true, true, window, 1, 0, 0, 0, 0, false, false, false, false, 0, null);\n                            link.dispatchEvent(event);\n                            success = true;\n\n                        } catch (ex) {\n                            $log.info(\"Download link method with simulated click failed with the following exception:\");\n                            $log.info(ex);\n                        }\n                    }\n\n                    if (!success) {\n                        // Fallback to window.location method\n                        try {\n                            // Prepare a blob URL\n                            // Use application/octet-stream when using window.location to force download\n                            var blob = new Blob([data], {\n                                type: octetStreamMime\n                            });\n                            var url = urlCreator.createObjectURL(blob);\n                            window.location = url;\n                            success = true;\n                        } catch (ex) {\n                            $log.info(\"Download link method with window.location failed with the following exception:\");\n                            $log.info(ex);\n                        }\n                    }\n                }\n            }\n\n            if (!success) {\n                // Fallback to window.open method\n                $log.info(\"No methods worked for saving the arraybuffer, using last resort window.open\");\n                window.open(httpPath, '_blank', '');\n            }\n            return filename;\n        };\n\n\n        $scope.get_icon2 = function(file){\n                // //console.log(\"FILE\", file);\n                if(!file || file == \"\"){\n                    return \"\";\n                }\n                var ft = file.split('.').pop();\n                // //console.log(\"ICON 2 : \", ft);\n                var icon_name = \"\";\n\n                // //console.log(\"FILE:\", ft);\n                // //console.log(\"index : \", ft.indexOf(\"pdf\"));\n                switch(true){\n                    case (ft.indexOf(\"pdf\") > -1):\n                        icon_name = \"pdf.png\";\n                    break;\n                    case (ft.indexOf(\"doc\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"docx\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"xls\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"xlsx\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"ppt\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"pptx\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"jpg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"jpeg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"png\") > -1):\n                        icon_name = \"png.png\";\n                    break;\n                    case (ft.indexOf(\"gif\") > -1):\n                        icon_name = \"gif.png\";\n                    break;\n                    case (ft.indexOf(\"zip\") > -1):\n                        icon_name = \"zip.png\";\n                    break;\n                    case (ft.indexOf(\"avi\") > -1):\n                        icon_name = \"avi.png\";\n                    break;\n                    case (ft.indexOf(\"mp4\") > -1):\n                        icon_name = \"mp4.png\";\n                    break;\n                    default:\n                        icon_name = \"file.png\";\n                    break;\n                }\n\n                // //console.log(\"FILE:\", icon_name);\n\n                return \"images/file_icons/\"+icon_name;\n            }\n      \n\n\n\n    }\n app.controller('AircraftStatusController', AircraftStatusController);\n\n    AircraftStatusController.$inject = ['UserService', 'MemberService', 'InstructorService', 'MembershipService', 'HolidayService', '$rootScope', '$location', '$scope', '$state', '$stateParams', '$uibModal', '$log', '$window', '$compile', '$timeout', 'uiCalendarConfig', 'BookingService', 'LicenceService', 'ClubDocumentService', 'PlaneDocumentService', '$http', 'PlaneService'];\n    function AircraftStatusController(UserService, MemberService, InstructorService, MembershipService, HolidayService, $rootScope, $location, $scope, $state, $stateParams, $uibModal, $log, $window, $compile, $timeout, uiCalendarConfig, BookingService, LicenceService, ClubDocumentService, PlaneDocumentService, $http, PlaneService) {\n        \n        var vm = this;\n\n        vm.clubs = [];\n        vm.user = $rootScope.globals.currentUser;\n        vm.user_id = vm.user.id;\n\n\n        vm.looking_for = $stateParams.registration;\n        if(vm.looking_for){\n            $scope.my_search2 = vm.looking_for;\n        }\n\n\n        vm.defect_severity;\n        vm.defect_severities = [\n            { title: \"No Fly Item - Ground the plane\"},\n            { title: \"Flyable - needs to be checked at next maintenance\"},\n            { title: \"Not urgent - but needs noting\"},\n            { title: \"Unsure of severity\"}\n        ]; \n\n\n        ////console.log(\"REG: \"+$stateParams.registration);\n\n\n         PlaneService.GetByUserMaintenance(vm.user.id)\n            .then(function (data) {\n                    ////console.log(\"data is : \", data);\n                   vm.clubs = data.clubs;\n\n\n\n\n                });\n\n\n            vm.get_initial = function(text){\n                return text.charAt(0);\n            }\n\n            vm.list_pilots = function(row){\n\n            var p1 = \"\";\n            var put = \"\";\n\n            // if(row.instructor_first_name && row.instructor_first_name !== null){\n            //     p1 = \"PIC: \"+row.instructor_first_name+\" \"+row.instructor_last_name;\n            //     put = \"<br />PUT: \"+row.first_name+\" \"+row.last_name;\n            // } else {\n            //     if(row.first_name && row.first_name !== null){\n            //         p1 = \"PIC: \"+row.first_name+\" \"+row.last_name;\n            //     } else {\n            //         p1 = \"PIC not yet set!\";\n            //     }\n            // }\n\n            p1 = \"PIC: \"+ vm.get_pic(row);\n            put = vm.get_put(row);\n            if(put && put !== \"\"){\n                put = \"<br />PUT: \" + put;\n            }\n\n            if(p1 && p1 == \"\"){\n                p1 = \"No PIC set yet!\";\n            }\n\n            return $sce.getTrustedHtml('<div>'+p1+' '+put+'</div>');\n\n        }\n\n        vm.get_pic = function(log){\n\n            var p1 = \"\";\n\n            if(log.pic_first_name && log.pic_first_name !== null){\n                p1 = vm.get_initial(log.pic_first_name) + \". \" + log.pic_last_name;\n            } else if(log.instructor_first_name && log.instructor_first_name !== \"\"){\n                p1 = vm.get_initial(log.instructor_first_name) + \". \" + log.instructor_last_name;\n            } else if(log.instructor_id == 0 && log.first_name && log.first_name !== \"\"){\n                p1 = vm.get_initial(log.first_name) + \". \" + log.last_name;\n            }\n\n            return p1;\n\n        }\n\n        vm.get_put = function(log){\n\n            var put = \"\";\n\n            if(log.put_first_name && log.put_first_name !== null){\n                put = vm.get_initial(log.put_first_name) + \". \" + log.put_last_name;\n            } else if(log.instructor_id > 0 && log.first_name && log.first_name !== \"\"){\n                put = vm.get_initial(log.first_name) + \". \" + log.last_name;\n            } \n\n            return put;\n\n        }\n\n            \n            vm.clean_times = function(time){\n                return time.substring(0,5);\n            }\n\n            vm.add_defect = function(plane_id, club_id){\n\n\n                var obj = {\n                    club_id: club_id,\n                    user_id: vm.user_id,\n                    plane_id: plane_id,\n                    defect: vm.defect,\n                    severity: vm.defect_severity.title,\n                    status: \"open\"\n                }\n\n\n\n                PlaneService.AddDefect(obj)\n                 .then(function (data) {\n                        ////console.log(\"data is : \", data);\n                        data.item.can_delete = true;\n\n                        //HELLO\n                        vm.clubs.find(club => club.id === club_id).planes.find(plane => plane.plane_id === plane_id).defects.push(data.item);\n                        //vm.reported_defects.push(data.item);\n\n                        vm.defect = \"\";\n                        vm.defect_severity = \"\";\n\n\n\n                    });\n\n            }\n\n            vm.delete_defect = function(id){\n                // //console.log(\"UNDO DEFECT ID \", id);\n\n                PlaneService.DeleteDefect(id)\n                .then(function (data) {\n                        ////console.log(\"data is : \", data);\n                       \n                        PlaneService.GetOpenIssues(vm.bookout.plane_id)\n                        .then(function (data) {\n                                ////console.log(\"data is : \", data);\n                               vm.reported_defects = data;\n                            });\n\n\n                    });\n\n            }\n\n\n            $scope.filter_detail = function(show_all = 0){\n                return (show_all == 0) ? {status: \"open\"} : {};\n            }\n\n            $scope.count_defects = function(defects, show_all = 0){\n\n               var counter = 0;\n\n               for(var i=0;i<defects.length;i++){\n                   if(show_all == 1){\n                       counter++;\n                   } else {\n                       if(defects[i].status == \"open\"){\n                           counter++;\n                       }\n                   }\n               }\n\n               return counter;\n\n           }\n          \n            $scope.get_icon = function(file){\n\n                var ft = file.name;\n                ft = ft.split('.').pop();\n                var icon_name = \"\";\n\n                // //console.log(\"FILE:\", ft);\n                // //console.log(\"index : \", ft.indexOf(\"pdf\"));\n                switch(true){\n                    case (ft.indexOf(\"pdf\") > -1):\n                        icon_name = \"pdf.png\";\n                    break;\n                    case (ft.indexOf(\"doc\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"docx\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"xls\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"xlsx\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"ppt\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"pptx\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"jpg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"jpeg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"png\") > -1):\n                        icon_name = \"png.png\";\n                    break;\n                    case (ft.indexOf(\"gif\") > -1):\n                        icon_name = \"gif.png\";\n                    break;\n                    case (ft.indexOf(\"zip\") > -1):\n                        icon_name = \"zip.png\";\n                    break;\n                    case (ft.indexOf(\"avi\") > -1):\n                        icon_name = \"avi.png\";\n                    break;\n                    case (ft.indexOf(\"mp4\") > -1):\n                        icon_name = \"mp4.png\";\n                    break;\n                    default:\n                        icon_name = \"file.png\";\n                    break;\n                }\n\n                // //console.log(\"FILE:\", icon_name);\n\n                return \"images/file_icons/\"+icon_name;\n            }\n\n\n            vm.get_icon2 = function(file){\n\n                var ft = file.split('.').pop();\n                // //console.log(\"ICON 2 : \", ft);\n                var icon_name = \"\";\n\n                // //console.log(\"FILE:\", ft);\n                // //console.log(\"index : \", ft.indexOf(\"pdf\"));\n                switch(true){\n                    case (ft.indexOf(\"pdf\") > -1):\n                        icon_name = \"pdf.png\";\n                    break;\n                    case (ft.indexOf(\"doc\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"docx\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"xls\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"xlsx\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"ppt\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"pptx\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"jpg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"jpeg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"png\") > -1):\n                        icon_name = \"png.png\";\n                    break;\n                    case (ft.indexOf(\"gif\") > -1):\n                        icon_name = \"gif.png\";\n                    break;\n                    case (ft.indexOf(\"zip\") > -1):\n                        icon_name = \"zip.png\";\n                    break;\n                    case (ft.indexOf(\"avi\") > -1):\n                        icon_name = \"avi.png\";\n                    break;\n                    case (ft.indexOf(\"mp4\") > -1):\n                        icon_name = \"mp4.png\";\n                    break;\n                    default:\n                        icon_name = \"file.png\";\n                    break;\n                }\n\n                // //console.log(\"FILE:\", icon_name);\n\n                return \"images/file_icons/\"+icon_name;\n            }\n\n\n        vm.show_receipt_image = function(receipt){\n\n            vm.show_receipt = true;\n            vm.receipt_image = receipt.image;\n\n        }\n\n        vm.get_icon3 = function(file){\n\n                var ft = file.split(';')[0];\n                // //console.log(\"ICON 2 : \", ft);\n                var icon_name = \"\";\n\n                // //console.log(\"FILE:\", ft);\n                // //console.log(\"index : \", ft.indexOf(\"pdf\"));\n                switch(true){\n                    case (ft.indexOf(\"pdf\") > -1):\n                        icon_name = \"pdf.png\";\n                    break;\n                    case (ft.indexOf(\"doc\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"docx\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"xls\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"xlsx\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"ppt\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"pptx\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"jpg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"jpeg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"png\") > -1):\n                        icon_name = \"png.png\";\n                    break;\n                    case (ft.indexOf(\"gif\") > -1):\n                        icon_name = \"gif.png\";\n                    break;\n                    case (ft.indexOf(\"zip\") > -1):\n                        icon_name = \"zip.png\";\n                    break;\n                    case (ft.indexOf(\"avi\") > -1):\n                        icon_name = \"avi.png\";\n                    break;\n                    case (ft.indexOf(\"mp4\") > -1):\n                        icon_name = \"mp4.png\";\n                    break;\n                    default:\n                        icon_name = \"file.png\";\n                    break;\n                }\n\n                // //console.log(\"FILE:\", icon_name);\n\n                return \"images/file_icons/\"+icon_name;\n            }\n\n        \n        $scope.search = function(row){\n            ////console.log(\"hi\", (angular.lowercase(row.title).indexOf(angular.lowercase($scope.my_search) || '') !== -1));\n            return (angular.lowercase(row.title).indexOf(angular.lowercase($scope.my_search) || '') !== -1);\n        };\n\n        $scope.search2 = function(row){\n            return (angular.lowercase(row.registration).indexOf(angular.lowercase($scope.my_search2) || '') !== -1);\n        };\n\n        $scope.getMySearchCount = function(str){\n            var docs = str.documents;\n            var total = 0;\n            for(var i=0;i<docs.length;i++){\n                if($scope.search(docs[i])){\n                    total++;\n                }\n            }\n            return total;\n        }\n\n        $scope.getMySearchCount2 = function(str){\n            var charges = str.charges;\n            var total = 0;\n            for(var i=0;i<charges.length;i++){\n                if($scope.search(charges[i])){\n                    total++;\n                }\n            }\n            return total;\n        }\n\n        //  $scope.get_hours_from_decimal = function(time){\n\n        //     if(time){\n        //         var n = new Date(0,0);\n        //         n.setMinutes(+time * 60);\n        //         return n.toTimeString().slice(0,5);\n        //     } else {\n        //         return \"N/A\";\n        //     }\n\n        // }\n\n        $scope.get_hours_from_decimal = function(time){\n\n            if(time){\n                 var sign = time < 0 ? \"-\" : \"\";\n                 var hour = Math.floor(Math.abs(time));\n                 var min = Math.round((Math.abs(time) * 60) % 60);\n                 if(min == 60){\n                     hour++;\n                     min = 0;\n                 }\n                 return sign + (hour < 10 ? \"0\" : \"\") + hour + \":\" + (min < 10 ? \"0\" : \"\") + min;\n             } else {\n                 return \"N/A\";\n             }\n        }\n\n\n\n        $scope.downloadDocument = function(doc, type) {\n            var data = $.param({\n                id: doc\n            });\n\n            //alert(\"type\", type);\n\n            var controller = \"plane_documents\";\n\n            switch(type){\n                 case \"radio\": \n                    controller = \"plane_radio_licence\";\n                break;\n                 case \"insurance\": \n                    controller = \"plane_insurance\";\n                break;\n                 case \"certificate\": \n                    controller = \"plane_certificate\";\n                break;\n                case \"noise\": \n                    controller = \"plane_noise_certificate\";\n                break;\n                case \"docs\": \n                    controller = \"plane_documents\";\n                break;\n                default:\n                    controller = \"plane_documents\";\n                break;\n            }\n\n            var ddd = doc.replace(/^.*[\\\\\\/]/, '');\n\n            $http.get('api/v1/'+controller+'/show_file/'+ddd, {\n                    responseType: 'arraybuffer'\n                })\n                .success(function(data, status, headers) {\n                    var zipName = processArrayBufferToBlob(data, headers);\n\n                    //Delete file from temp folder in server - file needs to remain open until blob is created\n                    //deleteFileFromServerTemp(zipName);\n                }).error(function(data, status) {\n                    alert(\"There was an error downloading the selected document(s).\");\n                })\n        };\n\n        $scope.downloadClubDocument = function(doc) {\n            var data = $.param({\n                id: doc\n            });\n\n            var ddd = doc.replace(/^.*[\\\\\\/]/, '');\n\n            $http.get('api/v1/club_documents/show_file/'+ddd, {\n                    responseType: 'arraybuffer'\n                })\n                .success(function(data, status, headers) {\n                    var zipName = processArrayBufferToBlob(data, headers);\n\n                    //Delete file from temp folder in server - file needs to remain open until blob is created\n                    //deleteFileFromServerTemp(zipName);\n                }).error(function(data, status) {\n                    alert(\"There was an error downloading the selected document(s).\");\n                })\n        };\n\n\n        function titlepath(path,name){\n\n        //In this path defined as your pdf url and name (your pdf name)\n            var prntWin = window.open();\n            prntWin.document.write(\"<html><head><title>\"+name+\"</title></head><body>\"\n                + '<embed width=\"100%\" height=\"100%\" name=\"plugin\" src=\"'+ path+ '\" '\n                + 'type=\"application/pdf\" internalinstanceid=\"21\"></body></html>');\n            prntWin.document.close();\n        }\n\n\n        vm.round_brake_times_start = function(input, earlier_input=null){\n            \n                if(input){\n                  if(input.indexOf(\":\") > -1){\n                    var split = input.split(\":\");\n                    var x = split[1];\n\n\n\n                    var min_nearest_five = ((x % 5) >= 2.5 ? parseInt(x / 5) * 5 + 5 : parseInt(x / 5) * 5);\n                    \n\n\n                    if(min_nearest_five < 10){\n                      min_nearest_five = \"0\"+min_nearest_five;\n                    } else if(min_nearest_five == 60){\n                      split[0]++;\n                      min_nearest_five = \"00\";\n                    } else if(min_nearest_five > 60){\n                      split[0]++;\n                      min_nearest_five = (min_nearest_five - 60);\n                    }\n\n\n                    if(earlier_input && earlier_input.indexOf(\":\") > -1){\n                            // console.log(\"total calculated?\");\n                            // console.log(\"earlier_input: \", earlier_input);\n                            // console.log(\"input: \", input);\n                            var esplit = earlier_input.split(\":\");\n                            var ehour = esplit[0];\n                            var emin = esplit[1];\n                            var etot = (parseInt(ehour)*60) + parseInt(emin); \n                            // console.log(\"etot: \", etot);\n                            var hr = split[0];\n                            var mn = min_nearest_five;\n                            var tot = (parseInt(hr)*60) + parseInt(mn);\n                            // console.log(\"tot: \", tot);\n\n                            if(etot < tot){\n                                //the earlier time is after the end time\n                                // console.log(\"etot < tot\");\n                                min_nearest_five = parseInt(min_nearest_five) - 5;\n                                if(min_nearest_five == 60){\n                                    split[0]++; \n                                    min_nearest_five = \"00\";\n                                } else if(min_nearest_five > 60){\n                                    split[0]++;\n                                    min_nearest_five = (min_nearest_five - 60);\n                                    if(min_nearest_five < 10 ){\n                                      min_nearest_five = \"0\"+min_nearest_five;\n                                    }\n                                } else if(min_nearest_five < 0){\n                                    split[0]--;\n                                    min_nearest_five = (60 + parseInt(min_nearest_five));\n                                }\n                                // console.log(\"split: \", split[0]);\n                                // console.log(\"min_nearest_five: \", min_nearest_five);\n                            }\n\n                    }\n                    //essentially we add 5 in case something happens over the limit\n\n                    return split[0] + \":\" + min_nearest_five;\n                  } else {\n                    return input;\n                  }\n                } else {\n                  return '';\n                }\n          \n\n          }\n\n          vm.round_brake_times_end = function(input, earlier_input=null){\n            \n                if(input){\n                  if(input.indexOf(\":\") > -1){\n                    var split = input.split(\":\");\n                    var x = split[1];\n\n\n\n                    var min_nearest_five = ((x % 5) >= 2.5 ? parseInt(x / 5) * 5 + 5 : parseInt(x / 5) * 5);\n                    \n\n\n                    if(min_nearest_five < 10){\n                      min_nearest_five = \"0\"+min_nearest_five;\n                    } else if(min_nearest_five == 60){\n                      split[0]++;\n                      min_nearest_five = \"00\";\n                    } else if(min_nearest_five > 60){\n                      split[0]++;\n                      min_nearest_five = (min_nearest_five - 60);\n                    }\n\n\n                    if(earlier_input && earlier_input.indexOf(\":\") > -1){\n                            // console.log(\"total calculated?\");\n                            // console.log(\"earlier_input: \", earlier_input);\n                            // console.log(\"input: \", input);\n                            var esplit = earlier_input.split(\":\");\n                            var ehour = esplit[0];\n                            var emin = esplit[1];\n                            var etot = (parseInt(ehour)*60) + parseInt(emin); \n                            // console.log(\"etot: \", etot);\n                            var hr = split[0];\n                            var mn = min_nearest_five;\n                            var tot = (parseInt(hr)*60) + parseInt(mn);\n                            // console.log(\"tot: \", tot);\n\n                            if(etot > tot){\n                                //the earlier time is after the end time\n                                // console.log(\"etot > tot\");\n                                min_nearest_five = parseInt(min_nearest_five) + 5;\n                                if(min_nearest_five == 60){\n                                    split[0]++; \n                                    min_nearest_five = \"00\";\n                                } else if(min_nearest_five > 60){\n                                    split[0]++;\n                                    min_nearest_five = (min_nearest_five - 60);\n                                    if(min_nearest_five < 10 ){\n                                      min_nearest_five = \"0\"+min_nearest_five;\n                                    }\n                                }\n                                // console.log(\"split: \", split[0]);\n                                // console.log(\"min_nearest_five: \", min_nearest_five);\n                            }\n\n                    }\n                    //essentially we add 5 in case something happens over the limit\n\n                    return split[0] + \":\" + min_nearest_five;\n                  } else {\n                    return input;\n                  }\n                } else {\n                  return '';\n                }\n          \n\n          }\n\n        function processArrayBufferToBlob(data, headers) {\n            var octetStreamMime = 'application/octet-stream';\n            var success = false;\n\n            // Get the headers\n            headers = headers();\n            //var ttt = title.toLowerCase().replace(/\\W/g, '_');\n            // Get the filename from the x-filename header or default to \"download.bin\"\n            var filename = headers['x-filename'] || 'download.zip';\n\n            // Determine the content type from the header or default to \"application/octet-stream\"\n            var contentType = headers['content-type'] || octetStreamMime;\n\n            try {\n\n                $log.info(\"first try\");\n                // Try using msSaveBlob if supported\n                var blob = new Blob([data], {\n                    //type: contentType\n                    type: 'application/pdf'\n                });\n\n                var fileURL = URL.createObjectURL(blob);\n                titlepath(fileURL, \"Secure Documents\");\n\n                // if (navigator.msSaveBlob)\n                //     navigator.msSaveBlob(blob, filename);\n                // else {\n                //     // Try using other saveBlob implementations, if available\n                //     var saveBlob = navigator.webkitSaveBlob || navigator.mozSaveBlob || navigator.saveBlob;\n                //     if (saveBlob === undefined) throw \"Not supported\";\n                //     saveBlob(blob, filename);\n                // }\n                success = true;\n            } catch (ex) {\n                $log.info(\"saveBlob method failed with the following exception:\");\n                $log.info(ex);\n            }\n\n            if (!success) {\n                // Get the blob url creator\n                var urlCreator = window.URL || window.webkitURL || window.mozURL || window.msURL;\n                if (urlCreator) {\n                    // Try to use a download link\n                    var link = document.createElement('a');\n                    if ('download' in link) {\n                        // Try to simulate a click\n                        try {\n                            $log.info(\"second try\");\n                            // Prepare a blob URL\n                            var blob = new Blob([data], {\n                                type: contentType\n                            });\n                            var url = urlCreator.createObjectURL(blob);\n                            link.setAttribute('href', url);\n\n                            // Set the download attribute (Supported in Chrome 14+ / Firefox 20+)\n                            link.setAttribute(\"download\", filename);\n\n                            // Simulate clicking the download link\n                            var event = document.createEvent('MouseEvents');\n                            event.initMouseEvent('click', true, true, window, 1, 0, 0, 0, 0, false, false, false, false, 0, null);\n                            link.dispatchEvent(event);\n                            success = true;\n\n                        } catch (ex) {\n                            $log.info(\"Download link method with simulated click failed with the following exception:\");\n                            $log.info(ex);\n                        }\n                    }\n\n                    if (!success) {\n                        // Fallback to window.location method\n                        try {\n\n                            $log.info(\"third try\");\n\n                            // Prepare a blob URL\n                            // Use application/octet-stream when using window.location to force download\n                            var blob = new Blob([data], {\n                                type: octetStreamMime\n                            });\n                            var url = urlCreator.createObjectURL(blob);\n                            window.location = url;\n                            success = true;\n                        } catch (ex) {\n                            $log.info(\"Download link method with window.location failed with the following exception:\");\n                            $log.info(ex);\n                        }\n                    }\n                }\n            }\n\n            if (!success) {\n                // Fallback to window.open method\n                $log.info(\"No methods worked for saving the arraybuffer, using last resort window.open\");\n                window.open(httpPath, '_blank', '');\n            }\n            return filename;\n        };\n\n\n        $scope.get_icon2 = function(file){\n                //console.log(\"FILE\", file);\n                if(!file || file == \"\"){\n                    return \"\";\n                }\n                var ft = file.split('.').pop();\n                // //console.log(\"ICON 2 : \", ft);\n                var icon_name = \"\";\n\n                // //console.log(\"FILE:\", ft);\n                // //console.log(\"index : \", ft.indexOf(\"pdf\"));\n                switch(true){\n                    case (ft.indexOf(\"pdf\") > -1):\n                        icon_name = \"pdf.png\";\n                    break;\n                    case (ft.indexOf(\"doc\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"docx\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"xls\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"xlsx\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"ppt\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"pptx\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"jpg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"jpeg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"png\") > -1):\n                        icon_name = \"png.png\";\n                    break;\n                    case (ft.indexOf(\"gif\") > -1):\n                        icon_name = \"gif.png\";\n                    break;\n                    case (ft.indexOf(\"zip\") > -1):\n                        icon_name = \"zip.png\";\n                    break;\n                    case (ft.indexOf(\"avi\") > -1):\n                        icon_name = \"avi.png\";\n                    break;\n                    case (ft.indexOf(\"mp4\") > -1):\n                        icon_name = \"mp4.png\";\n                    break;\n                    default:\n                        icon_name = \"file.png\";\n                    break;\n                }\n\n                // //console.log(\"FILE:\", icon_name);\n\n                return \"images/file_icons/\"+icon_name;\n            }\n      \n\n\n\n    }\n app.controller('AllDocumentsController', AllDocumentsController);\n\n    AllDocumentsController.$inject = ['UserService', 'MemberService', 'InstructorService', 'MembershipService', 'HolidayService', '$rootScope', '$location', '$scope', '$state', '$stateParams', '$uibModal', '$log', '$window', '$compile', '$timeout', 'uiCalendarConfig', 'BookingService', 'LicenceService', 'ClubDocumentService', 'PlaneDocumentService', '$http'];\n    function AllDocumentsController(UserService, MemberService, InstructorService, MembershipService, HolidayService, $rootScope, $location, $scope, $state, $stateParams, $uibModal, $log, $window, $compile, $timeout, uiCalendarConfig, BookingService, LicenceService, ClubDocumentService, PlaneDocumentService, $http) {\n        \n        var vm = this;\n\n        vm.clubs = [];\n        vm.user = $rootScope.globals.currentUser;\n        vm.user_id = vm.user.id;\n\n         ClubDocumentService.GetByUserId(vm.user.id)\n            .then(function (data) {\n                    ////console.log(\"data is : \", data);\n                   vm.clubs = data.clubs;\n\n                   for(var i=0; i<vm.clubs.length;i++){\n\n                       if(vm.clubs[i].membership_terms !== \"\"){\n                           vm.clubs[i].documents.push({title: \"Membership Terms & Conditions\", document: vm.clubs[i].membership_terms, updated_at: vm.clubs[i].membership_updated });\n                       }\n                       if(vm.clubs[i].privacy_terms !== \"\"){\n                           vm.clubs[i].documents.push({title: \"Privacy Terms\", document: vm.clubs[i].privacy_terms, updated_at: vm.clubs[i].privacy_updated });\n                       }\n                       if(vm.clubs[i].passenger_terms !== \"\"){\n                           vm.clubs[i].documents.push({title: \"Passenger Terms & Conditions\", document: vm.clubs[i].passenger_terms, updated_at: vm.clubs[i].passenger_updated });\n                       }\n                       \n                   }\n\n\n                });\n       \n          \n            $scope.get_icon = function(file){\n\n                var ft = file.name;\n                ft = ft.split('.').pop();\n                var icon_name = \"\";\n\n                // //console.log(\"FILE:\", ft);\n                // //console.log(\"index : \", ft.indexOf(\"pdf\"));\n                switch(true){\n                    case (ft.indexOf(\"pdf\") > -1):\n                        icon_name = \"pdf.png\";\n                    break;\n                    case (ft.indexOf(\"doc\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"docx\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"xls\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"xlsx\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"ppt\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"pptx\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"jpg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"jpeg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"png\") > -1):\n                        icon_name = \"png.png\";\n                    break;\n                    case (ft.indexOf(\"gif\") > -1):\n                        icon_name = \"gif.png\";\n                    break;\n                    case (ft.indexOf(\"zip\") > -1):\n                        icon_name = \"zip.png\";\n                    break;\n                    case (ft.indexOf(\"avi\") > -1):\n                        icon_name = \"avi.png\";\n                    break;\n                    case (ft.indexOf(\"mp4\") > -1):\n                        icon_name = \"mp4.png\";\n                    break;\n                    default:\n                        icon_name = \"file.png\";\n                    break;\n                }\n\n                // //console.log(\"FILE:\", icon_name);\n\n                return \"images/file_icons/\"+icon_name;\n            }\n\n\n            vm.get_icon2 = function(file){\n\n                var ft = file.split('.').pop();\n                // //console.log(\"ICON 2 : \", ft);\n                var icon_name = \"\";\n\n                // //console.log(\"FILE:\", ft);\n                // //console.log(\"index : \", ft.indexOf(\"pdf\"));\n                switch(true){\n                    case (ft.indexOf(\"pdf\") > -1):\n                        icon_name = \"pdf.png\";\n                    break;\n                    case (ft.indexOf(\"doc\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"docx\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"xls\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"xlsx\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"ppt\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"pptx\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"jpg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"jpeg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"png\") > -1):\n                        icon_name = \"png.png\";\n                    break;\n                    case (ft.indexOf(\"gif\") > -1):\n                        icon_name = \"gif.png\";\n                    break;\n                    case (ft.indexOf(\"zip\") > -1):\n                        icon_name = \"zip.png\";\n                    break;\n                    case (ft.indexOf(\"avi\") > -1):\n                        icon_name = \"avi.png\";\n                    break;\n                    case (ft.indexOf(\"mp4\") > -1):\n                        icon_name = \"mp4.png\";\n                    break;\n                    default:\n                        icon_name = \"file.png\";\n                    break;\n                }\n\n                // //console.log(\"FILE:\", icon_name);\n\n                return \"images/file_icons/\"+icon_name;\n            }\n\n        \n        $scope.search = function(row){\n            ////console.log(\"hi\", (angular.lowercase(row.title).indexOf(angular.lowercase($scope.my_search) || '') !== -1));\n            return (angular.lowercase(row.title).indexOf(angular.lowercase($scope.my_search) || '') !== -1);\n        };\n\n         $scope.search3 = function(row){\n            ////console.log(\"hi\", (angular.lowercase(row.title).indexOf(angular.lowercase($scope.my_search) || '') !== -1));\n            return (angular.lowercase(row.membership_name).indexOf(angular.lowercase($scope.my_search) || '') !== -1);\n        };\n\n        $scope.search2 = function(row){\n            return (angular.lowercase(row.registration).indexOf(angular.lowercase($scope.my_search2) || '') !== -1);\n        };\n\n        $scope.getMySearchCount = function(str){\n            var docs = str.documents;\n            var total = 0;\n            for(var i=0;i<docs.length;i++){\n                if($scope.search(docs[i])){\n                    total++;\n                }\n            }\n            return total;\n        }\n\n        $scope.getMySearchCount2 = function(str){\n            var charges = str.charges;\n            var total = 0;\n            for(var i=0;i<charges.length;i++){\n                if($scope.search(charges[i])){\n                    total++;\n                }\n            }\n            return total;\n        }\n\n        \n\n        $scope.downloadDocument = function(doc) {\n            var data = $.param({\n                id: doc\n            });\n\n            var ddd = doc.replace(/^.*[\\\\\\/]/, '');\n\n            $http.get('api/v1/plane_documents/show_file/'+ddd, {\n                    responseType: 'arraybuffer'\n                })\n                .success(function(data, status, headers) {\n                    var zipName = processArrayBufferToBlob(data, headers);\n\n                    //Delete file from temp folder in server - file needs to remain open until blob is created\n                    //deleteFileFromServerTemp(zipName);\n                }).error(function(data, status) {\n                    alert(\"There was an error downloading the selected document(s).\");\n                })\n        };\n\n\n\n        $scope.downloadClubDocument = function(doc) {\n            var data = $.param({\n                id: doc\n            });\n\n            var ddd = doc.replace(/^.*[\\\\\\/]/, '');\n\n            $http.get('api/v1/club_documents/show_file/'+ddd, {\n                    responseType: 'arraybuffer'\n                })\n                .success(function(data, status, headers) {\n                    var zipName = processArrayBufferToBlob(data, headers);\n\n                    //Delete file from temp folder in server - file needs to remain open until blob is created\n                    //deleteFileFromServerTemp(zipName);\n                }).error(function(data, status) {\n                    alert(\"There was an error downloading the selected document(s).\");\n                })\n        };\n\n        function titlepath(path,name){\n\n        //In this path defined as your pdf url and name (your pdf name)\n            var prntWin = window.open();\n            prntWin.document.write(\"<html><head><title>\"+name+\"</title></head><body>\"\n                + '<embed width=\"100%\" height=\"100%\" name=\"plugin\" src=\"'+ path+ '\" '\n                + 'type=\"application/pdf\" internalinstanceid=\"21\"></body></html>');\n            prntWin.document.close();\n        }\n\n        function processArrayBufferToBlob(data, headers) {\n            var octetStreamMime = 'application/octet-stream';\n            var success = false;\n\n            // Get the headers\n            headers = headers();\n            //var ttt = title.toLowerCase().replace(/\\W/g, '_');\n            // Get the filename from the x-filename header or default to \"download.bin\"\n            var filename = headers['x-filename'] || 'download.zip';\n\n            // Determine the content type from the header or default to \"application/octet-stream\"\n            var contentType = headers['content-type'] || octetStreamMime;\n\n            try {\n                // Try using msSaveBlob if supported\n                var blob = new Blob([data], {\n                    //type: contentType\n                    type: 'application/pdf'\n                });\n                var fileURL = URL.createObjectURL(blob);\n                //window.open(fileURL);\n                titlepath(fileURL, \"Secure Documents\");\n                // if (navigator.msSaveBlob)\n                //     navigator.msSaveBlob(blob, filename);\n                // else {\n                //     // Try using other saveBlob implementations, if available\n                //     var saveBlob = navigator.webkitSaveBlob || navigator.mozSaveBlob || navigator.saveBlob;\n                //     if (saveBlob === undefined) throw \"Not supported\";\n                //     saveBlob(blob, filename);\n                // }\n                success = true;\n            } catch (ex) {\n                $log.info(\"saveBlob method failed with the following exception:\");\n                $log.info(ex);\n            }\n\n            if (!success) {\n                // Get the blob url creator\n                var urlCreator = window.URL || window.webkitURL || window.mozURL || window.msURL;\n                if (urlCreator) {\n                    // Try to use a download link\n                    var link = document.createElement('a');\n                    if ('download' in link) {\n                        // Try to simulate a click\n                        try {\n                            // Prepare a blob URL\n                            var blob = new Blob([data], {\n                                type: contentType\n                            });\n                            var url = urlCreator.createObjectURL(blob);\n                            link.setAttribute('href', url);\n\n                            // Set the download attribute (Supported in Chrome 14+ / Firefox 20+)\n                            link.setAttribute(\"download\", filename);\n\n                            // Simulate clicking the download link\n                            var event = document.createEvent('MouseEvents');\n                            event.initMouseEvent('click', true, true, window, 1, 0, 0, 0, 0, false, false, false, false, 0, null);\n                            link.dispatchEvent(event);\n                            success = true;\n\n                        } catch (ex) {\n                            $log.info(\"Download link method with simulated click failed with the following exception:\");\n                            $log.info(ex);\n                        }\n                    }\n\n                    if (!success) {\n                        // Fallback to window.location method\n                        try {\n                            // Prepare a blob URL\n                            // Use application/octet-stream when using window.location to force download\n                            var blob = new Blob([data], {\n                                type: octetStreamMime\n                            });\n                            var url = urlCreator.createObjectURL(blob);\n                            window.location = url;\n                            success = true;\n                        } catch (ex) {\n                            $log.info(\"Download link method with window.location failed with the following exception:\");\n                            $log.info(ex);\n                        }\n                    }\n                }\n            }\n\n            if (!success) {\n                // Fallback to window.open method\n                $log.info(\"No methods worked for saving the arraybuffer, using last resort window.open\");\n                window.open(httpPath, '_blank', '');\n            }\n            return filename;\n        };\n\n      \n\n\n\n    }\n app.controller('AllInvoicesController', AllInvoicesController);\n\n    AllInvoicesController.$inject = ['$sce', 'PaymentService', 'UserService', 'MemberService', 'InstructorService', 'MembershipService', 'HolidayService', '$rootScope', '$location', '$scope', '$state', '$stateParams', '$uibModal', '$log', '$window', '$compile', '$timeout', 'uiCalendarConfig', 'BookingService', 'LicenceService', 'ClubDocumentService', 'PlaneDocumentService', '$http'];\n    function AllInvoicesController($sce, PaymentService, UserService, MemberService, InstructorService, MembershipService, HolidayService, $rootScope, $location, $scope, $state, $stateParams, $uibModal, $log, $window, $compile, $timeout, uiCalendarConfig, BookingService, LicenceService, ClubDocumentService, PlaneDocumentService, $http) {\n        \n        var vm = this;\n\n        vm.clubs = [];\n        vm.user = $rootScope.globals.currentUser;\n        vm.user_id = vm.user.id;\n        vm.show_pay_now = false;\n        vm.show_loading = false;\n\n        vm.last_invoice_opened = {};\n\n\n        var iconBank = '<svg viewBox=\"0 0 24 24\"><path d=\"M3 10h18M4 10V8l8-5 8 5v2M5 10v8M9 10v8M15 10v8M19 10v8M3 18h18M2 20h20\" fill=\"none\" stroke=\"#4f46e5\" stroke-width=\"1.6\"/></svg>';\n        var iconCard = '<svg viewBox=\"0 0 24 24\"><rect x=\"2\" y=\"4\" width=\"20\" height=\"16\" rx=\"2\" ry=\"2\" fill=\"none\" stroke=\"#4f46e5\" stroke-width=\"1.6\"/><path d=\"M2 9h20M6 14h6\" stroke=\"#4f46e5\" stroke-width=\"1.6\"/></svg>';\n        var iconNew  = '<svg viewBox=\"0 0 24 24\"><circle cx=\"12\" cy=\"12\" r=\"9\" fill=\"none\" stroke=\"#4f46e5\" stroke-width=\"1.6\"/><path d=\"M12 8v8M8 12h8\" stroke=\"#4f46e5\" stroke-width=\"1.6\"/></svg>';\n        var iconTerm = '<svg viewBox=\"0 0 24 24\"><rect x=\"6\" y=\"2\" width=\"12\" height=\"14\" rx=\"2\" fill=\"none\" stroke=\"#4f46e5\" stroke-width=\"1.6\"/><rect x=\"8\" y=\"5\" width=\"8\" height=\"3\" fill=\"none\" stroke=\"#4f46e5\" stroke-width=\"1.6\"/><rect x=\"9\" y=\"10\" width=\"6\" height=\"3\" fill=\"none\" stroke=\"#4f46e5\" stroke-width=\"1.6\"/></svg>';\n        \n          vm.donConfirm = function(methodLabel, paymentIntent){\n            // console.log(\"confirmation is called\", methodLabel);\n            // console.log(\"paymentIntent\", paymentIntent);\n          //alert('Parent received D confirmation: ' + methodLabel);\n            vm.complete_invoice(methodLabel, paymentIntent);\n          };\n\n          vm.default_payment = 'direct-debit';\n\n          vm.methods = [\n            { id: 'direct-debit', title: 'Direct Debit', subtitle: 'Use your BACS mandate', type: 'direct-debit', iconSvg: $sce.trustAsHtml(iconBank), visible: true },\n            { id: 'saved-card',   title: 'Saved card',   subtitle: 'Use a card on file',    type: 'saved-card',  iconSvg: $sce.trustAsHtml(iconCard), visible: true },\n            { id: 'new-card',     title: 'New card',     subtitle: 'Add a new debit/credit card', type: 'new-card', iconSvg: $sce.trustAsHtml(iconNew), visible: true },\n            { id: 'card-machine', title: 'Card Machine', subtitle: 'Pay in person',          type: 'card-machine', iconSvg: $sce.trustAsHtml(iconTerm), visible: true }\n          ];\n\n           vm.savedCards = [];\n\n           vm.complete_invoice = function(method, paymentIntent){\n\n               //we now have a payment to complete\n               //process_payment\n\n               var obj = {\n                   user_id: vm.user.id,\n                   club_id: vm.last_invoice_opened.club_id,\n                   paymentIntent: paymentIntent,\n                   invoice_id: vm.last_invoice_opened.id,\n                   method: method\n               }\n\n               PaymentService.ProcessPayment(obj)\n                   .then(function (data) {\n\n                       if(data.success){\n\n                           //finish with:\n                           //RELOAD THE INVOICES!!!\n                           UserService.GetInvoices(vm.user.id)\n                            .then(function (data) {\n\n                               vm.invoices = data.invoices;\n\n                               vm.show_pay_now = false;\n                               vm.show_loading = false;\n                               //alert(\"SUCCESS!\");\n                            });\n\n                       } else {\n                           //alert(\"Something happened which was not supposed to happen... Please try again\");\n                           console.log(\"===== ERROR =====\");\n                           console.log(data);\n                           console.log(\"===== ERROR =====\");\n                       }\n\n\n                   });\n\n           }\n\n           vm.close_pay_now = function(){\n               vm.show_pay_now = false;\n               vm.show_loading = false;\n           }\n\n        \n\n         vm.get_package_html = function(pack_obj){\n\n\n\n                            var used_on = \"\";\n                            for(var i=0;i<pack_obj.aircraft.length;i++){\n                                used_on = used_on + \" \" + pack_obj.aircraft[i].registration +\" (\"+ pack_obj.aircraft[i].plane_type +\") <br />\";\n                            }\n                            var text = \"\";\n                            if(pack_obj.validity == 0){\n                               text = \"Package purchased on: \"+moment(pack_obj.created_at).format(\"D MMM Y\")+\"<br /> Package does not expire <br /> To be used on:<br />\";\n                            } else {\n                               text = \"Package purchased on: \"+moment(pack_obj.created_at).format(\"D MMM Y\")+\"<br /> Package expires on: \"+ moment(pack_obj.created_at).add(pack_obj.validity, \"days\").format(\"D MMM Y\") +\" <br /> To be used on:<br />\";\n                            }\n                    \n                            var intro =  text+used_on;\n\n\n                            // bit = bit + '<h4 uib-tooltip=\"'+intro+'\"> '+package.title+' <i class=\"fa fa-question-circle\"></i></h4><div class=\"dual_solo\"><div class=\"dual\" uib-tooltip=\"Hours remaining on this package to fly dual (with an instructor)\"><span class=\"bigger_text\">'+vm.convert_decimal_to_hours( package.remaining_hours_dual )+'</span><span class=\"smaller_text\">DUAL</span></div><div class=\"solo\" uib-tooltip=\"Hours remaining on this package of solo rental\"><span class=\"bigger_text\">'+vm.convert_decimal_to_hours( package.remaining_hours_solo )+'</span><span class=\"smaller_text\">SOLO</span></div></div>';\n\n\n                            \n                            return intro;\n\n        }\n\n        vm.show_payment_option = function(invoice){\n            var status = invoice.status;\n            if(status == \"pending_submission\"){\n                return true;\n            } else if(status == \"issued\"){\n                return true;\n            } else {\n                return false;\n            }\n\n        }\n\n        vm.info;\n\n        vm.show_payment = function(invoice){\n            console.log(\"invoice details: \", invoice);\n            vm.last_invoice_opened = invoice;\n            vm.send = {\n                club_id: invoice.club_id,\n                user_id: invoice.user_id,\n                invoice_id: invoice.id\n            }\n\n            //get user cards\n            //get user info\n\n            MemberService.GetMandate(invoice.user_id, invoice.club_id)\n                    .then(function (data) {\n                            ////console.log(\"data is : \", data);\n                           \n                    if(data.success){\n                        vm.info = data.info;\n\n                        vm.savedCards = data.cards;\n\n                        if(vm.savedCards.length > 0){\n                            vm.methods[1].visible = true;\n                        } else {\n                            vm.methods[1].visible = false;\n                        }\n\n                        vm.machine = data.machine;\n                        if(vm.machine.success){\n                            vm.methods[3].visible = true;\n                        } else {\n                            vm.methods[3].visible = false;\n                        }\n\n                        vm.show_pay_now = true;\n                    }\n\n                });\n\n           \n\n        }\n\n        vm.convert_decimal_to_hours = function(number){\n            \n                            var sign = (number >= 0) ? 1 : -1;\n\n                            // Set positive value of number of sign negative\n                            number = number * sign;\n\n                            // Separate the int from the decimal part\n                            var hour = Math.floor(number);\n                            var decpart = number - hour;\n\n                            var min = 1 / 60;\n                            // Round to nearest minute\n                            decpart = min * Math.round(decpart / min);\n\n                            var minute = Math.floor(decpart * 60) + '';\n\n                            // Add padding if need\n                            if (minute.length < 2) {\n                            minute = '0' + minute; \n                            }\n\n                            if(minute == 60){\n                                hour = hour+1;\n                                minute = '00';\n                            }\n\n                            // Add Sign in final result\n                            sign = sign == 1 ? '' : '-';\n\n                            // Concate hours and minutes\n                            var time = sign + hour + ':' + minute;\n\n                            return time;\n\n                        }\n\n\n\n         UserService.GetInvoices(vm.user.id)\n            .then(function (data) {\n                    ////console.log(\"data is : \", data);\n                   vm.invoices = data.invoices;\n                });\n\n\n        UserService.GetUpcoming(vm.user.id)\n            .then(function (data) {\n                    ////console.log(\"data is : \", data);\n                   vm.upcoming = data.upcoming;\n                });\n       \n          \n            $scope.get_icon = function(file){\n\n                var ft = file.name;\n                ft = ft.split('.').pop();\n                var icon_name = \"\";\n\n                // //console.log(\"FILE:\", ft);\n                // //console.log(\"index : \", ft.indexOf(\"pdf\"));\n                switch(true){\n                    case (ft.indexOf(\"pdf\") > -1):\n                        icon_name = \"pdf.png\";\n                    break;\n                    case (ft.indexOf(\"doc\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"docx\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"xls\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"xlsx\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"ppt\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"pptx\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"jpg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"jpeg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"png\") > -1):\n                        icon_name = \"png.png\";\n                    break;\n                    case (ft.indexOf(\"gif\") > -1):\n                        icon_name = \"gif.png\";\n                    break;\n                    case (ft.indexOf(\"zip\") > -1):\n                        icon_name = \"zip.png\";\n                    break;\n                    case (ft.indexOf(\"avi\") > -1):\n                        icon_name = \"avi.png\";\n                    break;\n                    case (ft.indexOf(\"mp4\") > -1):\n                        icon_name = \"mp4.png\";\n                    break;\n                    default:\n                        icon_name = \"file.png\";\n                    break;\n                }\n\n                // //console.log(\"FILE:\", icon_name);\n\n                return \"images/file_icons/\"+icon_name;\n            }\n\n\n            vm.get_icon2 = function(file){\n\n                var ft = file.split('.').pop();\n                // //console.log(\"ICON 2 : \", ft);\n                var icon_name = \"\";\n\n                // //console.log(\"FILE:\", ft);\n                // //console.log(\"index : \", ft.indexOf(\"pdf\"));\n                switch(true){\n                    case (ft.indexOf(\"pdf\") > -1):\n                        icon_name = \"pdf.png\";\n                    break;\n                    case (ft.indexOf(\"doc\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"docx\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"xls\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"xlsx\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"ppt\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"pptx\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"jpg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"jpeg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"png\") > -1):\n                        icon_name = \"png.png\";\n                    break;\n                    case (ft.indexOf(\"gif\") > -1):\n                        icon_name = \"gif.png\";\n                    break;\n                    case (ft.indexOf(\"zip\") > -1):\n                        icon_name = \"zip.png\";\n                    break;\n                    case (ft.indexOf(\"avi\") > -1):\n                        icon_name = \"avi.png\";\n                    break;\n                    case (ft.indexOf(\"mp4\") > -1):\n                        icon_name = \"mp4.png\";\n                    break;\n                    default:\n                        icon_name = \"file.png\";\n                    break;\n                }\n\n                // //console.log(\"FILE:\", icon_name);\n\n                return \"images/file_icons/\"+icon_name;\n            }\n\n        \n        $scope.search = function(row){\n            ////console.log(\"hi\", (angular.lowercase(row.title).indexOf(angular.lowercase($scope.my_search) || '') !== -1));\n            return ( (angular.lowercase(row.invoice_number).indexOf(angular.lowercase($scope.my_search) || '') !== -1) || \n                    ((row.plane_registration)? (angular.lowercase(row.plane_registration).indexOf(angular.lowercase($scope.my_search) || '') !== -1) : false) ||\n                    (angular.lowercase(row.club_title).indexOf(angular.lowercase($scope.my_search) || '') !== -1) ||\n                    (angular.lowercase(row.created_at.toString()).indexOf(angular.lowercase($scope.my_search) || '') !== -1) ||\n                    (angular.lowercase((parseFloat(row.total).toFixed(2)).toString()).indexOf(angular.lowercase($scope.my_search) || '') !== -1) ||\n                    (angular.lowercase(row.status).indexOf(angular.lowercase($scope.my_search) || '') !== -1) );\n        };\n\n        $scope.show_more = function(index){\n\n\n            vm.invoices[index].show_more = (vm.invoices[index].show_more)? false : true;\n\n\n        }\n\n\n\n\n        function process_payment_bits(payments){\n\n\n\n\n\n\n\n\n\n        }\n\n\n        $scope.get_human_status = function(status){\n\n            var returned;\n            switch(status){\n                case 'issued':\n            \n                  returned = \"Created\";\n\n              break;\n\n              case 'pending_submission':\n                  \n                    returned = \"Requesting\";\n\n              break;\n\n              case 'submitted':\n                    \n                    returned = \"Requested\";\n\n              break;\n\n              case 'confirmed':\n                    \n                    returned = \"Paid\";\n\n              break;\n\n              case 'paid_out':\n                    returned = \"Paid\";\n\n              break;\n\n              case 'failed':\n                    returned = \"Failed\";\n\n              break;\n\n              case 'charged_back':\n                    returned = \"Charged Back\";\n\n              break;\n              default:\n                  returned = status;\n              break\n            }\n\n            return returned;\n\n        }\n\n     \n        $scope.downloadDocument = function(doc) {\n            var data = $.param({\n                id: doc\n            });\n\n            var ddd = doc.replace(/^.*[\\\\\\/]/, '');\n\n            $http.get('http://local.arrow.com/api/v1/plane_documents/show_file/'+ddd, {\n                    responseType: 'arraybuffer'\n                })\n                .success(function(data, status, headers) {\n                    var zipName = processArrayBufferToBlob(data, headers);\n\n                    //Delete file from temp folder in server - file needs to remain open until blob is created\n                    //deleteFileFromServerTemp(zipName);\n                }).error(function(data, status) {\n                    alert(\"There was an error downloading the selected document(s).\");\n                })\n        };\n\n        $scope.downloadInvoice = function(id) {\n            // var data = $.param({\n            //     id: doc\n            // });\n\n            //var ddd = doc.replace(/^.*[\\\\\\/]/, '');\n\n            $http.get('api/v1/invoice_pdf/get_ad_hoc_invoice/'+id, {\n                    responseType: 'arraybuffer'\n                })\n                .success(function(data, status, headers) {\n                    var zipName = processArrayBufferToBlob(data, headers);\n\n                    //Delete file from temp folder in server - file needs to remain open until blob is created\n                    //deleteFileFromServerTemp(zipName);\n                }).error(function(data, status) {\n                    alert(\"There was an error downloading the selected document(s).\");\n                })\n        };\n\n        function processArrayBufferToBlob(data, headers) {\n            var octetStreamMime = 'application/octet-stream';\n            var success = false;\n\n            // Get the headers\n            headers = headers();\n            //var ttt = title.toLowerCase().replace(/\\W/g, '_');\n            // Get the filename from the x-filename header or default to \"download.bin\"\n            var filename = headers['x-filename'] || 'download.zip';\n\n            // Determine the content type from the header or default to \"application/octet-stream\"\n            var contentType = headers['content-type'] || octetStreamMime;\n\n            try {\n                // Try using msSaveBlob if supported\n                var blob = new Blob([data], {\n                    type: contentType\n                });\n                if (navigator.msSaveBlob)\n                    navigator.msSaveBlob(blob, filename);\n                else {\n                    // Try using other saveBlob implementations, if available\n                    var saveBlob = navigator.webkitSaveBlob || navigator.mozSaveBlob || navigator.saveBlob;\n                    if (saveBlob === undefined) throw \"Not supported\";\n                    saveBlob(blob, filename);\n                }\n                success = true;\n            } catch (ex) {\n                $log.info(\"!!saveBlob method failed with the following exception:\");\n                $log.info(ex);\n            }\n\n            if (!success) {\n                // Get the blob url creator\n                var urlCreator = window.URL || window.webkitURL || window.mozURL || window.msURL;\n                if (urlCreator) {\n                    // Try to use a download link\n                    var link = document.createElement('a');\n                    if ('download' in link) {\n                        // Try to simulate a click\n                        try {\n                            // Prepare a blob URL\n                            var blob = new Blob([data], {\n                                type: contentType\n                            });\n                            var url = urlCreator.createObjectURL(blob);\n                            link.setAttribute('href', url);\n\n                            // Set the download attribute (Supported in Chrome 14+ / Firefox 20+)\n                            link.setAttribute(\"download\", filename);\n\n                            // Simulate clicking the download link\n                            var event = document.createEvent('MouseEvents');\n                            event.initMouseEvent('click', true, true, window, 1, 0, 0, 0, 0, false, false, false, false, 0, null);\n                            link.dispatchEvent(event);\n                            success = true;\n\n                        } catch (ex) {\n                            $log.info(\"Download link method with simulated click failed with the following exception:\");\n                            $log.info(ex);\n                        }\n                    }\n\n                    if (!success) {\n                        // Fallback to window.location method\n                        try {\n                            // Prepare a blob URL\n                            // Use application/octet-stream when using window.location to force download\n                            var blob = new Blob([data], {\n                                type: octetStreamMime\n                            });\n                            var url = urlCreator.createObjectURL(blob);\n                            window.location = url;\n                            success = true;\n                        } catch (ex) {\n                            $log.info(\"Download link method with window.location failed with the following exception:\");\n                            $log.info(ex);\n                        }\n                    }\n                }\n            }\n\n            if (!success) {\n                // Fallback to window.open method\n                $log.info(\"No methods worked for saving the arraybuffer, using last resort window.open\");\n                window.open(httpPath, '_blank', '');\n            }\n            return filename;\n        };\n\n      \n\n\n\n    }\n app.controller('AllPaymentsController', AllPaymentsController);\n\n    AllPaymentsController.$inject = ['UserService', 'MemberService', 'InstructorService', 'MembershipService', 'HolidayService', '$rootScope', '$location', '$scope', '$state', '$stateParams', '$uibModal', '$log', '$window', '$compile', '$timeout', 'uiCalendarConfig', 'BookingService', 'LicenceService', 'ClubDocumentService', 'PlaneDocumentService', '$http'];\n    function AllPaymentsController(UserService, MemberService, InstructorService, MembershipService, HolidayService, $rootScope, $location, $scope, $state, $stateParams, $uibModal, $log, $window, $compile, $timeout, uiCalendarConfig, BookingService, LicenceService, ClubDocumentService, PlaneDocumentService, $http) {\n        \n        var vm = this;\n\n        vm.clubs = [];\n        vm.user = $rootScope.globals.currentUser;\n        vm.user_id = vm.user.id;\n\n        vm.get_package_html = function(pack_obj){\n\n\n\n                            var used_on = \"\";\n                            for(var i=0;i<pack_obj.aircraft.length;i++){\n                                used_on = used_on + \" \" + pack_obj.aircraft[i].registration +\" (\"+ pack_obj.aircraft[i].plane_type +\") <br />\";\n                            }\n                            var text = \"\";\n                            if(pack_obj.validity == 0){\n                               text = \"Package purchased on: \"+moment(pack_obj.created_at).format(\"D MMM Y\")+\"<br /> Package does not expire <br /> To be used on:<br />\";\n                            } else {\n                               text = \"Package purchased on: \"+moment(pack_obj.created_at).format(\"D MMM Y\")+\"<br /> Package expires on: \"+ moment(pack_obj.created_at).add(pack_obj.validity, \"days\").format(\"D MMM Y\") +\" <br /> To be used on:<br />\";\n                            }\n                    \n                            var intro =  text+used_on;\n\n\n                            // bit = bit + '<h4 uib-tooltip=\"'+intro+'\"> '+package.title+' <i class=\"fa fa-question-circle\"></i></h4><div class=\"dual_solo\"><div class=\"dual\" uib-tooltip=\"Hours remaining on this package to fly dual (with an instructor)\"><span class=\"bigger_text\">'+vm.convert_decimal_to_hours( package.remaining_hours_dual )+'</span><span class=\"smaller_text\">DUAL</span></div><div class=\"solo\" uib-tooltip=\"Hours remaining on this package of solo rental\"><span class=\"bigger_text\">'+vm.convert_decimal_to_hours( package.remaining_hours_solo )+'</span><span class=\"smaller_text\">SOLO</span></div></div>';\n\n\n                            \n                            return intro;\n\n        }\n       \n\n        vm.convert_decimal_to_hours = function(number){\n            \n                            var sign = (number >= 0) ? 1 : -1;\n\n                            // Set positive value of number of sign negative\n                            number = number * sign;\n\n                            // Separate the int from the decimal part\n                            var hour = Math.floor(number);\n                            var decpart = number - hour;\n\n                            var min = 1 / 60;\n                            // Round to nearest minute\n                            decpart = min * Math.round(decpart / min);\n\n                            var minute = Math.floor(decpart * 60) + '';\n\n                            // Add padding if need\n                            if (minute.length < 2) {\n                            minute = '0' + minute; \n                            }\n\n                            // Add Sign in final result\n                            sign = sign == 1 ? '' : '-';\n\n                            if(minute == 60){\n                                hour = hour+1;\n                                minute = '00';\n                            }\n\n                            // Concate hours and minutes\n                            var time = sign + hour + ':' + minute;\n\n                            return time;\n\n                        }\n\n\n         UserService.GetPayments(vm.user.id)\n            .then(function (data) {\n                    // //console.log(\" PAY data is : \", data);\n                   vm.payments = data.payments;\n                });\n\n\n        UserService.GetUpcoming(vm.user.id)\n            .then(function (data) {\n                    ////console.log(\"data is : \", data);\n                   vm.upcoming = data.upcoming;\n                });\n       \n          \n            $scope.get_icon = function(file){\n\n                var ft = file.name;\n                ft = ft.split('.').pop();\n                var icon_name = \"\";\n\n                // //console.log(\"FILE:\", ft);\n                // //console.log(\"index : \", ft.indexOf(\"pdf\"));\n                switch(true){\n                    case (ft.indexOf(\"pdf\") > -1):\n                        icon_name = \"pdf.png\";\n                    break;\n                    case (ft.indexOf(\"doc\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"docx\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"xls\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"xlsx\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"ppt\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"pptx\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"jpg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"jpeg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"png\") > -1):\n                        icon_name = \"png.png\";\n                    break;\n                    case (ft.indexOf(\"gif\") > -1):\n                        icon_name = \"gif.png\";\n                    break;\n                    case (ft.indexOf(\"zip\") > -1):\n                        icon_name = \"zip.png\";\n                    break;\n                    case (ft.indexOf(\"avi\") > -1):\n                        icon_name = \"avi.png\";\n                    break;\n                    case (ft.indexOf(\"mp4\") > -1):\n                        icon_name = \"mp4.png\";\n                    break;\n                    default:\n                        icon_name = \"file.png\";\n                    break;\n                }\n\n                // //console.log(\"FILE:\", icon_name);\n\n                return \"images/file_icons/\"+icon_name;\n            }\n\n\n            vm.get_icon2 = function(file){\n\n                var ft = file.split('.').pop();\n                // //console.log(\"ICON 2 : \", ft);\n                var icon_name = \"\";\n\n                // //console.log(\"FILE:\", ft);\n                // //console.log(\"index : \", ft.indexOf(\"pdf\"));\n                switch(true){\n                    case (ft.indexOf(\"pdf\") > -1):\n                        icon_name = \"pdf.png\";\n                    break;\n                    case (ft.indexOf(\"doc\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"docx\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"xls\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"xlsx\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"ppt\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"pptx\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"jpg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"jpeg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"png\") > -1):\n                        icon_name = \"png.png\";\n                    break;\n                    case (ft.indexOf(\"gif\") > -1):\n                        icon_name = \"gif.png\";\n                    break;\n                    case (ft.indexOf(\"zip\") > -1):\n                        icon_name = \"zip.png\";\n                    break;\n                    case (ft.indexOf(\"avi\") > -1):\n                        icon_name = \"avi.png\";\n                    break;\n                    case (ft.indexOf(\"mp4\") > -1):\n                        icon_name = \"mp4.png\";\n                    break;\n                    default:\n                        icon_name = \"file.png\";\n                    break;\n                }\n\n                // //console.log(\"FILE:\", icon_name);\n\n                return \"images/file_icons/\"+icon_name;\n            }\n\n        \n        $scope.search = function(row){\n            ////console.log(\"hi\", (angular.lowercase(row.title).indexOf(angular.lowercase($scope.my_search) || '') !== -1));\n            return ( (angular.lowercase(row.id.toString()).indexOf(angular.lowercase($scope.my_search) || '') !== -1) || \n                    (angular.lowercase(row.club_title).indexOf(angular.lowercase($scope.my_search) || '') !== -1) ||\n                    (angular.lowercase(row.created_at.toString()).indexOf(angular.lowercase($scope.my_search) || '') !== -1) ||\n                    (angular.lowercase(row.amount.toString()).indexOf(angular.lowercase($scope.my_search) || '') !== -1) ||\n                    (angular.lowercase(row.status).indexOf(angular.lowercase($scope.my_search) || '') !== -1) );\n        };\n\n        $scope.show_more = function(index){\n\n\n            vm.invoices[index].show_more = (vm.invoices[index].show_more)? false : true;\n\n\n        }\n\n\n\n\n        function process_payment_bits(payments){\n\n\n\n\n\n\n\n\n\n        }\n\n\n        $scope.get_human_method = function(method){\n            \n            var returned;\n            switch(method){\n                case 'GoCardless':\n            \n                  returned = \"Direct Debit\";\n\n                break;\n\n                case 'Credit':\n                      \n                   returned = \"Credit\";\n\n                break;\n\n                case 'GoCardless + Credit':\n                        \n                   returned = \"Direct Debit + Credit\";\n\n                break;\n                case 'Equilibrium':\n                        \n                   returned = \"Not Required \";\n\n                break;\n            }\n\n          return returned;\n        }\n\n\n        $scope.get_human_status = function(status){\n\n            var returned;\n            switch(status){\n                case 'issued':\n            \n                  returned = \"Created\";\n\n              break;\n\n              case 'toaviate_ready':\n            \n                  returned = \"Requesting\";\n\n              break;\n\n              case 'pending_submission':\n                  \n                    returned = \"Requesting\";\n\n              break;\n\n              case 'submitted':\n                    \n                    returned = \"Requested\";\n\n              break;\n\n              case 'confirmed':\n                    \n                    returned = \"Paid\";\n\n              break;\n\n              case 'paid_out':\n                    returned = \"Paid\";\n\n              break;\n\n              case 'paid':\n                    returned = \"Paid\";\n\n              break;\n\n              case 'failed':\n                    returned = \"Failed\";\n\n              break;\n\n              case 'charged_back':\n                    returned = \"Charged Back\";\n\n              break;\n              default:\n                  returned = status;\n              break\n            }\n\n            return returned;\n\n        }\n\n     \n        $scope.downloadDocument = function(doc) {\n            var data = $.param({\n                id: doc\n            });\n\n            var ddd = doc.replace(/^.*[\\\\\\/]/, '');\n\n            $http.get('http://local.arrow.com/api/v1/plane_documents/show_file/'+ddd, {\n                    responseType: 'arraybuffer'\n                })\n                .success(function(data, status, headers) {\n                    var zipName = processArrayBufferToBlob(data, headers);\n\n                    //Delete file from temp folder in server - file needs to remain open until blob is created\n                    //deleteFileFromServerTemp(zipName);\n                }).error(function(data, status) {\n                    alert(\"There was an error downloading the selected document(s).\");\n                })\n        };\n\n        $scope.downloadInvoice = function(id) {\n            // var data = $.param({\n            //     id: doc\n            // });\n\n            //var ddd = doc.replace(/^.*[\\\\\\/]/, '');\n\n            $http.get('api/v1/invoice_pdf/get_ad_hoc_invoice/'+id, {\n                    responseType: 'arraybuffer'\n                })\n                .success(function(data, status, headers) {\n                    var zipName = processArrayBufferToBlob(data, headers);\n\n                    //Delete file from temp folder in server - file needs to remain open until blob is created\n                    //deleteFileFromServerTemp(zipName);\n                }).error(function(data, status) {\n                    alert(\"There was an error downloading the selected document(s).\");\n                })\n        };\n\n        function processArrayBufferToBlob(data, headers) {\n            var octetStreamMime = 'application/octet-stream';\n            var success = false;\n\n            // Get the headers\n            headers = headers();\n            //var ttt = title.toLowerCase().replace(/\\W/g, '_');\n            // Get the filename from the x-filename header or default to \"download.bin\"\n            var filename = headers['x-filename'] || 'download.zip';\n\n            // Determine the content type from the header or default to \"application/octet-stream\"\n            var contentType = headers['content-type'] || octetStreamMime;\n\n            try {\n                // Try using msSaveBlob if supported\n                var blob = new Blob([data], {\n                    type: contentType\n                });\n                if (navigator.msSaveBlob)\n                    navigator.msSaveBlob(blob, filename);\n                else {\n                    // Try using other saveBlob implementations, if available\n                    var saveBlob = navigator.webkitSaveBlob || navigator.mozSaveBlob || navigator.saveBlob;\n                    if (saveBlob === undefined) throw \"Not supported\";\n                    saveBlob(blob, filename);\n                }\n                success = true;\n            } catch (ex) {\n                $log.info(\"saveBlob method failed with the following exception:\");\n                $log.info(ex);\n            }\n\n            if (!success) {\n                // Get the blob url creator\n                var urlCreator = window.URL || window.webkitURL || window.mozURL || window.msURL;\n                if (urlCreator) {\n                    // Try to use a download link\n                    var link = document.createElement('a');\n                    if ('download' in link) {\n                        // Try to simulate a click\n                        try {\n                            // Prepare a blob URL\n                            var blob = new Blob([data], {\n                                type: contentType\n                            });\n                            var url = urlCreator.createObjectURL(blob);\n                            link.setAttribute('href', url);\n\n                            // Set the download attribute (Supported in Chrome 14+ / Firefox 20+)\n                            link.setAttribute(\"download\", filename);\n\n                            // Simulate clicking the download link\n                            var event = document.createEvent('MouseEvents');\n                            event.initMouseEvent('click', true, true, window, 1, 0, 0, 0, 0, false, false, false, false, 0, null);\n                            link.dispatchEvent(event);\n                            success = true;\n\n                        } catch (ex) {\n                            $log.info(\"Download link method with simulated click failed with the following exception:\");\n                            $log.info(ex);\n                        }\n                    }\n\n                    if (!success) {\n                        // Fallback to window.location method\n                        try {\n                            // Prepare a blob URL\n                            // Use application/octet-stream when using window.location to force download\n                            var blob = new Blob([data], {\n                                type: octetStreamMime\n                            });\n                            var url = urlCreator.createObjectURL(blob);\n                            window.location = url;\n                            success = true;\n                        } catch (ex) {\n                            $log.info(\"Download link method with window.location failed with the following exception:\");\n                            $log.info(ex);\n                        }\n                    }\n                }\n            }\n\n            if (!success) {\n                // Fallback to window.open method\n                $log.info(\"No methods worked for saving the arraybuffer, using last resort window.open\");\n                window.open(httpPath, '_blank', '');\n            }\n            return filename;\n        };\n\n      \n\n\n\n    }\napp.controller('ArtpiecesController', ArtpiecesController);\n \n    ArtpiecesController.$inject = ['UserService', 'CategoryService', 'ArtpiecesService', '$location', '$rootScope', 'FlashService', '$routeParams', '$scope'];\n    function ArtpiecesController(UserService, CategoryService, ArtpiecesService, $location, $rootScope, FlashService, $routeParams, $scope) {\n        var vm = this;\n        vm.artpiece = {};\n        vm.artpiece.categories = [];\n\n\n        //for the VIEW page\n\n        CategoryService.GetAll()\n                .then(function (data) {\n                    vm.categories = data;\n\n                    //If we are loading the edit page - let's get specific information that may be useful for the update! :-)\n                    if($routeParams.artpieceId !== \"\"){\n                    \t//for the edit page -- get the one\n\t\t\t\t\t\tArtpiecesService.GetById($routeParams.artpieceId)\n\t\t\t\t        \t\t.then(function (data){\n\t\t\t\t        \t\t\tvm.artpiece = data;\n\t\t\t\t        \t\t\tif(vm.artpiece.categories){\n\t\t\t\t\t        \t\t\t//console.log(vm.artpiece.categories);\n\t\t\t\t\t        \t\t\t// vm.artpiece.categories = JSON.parse(vm.artpiece.categories);\n\t\t\t\t\t        \t\t\t//console.log(\"FOR\");\n\t\t\t\t\t        \t\t\tfor(var i = 0; i < vm.artpiece.categories.length; i++){\n\t\t\t\t\t        \t\t\t\t//console.log(\"BOO\");\n\t\t\t\t\t        \t\t\t\t//console.log(vm.artpiece.categories[i]);\n\t\t\t\t\t        \t\t\t\t//remove from the dropdown the items already in the project\n\t\t\t\t\t        \t\t\t\tvm.categories = $.grep(vm.categories, function(e){ \n\t\t\t\t\t\t\t\t\t\t\t\treturn e.id != vm.artpiece.categories[i][\"category_id\"]; \n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t        \t\t\t\n\t\t\t\t\t        \t\t\t}\n\t\t\t\t\t        \t\t}\n\t\t\t\t        \t\t});\n                    }\n\n                });\n\n        ArtpiecesService.GetAll()\n        \t\t.then(function (data){\n        \t\t\tvm.artpieces = data;\n        \t\t});\n\n       \n\t\t$scope.tempAddCategory = function(data){\n\t\t\tvar category = JSON.parse(data);\n\t\t\t//console.log('add category_id : '+category.id);\n\t\t\tvm.artpiece.categories.push(category);\n\t\t\t//updating the select dropdown\n\t\t\tvm.categories = $.grep(vm.categories, function(e){ \n\t\t\t\treturn e.id != category.id; \n\t\t\t});\n\t\t}\n\n\t\t$scope.tempDeleteCategory = function(cat){\n\t\t\tvm.artpiece.categories = $.grep(vm.artpiece.categories, function(e){ \n\t\t\t\t\t     return e.id != cat.id; \n\t\t\t\t\t});\n\t\t\tvm.categories.push(cat);\n\t\t}\n\n\t\t$scope.AddCategory = function(data){\n\n\t\t\tvar category = JSON.parse(data);\n\t\t\t//console.log('add category_id : '+category.id);\n\n\t\t\tArtpiecesService.AddCategory( {\"category_id\": category.id, \"artpiece_id\": vm.artpiece.id} )\n        \t\t.then(function (data){\n        \t\t\n\t\t\t\t\tvm.artpiece.categories.push(category);\n\t\t\t\t\t//updating the select dropdown\n\t\t\t\t\tvm.categories = $.grep(vm.categories, function(e){ \n\t\t\t\t\t\treturn e.id != category.id; \n\t\t\t\t\t});\n\t\t\t});\n\n\t\t}\n\n\t\t$scope.DeleteCategory = function(category){\n\t\t\t//console.log(category);\n\t\t\tArtpiecesService.DeleteCategory({\"category_id\": category.category_id, \"artpiece_id\": vm.artpiece.id})\n        \t\t.then(function (data){\n\t\t\t\t\tvm.artpiece.categories = $.grep(vm.artpiece.categories, function(e){ \n\t\t\t\t\t     return e.id != category.id;\n\t\t\t\t\t});\n\t\t\t\t\tvm.categories.push(category);\n\t\t\t\t});\n\n\t\t}\n\n\t\t$scope.addArtpiece = function(){\n\t\t\t//console.log(\"SUBMITTED\");\n\t\t\t//console.log(vm.artpiece);\n\t\t\tArtpiecesService.Create(vm.artpiece)\n                .then(function (data) {\n                    \t\n                    $location.path(\"/artpieces\");\n                    vm.artpiece = {};\n\n                });\n\t\t}\n\n\t\t$scope.editArtpiece = function(){\n\t\t\tArtpiecesService.Update(vm.artpiece)\n                .then(function (data) {\n                    \t\n                    $location.path(\"/artpieces\");\n                    vm.artpiece = {};\n\n                });\n\t\t}\n\n\t\t$scope.deleteArtpiece = function(id){\n\t\t\t//console.log(\"GET HERE \"+id);\n\t\t\tArtpiecesService.Delete(id)\n                .then(function (data) {\n                    vm.artpieces = $.grep(vm.artpieces, function(e){ \n\t\t\t\t\t     return e.id != id; \n\t\t\t\t\t});\n                });\n\t\t}\n\n\t\t$scope.addCategory = function(){\n\t\t\t//console.log(\"ADD ONE \"+vm.new_category);\n\n\t\t\t//need to call the outside world here and now :0\n\t\t\tvar add_one = {\"title\": vm.new_category};\n\t\t\tCategoryService.Create(add_one)\n                .then(function (data) {\n                    vm.cats.push(data);\n                    //reset\n\t\t\t\t\tvm.new_category = \"\";\n                });\n\t\t}\n\n\n\n\t\t$scope.deleteCategory = function(id){\n\t\t\tCategoryService.Delete(id)\n                .then(function (data) {\n\n                    vm.cats = $.grep(vm.cats, function(e){ \n\t\t\t\t\t     return e.id != id; \n\t\t\t\t\t});\n\n                });\n\t\t}\n\n\n\n\n\n        //update on edit?\n  //      \tvm.myModel = 'Click here and delete me';\n\t\t// $scope.myUpdateHandler = function(id, category){\n\t\t//   // check your console\n\t\t//   //console.log('value of '+id+' your model is now: ' + category);\n\t\t//   var update = {\"id\": id, \"title\": category};\n\t\t//   CategoryService.Update(update)\n  //               .then(function (data) {\n  //                   //console.log(\"SAVED :)\");\n  //               });\n\t\t// };\n\n    }\n app.controller('BookinController', BookinController);\n\n    BookinController.$inject = ['$sce', 'UserService', 'MemberService', 'FoxService', 'InstructorService', 'MembershipService', 'HolidayService', '$rootScope', '$location', '$scope', '$state', '$stateParams', '$uibModal', '$log', '$window', '$compile', '$interval', '$timeout', 'uiCalendarConfig', 'BookingService', 'LicenceService', 'BookoutService', '$filter', 'PlaneService', 'InstructorCharges', 'PaymentService', 'InvoicesService', 'PackageService', 'CourseService', '$anchorScroll', 'smoothScroll'];\n    function BookinController($sce, UserService, MemberService, FoxService, InstructorService, MembershipService, HolidayService, $rootScope, $location, $scope, $state, $stateParams, $uibModal, $log, $window, $compile, $interval, $timeout, uiCalendarConfig, BookingService, LicenceService, BookoutService, $filter, PlaneService, InstructorCharges, PaymentService, InvoicesService, PackageService, CourseService, $anchorScroll, smoothScroll) {\n        \n        var vm = this;\n\n        vm.user = $rootScope.globals.currentUser;\n        vm.user_id = vm.user.id;\n\n        //this club ID needs to reflect the club that has been selected....\n        vm.club_id = 0;\n        vm.booking = {};\n\n        //base location to sort the airfields below\n        vm.wgs_n = \"51.51\";\n        vm.wgs_e = \"0.12\";\n\n        vm.split_flight = 0;\n        vm.show_takeoff_landing_times = false;\n\n        vm.change_booking = {};\n        vm.show_change_plane = false;\n        //we need to get the booking ID to pull as much data as we can!\n\n        vm.bookout = {\n            start: true,\n            passengers: [],\n            pic: {\n                id: vm.user_id\n            },\n            plane: {}\n        };\n\n        vm.this_pls_id_raw = 0;\n\n        vm.instructors = [];\n        vm.pics = [];\n        vm.instructor_charges = []; \n        vm.club_courses = [];      \n\n        vm.can_authorise = false;\n\n        vm.dateFormat = 'date:HH:mm \\'on\\' dd/MM/yyyy';\n        var setting_new_member;\n\n        vm.flight_times_complete = false;\n        vm.calculated_invoice = false;\n\n        vm.show_loading = true;\n\n        vm.reported_defects = [];\n\n        vm.scroll = true;\n\n        vm.previous_invoice;\n\n        vm.defect_severity;\n        vm.defect_severities = [\n            { title: \"No Fly Item - Ground the plane\"},\n            { title: \"Flyable - needs to be checked at next maintenance\"},\n            { title: \"Not urgent - but needs noting\"},\n            { title: \"Unsure of severity\"}\n        ];  \n\n\n        vm.claim_a_flight = [];\n        vm.claimed_flight = {};\n        vm.auto_claim = 0;\n        vm.ignore_next_tuition_change = false;\n\n        vm.get_currency = function(iso_code){\n\n\n           return $.grep(vm.currencies, function(e){ \n                        return e.iso_code == iso_code; \n                    })[0];\n\n        }\n\n        $scope.get_airfields = function(name){\n\n            if(name.length > 2 && name.length < 5){\n\n                 BookoutService.GetAirfieldsByCode(name)\n                .then(function (data) {\n                    //console.log(data);\n                    if(data.success){\n                        //use GB airfields first...\n                        vm.airfields = data.airfields;\n                       \n                         if(vm.airfields.length == 0){\n                            //console.log(\"SETTINGS HERE\");\n                               vm.airfields = [\n                                    {\n                                        id:0,\n                                        title: \"NOT LISTED : \"+ name,\n                                        code: \"ZZZZ\",\n                                        wgs_n: \"0\",\n                                        wgs_e: \"0\"\n                                    }];\n                        }\n\n                    } else {\n\n\n                        //console.log(\"WOOOPSIES...\");\n                        //this should be very very rare...\n                    }\n\n                });\n\n\n            }\n\n            if(name.length > 4){\n                var code = name.replace(/\\s/g, \"_\");\n                BookoutService.GetAirfields(code)\n                .then(function (data) {\n                    //console.log(data);\n                    if(data.success){\n                        //use GB airfields first...\n                        vm.airfields = data.airfields;\n\n\n                        if(vm.airfields.length == 0){\n                            //console.log(\"SETTINGS HERE\");\n                               vm.airfields = [\n                                    {\n                                        id:0,\n                                        title: \"NOT LISTED : \"+ name,\n                                        code: \"ZZZZ\",\n                                        wgs_n: \"0\",\n                                        wgs_e: \"0\"\n                                    }];\n                        }\n\n                    } else {\n                        //console.log(\"WOOOPSIES...\");\n                        //this should be very very rare...\n                    }\n\n                });\n\n            }\n        }\n        vm.original_bookout = {};\n        $scope.reset_claim_my_flight = function(){\n            //console.log(\"RESET CLAIM\");\n            vm.bookout = vm.original_bookout;\n            vm.different_date_warning = false; \n            vm.claimed_flight = {};\n            vm.calculate_invoice_for_flight();\n            vm.flight_times_complete = false;\n        }\n\n        vm.different_date_warning = false;\n        vm.has_used_claimed_flight = false;\n\n\n        var iconBank = '<svg viewBox=\"0 0 24 24\"><path d=\"M3 10h18M4 10V8l8-5 8 5v2M5 10v8M9 10v8M15 10v8M19 10v8M3 18h18M2 20h20\" fill=\"none\" stroke=\"#4f46e5\" stroke-width=\"1.6\"/></svg>';\n        var iconCard = '<svg viewBox=\"0 0 24 24\"><rect x=\"2\" y=\"4\" width=\"20\" height=\"16\" rx=\"2\" ry=\"2\" fill=\"none\" stroke=\"#4f46e5\" stroke-width=\"1.6\"/><path d=\"M2 9h20M6 14h6\" stroke=\"#4f46e5\" stroke-width=\"1.6\"/></svg>';\n        var iconNew  = '<svg viewBox=\"0 0 24 24\"><circle cx=\"12\" cy=\"12\" r=\"9\" fill=\"none\" stroke=\"#4f46e5\" stroke-width=\"1.6\"/><path d=\"M12 8v8M8 12h8\" stroke=\"#4f46e5\" stroke-width=\"1.6\"/></svg>';\n        var iconTerm = '<svg viewBox=\"0 0 24 24\"><rect x=\"6\" y=\"2\" width=\"12\" height=\"14\" rx=\"2\" fill=\"none\" stroke=\"#4f46e5\" stroke-width=\"1.6\"/><rect x=\"8\" y=\"5\" width=\"8\" height=\"3\" fill=\"none\" stroke=\"#4f46e5\" stroke-width=\"1.6\"/><rect x=\"9\" y=\"10\" width=\"6\" height=\"3\" fill=\"none\" stroke=\"#4f46e5\" stroke-width=\"1.6\"/></svg>';\n        \n        //direct-debit, saved-card, new-card, card-machine\n        vm.donConfirm = function(methodLabel, paymentIntent){\n            console.log(\"confirmation is called\", methodLabel);\n            console.log(\"paymentIntent\", paymentIntent);\n            //alert('Parent received D confirmation: ' + methodLabel);\n            //vm.book_in_flight(methodLabel, paymentIntent);\n\n            var where_to = \"home\";\n\n            if(vm.user.id !== vm.bookout.payer_id && (vm.user.id == vm.bookout.pic_id || vm.user.id == vm.bookout.instructor_id)){\n                //person booking in is the instructor - lets go to debrief:\n                where_to = \"debrief\";\n            } else if(vm.split_flight_confirmation == 1){\n               // where_to = \"split\"; - i dont think we get here\n            } \n\n            // else if(vm.can_authorise){\n            //    card-machine option?\n            //}\n\n\n            //where_to : home, next, split, debrief\n\n            vm.book_in_flight(where_to, methodLabel, paymentIntent);\n        };\n\n\n        vm.default_payment = 'direct-debit';\n\n        vm.methods = [\n            { id: 'direct-debit', title: 'Direct Debit', subtitle: 'Use your BACS mandate', type: 'direct-debit', iconSvg: $sce.trustAsHtml(iconBank), visible: true },\n            { id: 'saved-card',   title: 'Saved card',   subtitle: 'Use a card on file',    type: 'saved-card',  iconSvg: $sce.trustAsHtml(iconCard), visible: true },\n            { id: 'new-card',     title: 'New card',     subtitle: 'Add a new debit/credit card', type: 'new-card', iconSvg: $sce.trustAsHtml(iconNew), visible: true },\n            { id: 'card-machine', title: 'Card Machine', subtitle: 'Pay in person',          type: 'card-machine', iconSvg: $sce.trustAsHtml(iconTerm), visible: true }\n          ];\n\n          // vm.expandedId = 'direct-debit';\n          // vm.selectedId = 'direct-debit';\n          vm.savedCards = [\n         \n          ];\n\n        \n        $scope.claim_my_flight = function(force = false){\n            // console.log(\"CLAIM MY FLGIHT PLEASE!!\");\n            // console.log(\"CAIMING\", vm.claimed_flight);\n\n            if(vm.bookout.flight_date !== vm.claimed_flight.flight_date && force === false){\n                alert(\"The bookout date and the flight you are claiming do not match - are you absolutely sure that this is your flight?\");\n                vm.different_date_warning = true;\n                return false;\n            }\n\n            if(vm.this_claim_was_instructional == true){\n                vm.this_was_instructional_claim();\n            }\n\n            vm.this_pls_id_raw = Object.assign({}, vm.bookout);\n            console.log(\"vm.this_pls_id_raw\", vm.this_pls_id_raw);\n\n            vm.has_used_claimed_flight = true;\n\n            vm.bookout.from_airfield = vm.claimed_flight.from_airport;\n            vm.bookout.to_airfield = vm.claimed_flight.to_airport;\n\n            if(vm.claimed_flight.from_airport.id == vm.claimed_flight.to_airport.id){\n                if(vm.claimed_flight.touch_and_go > 2){\n                    // circuits 3?\n                    var selected_detail_type = vm.flight_types.find(item => item.id === 3);\n                    vm.bookout.flight_type = selected_detail_type;\n                } else {\n                    //local flight? 1 \n                    var selected_detail_type = vm.flight_types.find(item => item.id === 1);\n                    vm.bookout.flight_type = selected_detail_type;\n                }\n\n            } else {\n                var selected_detail_type = vm.flight_types.find(item => item.id === 2);\n                vm.bookout.flight_type = selected_detail_type;\n            }\n            \n            vm.bookout.flight_date = vm.claimed_flight.flight_date;\n\n            vm.bookout.brakes_off_rounded =  vm.claimed_flight.brakes_off_rounded;\n            vm.bookout.brakes_on_rounded = vm.claimed_flight.brakes_on_rounded;\n\n            vm.bookout.brakes_off = {time: vm.claimed_flight.brakes_off};\n            vm.bookout.brakes_on = {time: vm.claimed_flight.brakes_on};\n\n            vm.bookout.touch_and_go = vm.claimed_flight.touch_and_go;\n            vm.bookout.landings = vm.claimed_flight.full_stop_landings;\n            \n            vm.bookout.stops = vm.claimed_flight.stops;\n\n            vm.bookout.fox_log_id = vm.claimed_flight.fox_log_id;\n            vm.bookout.fox_claimed = 1;\n\n            vm.bookout.takeoff_time = vm.claimed_flight.takeoff_time;\n            vm.bookout.landing_time = vm.claimed_flight.landing_time;\n\n\n            vm.bookout.takeoff_rounded = vm.claimed_flight.takeoff_rounded;\n            vm.bookout.landing_rounded = vm.claimed_flight.landing_rounded;\n            //console.log(\"TAKEOFF TIME HERE : \", vm.bookout.takeoff_time);\n\n            //THIS IS THE KEY HERE delete this one once selected / complete\n            vm.bookout.claimed_fox_plane_log_sheet_id = vm.claimed_flight.id;\n\n\n            //set the important bits for the invoice now\n            vm.flight_units.brakes_to_brakes = vm.claimed_flight.brakes_time;\n            vm.flight_units.airborne_times = vm.claimed_flight.airborne_time;\n            vm.flight_units.flight_time = vm.claimed_flight.flight_time;\n            vm.flight_units.brakes_times_rounded = vm.bookout.brakes_times_rounded;\n            \n            //calculate the invoice yay\n            vm.calculate_invoice_for_flight();\n            vm.flight_times_complete = true;\n\n            if(vm.bookout.plane_charges.charge_type == \"tacho\" || vm.bookout.plane_charges.charge_type == \"hobbs\"){\n                //alert(\"Charges are based on tacho - please enter the final tacho number!\");\n                //scroll to the the correct bit?\n            }\n\n            console.log(\"BOOKING : \", vm.bookout.booking_id);\n            console.log(\"PLS ID : \", vm.bookout.id);\n        }\n\n\n        $scope.update_pic = function(){\n            // //console.log(\"--> \", vm.user.id);\n            // //console.log(\"--> \", vm.bookout.instructor_id);\n            // //console.log(\"--> \", vm.bookout.pic.user_id);\n\n            // if(vm.bookout.pic.user_id == vm.bookout.user_id){\n            //     //user is P1\n            //     var selected_pic = vm.pics.find(item => item.user_id === vm.bookout.pic.user_id);\n            //     vm.bookout.pic = selected_pic;\n            //     vm.bookout.pic_id = vm.bookout.pic.user_id;\n            // }\n\n            // if(vm.bookout.pic.user_id == vm.bookout.instructor_id){\n            //     //instructor is P1\n            //     var selected_put = vm.pics.find(item => item.user_id === vm.bookout.user_id);\n            //     vm.bookout.put = selected_put;\n            // }\n\n            var selected_pic = vm.pics.find(item => item.user_id === vm.bookout.pic.user_id);\n            vm.bookout.pic = selected_pic;\n            vm.bookout.pic_id = vm.bookout.pic.user_id;\n            // console.log(\"INSTRUCTION;:\", vm.this_claim_was_instructional);\n\n            if(!vm.this_claim_was_instructional || vm.this_claim_was_instructional == false){\n                // console.log(\"yagh\");\n                PackageService.GetPackagesByUserId(vm.bookout.pic_id)\n                .then(function (data) {\n                // IF IT HAS A PACKAGE ID --> THEN WE NEED TO CHECK IT PUT THE CORRECT PAYMENT INFORMATION THERE\n                    //console.log(\"BOOKOUT PACKAGE\", data);\n                    //console.log(\"BOOKOUT PACKAGE\", data.packages);\n                    vm.packages = data.items;\n\n                    PlaneService.GetUpdatedCharges(vm.bookout.club_id, vm.bookout.plane_id, vm.bookout.pic_id)\n                    .then(function (data) {\n                            ////console.log(\"data is : \", data);\n                            vm.bookout.plane_charges = data.plane_charges;\n\n\n                            vm.bookout.put_id = 0;\n                            vm.bookout.put = {};\n                            vm.bookout.instructor_id = 0;\n                            if(vm.bookout.pic_id > 0){\n                                vm.bookout.payer_id = vm.bookout.pic_id;\n                            } else if(vm.bookout.user_id > 0) {\n                                vm.bookout.payer_id = vm.bookout.pic_id;\n                            } else {\n                                //alert(\"It appears that no payer ID has been set yet.\");\n                            }\n\n\n                            vm.calculate_invoice_for_flight();\n                            // console.log(\"calc?\");\n                    });\n\n                });\n\n\n                \n\n            } else {\n                console.log(\"before change - this was instructional\");\n                if(vm.bookout.pic.instructor == 1){\n\n                } else {\n                    vm.this_claim_was_instructional = false;\n                    vm.bookout.put_id = 0;\n                    vm.bookout.put = {};\n                    vm.bookout.instructor_id = 0;\n                    if(vm.bookout.pic_id > 0){\n                        vm.bookout.payer_id = vm.bookout.pic_id;\n                    } else if(vm.bookout.user_id > 0) {\n                        vm.bookout.payer_id = vm.bookout.pic_id;\n                    } else {\n                        //alert(\"It appears that no payer ID has been set yet.\");\n                    }\n                    vm.calculate_invoice_for_flight();\n                }\n               \n            }\n            \n            vm.complete_flight = false;\n\n            if(vm.bookout.pic.user_id == vm.user.id){\n                vm.can_authorise = false;\n            }\n\n            if(!vm.bookout.booking || vm.bookout.booking.user_id == 0 || vm.bookout.user_id == 0){\n                vm.bookout.user_id = vm.bookout.pic.user_id;\n            }\n\n\n            if(vm.bookout.put_id == 0 && vm.bookout.instructor_id == 0){\n                // console.log(\"TRYING HERE ==> \", vm.bookout.pic_id);\n                // console.log(\"TRYING TWO ==> \", vm.bookout.payer_id);\n                vm.bookout.payer_id = vm.bookout.pic_id;\n                // console.log(\"TRYING THREE ==> \", vm.bookout.payer_id);\n            } else {\n                // console.log(\"TRYING PUT ID ==> \", vm.bookout.put_id);\n                // console.log(\"INSTRUCTOR ID ==> \", vm.bookout.instructor_id);\n\n            }\n\n             if(vm.bookout.payer_id == 0){\n                // console.log(\"PAYER ID = 0\");\n                //vm.bookout.payer_id = vm.bookout.pic_id;\n            }\n\n\n\n\n            if(vm.complete_flight){\n                vm.complete_this_flight();\n            }\n\n            // if(vm.bookout.pic.user_id == vm.user.id && vm.bookout.instructor_id > 0){\n            //     //console.log(\"okay... so you want the instructor to be put? interesting...\");\n            //     //adheres to booking\n\n            // } else if(vm.bookout.instructor_id > 0 && vm.bookout.pic.user_id == vm.bookout.instructor_id) {\n            //     //console.log(\"okay so you now have your booked instructor as the PIC again - nice\");\n            //     //adheres to booking\n\n            // } else {\n            //     //console.log(\"you've change instructor? what happened?\");\n            //     //availability has been checked hence we're OK\n\n            // }\n\n\n        }\n\n        $scope.update_put = function(){\n            // //console.log(\"--> \", vm.user.id);\n            // //console.log(\"--> \", vm.bookout.instructor_id);\n            // //console.log(\"--> \", vm.bookout.pic.user_id);\n            if(vm.bookout.put.user_id == vm.bookout.pic.user_id){\n                alert(\"please select a different PIC to the PUT\");\n                vm.bookout.put = {};\n                return false;\n            }\n\n            vm.complete_flight = false;\n            \n            var selected_put = vm.pics.find(item => item.user_id === vm.bookout.put.user_id);\n            vm.bookout.put = selected_put;\n\n            vm.bookout.put_id = selected_put.user_id;\n\n\n            if(vm.bookout.put_id > 0){\n                vm.bookout.instructor_id = vm.bookout.pic_id;\n\n                vm.bookout.instructor = vm.bookout.pic;\n\n                console.log(\"FI: \", vm.bookout.instructor);\n                console.log(\"instructor_id: \", vm.bookout.instructor_id);\n\n                $scope.update_pic();\n\n            }\n\n\n\n            PackageService.GetPackagesByUserId(vm.bookout.put_id)\n            .then(function (data) {\n            // IF IT HAS A PACKAGE ID --> THEN WE NEED TO CHECK IT PUT THE CORRECT PAYMENT INFORMATION THERE\n                //console.log(\"BOOKOUT PACKAGE\", data);\n                //console.log(\"BOOKOUT PACKAGE\", data.packages);\n                vm.packages = data.items;\n                PlaneService.GetUpdatedCharges(vm.bookout.club_id, vm.bookout.plane_id, vm.bookout.put_id)\n                    .then(function (data) {\n                            ////console.log(\"data is : \", data);\n                            vm.bookout.plane_charges = data.plane_charges;\n                            vm.calculate_invoice_for_flight();\n                    });\n            });\n\n            // if(vm.bookout.put_id > 0){\n            //     vm.bookout.payer_id = vm.bookout.put_id;\n            // }\n\n\n            if(vm.bookout.pic_id !== 0 && vm.bookout.pic_id !== vm.bookout.instructor_id){\n                vm.bookout.payer_id = vm.bookout.pic_id; //PIC is student supervised or otherwise solo\n            } else if((vm.bookout.instructor_id > 0 && vm.bookout.put_id > 0) || vm.bookout.instructor_id > 0 && vm.bookout.user_id > 0){\n                vm.bookout.payer_id = (vm.bookout.put_id > 0)? vm.bookout.put_id : vm.bookout.user_id; //put always pays\n            } else if(vm.bookout.put_id > 0){\n                vm.bookout.payer_id = vm.bookout.put_id;\n            } else if(vm.bookout.put_id == 0 && vm.bookout.user_id == 0){\n                vm.bookout.payer_id = vm.bookout.pic_id;\n            } else {\n                if(vm.bookout.instructor_id == 0){\n                    vm.bookout.payer_id = vm.bookout.pic_id;\n                }\n                if(vm.bookout.payer_id == 0){\n                    alert(\"It appears you need to select a student or person paying for this flight? Please select a student or pilot in command\");\n                }\n            }\n\n\n            \n            if(vm.complete_flight){\n                vm.complete_this_flight();\n            }\n\n            // if(vm.bookout.put.user_id == vm.bookout.user_id){\n            //     //user is P1\n            //     var selected_put = vm.pics.find(item => item.user_id === vm.bookout.put.user_id);\n            //     vm.bookout.put = selected_put;\n            // }\n\n            // if(vm.bookout.put.user_id == vm.bookout.instructor_id){\n            //     //instructor is P1\n            //     var selected_put = vm.pics.find(item => item.user_id === vm.bookout.user_id);\n            //     vm.bookout.put = selected_put;\n            // }\n\n\n            // if(vm.bookout.pic.user_id == vm.user.id && vm.bookout.instructor_id > 0){\n            //     //console.log(\"okay... so you want the instructor to be put? interesting...\");\n            //     //adheres to booking\n\n            // } else if(vm.bookout.instructor_id > 0 && vm.bookout.pic.user_id == vm.bookout.instructor_id) {\n            //     //console.log(\"okay so you now have your booked instructor as the PIC again - nice\");\n            //     //adheres to booking\n\n            // } else {\n            //     //console.log(\"you've change instructor? what happened?\");\n            //     //availability has been checked hence we're OK\n\n            // }\n        }\n\n        $scope.update_instructor = function(){\n            // //console.log(\"--> \", vm.user.id);\n            // //console.log(\"--> \", vm.bookout.instructor_id);\n            // //console.log(\"--> \", vm.bookout.pic.user_id);\n            \n            var selected_instructor = vm.instructors.find(item => item.user_id === vm.bookout.instructor.user_id);\n            \n            //console.log(\"INSTRUCTOR UPDATE: \", selected_instructor);\n\n            if(selected_instructor && selected_instructor.user_id > 0){\n                vm.bookout.instructor = selected_instructor;\n                vm.bookout.instructor_id = selected_instructor.user_id;\n                if(vm.bookout.pic_id !== 0 && vm.bookout.pic_id !== vm.bookout.instructor_id){\n                    vm.bookout.payer_id = vm.bookout.pic_id; //PIC is student supervised or otherwise solo\n                } else if((vm.bookout.instructor_id > 0 && vm.bookout.put_id > 0) || vm.bookout.instructor_id > 0 && vm.bookout.user_id > 0){\n                    vm.bookout.payer_id = (vm.bookout.put_id > 0)? vm.bookout.put_id : vm.bookout.user_id; //put always pays\n                } else if(vm.bookout.put_id > 0){\n                    vm.bookout.payer_id = vm.bookout.put_id;\n                } else if(vm.bookout.put_id == 0 && vm.bookout.user_id == 0){\n                    vm.bookout.payer_id = vm.bookout.pic_id;\n                } else {\n                    if(vm.bookout.instructor_id == 0){\n                        vm.bookout.payer_id = vm.bookout.pic_id;\n                    }\n                    if(vm.bookout.payer_id == 0){\n                        alert(\"It appears you need to select a student or person paying for this flight? Please select a student or pilot in command\");\n                    }\n                }\n                // if(vm.bookout.pic_id > 0){\n                //     vm.bookout.payer_id = vm.bookout.pic_id;\n                // }\n            } else {\n                vm.bookout.instructor = {};\n                vm.bookout.instructor_id = 0;\n                vm.bookout.payer_id = vm.bookout.pic_id;\n            }\n\n            if(vm.complete_flight){\n                vm.complete_this_flight();\n            }\n            \n        }\n\n\n        \n\n\n        // the ARRIVAL option should be automatically filled in when there was a departure prior to the flight and home airfield was\n        //entered as the destination\n\n        vm.flight_types = [\n            {\n                id: 1,\n                title: \"Local\"\n            }, \n            {\n                id: 2,\n                title: \"Departure\"\n            },\n            {\n                id: 3,\n                title: \"Circuits\"\n            },\n            {\n                id: 4,\n                title: \"Other\"\n            }\n        ];\n\n\n        vm.biggin_hill = {\n\n            routes: [\n                {\n                    id: 1,\n                    title: \"Kenley\"\n                },\n                {\n                    id: 2,\n                    title: \"Sevenoaks\"\n                },\n                {\n                    id: 3,\n                    title: \"Swanley\"\n                },\n                {\n                    id: 4,\n                    title: \"Other\"\n                }\n            ],\n            parking: \"\"\n\n        }\n\n        vm.flight_rules = [\n            {\n                id: 1,\n                title: \"VFR\"\n            },\n            {\n                id: 2,\n                title: \"IFR\"\n            }\n        ];\n        vm.split_flight_confirmation = 0;\n\n        vm.split_this_flight = function(){\n            vm.split_flight = 1;\n            //add this pls_id to the split\n            var split_send = vm.split_flight_time;\n            split_send.booking_id = vm.bookout.booking_id;\n            split_send.this_pls_id = vm.bookout.id;\n            // console.log(\"split it\");\n            // console.log(\"vm.bookout.id : \", vm.bookout.id);\n            // console.log(\"split_send : \", split_send);\n            PlaneService.HypotheticalFlightSplit(vm.bookout.id, split_send)\n             .then(function (data) {\n                    // console.log(\"data is : \", data);\n                    vm.split_one = data.first_flight;\n                    \n                    vm.split_flight = 1;    \n                    // vm.split_one.brakes_off = {\"time\": vm.split_one.brakes_off};\n                    // vm.split_one.brakes_on = {\"time\": vm.split_one.brakes_on};\n                    vm.split_two = data.second_flight;\n                    vm.split_two.brakes_off = {\"time\": vm.split_two.brakes_off};\n                    vm.split_two.brakes_on = {\"time\": vm.split_two.brakes_on};\n                });\n\n        }\n\n        vm.cancel_split = function(){\n            vm.bookout = vm.original_bookout;\n            vm.split_one = {};\n            vm.split_two = {};\n            vm.split_flight = 0;\n            vm.split_flight_confirmation = 0;\n\n            process_bookout_to_bookin(vm.bookout);\n\n\n        }\n\n        vm.update_split = function(){\n            // console.log(\"we updated the split time hmmm...\");\n            // console.log(vm.split_flight_time);\n            \n            // console.log(\"flight 1\");\n            // console.log(vm.bookout.brakes_off_rounded);\n            // console.log(vm.split_flight_time.time);\n\n            // console.log(\"flight 2\");\n            // console.log(vm.split_flight_time.time);\n            // console.log(vm.bookout.brakes_on_rounded);\n\n            var pls_id = vm.bookout.id; \n            if(!pls_id || pls_id == null || pls_id == 0){\n                //console.log(\"RAW> \", vm.this_pls_id_raw);\n                pls_id = vm.this_pls_id_raw;\n            }\n               // console.log(\"RAWDAWG \", pls_id);\n\n            if(vm.has_used_claimed_flight && vm.claimed_flight.id > 0){\n                //console.log(\"SPLIT FLIGHT CLAIMED\");\n                pls_id = vm.claimed_flight.id;\n            }\n\n            var split_send = vm.split_flight_time;\n            split_send.booking_id = vm.bookout.booking_id;\n            split_send.this_pls_id = vm.bookout.id;\n\n            // console.log(\"split it\");\n            // console.log(\"pls_id : \", pls_id);\n            // console.log(\"split_send : \", split_send);\n\n            //hypothetical_flight_split\n            PlaneService.HypotheticalFlightSplit(pls_id, split_send)\n             .then(function (data) {\n                    console.log(\"data is : \", data);\n                    vm.split_one = data.first_flight;\n                    \n                    vm.split_flight = 1;    \n                    // vm.split_one.brakes_off = {\"time\": vm.split_one.brakes_off};\n                    // vm.split_one.brakes_on = {\"time\": vm.split_one.brakes_on};\n                    vm.split_two = data.second_flight;\n                    vm.split_two.brakes_off = {\"time\": vm.split_two.brakes_off};\n                    vm.split_two.brakes_on = {\"time\": vm.split_two.brakes_on};\n                });\n\n\n        }\n\n        function clean_times(which, start_end, compared_to = null){\n\n            var compare_date;\n\n            // //console.log(\"CLEAN TIMES \" ,which);\n\n\n            var this_date = new Date();\n\n\n            if(vm.bookout && vm.bookout.brakes_off){\n\n                compare_date = new Date(compared_to);\n                var split_time = vm.bookout.brakes_off.time.split(\":\");\n                compare_date.setHours(split_time[0]);\n                compare_date.setMinutes(split_time[1]);\n                compare_date.setSeconds(0);\n\n                this_date = new Date(compared_to);\n                this_date.setHours(0);\n                this_date.setMinutes(0);\n                this_date.setSeconds(0);\n\n            } else {\n                switch(which){\n                    case 'today':\n                        // compare_date = new Date();\n                        compare_date = new Date(\"1990-07-26\");\n\n                    break;\n                    case 'past':\n                        //we need to consider the back-dating as possible issue...\n                        compare_date = new Date(\"1990-07-26\");\n                    break;\n                    case 'future':\n                        compare_date = new Date(\"1990-07-26\");\n                    break;\n                    case 'after':\n                    //differentiate here\n                        compare_date = new Date(compared_to);\n                        this_date = new Date(compared_to);\n                    break;\n                    case 'before':\n                    //differentiate here\n                        compare_date = new Date(compared_to);\n                    break;\n                }\n            }\n\n          \n\n            //console.log(\"THIS DATE\", this_date);\n            //console.log(\"COMPARE DATE\", compare_date);\n\n\n\n            vm[start_end].forEach(function(time, i){\n\n                        //this may very well be the case function here to change when the re-do the times            \n                        var split_time = time.time.split(\":\");\n                        this_date.setHours(split_time[0]);\n                        this_date.setMinutes(split_time[1]);\n                        this_date.setSeconds(0);\n\n\n                        if( moment(this_date).isAfter(moment(compare_date)) ){\n                            vm[start_end][i].disabled = 0;\n                            //we should / could be checking airport opening hours...?\n                            //vm[start_end][i].disabled = check_business_hours(parseInt(split_time[0]), parseInt(split_time[1]), (start_end == \"start_times\")? 1 : 0);\n                        } else {\n                            vm[start_end][i].disabled = 1;\n                        }\n                    });\n\n                //by definition as we are changing something to cause this function from being called - we need to recalculate the times:\n                //calculate_duration();\n\n        }\n\n        vm.start_times = [];\n        vm.all_times = [];\n\n        for(var i=0;i<24;i++){\n\n                for(var j=0; j<(60/5); j++){\n                    var k = 5 * j;\n                    k = ((k < 10) ? '0' : '') + k;\n                    vm.start_times.push({time: i+\":\"+k, disabled: false});\n                }\n\n                for(var j=0; j<(60/10); j++){\n                    var k = 10 * j;\n                    k = ((k < 10) ? '0' : '') + k;\n                    vm.all_times.push({time: i+\":\"+k, disabled: false});\n                }\n           \n\n        }\n        //clean_times('today', 'start_times');\n        clean_times('future', 'all_times');\n\n        // vm.bookout.pic = vm.pics[0];\n        vm.currency_days = 28;\n\n\n        vm.dateTimeRangePickerOptions = {\n                hour_step: 1,\n                minute_step: 30,\n                min_date: new Date(),\n                business_hours: {\n                    from: \"09:00\",\n                    to: \"22:30\"\n                }\n            };\n\n\n         vm.dateTimeRangePickerOptions2 = {\n                hour_step: 1,\n                minute_step: 5,\n                min_date: new Date(),\n                business_hours: {\n                    from: \"00:00\",\n                    to: \"23:55\"\n                }\n            };\n\n            vm.options = {\n                hour_step: 1,\n                minute_step: 5,\n                min_date: new Date(),\n                business_hours: {\n                    from: \"00:00\",\n                    to: \"23:55\"\n                }\n            };\n\n\n\n\n            vm.lubricant_type = [{ title: \"Fuel\"}, {title: \"Oil\"}];\n            vm.who_paid = [{ title: \"Me\"}, {title: \"Club\"}];\n            vm.receipt = {\n                image: \"\",\n                quantity: 0,\n                price: 0,\n                reimbursement: false,\n                item: {title: \"Fuel\"}\n            };\n\n            $scope.processFiles = function(files){\n\n                for(var i=0; i<files.length; i++){\n                    // //console.log(\"JSON\", files[i].file_return);\n                    var j = JSON.parse(files[i].file_return);\n                    // //console.log(\"PARSED\", j);\n                    files[i].file.temp_path = j.saved_url;\n                    // //console.log(\"file\", files[i].file);\n                    vm.receipt_image = files[i].file;\n                    vm.receipt.image = vm.receipt_image.temp_path;\n                    //console.log(\"IMAGE\", vm.receipt_image);\n                }\n               \n            }\n\n            vm.update_course = function(){\n\n                console.log(\"do we need to update tuition to be offered from this?\");\n                // IF nothing selected --> give ALL OPTIONS\n                if(vm.bookout.course && vm.bookout.course.id > 0){\n\n                    console.log(\"vm.bookout.course\", vm.bookout.course);\n\n                     InstructorCharges.GetByCourseId(vm.bookout.course.id)\n                    .then(function(data){\n                        vm.instructor_charges = data.items;  \n\n                        //check if updates selected tuition received list?\n                        if(vm.instructor_charges.length == 1){\n                            //set this automatically?\n                            vm.bookout.tuition_required = vm.instructor_charges[0];\n                        }\n                         //UPDATE TUITION CHARGES\n                        vm.ignore_next_tuition_change = true;\n                        vm.update_tuition_charges(); //>> is this right?\n                    });\n\n                } else {\n                     InstructorCharges.GetByClubId(vm.bookout.club_id)\n                    .then(function(data){\n                        vm.instructor_charges = data.items;  \n\n                        //check if updates selected tuition received list?\n                        if(vm.instructor_charges.length == 1){\n                            //set this automatically?\n                            vm.bookout.tuition_required = vm.instructor_charges[0];\n                        }\n                         //UPDATE TUITION CHARGES\n                        vm.ignore_next_tuition_change = true;\n                        vm.update_tuition_charges(); //>> is this right?\n\n                    });\n                }\n                // InstructorCharges.GetByClubId(booking.club_id)\n                // .then(function(data){\n                //     vm.instructor_charges = data.items;  \n                // });\n\n                // IF course is selected --> GIVE ONLY THAT COURSE OPTION\n\n\n               \n\n\n\n            }\n\n            vm.update_tuition_charges = function(){\n\n                if(vm.bookout.tuition_required && vm.bookout.tuition_required.id > 0){\n\n\n                    InstructorCharges.GetUpdatedCharges(vm.bookout.tuition_required.id)\n                    .then(function (data) {\n                        //console.log(\"data is : \", data);\n\n                        vm.bookout.tuition_charges = data.tuition_charges;\n                        vm.bookout.tuition_required = data.tuition_required;\n                        vm.bookout.tuition_id = data.tuition_required.id;\n                        console.log(\"tuition charges: \", vm.bookout);\n                        vm.calculate_invoice_for_flight();\n\n                        if(vm.complete_flight){\n                            vm.complete_this_flight();\n                        }\n                        vm.ignore_next_tuition_change = false;\n                    });\n\n                } else {\n                    if(!vm.ignore_next_tuition_change){\n                        if(vm.bookout.instructor_id > 0){\n                            alert(\"Please select a tuition type for this flight.\");\n                        }\n                        vm.ignore_next_tuition_change = false;\n                    }\n                    \n                }\n\n\n            }\n\n            vm.delete_receipt = function(id){\n\n                 PlaneService.DeleteReceipt(id)\n                .then(function (rcpt) {\n\n                    PlaneService.GetAllSheetReceipts(vm.bookout.id)\n                    .then(function (data) {\n                        ////console.log(\"data is : \", data);\n                        vm.lubricant_receipts = data;\n                        vm.calculate_invoice_for_flight();\n\n                    });\n\n                });\n            }\n\n\n            vm.check_reimbursement = function(){\n\n                if(vm.receipt.price < 0.01 || vm.receipt.currency == \"\"){\n                    return false;\n                }\n\n                var obj = {\n                    price: vm.receipt.price,\n                    currency: vm.receipt.currency.iso_code,\n                    club_id: vm.bookout.club_id\n                }\n\n                PlaneService.CheckReimbursement(obj)\n                    .then(function (data) {\n                        //console.log(\"conversion\", data);\n\n                        vm.receipt.reimbursed_amount = data.reimburse.reimbursed_amount;\n                        vm.receipt.reimbursed_currency = data.reimburse.reimbursed_currency;\n                        vm.receipt.reimbursed_rate = data.reimburse.rate;\n                        vm.receipt.reimbursed_datetime = data.reimburse.datetime;\n\n\n                    });\n\n\n            }\n\n\n            vm.add_receipt = function(){\n\n                if(vm.receipt.reimbursement && !vm.receipt.image){\n                    alert(\"You must upload a copy of your receipt if you wish to be re-imbursed.\");\n                    return false;\n                }\n\n                var obj = {\n                    plane_id: vm.bookout.plane_id,\n                    club_id: vm.bookout.club_id,\n                    user_id: vm.user.id,\n                    plane_log_sheet_id: vm.bookout.id,\n                    reimbursement: vm.receipt.reimbursement,\n                    image: vm.receipt.image,\n                    currency: vm.receipt.currency.iso_code,\n                    item: vm.receipt.item.title,\n                    quantity: vm.receipt.quantity,\n                    price: vm.receipt.price\n                }\n\n                //console.log(\"OBJ TO SEND: \", obj);\n\n\n                PlaneService.AddReceipt(obj)\n                .then(function (rcpt) {\n                            //console.log(\"RECEIPTS\", rcpt);          \n                            vm.lubricant_receipts.push(rcpt.item);\n\n\n                            //clear the uploaded items...\n                            vm.receipt = {\n                                image: \"\",\n                                quantity: 0,\n                                price: 0,\n                                reimbursement: false,\n                                item: {title: \"Fuel\"}\n                            };\n\n                            vm.calculate_invoice_for_flight();\n\n                });\n\n\n            }\n\n            /* ADD OR EDIT THE BOOKING */\n\n            function check_business_hours(i, k = null, start = 0){\n            //i is hours\n            //k is minutes\n            k = parseInt(k);\n            i = parseInt(i);\n\n            var this_step_disabled = 0; \n            if(vm.options.business_hours){\n                var split = vm.options.business_hours.from.split(\":\");\n                var split2 = vm.options.business_hours.to.split(\":\");\n\n                if(start == 0){\n                    //adjust to match times / end min 1 hour slots\n                   // split2[0] = parseInt(split2[0]) + 1;\n                } else {\n                    split2[0] = parseInt(split2[0]) - 1;\n                }\n\n                if(k || k == 0){\n                    \n                    if(i < parseInt(split[0]) ){\n                        // //console.log(\"we disable because \"+i+\":\"+k+\" is before \"+split.join(\":\") );\n                        this_step_disabled = 1;\n                    } else if(i == parseInt(split[0]) && k < parseInt(split[1])){\n                         // //console.log(\"we disable because \"+i+\":\"+k+\" is before \"+split.join(\":\") );\n                        this_step_disabled = 1;\n                    }\n\n                    // if(i >= parseInt(split2[0]) && k >= parseInt(split2[1]) ){\n                    //     // //console.log(\"we disable because \"+i+\":\"+k+\" is after \"+split2.join(\":\") );\n                    //     this_step_disabled = 1;\n                    // } \n\n\n                    if(i > parseInt(split2[0])){\n                        this_step_disabled = 1; \n                    } else if( i == parseInt(split2[0]) && k > parseInt(split2[1])){\n                        this_step_disabled = 1;\n                    }\n\n\n                } else {\n                    if(parseInt(split[0]) < i){\n                        this_step_disabled = 1;\n                    } \n                    if(parseInt(split2[0]) > i){\n                        this_step_disabled = 1;\n                    } \n                }\n            }\n\n            return this_step_disabled;\n        }\n\n        vm.options = {};\n        vm.start_times = [];\n        vm.end_times = [];\n\n        vm.takeoff_times = [];\n        vm.landing_times = [];\n\n        \n\n\n            function figure_out_steps(){\n                //console.log(\"OPTIONS\", vm.dateTimeRangePickerOptions2);\n                vm.options = vm.dateTimeRangePickerOptions2;\n                 for(var i=0;i<24;i+=vm.options.hour_step){\n\n                    if(vm.options.minute_step && vm.options.minute_step > 0){\n                        for(var j=0; j<(60/vm.options.minute_step); j++){\n                            var k = vm.options.minute_step * j;\n                            k = ((k < 10) ? '0' : '') + k;\n                            vm.start_times.push({time: i+\":\"+k, disabled: check_business_hours(i, k)});\n                            vm.end_times.push({time: i+\":\"+k, disabled: check_business_hours(i, k), duration: \"\"});\n                        }\n                    } else {\n                        vm.start_times.push({time: i+\":00\", disabled: check_business_hours(i)});\n                        vm.end_times.push({time: i+\":00\", disabled: check_business_hours(i), duration: \"\"});\n                    }\n\n                }\n                // vm.takeoff_times = angular.copy(vm.start_times);\n                // vm.landing_times = angular.copy(vm.end_times);\n                angular.copy(vm.start_times, vm.takeoff_times);\n                angular.copy(vm.end_times, vm.landing_times);\n            }\n\n            function init_times(){\n               for(var i=0;i<24;i+=vm.options.hour_step){\n\n                    if(vm.options.minute_step && vm.options.minute_step > 0){\n                        for(var j=0; j<(60/vm.options.minute_step); j++){\n                            var k = vm.options.minute_step * j;\n                            k = ((k < 10) ? '0' : '') + k;\n                            vm.start_times.push({time: i+\":\"+k, disabled: check_business_hours(i, k)});\n                            vm.end_times.push({time: i+\":\"+k, disabled: check_business_hours(i, k), duration: \"\"});\n                        }\n                    } else {\n                        vm.start_times.push({time: i+\":00\", disabled: check_business_hours(i)});\n                        vm.end_times.push({time: i+\":00\", disabled: check_business_hours(i), duration: \"\"});\n                    }\n\n                } \n                // vm.takeoff_times = angular.copy(vm.start_times);\n                // vm.landing_times = angular.copy(vm.end_times);\n                angular.copy(vm.start_times, vm.takeoff_times);\n                angular.copy(vm.end_times, vm.landing_times);\n            }\n\n            function get_duration_str(seconds){\n                //var seconds = Math.floor(seconds);\n                // //console.log(seconds);\n                // //console.log(moment.duration(seconds));\n                // //console.log(\"days: \"+moment.duration(seconds).days());\n                // //console.log(\"hours: \"+moment.duration(seconds).hours());\n                // //console.log(\"minutes: \"+moment.duration(seconds).minutes());\n\n                var days = moment.duration(seconds).days();\n                var hours = moment.duration(seconds).hours();\n                var minutes = moment.duration(seconds).minutes();\n\n                //occasional issue showing 59 minutes - unsure where but this is a fix for it... think moment() has a bug\n                if(minutes == 59){\n                    hours++;\n                    minutes = 0;\n                }\n\n\n                var string = \"\";\n                if(days > 0){\n                    string = string+\" \"+days+\" day\";\n                    string = (days > 1)? string+\"s\" : string;\n                }\n                if(hours > 0){\n                    string = string+\" \"+hours+\" hour\";\n                    string = (hours > 1)? string+\"s\" : string;\n                }\n                if(minutes > 0){\n                    string = string+\" \"+minutes+\" minute\";\n                    string = (minutes > 1)? string+\"s\" : string;\n                }\n\n                 // //console.log(\"STR : \"+string);\n\n                return string;\n\n            }\n\n            vm.calculate_my_brakes_duration = function(){\n             //   calculate_duration(); //symlink\n                 if(vm.bookout.start_date && vm.bookout.brakes_off){\n                    var start_datetime = new Date(vm.bookout.start_date);\n                    var start_time = vm.bookout.brakes_off.time.split(\":\");\n                    start_datetime.setHours(start_time[0]);\n                    start_datetime.setMinutes(start_time[1]);\n                    start_datetime.setSeconds(0);\n                    // //console.log(\"START DATETIME\", start_datetime);  \n\n                    vm.end_times.forEach(function(time, i){ \n                        //no need to go through each element if its not required to be shown!\n                        if(time.disabled == 0){\n\n                            var end_datetime = new Date(vm.bookout.end_date);\n                            var end_time = time.time.split(\":\");\n                            end_datetime.setHours(end_time[0]);\n                            end_datetime.setMinutes(end_time[1]);  \n                            end_datetime.setSeconds(0);\n                            // //console.log(\"END DATETIME\", end_datetime);  \n\n                            var difference = moment(moment(end_datetime).startOf(\"minute\")).diff(moment(start_datetime).startOf(\"minute\"));\n\n                            //now we need to calculate the difference in datetime\n                            // //console.log(\"d: \"+moment.duration(difference).days()+\" h: \"+moment.duration(difference).hours()+\" m: \"+moment.duration(difference).minutes());\n                            var human_str = get_duration_str(difference);\n\n                           \n\n\n                            // //console.log(\"human string\", human_str);\n                            if(human_str == \"\"){\n                                vm.end_times[i].disabled = 1;\n                                //vm.takeoff_times[i].disabled = 1;\n                            } else {\n                                vm.end_times[i].duration = \"( \"+human_str+\" )\";\n                            }\n\n\n                        } else {\n                            vm.end_times[i].duration = \"\";\n                        }\n                      //if(time.time == moment(future).format(\"H:mm\")){ id = i; return true;}; \n                    });\n\n                    // console.log(\"SELECTED HERE: vm.show_takeoff_landing_times \", vm.show_takeoff_landing_times);\n\n                    if(vm.show_takeoff_landing_times){\n                        //also set the takeoff 5mins after taxi?\n                        //vm.takeoff_times = vm.end_times;\n                        angular.copy(vm.end_times, vm.takeoff_times);\n                        // console.log(\"SELECTED HERE????\", vm.takeoff_times);\n                    }\n\n                }\n            }    \n\n            function calculate_duration(){\n                if(vm.bookout.start_date && vm.bookout.start_time){\n                    var start_datetime = new Date(vm.bookout.start_date);\n                    var start_time = vm.bookout.start_time.time.split(\":\");\n                    start_datetime.setHours(start_time[0]);\n                    start_datetime.setMinutes(start_time[1]);\n                    start_datetime.setSeconds(0);\n                    // //console.log(\"START DATETIME\", start_datetime);  \n\n                    vm.end_times.forEach(function(time, i){ \n                        //no need to go through each element if its not required to be shown!\n                        if(time.disabled == 0){\n\n                            var end_datetime = new Date(vm.bookout.end_date);\n                            var end_time = time.time.split(\":\");\n                            end_datetime.setHours(end_time[0]);\n                            end_datetime.setMinutes(end_time[1]);  \n                            end_datetime.setSeconds(0);\n                            // //console.log(\"END DATETIME\", end_datetime);  \n\n                            var difference = moment(moment(end_datetime).startOf(\"minute\")).diff(moment(start_datetime).startOf(\"minute\"));\n\n                            //now we need to calculate the difference in datetime\n                            // //console.log(\"d: \"+moment.duration(difference).days()+\" h: \"+moment.duration(difference).hours()+\" m: \"+moment.duration(difference).minutes());\n                            var human_str = get_duration_str(difference);\n\n                           \n\n\n                            // //console.log(\"human string\", human_str);\n                            if(human_str == \"\"){\n                                vm.end_times[i].disabled = 1;\n                                //vm.takeoff_times[i].disabled = 1;\n                            } else {\n                                vm.end_times[i].duration = \"( \"+human_str+\" )\";\n                            }\n\n\n                        } else {\n                            vm.end_times[i].duration = \"\";\n                        }\n                      //if(time.time == moment(future).format(\"H:mm\")){ id = i; return true;}; \n                    });\n\n                    //console.log(\"SELECTED HERE: vm.show_takeoff_landing_times \", vm.show_takeoff_landing_times);\n\n                    if(vm.show_takeoff_landing_times){\n                        //also set the takeoff 5mins after taxi?\n                        //vm.takeoff_times = vm.end_times;\n                        angular.copy(vm.end_times, vm.takeoff_times);\n                        //console.log(\"SELECTED HERE????\", vm.takeoff_times);\n                    }\n\n                }\n            }\n\n\n            vm.calculate_airborne_duration = function(){\n                if(vm.bookout.takeoff_time){\n                    var start_datetime = new Date(vm.bookout.start_date);\n                    var start_time = vm.bookout.takeoff_time.time.split(\":\");\n                    start_datetime.setHours(start_time[0]);\n                    start_datetime.setMinutes(start_time[1]);\n                    start_datetime.setSeconds(0);\n                    // //console.log(\"START DATETIME\", start_datetime);  \n\n                    vm.landing_times.forEach(function(time, i){ \n                        //no need to go through each element if its not required to be shown!\n                        if(time.disabled == 0){\n\n                            var end_datetime = new Date(vm.bookout.end_date);\n                            var end_time = time.time.split(\":\");\n                            end_datetime.setHours(end_time[0]);\n                            end_datetime.setMinutes(end_time[1]);  \n                            end_datetime.setSeconds(0);\n                            // //console.log(\"END DATETIME\", end_datetime);  \n\n                            var difference = moment(moment(end_datetime).startOf(\"minute\")).diff(moment(start_datetime).startOf(\"minute\"));\n\n                            //now we need to calculate the difference in datetime\n                            // //console.log(\"d: \"+moment.duration(difference).days()+\" h: \"+moment.duration(difference).hours()+\" m: \"+moment.duration(difference).minutes());\n                            var human_str = get_duration_str(difference);\n\n                           \n\n\n                            // //console.log(\"human string\", human_str);\n                            if(human_str == \"\"){\n                                vm.landing_times[i].disabled = 1;\n                            } else {\n                                vm.landing_times[i].duration = \"( \"+human_str+\" )\";\n                            }\n\n\n                        } else {\n                            vm.landing_times[i].duration = \"\";\n                        }\n                      //if(time.time == moment(future).format(\"H:mm\")){ id = i; return true;}; \n                    });\n                }\n            }\n\n\n            vm.calculate_after_landing_duration = function(){\n\n                if(vm.show_takeoff_landing_times){\n                        //also set the takeoff 5mins after taxi?\n\n                        if(vm.bookout.start_date && vm.bookout.landing_time){\n                            var start_datetime = new Date(vm.bookout.start_date);\n                            var start_time = vm.bookout.landing_time.time.split(\":\");\n                            start_datetime.setHours(start_time[0]);\n                            start_datetime.setMinutes(start_time[1]);\n                            start_datetime.setSeconds(0);\n                            // //console.log(\"START DATETIME\", start_datetime);  \n\n                            vm.end_times.forEach(function(time, i){ \n                                //no need to go through each element if its not required to be shown!\n                                if(time.disabled == 0){\n\n                                    var end_datetime = new Date(vm.bookout.end_date);\n                                    var end_time = time.time.split(\":\");\n                                    end_datetime.setHours(end_time[0]);\n                                    end_datetime.setMinutes(end_time[1]);  \n                                    end_datetime.setSeconds(0);\n                                    // //console.log(\"END DATETIME\", end_datetime);  \n\n                                    var difference = moment(moment(end_datetime).startOf(\"minute\")).diff(moment(start_datetime).startOf(\"minute\"));\n\n                                    //now we need to calculate the difference in datetime\n                                    // //console.log(\"d: \"+moment.duration(difference).days()+\" h: \"+moment.duration(difference).hours()+\" m: \"+moment.duration(difference).minutes());\n                                    var human_str = get_duration_str(difference);\n\n                                   \n\n\n                                    // //console.log(\"human string\", human_str);\n                                    if(human_str == \"\"){\n                                        vm.end_times[i].disabled = 1;\n                                    } else {\n                                        vm.end_times[i].duration = \"( \"+human_str+\" )\";\n                                    }\n\n\n                                } else {\n                                    vm.end_times[i].duration = \"\";\n                                }\n                              //if(time.time == moment(future).format(\"H:mm\")){ id = i; return true;}; \n                            });\n\n                            \n                        }\n\n\n                }\n\n\n                \n            }\n\n\n            vm.flight_units = \n            {\n                brakes_to_brakes: 0,\n                airborne_times: 0,\n                flight_time: 0,\n                meter_units: (vm.bookout.end_tacho - vm.bookout.start_tacho)\n            };\n\n            vm.cancel_split = function(){\n                vm.bookout = vm.original_bookout;\n                vm.bookout.brakes_off = vm.bookout.brakes_off.time;\n                vm.bookout.brakes_on = vm.bookout.brakes_on.time;\n                console.log(vm.bookout);\n                console.log(vm.bookout.brakes_on);\n                vm.split_flight_confirmation = 0;\n                vm.split_flight = 0;\n                // vm.split_one = {};\n                // vm.split_two = {};\n                process_bookout_to_bookin(vm.bookout);\n                //vm.calculate_my_airborne_duration();\n            }\n\n            vm.confirm_split = function(){\n                console.log(\"CONFIRM SPLIT\");\n\n                vm.try_split = true;\n\n                vm.before_split_bookout = vm.bookout;\n                vm.split_flight_confirmation = 1;\n\n                vm.original_bookout = vm.bookout;\n                vm.split_one.touch_and_go = vm.bookout.touch_and_go;\n                vm.split_one.tng = vm.bookout.tng;\n                console.log(\"TNG : \", vm.split_one.touch_and_go);\n\n                vm.split_one.full_stop_landings = vm.bookout.full_stop_landings\n                vm.split_one.landings = vm.bookout.landings;\n                vm.split_one.remote_landings = vm.bookout.remote_landings;\n                vm.split_one.pic = vm.bookout.pic;\n                vm.split_one.pic_id = vm.bookout.pic_id;\n                vm.split_one.put = vm.bookout.put;\n                vm.split_one.put_id = vm.bookout.put_id;\n                vm.split_one.payer_id = vm.bookout.payer_id;\n                vm.split_one.instructor = vm.bookout.instructor;\n                vm.split_one.instructor_id = vm.bookout.instructor_id;\n                vm.split_one.booking = vm.bookout.booking;\n                vm.split_one.booking_id = vm.bookout.booking_id;\n                if(vm.bookout.course && vm.bookout.course.id){\n                    vm.split_one.course_id = vm.bookout.course.id;\n                }\n                vm.split_one.course = vm.bookout.course;\n                vm.split_one.tuition_required = vm.bookout.tuition_required;\n                //vm.split_one.tuition = vm.bookout.course;\n                // vm.split_one.plane = vm.bookout.plane;\n                //vm.bookout.course\n\n                vm.split_one.authorised_solo = vm.bookout.authorised_solo;\n                // vm.split_one.plane = vm.bookout.plane;\n                // vm.split_one.plane = vm.bookout.plane;\n                // vm.split_one.plane = vm.bookout.plane;\n\n\n                //UPDATE THE FLIGHT TIME UNITS NOW\n                vm.flight_units.brakes_to_brakes = vm.split_one.brakes_times;\n\n                vm.flight_units.airborne_times = vm.split_one.airborne_time;\n\n                vm.flight_units.flight_time = vm.split_one.flight_time;\n\n                vm.flight_units.brakes_times_rounded = vm.split_one.brakes_times_rounded;\n\n\n                console.log(\"OLD ONE - \", vm.split_one);\n\n                vm.bookout = vm.split_one;\n\n                console.log(\"SPLIT 1 - \", vm.split_one);\n                console.log(\"SPLIT 2 - \", vm.split_two);\n                \n                process_bookout_to_bookin(vm.bookout);\n\n                console.log(\"new bookout = \", vm.bookout);\n\n                //vm.calculate_invoice_for_flight();\n            }\n            \n            vm.calculate_my_airborne_duration = function(){\n\n                if(vm.has_used_claimed_flight) { //and not overridden??\n                    //this should never happen....\n\n                    vm.flight_units.brakes_to_brakes = vm.claimed_flight.brakes_time;\n                    vm.flight_units.airborne_times = vm.claimed_flight.airborne_time;\n                    vm.flight_units.flight_time = vm.claimed_flight.flight_time;\n                    vm.flight_units.brakes_times_rounded = vm.claimed_flight.brakes_times_rounded;\n\n                    vm.calculate_invoice_for_flight();\n                \n\n                } else {\n\n\n                    if((vm.bookout.takeoff_time && vm.bookout.takeoff_time.time) && (vm.bookout.landing_time && vm.bookout.landing_time.time)){\n\n                        //console.log(\"BOTH SET SO\", vm.bookout.brakes_off.time);\n                        //console.log(\"BOTH SET SO\", vm.bookout.brakes_on.time);\n                        var start_datetime = new Date();\n                        var start_time = vm.bookout.takeoff_time.time.split(\":\");\n                        start_datetime.setHours(start_time[0]);\n                        start_datetime.setMinutes(start_time[1]);\n                        start_datetime.setSeconds(0);\n\n\n                        var end_datetime = new Date();\n                        //var end_time = time.time.split(\":\");\n                        var end_time = vm.bookout.landing_time.time.split(\":\");\n                        end_datetime.setHours(end_time[0]);\n                        end_datetime.setMinutes(end_time[1]);  \n                        end_datetime.setSeconds(0);\n\n\n                        var difference = moment(moment(end_datetime).startOf(\"minute\")).diff(moment(start_datetime).startOf(\"minute\"));\n                        // var human_str = get_duration_str(difference);\n\n                        vm.flight_units.airborne_times = moment.duration(difference).asHours();\n                        //console.log(\"HELLO DURATION CALC\", vm.flight_units.brakes_to_brakes);\n\n\n                        vm.calculate_invoice_for_flight();\n                        //  //console.log(\"HELLO DURATION CALC2\", human_str);\n\n                    }\n\n                    if(vm.bookout.brakes_off && vm.bookout.brakes_off.time !== \"\" && vm.bookout.brakes_on && vm.bookout.brakes_on.time !== \"\"){\n\n\n                        var bstart_datetime = new Date();\n                        var bstart_time = vm.bookout.brakes_off.time.split(\":\");\n                        bstart_datetime.setHours(bstart_time[0]);\n                        bstart_datetime.setMinutes(bstart_time[1]);\n                        bstart_datetime.setSeconds(0);\n\n\n                        var bend_datetime = new Date();\n                        //var end_time = time.time.split(\":\");\n                        if(vm.bookout.brakes_on && vm.bookout.brakes_on.time){\n\n                            var bend_time = vm.bookout.brakes_on.time.split(\":\");\n                            bend_datetime.setHours(bend_time[0]);\n                            bend_datetime.setMinutes(bend_time[1]);  \n                            bend_datetime.setSeconds(0);\n\n\n                            var difference = moment(moment(bend_datetime).startOf(\"minute\")).diff(moment(bstart_datetime).startOf(\"minute\"));\n                            // var human_str = get_duration_str(difference);\n\n                            vm.flight_units.brakes_to_brakes = moment.duration(difference).asHours();\n                            //console.log(\"HELLO DURATION CALC\", vm.flight_units.brakes_to_brakes);\n\n                            //console.log(\"FLIGHT BRAKES UNITS : \", vm.flight_units.brakes_to_brakes);\n\n                            vm.calculate_invoice_for_flight();\n\n\n                        }\n                        \n\n                    }\n\n                    \n\n                    \n                }\n\n\n                vm.flight_times_complete = true;\n\n            }\n\n\n\n            vm.update_dateTime = function(){\n                //console.log(\"STARTED\", vm.bookout.brakes_off);\n                //console.log(\"STARTED\", vm.bookout.brakes_on);\n                if(vm.has_used_claimed_flight) { //and not overridden??\n\n\n                    vm.flight_units.brakes_to_brakes = vm.claimed_flight.brakes_time;\n                    vm.flight_units.airborne_times = vm.claimed_flight.airborne_time;\n                    vm.flight_units.flight_time = vm.claimed_flight.flight_time;\n\n                    vm.calculate_invoice_for_flight();\n                \n                } else {\n\n\n                    if((vm.bookout.brakes_off && vm.bookout.brakes_off.time) && (vm.bookout.brakes_on && vm.bookout.brakes_on.time)){\n\n                        //console.log(\"BOTH SET SO\", vm.bookout.brakes_off.time);\n                        //console.log(\"BOTH SET SO\", vm.bookout.brakes_on.time);\n                        var start_datetime = new Date();\n                        var start_time = vm.bookout.brakes_off.time.split(\":\");\n                        start_datetime.setHours(start_time[0]);\n                        start_datetime.setMinutes(start_time[1]);\n                        start_datetime.setSeconds(0);\n\n\n                        var end_datetime = new Date();\n                        //var end_time = time.time.split(\":\");\n                        var end_time = vm.bookout.brakes_on.time.split(\":\");\n                        end_datetime.setHours(end_time[0]);\n                        end_datetime.setMinutes(end_time[1]);  \n                        end_datetime.setSeconds(0);\n\n\n                        var difference = moment(moment(end_datetime).startOf(\"minute\")).diff(moment(start_datetime).startOf(\"minute\"));\n                        // var human_str = get_duration_str(difference);\n\n                        vm.flight_units.brakes_to_brakes = moment.duration(difference).asHours();\n                        //console.log(\"HELLO DURATION CALC\", vm.flight_units.brakes_to_brakes);\n\n\n                        vm.calculate_invoice_for_flight();\n                        //  //console.log(\"HELLO DURATION CALC2\", human_str);\n\n                    }\n                }\n\n\n                vm.flight_times_complete = true;\n\n            }\n\n\n            function check_relative_date(date, start_end = \"start\"){\n                var relative = \"today\";\n                //console.log(\"RELATIVE TIME CHECK\", date);\n                if(moment(moment(date).format(\"YYYY/MM/DD\")).isAfter(moment().format(\"YYYY/MM/DD\"))){\n                    relative = \"future\";\n\n                    //then is after today\n                    // the catch is that if date == start / end date --> THEN we need to present that it is today even though it isnt - this is premise\n                    // that is valid only for the \"END\" cases (so that we return AFTER rather than today) --> otherwise the end_times available won't reflect\n                    //the fact that the start_times have been selected allowing the user to select an end time before start time (which is silly really...)\n\n                    if(vm.bookout.start_date && vm.bookout.end_date && start_end == \"end\"){\n                        if(moment(vm.bookout.start_date).isSame(moment(vm.bookout.end_date))){\n                            relative = \"after\"; // because we need to act as though it is after in the clean_times (to not be able to select end < start times)\n                        }\n                    }\n                    \n                } else if(moment(date).format(\"YYYY/MM/DD\") == moment().format(\"YYYY/MM/DD\")){\n                    //then today\n                    relative = (start_end == \"start\") ? \"today\" : \"after\";\n                } else {\n                    //must be in the past...\n                    relative = \"past\";\n                }\n                \n                // //console.log(\"relative is \", relative);\n                return relative;\n            }\n\n            // function add_hour_to_end(){\n            //     var a = vm.bookout.start_time.time.split(\":\");\n            //     //var b = new Date();\n            //     var b = new Date(vm.bookout.start_date);\n            //     b.setHours(a[0]);\n            //     b.setMinutes(a[1]);\n            //     b.setSeconds(0);\n            //     var future = moment(b).add(1, \"hour\").format();\n            //    // clean_times('after', 'end_times', future);\n            //    //\n\n            //      //clean_times(check_relative_date(vm.bookout.end_date, \"end\"), 'end_times', future);\n\n\n\n            //     if(parseInt(a[0]) >= 23){\n            //         if(moment(vm.bookout.start_date).isSame(moment(vm.bookout.end_date))){\n            //              // //console.log(\"THIS ADD DAY\");\n            //             // //console.log(\"start\", vm.bookout.start_date);\n            //             // //console.log(\"end\", vm.bookout.end_date);\n            //              // //console.log(\"after or = 11pm - then we need to change the date that follows the same pattern\");\n            //             vm.bookout.end_date = new Date(moment(vm.bookout.end_date).add(1, \"day\").format());\n            //             clean_times('future', 'end_times');\n\n            //             //set it to 00:00 hours probably a wise thing...\n            //             vm.bookout.end_time = vm.end_times[0];\n\n\n            //         } \n            //     } else {\n            //         clean_times('after', 'end_times', b);\n            //     }\n\n            // }\n\n        function check_times(){\n\n                var c = new Date();\n                var a = (vm.bookout.start_time) ? vm.bookout.start_time.time.split(\":\") : [c.getHours(), c.getMinutes()];\n                var b = new Date(vm.bookout.start_date);\n                b.setHours(a[0]);\n                b.setMinutes(a[1]);\n                b.setSeconds(0);\n                var future = moment(b).add(1, \"hour\").format();\n\n                //check if the end_time is set && if the end time is > start time...\n                if(start_after_end() || !vm.bookout.end_time){\n                    \n                    clean_times(check_relative_date(vm.bookout.end_date, \"end\"), 'end_times', b);\n\n                    var id;\n                    // vm.end_times.forEach(function(time, i){ \n                    //   if(time.time == moment(future).format(\"H:mm\")){ id = i; return true;}; \n                    // });\n                    vm.end_times.some(function(time, i){ \n                      if(time.time == moment(future).format(\"H:mm\")){ id = i; return i;};  \n                    });\n\n                    vm.bookout.end_time = {};\n                    vm.bookout.end_time = vm.end_times[id];\n\n                } else {\n                    clean_times(check_relative_date(vm.bookout.end_date, \"end\"), 'end_times', b);\n                }\n\n\n                 //need to update the selection of the end time if this has been set\n                if(vm.bookout.end_time && vm.bookout.end_time.disabled == 1){\n\n                    var id;\n                    //used to use a forEach loop but decided to run a some loop instead due to the benefit of not going through all elements\n                    // vm.end_times.forEach(function(time, i){ \n                    //   if(time.time == moment(future).format(\"H:mm\")){ id = i; return true;}; \n                    // });\n                    vm.end_times.some(function(time, i){ \n                      if(time.time == moment(future).format(\"H:mm\")){ id = i; return i;};  \n                    });\n\n                    vm.bookout.end_time = {};\n                    vm.bookout.end_time = vm.end_times[id];\n\n                }\n\n                if(vm.bookout.start_time && vm.bookout.start_time.disabled == 1){\n\n                    var id;\n                    vm.start_times.some(function(time, i){ \n                      if(time.disabled == 0){ id = i; return i;}; \n                    });\n\n                    vm.bookout.start_time = {};\n                    vm.bookout.start_time = vm.start_times[id];\n\n                    calculate_duration();\n                }\n        }\n\n\n\n\n         function booking_today(){\n                if(moment(vm.bookout.start_date).format(\"DD/MM/YYYY\") == moment().format(\"DD/MM/YYYY\")){\n                    //console.log(\"WE ARE TODAY?\");\n                    clean_times('today', 'start_times');\n\n                } else {\n                    // //console.log(\"should get full day\");\n                    if(moment(vm.bookout.start_date).isAfter(moment()) ){\n                        clean_times('future', 'start_times');\n                    }\n                }\n\n                if(moment(vm.bookout.end_date).format(\"DD/MM/YYYY\") == moment().format(\"DD/MM/YYYY\")){\n                    if(vm.bookout.start_time){\n                       //console.log(\"START TIME\", vm.bookout.start_time);\n                        add_hour_to_end(); \n                    }\n                    clean_times(check_relative_date(vm.bookout.start_date), 'end_times');\n                }\n\n\n                if(vm.bookout.end_date == vm.bookout.start_date){\n                        // //console.log(\"booking today where end = start\");\n                        if(vm.bookout.start_time){\n                            var a = vm.bookout.start_time.time.split(\":\");\n                            var b = new Date(vm.bookout.start_date);\n                            b.setHours(a[0]);\n                            b.setMinutes(a[1]);\n                            b.setSeconds(0);\n\n                            //we need to check the times give\n                            if(start_after_end()){\n                                clean_times(check_relative_date(vm.bookout.start_date), 'start_times');\n                                // //console.log(\"UPDATE END BITS IF START > END required?\");\n                                clean_times(check_relative_date(vm.bookout.end_date, \"end\"), 'end_times', b);\n                                add_hour_to_end();\n                            } else {\n                                // //console.log(\"UPDATE END BITS IF START > END 2\", check_relative_date(vm.bookout.start_date, \"end\"));\n                                clean_times(check_relative_date(vm.bookout.end_date, \"end\"), 'end_times', b);\n                            }\n\n\n                        }\n                }\n\n            }\n\n            // clean_times('today', 'start_times');\n            booking_today();\n\n\n        $scope.update_dateTime = function(which_update){\n\n            //console.log(\"UPDATE TIME HERE\", which_update);\n\n            switch(which_update){\n\n               \n\n                case 'start_time':\n\n                    //do we need to clean the times? if so.. \n                    booking_today();\n\n                    check_times();\n\n                    //we need to calculate the time in between the start and the end!\n                    calculate_duration();\n                    \n\n                break;\n\n                case 'end_time':\n                    check_times();\n\n                break;\n\n                case 'edit':\n\n                    // //this is the edit function that needs to be setup.\n                    // booking_today();\n\n                    // //number 1 = we have set start and end of the current date....\n                    // // setTimeout(function(){\n                    // //     check_times();\n                    // //     // calculate_duration();\n                    // // }, 5000);\n                    // //console.log(\"ASD \",vm.bookout.start_date);\n                    // // clean_times(check_relative_date(vm.bookout.start_date), 'start_times');\n                    // check_times();\n                    // calculate_duration();\n\n                    booking_today();\n\n                    clean_times(check_relative_date(vm.bookout.start_date), 'start_times');\n\n                    check_times();\n\n                    calculate_duration();\n\n                    setTimeout(function(){\n                        //do we need to clean the times? if so.. \n                        // pre_select_value_id(\"start_times\", vm.bookout.start_time);\n                        pre_select_value_id();\n                        //we need to calculate the time in between the start and the end!\n                    }, 500);\n\n\n\n\n                    //we need to set the previously selected plane here...\n\n\n                break;\n\n            }\n\n\n            //an update on the form would require an update of the plane / waiting lists available\n          \n\n\n        }\n\n\n\n        function start_after_end(){\n                var start_after_end = false;\n                if(vm.bookout.end_time){\n                    // //console.log(\"START AFTER END LOOP\");\n                    var start_datetime = new Date(vm.bookout.start_date);\n                    var start_time = vm.bookout.start_time.time.split(\":\");\n                    start_datetime.setHours(start_time[0]);\n                    start_datetime.setMinutes(start_time[1]);\n                    start_datetime.setSeconds(0);\n\n                    var end_datetime = new Date(vm.bookout.end_date);\n                    var end_time = vm.bookout.end_time.time.split(\":\");\n                    end_datetime.setHours(end_time[0]);\n                    end_datetime.setMinutes(end_time[1]);\n                    end_datetime.setSeconds(0);\n\n                    if(moment(start_datetime).isAfter(moment(end_datetime)) || moment(start_datetime).isSame(end_datetime) || end_datetime == start_datetime){\n                        start_after_end = true;\n                    }\n\n\n                }\n                return start_after_end;\n        }\n\n        figure_out_steps();\n        init_times();\n\n        switch($state.current.data.action){\n            case \"add\":\n\n                //console.log(\"bookout\", $stateParams.id);\n                //so now we can load the BOOKING with this ID, and therefore can sort it all out :)\n                // let us preload the content required from the booking - fetch the booking\n                //console.log(\"FETCH THE BOOKING\");\n\n                BookingService.GetForBookIn($stateParams.id)\n                 .then(function (data) {\n                    console.log(\"data is : \", data);\n                    if(data.success){\n                        //console.log(\"success\");\n                        \n\n                        if(data.bookout.booked_in == 1){\n                            alert(\"It appears that you have already booked this flight back in...\");\n                            $state.go('dashboard.my_account', {}, { reload: true });\n                        }\n\n                        vm.original_bookout = data.bookout;\n                        vm.bookout = data.bookout;\n\n                        vm.claim_a_flight = data.unclaimed;\n                        // BookingService.GetUnclaimedFlights(vm.bookout.plane_id).then(function (data) {\n                        //         ////console.log(\"data is : \", data);\n                        //         if(data.success){\n                        //             console.log(data);\n                        //         }\n                        //     });\n\n\n                        // FoxService.GetFoxEntriesByPlane(vm.bookout.plane_id)\n                        // .then(function (data) {\n                        //     if(data.success){\n                        //         console.log(data);\n                        //         vm.claim_a_flight = data.to_claim;\n                        //     }\n\n                        // });\n\n                        //temporary bits to overcome the start and end times issues...\n                        vm.bookout.start_date = new Date(\"2100/07/26\");\n                        vm.bookout.end_date = new Date(\"2100/07/26\");\n                        //console.log(\"RAW DATA HERE : \", data);\n                        // MemberService.GetAllByPics(data.bookout.club_id, vm.user.id)\n\n                        MemberService.GetAllByPicsBookinout(vm.bookout.booking_id, vm.bookout.club_id, vm.user.id, 1)\n                            .then(function (pics) {\n                                    vm.pics = pics;\n                                    console.log(\"PICS: \", vm.pics);\n                                    process_bookout_to_bookin(data.bookout);\n                            });\n\n                       MemberService.GetAllByClubInstructor(vm.bookout.club_id, vm.user.id)\n                            .then(function (instructors) {\n                                    vm.instructors = instructors.instructors;\n                                    //process_bookout_to_bookin(data.bookout);\n                            });\n\n\n                        PackageService.GetPackagesForBookout(vm.bookout.id)\n                            .then(function (data) {\n                            // IF IT HAS A PACKAGE ID --> THEN WE NEED TO CHECK IT PUT THE CORRECT PAYMENT INFORMATION THERE\n                                //console.log(\"BOOKOUT PACKAGE\", data);\n                                //console.log(\"BOOKOUT PACKAGE\", data.packages);\n                                vm.packages = data.packages;\n                            });\n\n                            // if(vm.bookout.put_id > 0){\n                            //     vm.bookout.payer_id = vm.bookout.put_id;\n                            // } else {\n                            //     vm.bookout.payer_id = vm.bookout.pic_id;\n                            // }\n\n                            if(vm.bookout.payer_id == 0){\n                                if(vm.bookout.pic_id !== 0 && vm.bookout.pic_id !== vm.bookout.instructor_id){\n                                    vm.bookout.payer_id = vm.bookout.pic_id; //PIC is student supervised or otherwise solo\n                                } else if((vm.bookout.instructor_id > 0 && vm.bookout.put_id > 0) || vm.bookout.instructor_id > 0 && vm.bookout.user_id > 0){\n                                    vm.bookout.payer_id = (vm.bookout.put_id > 0)? vm.bookout.put_id : vm.bookout.user_id; //put always pays\n                                } else if(vm.bookout.put_id > 0){\n                                    vm.bookout.payer_id = vm.bookout.put_id;\n                                } else if(vm.bookout.put_id == 0 && vm.bookout.user_id == 0){\n                                    vm.bookout.payer_id = vm.bookout.pic_id;\n                                } else {\n                                    if(vm.bookout.instructor_id == 0){\n                                        vm.bookout.payer_id = vm.bookout.pic_id;\n                                    }\n                                    if(vm.bookout.payer_id == 0){\n                                        alert(\"It appears you need to select a student or person paying for this flight? Please select a student or pilot in command\");\n                                    }\n                                }\n                            }\n\n\n                        \n\n                    }\n                });\n\n                \n            break;\n            case \"edit\":\n\n            \n\n\n\n            break;\n            case \"list\":\n\n             \n\n\n            break;\n            default:\n                //console.log(\"none of the above... redirect somewhere?\");\n            break;\n        }  \n      \n\n        vm.get_package_html = function(pack_obj){\n            var used_on = \"\";\n            for(var i=0;i<pack_obj.aircraft.length;i++){\n                used_on = used_on + \" \" + pack_obj.aircraft[i].registration +\" (\"+ pack_obj.aircraft[i].plane_type +\") <br />\";\n            }\n            var text = \"\";\n            if(pack_obj.validity == 0){\n               text = \"Package purchased on: \"+moment(pack_obj.created_at).format(\"D MMM Y\")+\"<br /> Package does not expire <br /> To be used on:<br />\";\n            } else {\n               text = \"Package purchased on: \"+moment(pack_obj.created_at).format(\"D MMM Y\")+\"<br /> Package expires on: \"+ moment(pack_obj.created_at).add(pack_obj.validity, \"days\").format(\"D MMM Y\") +\" <br /> To be used on:<br />\";\n            }\n    \n            return text+used_on;\n\n        }\n\n        vm.this_was_a_supervised_solo = function(){\n            vm.this_was_supervised_solo = !vm.this_was_supervised_solo;\n            //pic probably is the payer\n            if(vm.this_was_supervised_solo){\n                vm.bookout.payer_id = vm.bookout.pic_id;\n            } else if(vm.bookout.put_id > 0) {\n                vm.bookout.payer_id = vm.bookout.put_id;\n            } else if(vm.bookout.user_id > 0){\n                vm.bookout.payer_id = vm.bookout.user_id;\n            }\n\n            // if(vm.complete_flight && vm.){\n            //     vm.complete_this_flight();\n            // }\n\n        }\n\n        vm.this_was_instructional_claim = function(){\n            //toggle as it worked\n            vm.this_claim_was_instructional = !vm.this_claim_was_instructional;\n            vm.complete_flight = false;\n            if(vm.this_claim_was_instructional){\n\n                vm.ignore_next_tuition_change = true;\n\n                //then PIC is the INSTRUCTOR\n                //vm.bookout.instructor_id = vm.bookout.pic.user_id;\n                vm.bookout.payer_id = vm.bookout.put_id;\n\n                if(vm.bookout.instructor_id == 0 && (vm.bookout.pic && vm.bookout.pic.user_id > 0)){\n                    vm.bookout.instructor_id = vm.bookout.pic.user_id;\n                }\n\n                preselect_course_and_tuition();\n\n            } else {\n                vm.bookout.put_id = 0;\n                vm.bookout.put = {};\n                vm.bookout.instructor_id = 0;\n                if(vm.bookout.pic_id > 0){\n                    vm.bookout.payer_id = vm.bookout.pic_id;\n                } else if(vm.bookout.user_id > 0) {\n                    vm.bookout.payer_id = vm.bookout.user_id;\n                } else {\n                    //alert(\"It appears that no payer ID has been set yet.\");\n                }\n            }\n\n            vm.calculate_invoice_for_flight();\n\n            // if(vm.complete_flight){\n            //     vm.complete_this_flight();\n            // }\n\n        }\n\n\n        // vm.convert_decimal_to_hours = function(decimal_time){\n        //     var temp = new Array();\n        //     temp = decimal_time.toString().split('.');\n            \n        //     var hours = temp[0];\n        //     if(hours < 10){\n        //         hours = \"0\"+hours;\n        //     }\n        //     if(temp[1]){\n        //        var minutes = 100 / temp[1];\n        //         minutes = Math.round(60 / minutes); \n\n        //         if(minutes < 10){\n        //             minutes = \"0\"+minutes;\n        //         }\n        //     } else {\n        //         minutes = \"00\"\n        //     }\n\n        //     return hours + ':' + minutes;\n        // }\n\n\n\n        $scope.applyFilter = function(model, filter) {\n            if(filter){\n\n                var pieces = filter.split(':');\n\n                var filterName = pieces[0];\n\n                var params = [model];\n\n                if(pieces.length>1){\n                    \n                    // //console.log(\"hello\", pieces.slice(1).join(\":\"));\n                    if(filterName.toLowerCase() == \"date\"){\n                       params.push( pieces.slice(1).join(\":\") );\n                    }\n                    //params = params.slice(1, -1);\n                    // //console.log(\"contact it\", params);\n\n                } else {\n                    params = params.concat(pieces.slice(1));\n                }\n\n                return $filter(filterName).apply(this,params);\n            }else{\n                return model;\n            }\n        }\n\n        vm.add_defect = function(){\n\n\n            var obj = {\n                club_id: vm.bookout.club_id,\n                user_id: vm.bookout.user_id,\n                plane_id: vm.bookout.plane_id,\n                defect: vm.defect,\n                severity: vm.defect_severity.title,\n                status: \"open\"\n            }\n\n            \n\n        \n            PlaneService.AddDefect(obj)\n             .then(function (data) {\n                    ////console.log(\"data is : \", data);\n                    data.item.can_delete = true;\n\n                   vm.reported_defects.push(data.item);\n\n                   vm.defect = \"\";\n                   vm.defect_severity = \"\";\n                });\n\n        }\n\n        vm.delete_defect = function(id){\n            //console.log(\"UNDO DEFECT ID \", id);\n\n            PlaneService.DeleteDefect(id)\n            .then(function (data) {\n                    ////console.log(\"data is : \", data);\n                   \n                    PlaneService.GetOpenIssues(vm.bookout.plane_id)\n                    .then(function (data) {\n                            ////console.log(\"data is : \", data);\n                           vm.reported_defects = data;\n                        });\n\n\n                });\n\n        }\n\n        vm.tacho_error_highlight = false;\n\n        vm.check_tacho_bigger = function(){\n\n         if(vm.bookout.start_tacho >= vm.bookout.end_tacho){\n                    alert(\"Please check start and end tacho \\n You cannot end on a smaller tacho\");\n                    vm.tacho_error_highlight = true;\n                } else {\n                    vm.tacho_error_highlight = false;\n                }\n\n         }\n\n\n        vm.calculate_invoice_for_flight = function(){\n             console.log(\"RUN CALCULATION\", vm.flight_units);\n            //vm.flight_units where the units are stored\n            if(vm.free_flight){\n                if(vm.bookout.plane_charges){\n                    vm.bookout.plane_charges.charge_rate_unit = 0;\n                    vm.bookout.plane_charges.surcharge_fee = 0;\n                    vm.bookout.plane_charges.landing_fee = 0;\n                    vm.bookout.plane_charges.touch_and_go_fee = 0;\n                }\n                \n                if(vm.bookout.tuition_charges){\n                    vm.bookout.tuition_charges.price = 0;\n                }\n                \n            }\n\n            //vm.bookout.plane_charges where the fees are stored\n            var plane_units = 0;\n\n\n            if(vm.claimed_flight && vm.claimed_flight !== null){\n                // console.log(\"NO SELECTED FLIGHT??\");\n\n                //plane units\n                if(vm.bookout.plane_charges.charge_type == \"flight\"){\n                    //then the units relate to the entered numbers:\n                    plane_units = vm.flight_units.airborne_times;\n\n                } else if(vm.bookout.plane_charges.charge_type == \"airborne\"){\n                    //then the units relate to the entered numbers:\n                    plane_units = vm.flight_units.airborne_times;\n\n                } else if(vm.bookout.plane_charges.charge_type == \"brakes\"){\n                    //then the units relate to the entered numbers:\n                    if((!vm.flight_units.brakes_to_brakes || vm.flight_units.brakes_to_brakes == 0) && vm.bookout.brakes_times && vm.bookout.brakes_times > 0){\n                                            plane_units = vm.bookout.brakes_times;\n                                            vm.flight_units.brakes_to_brakes = vm.bookout.brakes_times;\n\n                    } else {\n                                            plane_units = vm.flight_units.brakes_to_brakes;\n                    }\n\n                } else if(vm.bookout.plane_charges.charge_type == \"brakes_rounded\"){\n                    //then the units relate to the entered numbers:\n                    plane_units = vm.flight_units.brakes_to_brakes;\n                } else {\n                    //hobbs --> to use the tacho area as the item\n                    //then the units we need to calculate relate to the hours between brakes off and on.\n                    plane_units = (vm.bookout.end_tacho - vm.bookout.start_tacho);\n                }\n\n\n            } else {\n                // console.log(\"SELECT FLIGHT SO WE CAN USE THE FOLLOWING\");\n                //plane units\n                if(vm.bookout.plane_charges.charge_type == \"flight\"){\n                    //then the units relate to the entered numbers:\n                    plane_units = vm.flight_units.flight_time;\n\n                } else if(vm.bookout.plane_charges.charge_type == \"airborne\"){\n                    //then the units relate to the entered numbers:\n                    plane_units = vm.flight_units.airborne_times;\n\n                } else if(vm.bookout.plane_charges.charge_type == \"brakes\"){\n                    //then the units relate to the entered numbers:\n                    //plane_units = vm.flight_units.brakes_to_brakes;\n\n                    if((!vm.flight_units.brakes_to_brakes || vm.flight_units.brakes_to_brakes == 0) && vm.bookout.brakes_times && vm.bookout.brakes_times > 0){\n                                            plane_units = vm.bookout.brakes_times;\n                                            vm.flight_units.brakes_to_brakes = vm.bookout.brakes_times;\n\n                    } else {\n                                            plane_units = vm.flight_units.brakes_to_brakes;\n                    }\n\n                } else if(vm.bookout.plane_charges.charge_type == \"brakes_rounded\"){\n                    //then the units relate to the entered numbers:\n                    plane_units = vm.flight_units.brakes_times_rounded;\n                } else {\n                    //hobbs --> to use the tacho area as the item\n                    //then the units we need to calculate relate to the hours between brakes off and on.\n                    plane_units = (vm.bookout.end_tacho - vm.bookout.start_tacho);\n                }\n\n            }\n\n            \n            if((!vm.flight_units.brakes_to_brakes || vm.flight_units.brakes_to_brakes == 0) && vm.bookout.brakes_times && vm.bookout.brakes_times > 0){\n                console.log(\"force it again\");\n                vm.flight_units.brakes_to_brakes = vm.bookout.brakes_times;\n            }\n\n\n\n            console.log(\"plane units: \", plane_units);\n            vm.package_removed = [];\n            vm.package_used = false;\n\n            if(vm.packages && vm.packages.length > 0){\n\n                for(var i=0;i<vm.packages.length;i++){\n                                \n                    vm.package_used = true;\n\n                    if(vm.bookout.instructor_id && vm.bookout.instructor_id > 0){\n                        //then its dual\n                        if(vm.packages[i].remaining_hours_dual && vm.packages[i].remaining_hours_dual > 0){\n                            if(plane_units < vm.packages[i].remaining_hours_dual){\n\n                                var rem = vm.packages[i].remaining_hours_dual - plane_units;\n                                vm.package_removed.push({solo_dual: \"dual\", title: vm.packages[i].title, member_packages_id: vm.packages[i].id, hours_dual_before: vm.packages[i].remaining_hours_dual, hours_dual_spent: plane_units, hours_dual_remaining_after: rem, hours_solo_remaining_after: vm.packages[i].remaining_hours_solo, package_id: vm.packages[i].package_id});\n                                plane_units = 0;\n\n                                break;\n                            } else {\n\n                                vm.package_removed.push({solo_dual: \"dual\", title: vm.packages[i].title, member_packages_id: vm.packages[i].id, hours_dual_before: vm.packages[i].remaining_hours_dual, hours_dual_spent: vm.packages[i].remaining_hours_dual, hours_dual_remaining_after: 0, hours_solo_remaining_after: vm.packages[i].remaining_hours_solo, package_id: vm.packages[i].package_id});\n                                plane_units = plane_units - vm.packages[i].remaining_hours_dual;\n\n                            }\n\n                        }\n\n                    } else {\n                        //then its solo\n                        if(vm.packages[i].remaining_hours_solo && vm.packages[i].remaining_hours_solo > 0){\n                             if(plane_units < vm.packages[i].remaining_hours_solo){\n\n                                var rem = vm.packages[i].remaining_hours_solo - plane_units;\n                                vm.package_removed.push({solo_dual: \"solo\", title: vm.packages[i].title, member_packages_id: vm.packages[i].id, hours_solo_before: vm.packages[i].remaining_hours_solo, hours_solo_spent: plane_units, hours_solo_remaining_after: rem, hours_dual_remaining_after: vm.packages[i].remaining_hours_dual, package_id: vm.packages[i].package_id });\n                                plane_units = 0;\n\n                                break;\n                            } else {\n\n                                vm.package_removed.push({solo_dual: \"solo\", title: vm.packages[i].title, member_packages_id: vm.packages[i].id, hours_solo_before: vm.packages[i].remaining_hours_solo, hours_solo_spent: vm.packages[i].remaining_hours_solo, hours_solo_remaining_after: 0, hours_dual_remaining_after: vm.packages[i].remaining_hours_dual, package_id: vm.packages[i].package_id });\n                                plane_units = plane_units - vm.packages[i].remaining_hours_solo;\n                                \n                            }\n\n                        }\n\n                    }\n\n                }\n\n            }    \n\n            //console.log(\"charge rate: \", vm.bookout.plane_charges.charge_rate_unit);\n            //console.log(\"plane_units: \", plane_units);\n            var plane_total = (vm.bookout.plane_charges.charge_rate_unit * plane_units);\n            //console.log(\"plane_total\", plane_total);\n\n\n\n            //plane surchages::::\n            var surcharge_units = 0;\n            if(vm.bookout.plane_charges.surcharge_type == \"flight\" || vm.bookout.plane_charges.surcharge_type == \"taxi\"){\n                //then the units relate to the entered numbers:\n                surcharge_units = 1;\n            } else if(vm.bookout.plane_charges.surcharge_type !== \"none\") {\n                //then the units are based on the plane units\n                surcharge_units = plane_units;\n            }\n\n            var surcharge_total = (vm.bookout.plane_charges.surcharge_fee * surcharge_units);\n\n\n            //landings and touch and goes etc...\n            if(vm.bookout.landings < 0){\n                vm.bookout.landings = 1;\n            }\n            var landing_units = vm.bookout.landings | 0;\n            var landings_total = (landing_units * vm.bookout.plane_charges.landing_fee);\n\n            if(vm.bookout.tng < 0){\n                vm.bookout.tng = 1;\n            }\n            var tg_units = vm.bookout.tng | 0;\n            var tng_total = (tg_units * vm.bookout.plane_charges.touch_and_go_fee);\n\n            var tuition_charge_type = \"none\";\n            var tuition_price = 0;\n            var tuition_total = 0;\n            var tuition_units = 0;\n\n            if(!vm.packages || vm.packages.length == 0 || plane_units > 0){\n\n\n                //TUITION CHARGES\n                \n                if(vm.bookout.instructor_id > 0 && vm.bookout.tuition_id > 0 && vm.bookout.tuition_charges){\n\n                    tuition_charge_type = vm.bookout.tuition_charges.charge_type;\n                    tuition_price = vm.bookout.tuition_charges.price;\n\n                    if(tuition_charge_type == \"brakes\"){\n                        tuition_units = vm.flight_units.brakes_to_brakes;\n                        tuition_charge_type = \"brakes off to brakes on hours\";\n                    } else if(tuition_charge_type == \"brakes_rounded\"){\n                        tuition_units = vm.flight_units.brakes_times_rounded;\n                        tuition_charge_type = \"rounded brakes off to brakes on hours\";\n                    } else if(tuition_charge_type == \"plane\"){\n                        tuition_units = plane_units;//(vm.bookout.end_tacho - vm.bookout.start_tacho);\n                        tuition_charge_type = \"plane units\";\n                    } else if(tuition_charge_type == \"session\"){\n                        tuition_units = 1;\n                        tuition_charge_type = \"session\";\n                    }\n\n                    tuition_total = (tuition_units * tuition_price);\n\n                }\n\n\n            }\n\n            var total_to_remove = 0;\n            var receipts = [];\n            //need to process the reductions due to the receipts...\n            if(vm.lubricant_receipts && vm.lubricant_receipts.length > 0){\n                for(var i = 0;i<vm.lubricant_receipts.length;i++){\n\n                    if(vm.lubricant_receipts[i].reimbursement == 1){\n                        receipts.push(vm.lubricant_receipts[i]);\n                        total_to_remove = Number.parseFloat(Number.parseFloat(total_to_remove) + Number.parseFloat(vm.lubricant_receipts[i].reimbursed_amount));\n                    }\n\n                } \n            }\n            \n\n            // //console.log(\"CALC HERE\", total_to_remove);\n\n\n\n\n\n\n            var total = (plane_total + surcharge_total + landings_total + tng_total + tuition_total - total_to_remove);\n            // //console.log(\"plane_total plane_total\", plane_total);\n            // //console.log(\"plane_total surcharge_total\", surcharge_total);\n            // //console.log(\"plane_total landings_total\", landings_total);\n            // //console.log(\"plane_total tng_total\", tng_total);\n            // //console.log(\"plane_total tuition_total\", tuition_total);\n            // //console.log(\"plane_total total_to_remove\", total_to_remove);\n\n            vm.invoice_totals = vm.previous_total + total;\n\n            vm.send.amount = vm.invoice_totals * 100;\n\n            vm.plane_charges = {\n                plane_charge_type: vm.bookout.plane_charges.charge_type,\n                plane_unit_price: vm.bookout.plane_charges.charge_rate_unit,\n                plane_units: plane_units,\n                plane_total: plane_total,\n                surcharge_charge_type: vm.bookout.plane_charges.surcharge_type,\n                surcharge_unit_price: vm.bookout.plane_charges.surcharge_fee,\n                surcharge_units: surcharge_units,\n                surcharge_total: surcharge_total,\n                landing_units: landing_units,\n                landing_unit_price: vm.bookout.plane_charges.landing_fee,\n                landing_total: landings_total,\n                tng_units: tg_units,\n                tng_unit_price: vm.bookout.plane_charges.touch_and_go_fee,\n                tng_total: tng_total,\n                tuition_charge_type: tuition_charge_type,\n                tuition_unit_price: tuition_price,\n                tuition_units: tuition_units,\n                tuition_total: tuition_total,\n                receipts: receipts,\n                total: total\n            };\n\n            //vm.bookout.tuition_charges\n\n\n            vm.calculated_invoice = true;\n\n        }\n\n        vm.instructor_charges = []; \n\n\n        // vm.update_book_in_options = function(){\n        //     vm.complete_flight = ( (vm.bookout.flight_type.title !== \"Local\" && vm.bookout.to_airfield.id !== vm.bookout.home_airport_id) || vm.bookout.to_airfield.id !== vm.bookout.home_airport_id) ? false : true;\n        // }\n\n\n        vm.complete_flight = false;\n        vm.complete_this_flight = function(){\n\n\n\n            if(vm.tacho_error_highlight){\n                alert(\"You cannot complete a flight where the last meter reading is greater than the start meter reading!\");\n                return false;\n            }\n\n            if(vm.this_claim_was_instructional && (vm.bookout.instructor_id == 0 || vm.bookout.tuition_id == 0)){\n                alert(\"You need to add an instructor and tuition type if this flight was instructional.\");\n                return false;\n            }\n\n            if(vm.bookout.instructor_id > 0 && vm.bookout.tuition_id == 0){\n                alert(\"Please select a tuition type for this flight.\");\n                return false;\n            }\n            \n            if(vm.tacho_error_highlight){\n                alert(\"You cannot complete a flight where the last meter reading is greater than the start meter reading!\");\n                return false;\n            }\n\n            if(vm.invoice_totals === NaN){\n                alert(\"Please ensure you have filled in the form above - as the current total for this invoice cannot be calculated without this.\");\n                return false;\n            }\n\n\n            // var getShort = {club_id: vm.bookout.booking.club_id,\n            //     user_id: vm.bookout.booking.user_id};\n\n            // //console.log(\"PASSING\", getShort);\n            // let's fetch some information about the user\n\n            var club_id_confirmed = (vm.bookout.booking && vm.bookout.booking.club_id > 0)? vm.bookout.booking.club_id : vm.bookout.club_id;\n            var user_id_confirmed = (vm.bookout.booking && vm.bookout.booking.user_id > 0)? vm.bookout.booking.user_id : vm.bookout.user_id;\n\n            MemberService.GetMandate(vm.bookout.payer_id, club_id_confirmed)\n                    .then(function (data) {\n                            ////console.log(\"data is : \", data);\n                           \n                            if(data.success){\n                                vm.info = data.info;\n                            }\n\n                        });\n\n            vm.cards = [];\n\n            //NEED TO UPDATE THIS!!!!!\n           var send = {\n               user_id: vm.bookout.payer_id,\n               club_id: club_id_confirmed,\n               membership_id: 1\n           }\n            PaymentService.GetMemberCards(send)\n            .then(function (data) {\n\n                //console.log(data);\n                vm.cards = data.cards;\n                vm.savedCards = data.cards;\n                // vm.membership_now.cards = data.cards;\n                // vm.membership_now.default_card = data.default_card;\n\n            });\n\n\n\n            console.log(\"CONFIRM BOOKING IS : \", vm.bookout.booking_id);\n\n            vm.complete_flight = true;\n        }\n\n\n\n\n\n        var compile_invoice = function(){\n            var items = [];\n            // vm.plane_charges\n            //add plane costs\n\n            if(vm.package_used && vm.package_removed && vm.package_removed.length > 0){\n                for(var i=0;i<vm.package_removed.length;i++){\n                    var uuint = (vm.package_removed[i].hours_dual_spent > 0) ? vm.package_removed[i].hours_dual_spent : vm.package_removed[i].hours_solo_spent;\n                    items.push({package_id: vm.package_removed[i].package_id, title: \"Package: \"+vm.package_removed[i].title, hours: uuint, hours_type: vm.package_removed[i].solo_dual, member_packages_id: vm.packages[i].id, unit_price: 0, total: 0, organise: 0});\n                    \n                }\n            //items.push({title: \"Plane \"+vm.plane_charges.plane_charge_type+\" Charge\", unit: vm.plane_charges.plane_units, unit_price: vm.plane_charges.plane_unit_price, total: vm.plane_charges.plane_total, organise: 0});\n            }\n\n            items.push({title: \"Aircraft \"+vm.plane_charges.plane_charge_type+\" Charge\", unit: vm.plane_charges.plane_units, unit_price: vm.plane_charges.plane_unit_price, total: vm.plane_charges.plane_total, organise: 0});\n            if(vm.plane_charges.surcharge_total > 0){\n                items.push({title: \"Surcharge per \"+vm.plane_charges.surcharge_charge_type, unit: vm.plane_charges.surcharge_units, unit_price: vm.plane_charges.surcharge_unit_price, total: vm.plane_charges.surcharge_total, organise: 1});\n            }\n            if(vm.plane_charges.tuition_total > 0){\n                items.push({title: \"Tuition Charge - \"+vm.bookout.tuition_required.title, unit: vm.plane_charges.tuition_units, unit_price: vm.plane_charges.tuition_unit_price, total: vm.plane_charges.tuition_total, organise: 2});\n            }\n            if(vm.plane_charges.landing_total > 0){\n                items.push({title: \"Home Landing\", unit: vm.plane_charges.landing_units, unit_price: vm.plane_charges.landing_unit_price, total: vm.plane_charges.landing_total, organise: 4});\n            }\n            if(vm.plane_charges.tng_total > 0){\n                items.push({title: \"Home Touch and Go\", unit: vm.plane_charges.tng_units, unit_price: vm.plane_charges.tng_unit_price, total: vm.plane_charges.tng_total, organise: 3});\n            }\n           \n\n            //RENTAL ITEMS !? --> make it free for now...\n\n            for(var i=0;i<vm.plane_charges.receipts.length;i++){\n                var org = parseInt(5 + i)\n                items.push({title: \"Reimbursement - \"+vm.plane_charges.receipts[i].item, unit: vm.plane_charges.receipts[i].quantity, unit_price: (vm.plane_charges.receipts[i].price / vm.plane_charges.receipts[i].quantity), total: -vm.plane_charges.receipts[i].price, organise: org});\n            }\n\n            return items;\n        }\n\n\n\n        vm.get_package_html = function(pack_obj){\n            var used_on = \"\";\n            for(var i=0;i<pack_obj.aircraft.length;i++){\n                used_on = used_on + \" \" + pack_obj.aircraft[i].registration +\" (\"+ pack_obj.aircraft[i].plane_type +\") <br />\";\n            }\n            var text = \"\";\n            if(pack_obj.validity == 0){\n               text = \"Package purchased on: \"+moment(pack_obj.created_at).format(\"D MMM Y\")+\"<br /> Package does not expire <br /> To be used on:<br />\";\n            } else {\n               text = \"Package purchased on: \"+moment(pack_obj.created_at).format(\"D MMM Y\")+\"<br /> Package expires on: \"+ moment(pack_obj.created_at).add(pack_obj.validity, \"days\").format(\"D MMM Y\") +\" <br /> To be used on:<br />\";\n            }\n    \n            return text+used_on;\n\n        }\n\n\n        vm.convert_decimal_to_hours = function(number){\n            \n            var sign = (number >= 0) ? 1 : -1;\n\n            // Set positive value of number of sign negative\n            number = number * sign;\n\n            // Separate the int from the decimal part\n            var hour = Math.floor(number);\n            var decpart = number - hour;\n\n            var min = 1 / 60;\n            // Round to nearest minute\n            decpart = min * Math.round(decpart / min);\n\n            var minute = Math.floor(decpart * 60) + '';\n\n            // Add padding if need\n            if (minute.length < 2) {\n            minute = '0' + minute; \n            }\n\n            // Add Sign in final result\n            sign = sign == 1 ? '' : '-';\n\n            // Concate hours and minutes\n            var time = sign + hour + ':' + minute;\n\n            return time;\n\n        }\n\n\n\n\n        //complete the booking back in\n        vm.book_in_flight = function(where_to = \"home\", payment = \"none\", paymentIntent = \"\"){\n            vm.show_loading = true;\n\n            //need to make sure that this is not the instructor paying for the flight..... \n            //If the instructor / management fills in these details, we want to make sure that the actual user gets charged.\n            // console.log(\"vm.this_pls_id_raw\", vm.this_pls_id_raw);\n            // console.log(\"vm.bookout.booking_id 1 - \", vm.bookout.booking_id);\n\n\n\n            // //to generate the payment side::::\n            // vm.plane_charges\n            // vm.payment_card \n            // vm.user.id\n\n\n            // //defects already reported\n            // //receipts already reported\n\n            // //need to check / update::: \n            // detail_type_id\n            // from_airport_id\n            // to_airport_id\n            // //if from_airport_id == to_airport_id ==> detail_type_id = 1 (local)\n\n\n            // pic_id\n            // tacho_start\n            // tacho_end\n            // brakes_off\n            // brakes_on\n            // //need to total the added receipts's quantities\n            // oil_uplift_litres\n            // fuel_uplift_litres\n\n            // full_stop_landings\n            // touch_and_go \n\n            // booked_in = 1\n            // flight_date = today\n\n\n            // dual_flight - mention\n            // var dual_flight = (vm.bookout.pic_id !== vm.bookout.user_id)? 1 : 0;\n\n\n            // var from_airfield = (vm.bookout.)\n\n            \n\n            //\n            var flag_flight = false;\n\n            //need to check that the start tacho has not been altered ==> otherwise we need to flag this....\n            var oil = 0;\n            var fuel = 0;\n            for(var i=0;i<vm.lubricant_receipts.length;i++){\n                if(vm.lubricant_receipts[i].item == \"Fuel\"){\n                    fuel = Number.parseFloat(fuel) + Number.parseFloat(vm.lubricant_receipts[i].quantity);\n                } else {\n                    oil = Number.parseFloat(oil) + Number.parseFloat(vm.lubricant_receipts[i].quantity);\n                }\n            }\n\n\n            //landings\n            var total_landings = parseInt(parseInt(vm.bookout.landings) + parseInt(vm.bookout.tng) + parseInt(vm.bookout.remote_landings));\n            if(total_landings < 1){\n                if(confirm(\"It looks as though you didn't land, is that correct?\")){\n                    //console.log(\"how does a plane go for a flight but doesn't land anywhere?\");\n                    flag_flight = true;\n                    //repositioning on airfield, maybe?\n                } else {\n                    return false;\n                }\n            }\n\n            //only if we charge by tacho - surely?\n            //if start tacho was not start tacho....\n            if(vm.bookout.plane_charges.charge_type == \"tacho\" || vm.bookout.plane_charges.charge_type == \"hobbs\"){\n                if(Number.parseFloat(vm.start_tacho_orig) !== Number.parseFloat(vm.bookout.start_tacho)){\n                   if(confirm(\"It looks as though your start meter reading [\"+vm.bookout.start_tacho+\"] is not the same as the previous flight's last meter reading of \"+vm.start_tacho_orig+\" - is that correct?\")){\n                        //console.log(\"Someone seems to have a different tacho reading... need to flag this to management to check...\");\n                        flag_flight = true;\n                        //repositioning on airfield, maybe?\n                    } else {\n                        return false;\n                    } \n                }\n            }\n\n\n\n\n            // WHEN A USER ENTERS A NEW AIRFIELD / STRIP INTO THE SYSTEM ::: \n            // the vm.bookout.from_airfield.id = 0 \n            // OR\n            // vm.bookout.to_airfield.id = 0\n            // we need a switchcase to add the airport details in the send if a number is not already in there\n            // then if the ID = 0, and the new_from_airport is filled in, we add it to the DB before we add the logbook entry\n            // then we flag that entry as \"NEW AIRFIELD --> PLEASE VERIFY THE ENTRY for an admin to double check\"\n            // should be straight forward entry \n\n            // then once this is complete - we need to look at the problem with empty brakes time / estimated flight time\n            // then we need to look at the logbooks --> separate the Engine, Prop, Airframe logbooks, and keep a separate tab on there\n\n\n            var is_dual_flight = 0;\n            if(vm.bookout.instructor_id > 0 && vm.bookout.tuition_id > 0){\n                is_dual_flight = 1;\n            }\n\n            if(is_dual_flight == 0 && vm.put_id > 0 && vm.pic_id !== vm.put_id){\n                is_dual_flight = 1;\n            } else if(is_dual_flight == 0 && vm.put_id > 0){\n                is_dual_flight = 1;\n            }\n\n            var authorised_solo = 0;\n            var authorised_by = 0;\n            if(vm.this_was_supervised_solo){\n                authorised_solo = 1;\n                if(vm.bookout.instructor && vm.bookout.instructor.user_id){\n                    authorised_by = vm.bookout.instructor.user_id;\n                } else if(vm.bookout.instructor_id > 0){\n                    authorised_by = vm.bookout.instructor_id;\n                }\n            }\n\n            //must be a claimed flight\n            var bookout_user_id = vm.bookout.user_id;\n            if(!bookout_user_id || bookout_user_id == 0){\n                bookout_user_id = vm.bookout.payer_id;\n            }\n\n            var bookout_instructor_id = vm.bookout.instructor_id;\n            if(!bookout_instructor_id || bookout_instructor_id == 0 && is_dual_flight == 1 && vm.bookout.pic_id > 0){\n                bookout_instructor_id = vm.bookout.pic_id;\n            }\n\n\n\n            var put_id = vm.bookout.put_id;\n            if(put_id == 0 && is_dual_flight == 1){\n                put_id = vm.bookout.payer_id;\n            }\n\n            var pic_id = vm.bookout.pic_id;\n            if(pic_id == 0 && is_dual_flight == 0){\n                pic_id = vm.bookout.payer_id;\n            }\n            if(pic_id == 0 && vm.bookout.payer_id > 0 && bookout_instructor_id == 0){\n                pic_id = vm.bookout.payer_id;\n            }\n\n            var to_airport_id = (vm.bookout.flight_type.id == 1)? vm.bookout.from_airfield.id : vm.bookout.to_airfield.id;\n\n            if(is_dual_flight == 1 && bookout_instructor_id < 1){\n                //instructor wasn't set above...\n                console.log(\"did we forget to set the FI?\");\n            }\n\n            var pay_with = {method: {}, method_name: \"\"};\n\n            // if(payment == '' || payment == 'none'){\n            //     // alert('unset payment method');\n            // } else if(payment == 'cc'){\n            //     // alert('pay by card');\n            //     pay_with.method = vm.payment_card;\n            //     pay_with.method_name = \"stripe\";\n            // } else if (payment == 'dd'){\n            //     // alert('pay by direct debit');\n            //     pay_with.method = vm.info;\n            //     pay_with.method_name = \"gocardless\";\n            // } else if (payment == 'cm'){\n            //     // alert('pay by card machine');\n            //     pay_with.method_name = \"cardmachine\";\n            // } else {\n            //     alert('not sure on payment method');\n            // }\n\n\n           \n\n            // console.log(\"PAY WITH : \", pay_with);\n           // return false;\n\n\n            var obj = {\n                user_id: bookout_user_id,\n                club_id: vm.bookout.club_id,\n                plane_id: vm.bookout.plane_id,\n                instructor_id: bookout_instructor_id,\n                booking_id: vm.bookout.booking_id,\n                payer_id: vm.bookout.payer_id,\n                plane_log_sheet: {\n                    dual_flight: is_dual_flight,\n                    authorised_solo: authorised_solo,\n                    authorised_by: authorised_by,\n                    tuition_id: vm.bookout.tuition_id,\n                    course_id: vm.bookout.course_id,\n                    club_id: vm.bookout.club_id,\n                    plane_id: vm.bookout.plane_id,\n                    pic_id: pic_id,\n                    put_id: put_id,\n                    user_id: bookout_user_id,\n                    payer_id: vm.bookout.payer_id,\n                    detail_type_id: vm.bookout.flight_type.id,\n                    from_airport_id: vm.bookout.from_airfield.id,\n                    to_airport_id: to_airport_id,\n                    tacho_start: vm.bookout.start_tacho,\n                    tacho_end: vm.bookout.end_tacho,\n                    brakes_off: vm.bookout.brakes_off.time,\n                    brakes_on: vm.bookout.brakes_on.time,\n                    oil_uplift_litres: oil,\n                    fuel_uplift_litres: fuel,\n                    full_stop_landings: vm.bookout.landings,\n                    touch_and_go: vm.bookout.tng,\n                    remote_landings: vm.bookout.remote_landings,\n                    booked_in: 1,\n                    original_id: vm.this_pls_id_raw.id,\n                    booked_in_by: vm.user.id //,\n                    // authorised_solo: (vm.bookout.authorised_solo)? true : false\n                },\n                invoice: compile_invoice(),\n                paying_now: vm.complete_flight,\n                pay_with: pay_with,\n                free_flight: vm.free_flight,\n                paymentIntent: paymentIntent,\n                // card_id: (vm.complete_flight && !vm.free_flight && !vm.can_authorise && vm.payment_card.id > 0)? vm.payment_card.id : 0,\n                flag_flight: flag_flight\n            };\n\n\n\n            if(payment == \"new-card\"){\n                obj.paymentIntent = paymentIntent;\n                obj.method = payment;\n                obj.pay_with.method = payment;\n                obj.pay_with.method_name = payment;\n            } else if(payment == \"saved-card\"){\n                obj.paymentIntent = paymentIntent;\n                obj.method = payment;\n                obj.pay_with.method = payment;\n                obj.pay_with.method_name = payment;\n            } else if(payment == \"direct-debit\"){\n                //nothing to add - it should just work...\n                obj.method = payment;\n                obj.pay_with.method = payment;\n                obj.pay_with.method_name = payment;\n            } else if(payment == \"card-machine\"){\n                //nothing here at the moment?\n                obj.paymentIntent = paymentIntent;\n                obj.method = payment;\n                obj.pay_with.method = payment;\n                obj.pay_with.method_name = payment;\n            } else if(payment == \"free\"){\n                obj.method = payment;\n                obj.pay_with.method = payment;\n                obj.pay_with.method_name = payment;\n            }\n\n            //otherwise leave default\n\n\n\n\n            if(to_airport_id == 0){\n                obj.plane_log_sheet.new_to_airport = vm.bookout.to_airfield;\n                obj.plane_log_sheet.new_to_airport.title = obj.plane_log_sheet.new_to_airport.title.replace(\"NOT LISTED : \", \"\");\n            }\n\n            if(vm.bookout.from_airfield.id == 0){\n                obj.plane_log_sheet.new_from_airport = vm.bookout.from_airfield;\n                obj.plane_log_sheet.new_from_airport.title = obj.plane_log_sheet.new_from_airport.title.replace(\"NOT LISTED : \", \"\");\n            }    \n\n            \n\n\n            //we need to add some items if this links to a FOX AVIONIX FLIGHT LOG\n            obj.plane_log_sheet.fox_log_id = vm.bookout.fox_log_id;\n            obj.plane_log_sheet.fox_claimed = 1;\n\n            obj.plane_log_sheet.takeoff_time = vm.bookout.takeoff_time;\n            obj.plane_log_sheet.landing_time = vm.bookout.landing_time;\n\n            if(vm.has_used_claimed_flight && vm.claimed_flight && vm.claimed_flight.takeoff_time && vm.claimed_flight.takeoff_time !== \"\"){\n                obj.plane_log_sheet.takeoff_time = vm.claimed_flight.takeoff_time;\n                obj.plane_log_sheet.landing_time = vm.claimed_flight.landing_time;\n\n                obj.plane_log_sheet.landing_rounded = vm.claimed_flight.landing_rounded;\n                obj.plane_log_sheet.takeoff_rounded = vm.claimed_flight.takeoff_rounded;\n            }\n            // console.log(\"TAKEOFF TIME 1 : \", obj.plane_log_sheet.takeoff_time);\n            // console.log(\"TAKEOFF TIME 1 : \", vm.bookout.takeoff_time);\n            // console.log(\"CLAIMED: \", vm.claimed_flight);\n\n            \n            \n            // console.log(\"TAKEOFF TIME 2 : \", obj.plane_log_sheet.takeoff_time);\n\n            obj.plane_log_sheet.brakes_time = vm.flight_units.brakes_to_brakes;\n            obj.plane_log_sheet.airborne_time = vm.flight_units.airborne_times;\n\n\n            //THIS IS THE KEY HERE delete this one once selected / complete\n            obj.plane_log_sheet.claimed_fox_plane_log_sheet_id = vm.claimed_flight.id;\n\n            if(vm.split_flight && vm.split_one){\n                obj.plane_log_sheet.brakes_off_rounded = vm.split_one.brakes_off_rounded;\n                obj.plane_log_sheet.brakes_on_rounded = vm.split_one.brakes_on_rounded;\n                obj.plane_log_sheet.takeoff_time = vm.split_one.takeoff_time;\n                obj.plane_log_sheet.landing_time = vm.split_one.landing_time;\n                obj.plane_log_sheet.takeoff_rounded = vm.split_one.takeoff_rounded;\n                obj.plane_log_sheet.landing_rounded = vm.split_one.landing_rounded;\n                obj.plane_log_sheet.airborne_rounded = vm.split_one.airborne_rounded;\n                obj.plane_log_sheet.brakes_times_rounded = vm.split_one.brakes_times_rounded;\n                obj.plane_log_sheet.brakes_time = vm.split_one.brakes_time;\n                obj.plane_log_sheet.flight_time = vm.split_one.flight_time;\n                obj.plane_log_sheet.airborne_time = vm.split_one.airborne_time;\n                obj.plane_log_sheet.flight_time = vm.split_one.flight_time;\n            }\n\n            if(vm.split_flight == 1 && vm.split_two && vm.split_two !== \"\"){\n\n                //if there was a split - this is where we sort out the magic to go with it!\n                console.log(\"vm.bookout.booking_id \", vm.bookout.booking_id);\n                console.log(\"vm.split_two.booking \", vm.split_two.booking);\n                delete vm.split_two.booking;\n                delete vm.split_two.passengers;\n                delete vm.split_two.from_airport;\n                delete vm.split_two.to_airport;\n                delete vm.split_two.plane_charges;\n                delete vm.split_two.tuition_charges;\n                delete vm.split_two.tuition_required;\n                delete vm.split_two.pilot_in_command;\n                delete vm.split_two.home_airport_id;\n                delete vm.split_two.aircraft;\n                delete vm.split_two.stops;\n                delete vm.split_two.user;\n                delete vm.split_two.last_tacho;\n                delete vm.split_two.instructor;\n                delete vm.split_two.id;\n\n                // if there was an update of the destination on the book-in\n                // and the flight was split - then they must start from that point \n                //on the next flight (hopefully anyway!!)\n\n                if(to_airport_id > 0 && to_airport_id !== vm.split_two.from_airport_id){\n                    vm.split_two.from_airport_id = to_airport_id;\n                }\n                //we didn't de-construct this - hence why this is not needed.\n                // vm.split_two.brakes_on = vm.split_two.brakes_on.time;\n                // vm.split_two.brakes_off = vm.split_two.brakes_off.time;\n\n                if(vm.split_two && vm.split_two.brakes_on && vm.split_two.brakes_on.time){\n                    vm.split_two.brakes_on = vm.split_two.brakes_on.time;\n                }\n                if(vm.split_two && vm.split_two.brakes_off && vm.split_two.brakes_off.time){\n                    vm.split_two.brakes_off = vm.split_two.brakes_off.time;\n                }\n                if(vm.split_two){\n                    vm.split_two.is_split_flight = 1;\n                }\n\n                if(vm.split_two && obj.plane_log_sheet.booking_id && obj.plane_log_sheet.booking_id > 0){\n                    vm.split_two.booking_id = obj.plane_log_sheet.booking_id;\n                }\n               \n\n                obj.plane_log_sheet.split_two = vm.split_two;\n\n                obj.plane_log_sheet.is_split_flight = 1;\n\n            }\n            \n           \n\n            //IF THIS IS THE COMPLETION OF THE SPLIT FLIGHTS\n            if(vm.is_split_flight && vm.is_split_flight == 1 && vm.split_flight == 0){\n                //chances are this is when it is complete??\n                //vm.is_split_complete = 1;\n                obj.plane_log_sheet.is_split_complete = 1;\n\n            }\n\n            // console.log(\"is_split_flight : \", vm.is_split_flight);\n            // console.log(\"split_flight : \", vm.split_flight);\n            // console.log(\"obj pls \", obj.plane_log_sheet);\n            // return false;\n\n\n            if(obj && obj.plane_log_sheet && obj.plane_log_sheet.takeoff_time && obj.plane_log_sheet.takeoff_time.time && obj.plane_log_sheet.takeoff_time.time !== \"\"){\n                obj.plane_log_sheet.takeoff_time = obj.plane_log_sheet.takeoff_time.time;\n            }\n\n            if(obj && obj.plane_log_sheet && obj.plane_log_sheet.landing_time && obj.plane_log_sheet.landing_time.time && obj.plane_log_sheet.landing_time.time !== \"\"){\n                obj.plane_log_sheet.landing_time = obj.plane_log_sheet.landing_time.time;\n            }\n            \n\n             // console.log(\"TO BE SENDING : \", obj);\n             // console.log(\"where_to : \", where_to);\n             // console.log(\"TO BE SENDING : \", obj);\n\n            // console.log(obj);\n            // return false;\n\n            //return false;\n            //vm.bookout.id is actually a plane_log_sheet_id ??? \n\n            BookoutService.BookInFlight(vm.bookout.id, obj)\n            .then(function(data){\n                ////console.log(\"SENT - \", data);\n\n                vm.after_where_to = where_to;\n                vm.after_data = data;\n                \n\n                //STOPPPPP\n                            //return false;\n                //vm.show_loading = false;\n                \n                if(data.success){\n                    console.log(\"paymentID\", vm.paymentID);\n                    if(data.paymentID){\n                        vm.payment_id = data.paymentID;\n                        vm.paymentID = data.paymentID;\n                    }\n\n                    if(pay_with.method_name == \"cardmachine\"){\n                        console.log(\"paymentID 1\", vm.paymentID);\n                        console.log(\"paymentID 2\", data.paymentID);\n\n                        vm.show_cardmachine = true;\n                      \n                        poll_check_payment(data.paymentID, 30, function(result) {\n                            if (result) {\n                                //alert(\"Payment confirmed!\");\n                                vm.stop_polling = true;\n                                 vm.show_loading = false;\n                                after_success_bookin(where_to, data);\n                            } else {\n                                //alert(\"Payment not confirmed - please try again\");\n                                 vm.show_loading = false;\n                            }\n                        });\n                        console.log(\"check_payment \", check_payment);\n                       \n\n\n                    } else {\n                         vm.show_loading = false;\n                        vm.stop_polling = true;\n                        after_success_bookin(where_to, data);\n                    }\n\n                \n                } else {\n\n                    if(pay_with.method_name == \"stripe\" && data.card_processor){\n                        //we need to show the 3DS secondary auth\n                        // alert(\"Your card processor requires authentication\");\n                        console.log(\"BEFORE STRIPE = \", data);\n\n                        var stripe = Stripe('pk_test_51QttFFG8WiGSRCORyxkdZTO8oajcqz9OUsvcDJFpr9FB2PAdbzJc0tS7WNnfzKYsTiqHN1YDZi5UtXk4K52SeD4h00YWXuChNd');\n                        stripe.confirmCardPayment(\n                          data.client_secret,\n                          {\n                            payment_method: data.payment_method,\n                            return_url: data.card_url.return_url\n                          },\n                          // Disable the default next action handling.\n                          // {handleActions: false}\n                        ).then(function(result) {\n                          // Handle result.error or result.paymentIntent\n                          // More details in Step 2.\n                          console.log(result);\n                         \n                          if(result.error) {\n                            console.error(result.error);\n                            if(result.error.code == \"payment_intent_authentication_failure\"){\n                                //alert(\"You have failed to pass your card issuer's authentication - please try again or pay with another payment method.\");\n                                vm.show_loading = false;\n                                after_success_bookin(where_to, data);\n                            }\n                          } else if(result.paymentIntent.status === 'succeeded') {\n                            console.log('Payment successful!');\n                            //we need to let the server know the payment was successful so it can be entered into the transaction list\n                            BookoutService.CheckPayment(data.paymentID)\n                                .then(function(data){\n                                    if(data.success){\n                                       \n                                        vm.show_loading = false;\n                                        after_success_bookin(where_to, data);\n                                        \n                                    } else {\n                                       // alert(\"We encountered an error - this invoice will be visible in your invoices for completion\");\n                                        console.log(\"NOTHING SENT?\");\n                                        vm.show_loading = false;\n                                    }\n                                });\n\n                            \n\n                          } else {\n                            console.log(\"not sure what happened\");\n                             vm.show_loading = false;\n                          }\n\n\n                        });\n\n\n                    } else if(data.error){\n\n                        //there was an error with the link to the card machine...\n                        alert(\"There was an error connecting to the card machine - please ensure that the card machine is ON and connected to the internet.\");\n                         vm.show_loading = false;\n                        vm.show_cardmachine = true;\n\n                    } else {\n                        alert(\"an error occurred.... \\n\\n \"+data.message);\n                         vm.show_loading = false;\n                    }\n\n                    // //console.log(data);\n                }\n            });\n\n        }\n\n        vm.close_machine_popup = function(){\n\n            //clear the card machine and close the popup??\n\n            //at this point the flight probably has already been booked back in... lets consider how to give options for payment\n             BookoutService.ClearMachine(vm.payment_id, vm.club_id)\n            .then(function(data){\n                if(data.success){\n                    console.log(\"machine should be clear now?\", data);\n                    vm.show_cardmachine = false;\n                    vm.show_after_bookedin = true;\n\n                } else {\n                    console.log(\"No success on card machine clear\");\n                    //at this point the flight probably has already been booked back in... lets consider how to give options for payment\n                    vm.show_cardmachine = false;\n                    vm.show_after_bookedin = true;\n                }\n            });\n\n\n\n            // vm.show_cardmachine = false;\n            // vm.show_after_bookedin = true;\n\n        }\n\n        vm.cancel_machine = function(){\n\n            //cancel the payment request?\n            BookoutService.ClearMachine(vm.payment_id, vm.club_id)\n            .then(function(data){\n                if(data.success){\n                    console.log(\"machine should be clear now?\", data);\n                    vm.show_cardmachine = false;\n                    //at this point the flight probably has already been booked back in... lets consider how to give options for payment\n                    vm.show_after_bookedin = true;\n                    vm.stop_polling = true;\n\n                } else {\n                    console.log(\"No success on card machine clear\");\n                    //at this point the flight probably has already been booked back in... lets consider how to give options for payment\n                    vm.show_after_bookedin = true;\n\n                }\n            });\n\n\n\n        }\n\n        vm.close_bookedin = function(){\n\n            BookoutService.ClearMachine(vm.payment_id, vm.club_id)\n            .then(function(data){\n                 //once cleared - we continue?\n                 console.log(\"regardless of clear - should now be cleared?\");\n                 vm.show_cardmachine = false;\n                 vm.show_after_bookedin = false;\n                 vm.stop_polling = true;\n                 after_success_bookin(vm.after_where_to, vm.after_data);\n            });\n\n        }\n\n\n        vm.reset_card_machine = function(){\n\n            console.log(\"retry\", vm.payment_id);\n            //try to send the request a second time to the machine?\n             BookoutService.RetryPaymentMachine(vm.payment_id, vm.club_id)\n            .then(function(data){\n                console.log(data);\n                if(data.success){\n                    alert(\"The card machine should hopefully be displaying the payment now\");\n                    //create new poll??\n                    vm.stop_polling = false;\n                    poll_check_payment(vm.payment_id, 30, function(result) {\n                        if (result) {\n                            alert(\"Payment confirmed!\");\n                            vm.stop_polling = true;\n                            after_success_bookin(vm.after_where_to, vm.after_data);\n                        } else {\n                            alert(\"Payment not confirmed - please try again\");\n                        }\n                    });\n                } else {\n                    if(data.success == false && data.message == \"The payment has already been successfully made.\"){\n                        vm.stop_polling = true;\n                        after_success_bookin(vm.after_where_to, vm.after_data);\n                    }\n                    alert(data.message);\n                }\n\n            });\n\n\n            vm.show_cardmachine = true;\n\n        }\n\n        function poll_check_payment(id, maxAttempts, finalCallback) {\n            var attempts = 0;\n\n                function attempt() {\n                    check_payment(id, function(success) {\n                        attempts++;\n                        if (success) {\n                            console.log(\"Payment confirmed!\");\n                            finalCallback(true);\n                        } else if (attempts >= maxAttempts) {\n                            console.log(\"Max attempts reached, giving up.\");\n                            finalCallback(false);\n                        } else if (vm.stop_polling) {\n                            console.log(\"called to stop polling\");\n                            finalCallback(false);\n                            return;\n                        } else {\n                            console.log(\"Retrying in 10000 ms...\");\n                            setTimeout(attempt, 10000);\n                        }\n                    });\n                }\n\n                attempt(); // Start polling\n        }\n\n        function get_update_on_cardmachine(payment_id, retry, limit, callback2){\n            if(retry <= limit){\n\n                check_payment(payment_id, function(result) {\n                    if (result) {\n                        // do something if true\n                        console.log(\"RESPONSE FROM CHECK PAYMENT IS TRUE\");\n                        callback2(true);//{success: true, message: \"payment checked & done\"};\n                    } else {\n                        // do something if false\n                         console.log(\"delay and try again?\");\n                    \n                        setTimeout(() => {\n                          console.log(\"Delayed for 5 second.\", payment_id);\n                          console.log(\"Delayed for 5 second.\", vm.payment_id);\n                          retry++;\n                          callback2(get_update_on_cardmachine(payment_id, retry, limit, callback));\n                        }, 10000);\n                    }\n                });\n\n                // var status_card = check_payment(payment_id);\n                // console.log(\"STATUS HERE:\", status_card);\n                // if(status_card){\n                //     console.log(\"RESPONSE FROM CHECK PAYMENT IS TRUE\");\n                //     return true;//{success: true, message: \"payment checked & done\"};\n                // } else {\n                //     console.log(\"delay and try again?\");\n                    \n                //     setTimeout(() => {\n                //       console.log(\"Delayed for 5 second.\", payment_id);\n                //       console.log(\"Delayed for 5 second.\", vm.payment_id);\n                //       retry++;\n                //       return get_update_on_cardmachine(payment_id, retry, limit);\n                //     }, 10000);\n                // }\n            } else {\n                console.log(\"over limit?\");\n                callback2(false);// false;//{success: false, message: \"too many attempts\"};\n            }\n        }\n\n        function check_payment(id, callback){\n\n            BookoutService.CheckPayment(id)\n            .then(function(data){\n                if(data.success){\n                    console.log(\"check payment\", data);\n                    if(data.status){\n                        console.log(\"status = true\");\n                         callback(true);\n                    } else {\n                        console.log(\"status = false\");\n                         callback(false);\n                    }\n                    \n                } else {\n                        console.log(\"NOTHING SENT?\");\n                         callback(false);\n                }\n            });\n\n           // return false;\n\n        }\n\n\n\n        function after_success_bookin(where_to, data){\n                if(where_to == \"home\"){\n                        $state.go('dashboard.my_account', {}, { reload: true });\n                    } else if(where_to == \"debrief\") {\n                        console.log(\"DEBRIEF!!\");\n                        //if((vm.user.id == vm.bookout.instructor_id) && (vm.bookout.booking_id > 0 || vm.bookout.course_id > 0)){\n                        if((vm.user.id == vm.bookout.instructor_id || (vm.user.id == vm.bookout.pic_id && vm.bookout.put_id > 0)) && (vm.bookout.booking_id > 0 || vm.bookout.course_id > 0) ){\n                          console.log(\"DEBRIEF 2!!\");\n\n                          // /debriefing/:booking_id/:plane_log_sheet_id\n                          //:split_next_id/:split_booking_id\n                          /*\n                            \"plane_log_sheet_id\" => $split_two_id, --> data.split.plane_log_sheet_id\n                            \"booking_id\" => $booking_id --> data.split.booking_id\n                          */\n                          //\n                              var booking_id = 0;\n                              if(vm.bookout.booking_id < 1){\n                                  booking_id = data.split.booking_id;\n                              } else {\n                                  booking_id = vm.bookout.booking_id;\n                              }\n\n                            if(data.split){\n                              console.log(\"DEBRIEF WITH DATA RESPONSE\");\n                              console.log(data);\n                              // return false;\n\n                                $state.go('dashboard.manage_user.debriefing', { booking_id: booking_id, plane_log_sheet_id: vm.bookout.id, split_next_id: data.split.plane_log_sheet_id, split_booking_id: data.split.booking_id }, { reload: true });\n                            } else {\n                              console.log(\"DEBRIEF without DATA RESPONSE\");\n                              // return false;\n                                $state.go('dashboard.manage_user.debriefing', { booking_id: booking_id, plane_log_sheet_id: vm.bookout.id, split_next_id: 0, split_booking_id: 0 }, { reload: true });\n                            }\n\n                        } else {\n                          console.log(\"DEBRIEF 3!!\");\n                          // return false;\n                            $state.go('dashboard.my_account', {}, { reload: true });\n                        }                        \n\n                    } else if(where_to == \"split\") {\n\n                        console.log(\"SPLIT HERE\");\n                        // //console.log(\"BOOKING _ID \"+vm.bookout.booking_id);\n                        //originally here --> but we don't want this...\n                       // $state.go('dashboard.my_account.bookout_with_booking', {booking_id: vm.bookout.booking_id, claim_id: vm.claim_id, split: vm.split_two}, {reload: true });\n\n                        var booking_id = 0;\n                        if(vm.bookout.booking_id < 1){\n                            booking_id = data.split.booking_id;\n                        } else {\n                            booking_id = vm.bookout.booking_id;\n                        }\n\n                       if((vm.user.id == vm.bookout.instructor_id || (vm.user.id == vm.bookout.pic_id && vm.bookout.put_id > 0)) && (vm.bookout.booking_id > 0 || vm.bookout.course_id > 0)){\n                              console.log(\"SPLIT AND DEBRIEF???\");\n                          // /debriefing/:booking_id/:plane_log_sheet_id\n                              // console.log(\"SPLIT and success in data obj\");\n                              // // split_flight_id: data.split.plane_log_sheet_id, \n                              // // split_flight_booking_id: data.split.booking_id, \n                              // // split: vm.split_two\n                              // console.log(\"data.split.plane_log_sheet_id : \", data.split.plane_log_sheet_id);\n                              // console.log(\"data.split.booking_id : \", data.split.booking_id);\n                              // console.log(\"split : \", vm.split_two);\n                              //  return false;\n                              $state.go('dashboard.manage_user.debriefing', { booking_id: data.split.booking_id, plane_log_sheet_id: vm.bookout.id, split_next_id: data.split.plane_log_sheet_id, split_booking_id: data.split.booking_id }, { reload: true });\n\n                            // $state.go('dashboard.manage_user.debriefing', {booking_id: vm.bookout.booking_id, plane_log_sheet_id: vm.bookout.id, split_flight_id: data.split.plane_log_sheet_id, split_flight_booking_id: data.split.booking_id, split: vm.split_two }, { reload: true });\n                        } else {\n                              // console.log(\"SPLIT back to account\");\n                              //  return false;\n                            //$state.go('dashboard.my_account', {}, { reload: true });\n\n                            //IF THIS PERSON IS BOOKING IT IN - I THINK THEY SHOULD CONTINUE THIS TO THE END....\n                            $state.go('dashboard.my_account.book_in', {id: data.split.plane_log_sheet_id}, {reload: true });\n\n                        }\n\n\n                    } else {\n                       $state.go('dashboard.my_account.bookout_with_booking', {booking_id: vm.bookout.booking_id}, {reload: true });\n                    }\n        }\n\n        function preselect_course_and_tuition(){\n\n            console.log(\"PRESELECT TUITION NOW\");\n\n\n            if(vm.club_courses.length == 1){\n                //preset it??\n                //console.log(\"length is 1\", vm.bookout.course_id);\n                if(!vm.bookout.course_id || vm.bookout.course_id == 0){\n                   vm.bookout.course_id = vm.club_courses[0].id;\n                   vm.bookout.course = vm.club_courses[0];\n                    //console.log(\"HERE?\", vm.bookout.course);\n                }\n            }\n            console.log(vm.bookout.course_id);\n            console.log(vm.club_courses);\n            if(vm.bookout.course_id > 0){\n                var selected_course = vm.club_courses.find(item => item.id === vm.bookout.course_id);\n                vm.bookout.course = selected_course;\n            }\n\n            if(vm.instructor_charges.length == 1){\n                //var selected_tuition = vm.instructor_charges.find(item => item.id === vm.bookout.instruction_required_id);\n                vm.bookout.tuition_required = vm.instructor_charges[0];\n            }\n\n            vm.update_tuition_charges();\n\n        }\n\n\n        vm.this_claim_was_instructional = false;\n        vm.this_was_supervised_solo = false;\n        vm.start_tacho_orig;\n        vm.send = {};\n\n        function process_bookout_to_bookin(booking){\n\n            // console.log(booking);\n            //vm.bookout is where we want to fill the content....\n            vm.bookout.booking_id = booking.booking_id;\n            vm.bookout.club_id = booking.club_id;\n            vm.bookout.user_id = booking.user_id;\n            vm.bookout.plane = booking.plane;\n            vm.club_id = booking.club_id;\n            vm.is_split_flight = booking.is_split_flight;\n            // vm.bookout.return = new Date(booking.end);\n            // vm.bookout.booking_start = new Date(booking.start);\n            \n            // vm.this_pls_id_raw = vm.bookout.id;\n            //vm.this_pls_id_raw = Object.assign({}, booking);\n\n            vm.send = {\n                club_id: vm.bookout.club_id,\n                user_id: vm.user.id\n                // ,\n                // plane_log_sheet_id: booking.id\n            }\n            // console.log(\"booking\", booking);\n            // console.log(\"booking_id\", booking.booking_id);\n\n            /*\n            VM.SEND --> TO THE PAYMENT MODAL\n                if invoice --> remove booking_id add invoice_id \n                if no invoice / booking --> remove both and add amount * 100\n                ie: amount: vm.invoice_totals * 100,\n                user must be the user for that invoice / PAYER ID --> careful on admin functions\n            */\n\n\n\n             PlaneService.GetCurrencies(vm.club_id)\n             .then(function(data){\n                        vm.currencies = data.currencies;   \n                        vm.club_currency = data.club_currency;\n\n                        vm.receipt.currency = $.grep(vm.currencies, function(e){ \n                            return e.iso_code == vm.club_currency; \n                        })[0];;\n\n                });\n\n\n            \n\n\n\n             //&& vm.bookout.user_id !== vm.user.id --> if no bookout was done, this wont work\n             if(((vm.user.access.instructor.indexOf(vm.club_id) > -1) || (vm.user.access.manager.indexOf(vm.club_id) > -1) ) ){\n                // //console.log(\"NOT BOOKING FOR SELF?\");\n                vm.can_authorise = true;\n\n            }\n\n\n\n            vm.invoices = [];\n            vm.previous_total = 0;\n\n            vm.free_flight = false;\n\n            // //console.log(\"actual stuff = \", booking);\n            //there should also be a PILOT / OWNER -> NO MONEY REQUIRED bit\n            if(booking.booking && booking.booking.maintenance_flight == 1){\n                // //console.log(\"FREE FLIGHT WOOO\");\n                vm.free_flight = true;\n                //vm.plane_charges.total = 0;\n            }\n\n\n\n                //IF THIS IS NOT SPLIT FLIGHT??? OTHERWISE... DISASTER?\n                //need to check functionality before release!!\n                if(vm.is_split_flight == 1){\n                    //console.log(\"IS SPLIT?\");\n\n                    \n                    InvoicesService.GetAllByBooking(booking.booking_id)\n                    .then(function (data) {\n                            //console.log(\"invoice data is : \", data);\n                            if(data.success){\n                                //console.log(\"data\", data.invoices);\n                                // vm.previous_invoice = data.invoice;\n                                vm.previous_invoice = data.invoices;\n\n                                // data.invoices.forEach((invoice) => function(){\n                                //     console.log(\"each invoice\", invoice);\n                                //     invoice.flights.forEach((flight) => function(){\n                                //         console.log(\"each flight\", flight);\n                                //         vm.invoices.push(flight);\n                                //         vm.previous_total = (Number.parseFloat(vm.previous_total) + Number.parseFloat(flight.total));\n                                //     });\n                                // });\n                                for(var i=0;i<data.invoices.length;i++){\n                                     Object.keys(data.invoices[i].flights).forEach(function(key) {\n                                        var flight = data.invoices[i].flights[key];\n                                        //console.log(key, flight);\n                                        vm.invoices.push(flight);\n                                        vm.previous_total = (Number.parseFloat(vm.previous_total) + Number.parseFloat(flight.total));\n                                    });\n\n\n\n                                }\n\n                               \n\n                                // for (var key in data.invoices.flights) {\n                                //     console.log(\"KEY \", key);\n                                //     vm.invoices.push(data.invoices.flights[key]);\n                                //     vm.previous_total = (Number.parseFloat(vm.previous_total) + Number.parseFloat(data.invoices.flights[key][\"total\"]));\n                                //     // for(var i=0;i<data.invoice.flights[key].length;i++){\n                                //     // }\n                                // }\n\n\n                                \n                                \n                                // console.log(\"invoices\", vm.invoices);\n                                // //console.log(\"FLIGHTS TOTAL\", vm.previous_total);\n                                // vm.invoices = data.invoice.flights;\n                            } else {\n                                // //console.log(\"no invoices have yet been issued for this flight\");\n                            }\n\n\n                        });\n\n                } else {\n                    console.log(\"NOT SPLIT?\");\n\n\n                }\n\n            \n\n\n            PlaneService.GetOpenIssues(booking.plane_id)\n            .then(function (data) {\n                    ////console.log(\"data is : \", data);\n                   vm.reported_defects = data;\n                });\n\n              PlaneService.GetAllSheetReceipts(vm.bookout.id)\n                .then(function (data) {\n                    ////console.log(\"data is : \", data);\n                    vm.lubricant_receipts = data;\n                });\n\n\n                InstructorCharges.GetByClubId(booking.club_id)\n                .then(function(data){\n                    vm.instructor_charges = data.items;  \n                });\n\n                \n\n\n                //vm.club_courses = data.items\n\n\n\n\n            //we need to update the PICS now...\n\n           \n            //we need to know where the plane was last booked-in at \n            //(ie: if last flight bookout was completed - where the plane landed at last)\n            //if the last booking was not yet completed, then we can assume that this last flight was returning to base.\n            if((booking && booking.id > 0) || (vm.try_split)){\n                console.log(\"PIC ID: \", booking.pic_id);\n                if(vm.pics && booking.pic_id){\n                    var selected_pic = vm.pics.find(item => item.user_id === booking.pic_id);\n                    console.log(\"selected_pic : \", selected_pic);\n                    vm.bookout.pic = selected_pic;\n                }\n                \n\n\n                // //console.log(\"booking.detail_type_id\", booking.detail_type_id);\n\n                var selected_detail_type = vm.flight_types.find(item => item.id === booking.detail_type_id);\n                vm.bookout.flight_type = selected_detail_type;\n\n                if(booking.instructor && booking.instructor !== \"\" && booking.instructor.user_id == booking.pic_id){\n                    vm.bookout.put = vm.bookout.user;\n                }\n\n\n                if(vm.pics && booking.put_id){\n                    var selected_put = vm.pics.find(item => item.user_id === booking.put_id);\n                    console.log(\"selected_put : \", selected_put);\n                    vm.bookout.put = selected_put;\n                }\n\n                // if(booking.instructor && booking.instructor.user_id > 0 && booking.pic_id == booking.user.id){\n\n                // }\n\n                vm.bookout.authorised_solo = (booking.authorised_solo == 1)? true : false;\n\n\n                vm.bookout.from_airfield = booking.from_airport;\n                vm.bookout.to_airfield = booking.to_airport;\n                \n                if(booking.course_id > 0){\n                    vm.bookout.course_id = booking.course_id;\n                } else if(booking.booking && booking.booking.course_id && booking.booking.course_id > 0){\n                    vm.bookout.course_id = booking.booking.course_id;\n                }\n\n                vm.bookout.start_tacho = Number.parseFloat(booking.last_tacho);\n                \n                vm.start_tacho_orig = booking.last_tacho;\n\n\n\n               \n                 //this is where we sort out some of the last bits....\n\n                //var instructor = vm.pics.find(item => item.user_id === booking.instructor.id);\n                vm.bookout.instructor = booking.instructor;\n                var selected_pic = vm.pics.find(item => item.user_id === booking.pic_id);\n                vm.bookout.pic = selected_pic;\n\n\n            }\n\n\n\n\n\n            // if(booking.instructor && booking.instructor !== \"\" && booking.instructor.id > 0){\n            //     // then we need to set the PIC as the instructor\n            //     //select from pics where user_id = booking.user_id;\n            //     var selected_pic = vm.pics.find(item => item.user_id === booking.instructor.id);\n            //     //set the PIC now...\n            //     vm.bookout.pic = selected_pic;\n            //     vm.bookout.instructor_id = booking.instructor.id;\n            //     vm.bookout.instructor = booking.instructor;\n\n\n            //     var selected_put = vm.pics.find(item => item.user_id === booking.user_id);\n            //     vm.bookout.put = selected_put;\n\n            // } else {\n            //     //then the user is the PIC\n            //     var selected_pic = vm.pics.find(item => item.user_id === booking.user_id);\n            //     vm.bookout.pic = selected_pic;\n\n            // }\n\n       \n\n            if(booking && booking.plane_details && booking.plane_details.location && booking.plane_details.location.wgs_n){\n                vm.wgs_n = booking.plane_details.location.wgs_n\n                vm.wgs_e = booking.plane_details.location.wgs_e;\n            }\n            var location_default = \"\";\n\n            if(booking && booking.plane_details && booking.plane_details.location && booking.plane_details.location.code){\n                location_default = booking.plane_details.location.code.slice(0, -1);\n            } else {\n                location_default = \"EG\";\n            }\n\n            //vm.update_book_in_options();\n\n            BookoutService.GetAirfieldsByCode(location_default)\n                .then(function (data) {\n                    if(data.success){\n                        //use GB airfields first...\n                        vm.airfields = data.airfields;\n                        // var selected_location = vm.airfields.find(item => item.id === booking.plane_details.location.id);\n                        // //console.log(\"selected_location\", selected_location);\n                        // vm.bookout.from_airfield = selected_location;\n                       }\n                    });\n\n\n            if(booking.fox_log_id && booking.fox_log_id > 0){\n                vm.auto_claim = 1;\n                //vm.has_used_claimed_flight = true;\n\n                if(vm.bookout.from_airport.id == vm.bookout.to_airport.id){\n                    if(vm.bookout.touch_and_go > 2){\n                        // circuits 3?\n                        var selected_detail_type = vm.flight_types.find(item => item.id === 3);\n                        vm.bookout.flight_type = selected_detail_type;\n                    } else {\n                        //local flight? 1 \n                        var selected_detail_type = vm.flight_types.find(item => item.id === 1);\n                        vm.bookout.flight_type = selected_detail_type;\n                    }\n\n                } else {\n                    var selected_detail_type = vm.flight_types.find(item => item.id === 2);\n                    vm.bookout.flight_type = selected_detail_type;\n                }\n\n                vm.bookout.brakes_off = {time: vm.bookout.brakes_off};\n                vm.bookout.brakes_on = {time: vm.bookout.brakes_on};\n\n                //vm.bookout.touch_and_go = vm.bookout.touch_and_go;\n                vm.bookout.tng = vm.bookout.touch_and_go;\n                vm.bookout.landings = vm.bookout.full_stop_landings;\n\n//                vm.bookout.fox_log_id = vm.claimed_flight.fox_log_id; already set\n                vm.bookout.fox_claimed = 1;\n\n                vm.has_used_claimed_flight = true;\n                vm.has_requested_to_change_times = false;\n                // vm.bookout.takeoff_time = vm.bookout.takeoff_time;\n                // vm.bookout.landing_time = vm.bookout.landing_time;\n\n                //THIS IS THE KEY HERE delete this one once selected / complete\n                \n\n                if(vm.claimed_flight && vm.claimed_flight.id > 0){\n                    vm.bookout.claimed_fox_plane_log_sheet_id = vm.claimed_flight.id;\n                }\n                if(vm.bookout.fox_log_id > 0){\n                    vm.bookout.claimed_fox_plane_log_sheet_id = vm.bookout.fox_log_id;\n                }\n\n\n\n\n                //WHAT DOES THIS DO!?\n\n                //set the important bits for the invoice now\n                vm.flight_units.brakes_to_brakes = vm.bookout.brakes_time;\n                vm.flight_units.airborne_times = vm.bookout.airborne_time;\n                vm.flight_units.flight_time = vm.bookout.flight_time;\n                vm.flight_units.brakes_times_rounded = vm.bookout.brakes_times_rounded;\n\n                //calculate the invoice yay\n                vm.calculate_invoice_for_flight();\n                vm.flight_times_complete = true;\n\n                // if(vm.bookout.instructor_id > 0 || vm.bookout.put_id > 0 || vm.this_was_instructional_claim || vm.this_claim_was_instructional || vm.bookout.course_id > 0){\n                //    // console.log(\"process bookout to book in\");\n\n                //     preselect_course_and_tuition();\n                // }\n\n                //IF THE PIC is authorised to SOLO\n                //OR IF THE USER IS OWNER-FLIER!!\n\n                // we need to set the PIC as themselves automatically\n                // it feels silly to have to fill it in otherwise. \n\n\n\n            } else { \n                if(vm.bookout.plane_charges.charge_type == \"airborne\" || vm.bookout.plane_charges.charge_type == \"flight\"){\n                    vm.show_takeoff_landing_times = true;\n                }\n                // console.log('else');\n                \n            }\n\n\n\n            CourseService.GetCoursesByClubId(booking.club_id)\n                .then(function(data){\n                    vm.club_courses = data.items;\n\n                    if(vm.bookout.instructor_id > 0 || vm.bookout.put_id > 0 || vm.this_was_instructional_claim || vm.this_claim_was_instructional || vm.bookout.course_id > 0){\n                        // console.log(\"process bookout to book in\");\n                        preselect_course_and_tuition();\n                        //try_split??\n                    }\n                });\n            //booking.plane_details.location.id\n            // vm.bookout.pic = selected_pic;\n\n            // $location.hash('top');\n            // $anchorScroll();\n            if(vm.scroll){\n                vm.scroll = false;\n                smoothScroll.toTop();\n                vm.show_loading = false;\n            }\n            \n\n        }\n\n\n            //nice looking date pickers\n\n\n            $scope.popup = [];\n\n            $scope.open = function(id, $event) {\n                // //console.log(\"THIS\", id);\n                //this comment would allow the event not to be affect by clicking it again... not sure this is a good idea\n                if($scope.popup[id] && $scope.popup[id].opened == true){\n                    $event.preventDefault();\n                    $event.stopPropagation();\n                } else {\n                    $scope.popup[id] = {opened: true};\n                }\n            };\n\n            $scope.formats = ['dd/MM/yyyy', 'yyyy/MM/dd', 'dd.MM.yyyy', 'shortDate'];\n            $scope.format = $scope.formats[0];\n\n            $scope.datePickerOptions = {\n                                        format: 'dd/MM/yyyy',\n                                        showWeeks: false\n                                    };\n\n           \n\n         \n        \n\n\n    }\n app.controller('Bookings2Controller', Bookings2Controller);\n\n    Bookings2Controller.$inject = ['UserService', 'BookoutService',  'MemberService', 'InstructorService', 'MembershipService', 'HolidayService', '$rootScope', '$location', '$scope', '$state', '$stateParams', '$uibModal', '$log', '$window', '$compile', '$timeout', 'uiCalendarConfig', 'BookingService', 'InstructorCharges', 'CourseService'];\n    function Bookings2Controller(UserService, BookoutService,  MemberService, InstructorService, MembershipService, HolidayService, $rootScope, $location, $scope, $state, $stateParams, $uibModal, $log, $window, $compile, $timeout, uiCalendarConfig, BookingService, InstructorCharges, CourseService) {\n        \n        var vm = this;\n        var defaultStartTime = 480;\n        var defaultEndTime = 1080;\n\n        $scope.va1 = '123';\n        \n        //alert(\"boo\");\n        vm.user = $rootScope.globals.currentUser;\n\n        vm.allUsers = [];\n        vm.club = {};\n        vm.page_title = \"\";\n        vm.club.member = {};\n        \n        vm.imported_new_headers = [];\n        vm.see_booking = {};\n\n        vm.is_current = false;\n        vm.currency_type = \"\";\n        vm.currency_days = \"\";\n\n        vm.booking_self = true;\n\n        vm.times_clean_type = \"start_times\";\n\n        $scope.club_timezone = \"Europe/London\";\n        vm.club_timezone = \"Europe/London\";\n\n        vm.is_edit_show_all = false;\n        // vm.club.member.membership_id = {};\n        \n        vm.action = $state.current.data.action;\n        vm.return_to = $state.current.data.return_to;\n        //vm.club_id = 0;\n\n        //just in case i missed a changed value...\n        vm.user_id = vm.user.id;\n\n        vm.no_show_cols = [\"membership_start\", \"membership_id\", \"selected\"];\n\n        var newDate = new Date();\n        \n        var h_start = Math.floor( defaultStartTime / 60 );          \n        var i_start = defaultStartTime % 60;\n        var h_end = Math.floor( defaultEndTime / 60 );          \n        var i_end = defaultEndTime % 60;\n\n        var defaultStart = new Date(newDate.getFullYear(), newDate.getMonth(), newDate.getDate(), h_start, i_start, 0);\n        var defaultEnd = new Date(newDate.getFullYear(), newDate.getMonth(), newDate.getDate(), h_end, i_end, 0);\n        vm.default_date =  new Date();\n\n        vm.datepickerOptions = {\n            customClass: getDayClass,\n            format: 'dd/MM/yyyy',\n            showWeeks: false\n        }\n\n        vm.dateTimeRangePickerOptions = {\n            hour_step: 1,\n            minute_step: 30,\n            min_date: today,\n            datepicker:{\n                customClass: getDayClass,\n                format: 'dd/MM/yyyy',\n                showWeeks: false,\n                minDate: today\n            }\n            ,\n            business_hours: {\n                from: \"09:00\",\n                to: \"22:30\"\n            }\n        };\n\n        $scope.whole_day_booking = false;\n\n\n        // BookingService.GetAll(vm.user.id, moment().format(\"Y-M-D\"), \"\")\n        //     .then(function(data){\n        //         $scope.all_events = data.events;\n        //         $scope.all_resources = data.resources;\n        //     });\n\n\n        vm.instructor_charges = [];\n\n\n\n\n        vm.cancellation = { \n                            reasons: [\n                                \"Pilot Unwell\",\n                                \"Pilot Unavailable\",\n                                \"Weather at home base\",\n                                \"Weather at destination\",\n                                \"Plane Unavailable\",\n                                \"Plane Unserviceable\",\n                                \"Plane Returned Too Late by previous booking\",\n                                \"Instructor Not Available\",\n                                \"Airfield Closed\",\n                                \"Airspace Closed\",\n                                \"Other - please specify\"\n                            ],\n                            notes: \"\"\n                        };\n\n\n\n        var today = new Date();\n        today.setMinutes(0);\n        today.setSeconds(0);\n        // var end = moment(today);\n        // end.add(2, \"hours\");\n        // end = new Date(end);\n        // end.setSeconds(0);\n\n        var end = new Date();\n        end.setHours(end.getHours() + 2);\n        end.setSeconds(0);\n\n\n        var datepicker_today = new Date().format(\"d/M/yyyy\");\n\n\n        vm.start_times = [];\n        vm.end_times = [];\n\n        vm.new_booking = {\n            start_date: today,\n            end_date: today,\n            free_seats: [],\n            passengers: [],\n            options: vm.dateTimeRangePickerOptions\n        };\n\n        $scope.toggle = true;\n        $scope.whentimechangedata = {};\n        $scope.overridePicker = true;\n\n        var date = Date();\n        vm.planes = [];\n        init_times();\n\n      $scope.formats = ['dd/MM/yyyy', 'yyyy/MM/dd', 'dd.MM.yyyy', 'shortDate'];\n      $scope.format = $scope.formats[0];\n        //prepare_add_edit();\n\n\n       \n\n\n        switch(vm.action){\n            case \"add\":\n                // //console.log(\"adding a new member please\");\n                vm.page_title = \"Add a Booking\";\n\n                //update_bookings();\n\n                vm.new_booking = {\n                                    start_date: today,\n                                    end_date: today,\n                                    free_seats: [],\n                                    passengers: [],\n                                    options: vm.dateTimeRangePickerOptions\n                };\n                figure_out_steps();\n\n\n\n\n\n            break;\n            case \"edit\":\n                vm.page_title = \"Edit a Booking\";\n                // //console.log(\"edit an existing booking\");\n\n                vm.see_booking.visible = 0;\n\n                // vm.default_date = new Date(\"2016-10-11\");\n                vm.new_booking = {\n                                    start_date: today,\n                                    end_date: today,\n                                    free_seats: [],\n                                    passengers: [],\n                                    options: vm.dateTimeRangePickerOptions\n                };\n                figure_out_steps();\n                //vm.new_booking.\n                //get a single events\n                \n                update_bookings();\n\n                    //SSCROLL TOOOOO scroll to --> fc-now-indicator fc-now-indicator-line\n\n\n\n                if($stateParams.booking_id){\n\n\n                     \n\n\n\n\n                     BookingService.GetEdit(vm.user.id, $stateParams.booking_id)\n                        .then(function(data){\n                            // //console.log(\"GETTING CONTENT FROM EDIT : \", data);\n\n                            if(data.success){\n\n\n\n                                // //console.log(\"EDIT THIS CONTENT HERE\", data);\n                                // //console.log(\"CHECK CONTENT FROM RETURN\", data.booking.instructor);\n\n                                vm.new_booking = data.booking;\n\n\n\n\n\n                                if(vm.user.access.instructor.indexOf(data.booking.club_id) > -1 || vm.user.access.manager.indexOf(data.booking.club_id) > -1){\n                                    // //console.log(\"THIS IS AN INSTRUCTOR IN THIS CLUB...\");\n                                    \n                                    vm.show_self_option = true;\n                                }\n\n                                if(data.booking.user_id == vm.user.id){\n                                    vm.booking_self = true;\n                                } else {\n                                    vm.booking_self = false;\n                                }\n\n                                if(data.booking.maintenance_flight == 1){\n                                    vm.new_booking.maintenance_flight = true;\n                                }\n\n                                // //console.log(\"MY INSTRUCTOR HERE: \", vm.new_booking.instructor);\n                                vm.new_booking.options = vm.dateTimeRangePickerOptions;\n                                vm.new_booking.edit_booking = 1;\n\n\n\n                                // console.log(\"GET EDIT - \", vm.new_booking.start);\n                                vm.new_booking.start_date = moment(vm.new_booking.start).toDate(); //new Date(vm.new_booking.start);\n                                // console.log(\"GET EDIT - \", vm.new_booking.start_date);\n\n\n\n\n                                // vm.new_booking.start_time = {time: moment(vm.new_booking.start).format(\"HH:mm\"), disabled: 1};\n                                vm.new_booking.start_time = {time: moment(vm.new_booking.start).format(\"HH:mm\")};\n                                // vm.new_booking.end_date = moment(luxon.DateTime.fromISO(vm.new_booking.end).toISO()).toDate();// new Date(vm.new_booking.end);\n                                vm.new_booking.end_date = moment(vm.new_booking.end).toDate();// new Date(vm.new_booking.end);\n\n                                vm.new_booking.end_time = {time: moment(vm.new_booking.end).format(\"HH:mm\")};\n\n\n                                vm.new_booking.after_booking_end = moment().isAfter(moment(vm.new_booking.end));\n\n                                \n                                //vm.default_date = new Date(vm.new_booking.start);\n\n                                \n                                if(vm.new_booking.instructor && vm.new_booking.instructor.id == vm.user_id){\n                                    vm.booking_self = false;\n                                }\n\n\n                                 //this will require breaking up quite a bit... but to access the parent one...\n                                $scope.$parent.vm.default_date =  vm.new_booking.start_date;\n                                setTimeout(function(){\n\n                                    if($scope.$parent.vm.see_booking){\n                                        $scope.$parent.vm.see_booking.visible = 1;\n                                    }\n                                    \n\n\n\n                                    //removed the go to date which was causing errors....\n                                   $(\"#calendar\").fullCalendar(\"gotoDate\", vm.new_booking.start_date );\n                                //console.log(\"HERE WE GO\", vm.new_booking.start_date);\n\n                                    //VERY hacky... not good - but it scrolls to the right place... maybe add a \n                                    setTimeout(function(){\n                                        console.log(\"ID IS : \", $stateParams.booking_id);\n                                            var w = parseInt($('a.fc-timeline-event.booking'+$stateParams.booking_id).css(\"left\"));\n                                        var b = parseInt($('a.fc-timeline-event.booking'+$stateParams.booking_id).width());\n                                         let offsetEvent = w + (b/2) - ($('tbody .fc-time-area .fc-scroller').width()  / 2);\n\n                                        $('tbody .fc-time-area .fc-scroller').animate({\n                                            scrollLeft:  offsetEvent\n                                        }, 1800);\n                                    }, 1000);\n\n\n                                    $scope.$apply();\n\n                                                                //console.log(\"ERR BEFORE HERE?\");\n\n\n                                }, 800);\n\n                                // //console.log(\"DEFAULT\", vm.default_date);                               \n\n                                generate_datetimes();\n\n                                $scope.update_dateTime(\"edit\");\n                                \n                                // //console.log(\"EDIT\", vm.new_booking);\n                                // //console.log(\"=== CHECK AT EDIT\", vm.new_booking.instructor);\n                                \n\n                                // InstructorCharges.GetByClubId(vm.new_booking.club_id)\n                                //     .then(function(data){\n\n                                //         vm.instructor_charges = data.items;  \n                                //         // //console.log(\"====> \", data); \n                                //     });\n\n                                //vm.courses\n                                // console.log(\"GET COURSES\");\n                                CourseService.GetCoursesByClubId(vm.new_booking.club_id)\n                                .then(function(data){\n                                    vm.courses = data.items;   \n                                    // console.log(\"COURSES\", vm.courses);\n\n                                    //set new_booking.tuition-required \n                                    vm.new_booking.tuition_required = vm.courses.find(function(course, index) {\n                                                                    if(course.id == vm.new_booking.course_id)\n                                                                        return true;\n                                                                });\n\n\n                                });\n\n\n\n                                //get all the club members by first and last name and email --> nothing else\n                                //this would only include the members that are for the plane that was selected....\n\n\n                                ////console.log(\"BEFORE GET\", vm.new_booking.end_time);\n                                prepare_add_edit(vm.new_booking.club_id, vm.new_booking.end);\n\n\n\n                                if(vm.new_booking.rental_items){\n                                    //then we may have shizzle to check / update\n                                    for(var i=0;i<vm.new_booking.rental_items.length;i++){\n                                        //first and foremost we need to check the available bits....\n                                        // //console.log(\"NO TO BOOK: \"+vm.new_booking.rental_items[i][\"number_to_book\"]);\n                                        vm.new_booking.rental_items[i][\"number_to_book\"] = parseInt(vm.new_booking.rental_items[i][\"number_to_book\"]);\n                                    }\n                                }\n\n                                if(vm.new_booking.free_seats){\n                                    // //console.log(\"FREE\", vm.new_booking.free_seats);\n                                    vm.new_booking.free_seats = parseInt(vm.new_booking.free_seats);\n                                }\n                                console.log(\"here\");\n                                if(vm.new_booking.instructor){\n                                   console.log(\"MY INSTRUCTOR HERE22: \", vm.new_booking.instructor);\n\n                                }\n\n                                // console.log(\"course: \", vm.new_booking.course_id);\n\n\n                                if((vm.club_id == 0 || !vm.club_id) && vm.new_booking.plane && vm.new_booking.plane.id){\n                                    vm.club_id = vm.new_booking.plane.club_id;\n                                }\n                                //vm.init_passengers();\n                                free_places();\n                                // console.log(\"HEY PAX\");\n                                // vm.init_passengers();\n                                // //console.log(\"MY INSTRUCTOR HERE2244: \", vm.new_booking.instructor);\n\n                            } else {\n                                alert(\"Booking Error \\n \\n\"+data.message);\n                                $state.go('dashboard.add_booking');\n                            }\n\n                        });\n\n\n                }\n               \n\n\n               \n            break;\n            case \"list\":\n                //need to update this to be part of the authentication\n                //to find out club id\n                // //console.log(\"VM\", vm);\n                // //console.log(\"VM\", $stateParams);\n\n                //alert(\"LIST\");\n                //alert(moment($stateParams.start).add(1, \"hour\").format(\"HH:mm\"));\n\n             \n\n\n                vm.show_no_membership_message = false;\n                vm.hide_dropdown = false; \n                vm.clubs = [];\n\n                //we need to get the memberships that the user is a member of....\n                MemberService.GetUserClubs(vm.user.id)\n                 .then(function(data){\n                        vm.clubs = data.clubs;\n\n                        // //console.log(\"CLUBS HERE : \", data);\n\n                        if(vm.clubs && vm.clubs.length > 1){\n                            vm.hide_dropdown = true;\n                        } else if(vm.clubs.length == 1) {\n                            vm.club_id = vm.clubs[0].id;\n                            //console.log(\"SETTING THE CLUB ID HERE:: \", vm.club_id);\n                        }\n                    \n                        update_bookings();\n\n                    });\n                 \n                 //generate_datetimes();\n\n                //  BookingService.GetAllPlanes(vm.user.id, moment(vm.new_booking.start_datetime).format(\"Y-M-D HH:mm\"), moment(vm.new_booking.end_datetime).format(\"Y-M-D HH:mm\"), 0, 0)\n                // .then(function(data){\n                   \n                //     vm.planes = data;\n                //     // //console.log(\"PLANES NOW SET\", vm.planes);\n                //     if($stateParams.plane_id){\n                //         // //console.log(\"plane_id\", $stateParams.plane_id);\n                //         for(var i=0;i<vm.planes.length;i++){\n                //             // //console.log(\"I\", i);\n                //             // //console.log(\"id 1\", vm.planes[i].id);\n                //             // //console.log(\"I\", i);\n                //             if(parseInt(vm.planes[i].id) == $stateParams.plane_id){\n                //                 vm.new_booking.plane = vm.planes[i];\n                //                 // //console.log(\"found\", vm.planes[i]);\n                //             }\n                //         }\n\n                //     }\n\n                // });\n\n            break;\n            default:\n                //console.log(\"none of the above... redirect somewhere?\");\n            break;\n        }  \n\n\n\n        function getAllPlaneUpdate(){\n            check_times();\n            //$scope.update_dateTime('edit');\n             // BookingService.GetAllPlanes(vm.user.id, vm.new_booking.start_datetime, vm.new_booking.end_datetime, 0, 0)\n             //    .then(function(data){\n                   \n             //        //this gets the events and bookings for the period checked here...\n             //        // var events = data.events;\n             //        vm.planes = data;\n                \n\n             //    });\n        }\n\n        \n       \n        $scope.back = function(){\n            $window.history.back();\n        }\n\n        /* THIS SECTION IS ABOUT THE CALENDAR SHOWN ON ALL PAGES */\n\n\n        /* FUNCTIONS REQUIRED FOR ALL PAGES SHOWING THE BOOKINGS ON CALENDAR */\n\n\n        $scope.test = function(){\n            //console.log(\"UPDATE\");\n            vm.new_booking.instructor = {\n                id: 90,\n                first_name: \"A\",\n                last_name: \"REYNIER\"\n            };\n        }\n    \n\n    $scope.updateEvents = function(start, end){\n        ////console.log(\"start\", start, \"end\", end);\n\n        BookingService.GetAll(vm.user.id, start, end)\n        .then(function(data){\n            // //console.log(data);\n\n            $scope.all_events = data.events;\n            $scope.all_resources = data.resources;\n\n            // //console.log(\"hello\", $scope.all_events);\n            // //console.log(\"hello\", $scope.all_resources);\n\n            return data;\n\n        });\n    }\n\n\n\n    /* Render Tooltip */\n    $scope.eventRender = function( event, element, view ) {\n        element.attr({'tooltip': event.title,\n                      'tooltip-append-to-body': true});\n        $compile(element)($scope);\n    };\n\n    \n    $scope.alertOnClicked = function(calEvent, jsEvent, view){\n            \n            vm.see_booking = calEvent;    \n\n            vm.see_booking.start_date = moment(vm.see_booking.start).format(\"DD/MM/YYYY\");\n            vm.see_booking.end_date = moment(vm.see_booking.end).format(\"DD/MM/YYYY\");\n            vm.see_booking.start_time = moment(vm.see_booking.start).format(\"HH:mm\");\n            vm.see_booking.end_time = moment(vm.see_booking.end).format(\"HH:mm\");\n\n            vm.see_booking.start_datetime = new Date(new Date(vm.see_booking.start).toUTCString());\n            vm.see_booking.end_datetime = new Date(vm.see_booking.end);\n            vm.see_booking.visible = 1;\n\n            vm.see_booking.after_booking_end = moment().isAfter(moment(vm.see_booking.end));\n\n            $scope.$apply();\n    };\n\n\n    $scope.close_details = function(){\n            vm.see_booking.visible = 0;\n    }\n\n\n    $scope.changeLang = function() {\n    \n        $scope.uiConfig.calendar.dayNames = [\"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\"];\n        $scope.uiConfig.calendar.dayNamesShort = [\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"];\n      \n    };\n\n    $scope.changed = function () {\n        // $log.log('Time changed to: ' + $scope.mytime);\n        $scope.check_plane_availability();\n    };\n\n    function j_changed() {\n        // $log.log('Time changed to: ' + $scope.mytime);\n        $scope.check_plane_availability();\n    };\n\n    $scope.check_plane_availability = function(){\n       \n        generate_datetimes();\n\n        //getALL?\n        var getA = (vm.new_booking.edit_booking == 1)? 1 : 0;\n        var plane_id = (vm.new_booking.plane_id > 0)? vm.new_booking.plane_id : 0;\n        if(vm.new_booking.plane && vm.new_booking.plane.id){\n            plane_id = vm.new_booking.plane.id;\n        }\n\n        console.log(\"START BOOKINGS 2\", vm.new_booking.start_datetime);\n        // //console.log(\"START\", moment(vm.new_booking.start_datetime).format(\"Y-M-D HH:mm\"));\n        // //console.log(\"END\", vm.new_booking.end_datetime);\n        console.log(vm.new_booking.start_datetime);\n        console.log(vm.new_booking.end_datetime);\n\n        console.log(\"START BOOKINGS 2\", new Date(vm.new_booking.start_datetime).toISOString());\n\n        var start_dt = new Date(vm.new_booking.start_datetime).toISOString();\n        var end_dt = new Date(vm.new_booking.end_datetime).toISOString();\n        var show_all = (vm.is_edit_show_all) ? 1 : 0;\n        BookingService.GetAllPlanes(vm.user.id, start_dt, end_dt, show_all, plane_id)\n        .then(function(data){\n           \n            //this gets the events and bookings for the period checked here...\n            // var events = data.events;\n            vm.planes = data;\n            \n\n            if(getA == 1){\n                //then I just want to iterate through these and return the plane already selected as \"available...\"\n\n                ////console.log(\"PLANE\", vm.new_booking.plane);\n\n                for(var i = 0; i<vm.planes.length; i++){\n                    if(vm.planes[i].id == vm.new_booking.plane.id){\n                        reset_chosen = 0;\n                        vm.new_booking.plane = vm.planes[i];\n                        //chosen is still available WOOOO\n                        $scope.check_rental_items();\n                    }\n                }\n\n\n\n            } else {\n\n                 //check if anything was already selected...\n                var reset_chosen = 1;\n                if(vm.new_booking.plane){\n                    for(var i = 0; i<vm.planes.length; i++){\n                        if(vm.planes[i].id == vm.new_booking.plane.id){\n                            reset_chosen = 0;\n                            //chosen is still available WOOOO\n                            $scope.check_rental_items();\n                        }\n                    }\n                    if(reset_chosen == 1){\n                        //then we just need to clear currently selected plane\n                        vm.new_booking.plane = {};\n                        delete(vm.new_booking.plane);\n                    }\n                    //otherwise we can leave that we've already done! :)\n                }\n\n\n            }\n\n        });\n\n    }\n\n    $scope.events = [];\n\n    function getDayClass(data) {\n        var date = data.date,\n          mode = data.mode;\n        if (mode === 'day') {\n          var dayToCheck = new Date(date).setHours(0,0,0,0);\n\n          for (var i = 0; i < $scope.events.length; i++) {\n            var currentDay = new Date($scope.events[i].date).setHours(0,0,0,0);\n\n            if (dayToCheck === currentDay) {\n              return $scope.events[i].status;\n            }\n          }\n        }\n\n        return '';\n      }\n\n\n    $scope.addOne = function(start=null, plane_id=null, end=null){\n        // //console.log(\"ADDING HERE --> with \", start);\n\n        if(start && !end){    \n            // var end = new Date(start);\n            // end.setHours(end.getHours() + 1); \n            // console.log(\"END::: \", end);            \n            end = moment(start).add(1, \"hour\").format();\n        }\n\n        // console.log(\"ADD ONE : \", plane_id);\n        // console.log(\"ADD ONE : \", start);\n        // console.log(\"ADD ONE : \", end);\n\n        \n\n        if(vm.action == \"list\" || vm.action == \"add\"){\n            console.log(\"add it yeah\");\n            vm.add_booking_event({\"start\": start, \"plane_id\": plane_id, \"end\": end});\n        } else if (vm.action == \"edit\") {\n            $state.go('dashboard.add_booking', {\"start\": start, \"plane_id\": plane_id, \"end\": end});\n        } else {\n\n        }\n        //IF ALREADY ON HERE --> \n\n        //OTHERWISE BELOW\n            //alert(end);\n        // $state.go('dashboard.add_booking', {\"start\": start, \"plane_id\": plane_id, \"end\": end});\n\n\n\n    }\n\n    $scope.cancel_changes = function(){\n        $state.go('dashboard.add_booking');\n    }\n\n    $scope.check_rental_items = function(){\n        generate_datetimes();\n\n        vm.rental_items = [];\n\n        if(vm.new_booking.plane){\n\n            var club_id = (vm.new_booking.edit_booking == 1) ? vm.new_booking.club_id : vm.new_booking.plane.club_id;\n            // var start_datetime = luxon.DateTime.fromISO( new Date(vm.new_booking.start_datetime) ).toISO();\n            // var end_datetime = luxon.DateTime.fromISO( new Date(vm.new_booking.end_datetime) ).toISO();\n\n            var start_datetime = new Date(vm.new_booking.start_datetime).toISOString();\n            var end_datetime = new Date(vm.new_booking.end_datetime).toISOString();\n\n            BookingService.GetRentalItems(club_id, start_datetime, end_datetime, 0)\n            .then(function(data){\n           \n                vm.rental_items = data;\n\n                if(vm.new_booking.rental_items){\n                    //then we may have shizzle to check / update\n                    for(var i=0;i<vm.new_booking.rental_items;i++){\n                        //first and foremost we need to check the available bits....\n                        var found = 0;\n                        for(var j=0;j<vm.rental_items.length;j++){\n                            if(vm.rental_items[j][\"id\"] == vm.new_booking.rental_items[i][\"id\"]){\n                                //then we need to check that the current numbers available are still the same as before...\n                                if(parseInt(vm.new_booking.rental_items[i][\"number_to_book\"]) > parseInt(vm.rental_items[j][\"number_available\"])){\n                                    vm.new_booking.rental_items[i][\"number_to_book\"] = parseInt(vm.rental_items[j][\"number_available\"]);\n                                }\n                                vm.new_booking.rental_items[i][\"number_available\"] = parseInt(vm.rental_items[j][\"number_available\"]);\n                                found = 1;\n                                break;\n                            }\n                        }\n                        if(found == 0){\n                            //then we need to remove it...\n                            delete vm.new_booking.rental_items[i];\n                        }\n\n                    }\n\n                }\n\n\n                for(var k=0; k<vm.rental_items.length;k++){\n                    vm.rental_items[k].number = 0;\n                }\n\n                //if there is one already selected?\n                //check if anything was already selected...\n                if(vm.new_booking.rental_items){\n                    for(var j=0; j<vm.new_booking.rental_items; j++){\n                        var reset_chosen = 1;\n                        for(var i = 0; i<vm.rental_items.length; i++){\n                            if(vm.rental_items[i].id == vm.new_booking.rental_items[j].id){\n                                reset_chosen = 0;\n                                //chosen is still available WOOOO\n                            }\n                        }\n                        if(reset_chosen == 1){\n                            //then we just need to clear currently selected plane\n                            delete vm.new_booking.rental_items[j];\n                        }\n                    }\n                    //otherwise we can leave that we've already done! :)\n                }\n\n\n\n\n            });\n\n        }\n    }\n\n    function check_times(clean_type = null){\n\n            var c = new Date();\n            var a = (vm.new_booking.start_time) ? vm.new_booking.start_time.time.split(\":\") : [c.getHours(), c.getMinutes()];\n            var b = new Date(vm.new_booking.start_date);\n            b.setHours(a[0]);\n            b.setMinutes(a[1]);\n            b.setSeconds(0);\n            var future = moment(b).add(1, \"hour\").format();\n\n            //check if the end_time is set && if the end time is > start time...\n            if(start_after_end() || !vm.new_booking.end_time){\n\n                clean_times(check_relative_date(vm.new_booking.end_date, \"end\"), 'end_times', b);\n\n                var id;\n                // vm.end_times.forEach(function(time, i){ \n                //   if(time.time == moment(future).format(\"H:mm\")){ id = i; return true;}; \n                // });\n                vm.end_times.some(function(time, i){ \n                  if(time.time == moment(future).format(\"H:mm\")){ id = i; return i;};  \n                });\n\n                vm.new_booking.end_time = {};\n                vm.new_booking.end_time = vm.end_times[id];\n\n            } else {\n                if(!clean_type){\n                    clean_times(check_relative_date(vm.new_booking.end_date, \"end\"), 'end_times', b);\n                } \n            }\n\n\n             //need to update the selection of the end time if this has been set\n            if(vm.new_booking.end_time && vm.new_booking.end_time.disabled == 1){\n\n                var id;\n                //used to use a forEach loop but decided to run a some loop instead due to the benefit of not going through all elements\n                // vm.end_times.forEach(function(time, i){ \n                //   if(time.time == moment(future).format(\"H:mm\")){ id = i; return true;}; \n                // });\n                vm.end_times.some(function(time, i){ \n                  if(time.time == moment(future).format(\"H:mm\")){ id = i; return i;};  \n                });\n\n                vm.new_booking.end_time = {};\n                vm.new_booking.end_time = vm.end_times[id];\n\n            }\n\n            if(vm.new_booking.start_time && vm.new_booking.start_time.disabled == 1){\n                if(!clean_type){\n               \n                var id;\n                vm.start_times.some(function(time, i){ \n                  if(time.disabled == 0){ id = i; return i;}; \n                });\n\n                vm.new_booking.start_time = {};\n                vm.new_booking.start_time = vm.start_times[id];\n                 } \n\n                calculate_duration();\n            }\n    }\n\n    $scope.update_dateTime = function(which_update, params=null){\n\n        ////console.log(\"UPDATE TIME HERE\", which_update);\n\n        switch(which_update){\n\n            case 'start_date':\n\n                booking_today();\n\n                if(vm.new_booking.start_date > vm.new_booking.end_date){\n                    vm.new_booking.end_date = vm.new_booking.start_date;\n                }\n\n                clean_times(check_relative_date(vm.new_booking.start_date), 'start_times');\n\n                check_times();\n\n                if(start_after_end()){\n                    add_hour_to_end();\n                }\n\n            break;\n\n            case 'end_date':\n\n                 booking_today();\n                \n                check_times();\n\n                if(vm.new_booking.end_date < vm.new_booking.start_date){\n                    vm.new_booking.start_date = vm.new_booking.end_date;\n                    clean_times(check_relative_date(vm.new_booking.start_date), 'start_times');\n                } else {\n                    clean_times(check_relative_date(vm.new_booking.start_date), 'start_times');\n                    clean_times(check_relative_date(vm.new_booking.end_date, \"end\"), 'end_times');\n                }\n\n                if(start_after_end()){\n                    add_hour_to_end();\n                }\n\n\n            break;\n\n            case 'start_time':\n\n                // alert(\"start_time\");\n                //do we need to clean the times? if so.. \n                booking_today();\n\n                check_times();\n\n                //we need to calculate the time in between the start and the end!\n                calculate_duration();\n                \n\n            break;\n\n            case 'end_time':\n                // vm.times_clean_type = \"start_times\";\n                // if(moment(vm.new_booking.start).unix() < moment().unix()){\n                //     vm.times_clean_type = \"past\";\n                // }\n                if(vm.times_clean_type == \"past\"){\n                    //alert(\"end_time\");\n                    check_times(\"edit\");\n                } else {\n                    check_times();\n                }\n\n\n            break;\n\n            case 'edit':\n                //alert(\"edit - 1\");\n\n                // //this is the edit function that needs to be setup.\n                // booking_today();\n\n                // //number 1 = we have set start and end of the current date....\n                // // setTimeout(function(){\n                // //     check_times();\n                // //     // calculate_duration();\n                // // }, 5000);\n                // //console.log(\"ASD \",vm.new_booking.start_date);\n                // // clean_times(check_relative_date(vm.new_booking.start_date), 'start_times');\n                // check_times();\n                // calculate_duration();\n                //alert(\"EDIT 1\");\n\n                vm.is_edit_show_all = true;\n //start_times\n                vm.times_clean_type = \"start_times\";\n                if(moment(vm.new_booking.start).unix() < moment().unix()){\n                    vm.times_clean_type = \"past\";\n                    //clean_times(check_relative_date(vm.new_booking.start_date), \"end_times\");\n                                \n\n\n                } else {\n                                check_times();\n                    booking_today();\n                }\n                calculate_duration();\n\n                setTimeout(function(){\n                    //do we need to clean the times? if so.. \n                    // pre_select_value_id(\"start_times\", vm.new_booking.start_time);\n                    pre_select_value_id();\n                    //we need to calculate the time in between the start and the end!\n                }, 500);\n\n\n\n\n                //we need to set the previously selected plane here...\n\n\n            break;\n\n            case 'edit2':\n                //alert(\"edit2\");\n                // //this is the edit function that needs to be setup.\n                // booking_today();\n\n                // //number 1 = we have set start and end of the current date....\n                // // setTimeout(function(){\n                // //     check_times();\n                // //     // calculate_duration();\n                // // }, 5000);\n                // //console.log(\"ASD \",vm.new_booking.start_date);\n                // // clean_times(check_relative_date(vm.new_booking.start_date), 'start_times');\n                // check_times();\n                // calculate_duration();\n\n                booking_today();\n\n                clean_times(check_relative_date(vm.new_booking.start_date), 'start_times');\n\n                check_times();\n\n                calculate_duration();\n\n                setTimeout(function(){\n                    //do we need to clean the times? if so.. \n                    // pre_select_value_id(\"start_times\", vm.new_booking.start_time);\n                    pre_select_value_id();\n                    //we need to calculate the time in between the start and the end!\n\n                     if(params){\n                        // alert(\"plane\");\n                        // alert(params);\n                        // //console.log(\"SELECT ME \", vm.planes);\n                                for(var i=0;i<vm.planes.length;i++){\n                                    // //console.log(\"I\", i);\n                                    // //console.log(\"id 1\", vm.planes[i].id);\n                                    // //console.log(\"I\", i);\n                                    if(parseInt(vm.planes[i].id) == params){\n                                        vm.new_booking.plane = vm.planes[i];\n                                        $scope.getPlaneInstructors(vm.new_booking.plane.id);\n                                         ////console.log(\"found\", vm.new_booking);\n                                         $scope.$apply();\n                                    }\n                                }\n                    }\n                    \n                }, 500);\n\n\n\n\n                //we need to set the previously selected plane here...\n\n\n            break;\n\n\n        }\n\n\n        //an update on the form would require an update of the plane / waiting lists available\n        $scope.check_plane_availability();\n\n        if(vm.new_booking.plane){\n            //then we check what is available for these guys!\n            $scope.check_rental_items();\n        }\n\n        //if the plane was already selected - then we can also update the instructors so as to not require\n        //the user to have to re-select the plane\n        if(vm.new_booking.plane){\n            $scope.getPlaneInstructors();\n        }\n\n\n\n\n        if(vm.new_booking.plane){\n            //let's update the visual representation of the booking on the right hand side\n            var booking_start = vm.new_booking.start_date;\n            var s_date = moment(vm.new_booking.start_date).format(\"Y-MM-DD\");\n            var s_time = vm.new_booking.start_time.time;\n            // //console.log(\"HERE : \", s_date);\n            // //console.log(\"HERE : \", s_time);\n            var n_start = moment(s_date + \" \" + s_time);\n\n            var e_date = moment(vm.new_booking.end_date).format(\"Y-MM-DD\");\n            var e_time = vm.new_booking.end_time.time;\n            var n_end = moment(e_date + \" \" + e_time);\n\n            // //console.log(\"HERE : \", n_start);\n            // //console.log(\"START HERE + \", vm.new_booking.start_date);\n            // //console.log(\"END HERE + \", vm.new_booking.end_date);\n            var new_event = {\n                                 \"id\":\"TEMP\",\n                                 \"title\":\"TEMPORARY\",\n                                 \"resourceId\": parseInt(vm.new_booking.plane.id),\n                                 \"start\":n_start,\n                                 \"end\":n_end,\n                                 \"editable\":false,\n                                 \"color\":\"rgb(255, 110, 110)\",\n                                 \"opacity\":\"1\"\n                              };\n                       \n\n            if(vm.already_added_temp){\n\n                    $('#calendar').fullCalendar(\"removeEvents\", \"TEMP\")\n                    setTimeout(function(){\n                        $('#calendar').fullCalendar('renderEvent', new_event);\n                    }, 150);\n\n\n            } else {\n\n\n               \n                $('#calendar').fullCalendar('renderEvent', new_event);\n                vm.already_added_temp = true;\n                                            \n\n\n            }\n        }\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n    }\n\n\n\n\n    function pre_select_value_id(){\n\n        vm.start_times.forEach(function(times, i){\n            // //console.log(times.time+\" == \"+vm.new_booking.start_time.time);\n            if(times.time == vm.new_booking.start_time.time){\n                // //console.log(\"THIS I \", i);\n                vm.new_booking.start_time = vm.start_times[i];\n            }\n\n        });\n        // //console.log(\"END\", vm.end_times);\n\n         vm.end_times.forEach(function(times, i){\n\n            if(times.time == vm.new_booking.end_time.time){\n                // //console.log(\"THIS I \", i);\n                vm.new_booking.end_time = vm.end_times[i];\n            }\n\n        });\n\n        $scope.$apply();\n\n    }\n\n    vm.decline_new_booking_error = function(){\n        vm.new_booking_errors = {};\n        $('#calendar').fullCalendar('removeEvents');\n        $('#calendar').fullCalendar('addEventSource', all_events);\n    }\n\n    vm.override_new_booking_errors = function(){\n        vm.new_booking.admin_override = true;\n        vm.new_booking_errors = {};\n        $scope.make_booking(true);\n    }\n\n\n\n\n\n    $scope.update_booking = function(valid){\n\n\n        //alert(\"UPDATE\");\n\n        generate_datetimes();\n\n        if(valid){\n\n                // //console.log(\"VALID SUBMISSION\");\n                // //console.log(\"START\", vm.new_booking.start_datetime);\n                // //console.log(\"END\", vm.new_booking.end_datetime);\n\n                var booking = {};\n                var booking = jQuery.extend(true, {}, vm.new_booking); \n                // //console.log(booking);\n                delete booking.options;\n                delete booking.instructor;\n                delete booking.plane;\n                delete booking.start_date;\n                delete booking.start_time;\n                delete booking.end_date;\n                delete booking.end_time;\n                delete booking.start_datetime;\n                delete booking.end_datetime;\n                delete booking.tuition_required;\n                delete booking.after_booking_end;\n                // //console.log(booking);\n                // //console.log(vm.new_booking);\n                booking.free_seats = (vm.new_booking.free_seats.constructor === Array) ? 0 : vm.new_booking.free_seats;\n                booking.start = vm.new_booking.start_datetime;\n                booking.end = vm.new_booking.end_datetime;\n\n                if(vm.new_booking.tuition_required && vm.new_booking.tuition_required.id > 0){\n                    booking.course_id = vm.new_booking.tuition_required.id;\n                }\n\n                booking.maintenance_flight = vm.new_booking.maintenance_flight;\n\n\n// Date.parse(vm.new_booking.start_datetime)\n\n                if(moment(Date.parse(vm.new_booking.end_datetime)).add(1, \"hour\").isBefore()){\n                    alert(\"This booking ends in the past by more than an hour - you cannot amend a booking that finished in the past.\");\n                    return false;\n                }\n                //30 mintues leeway in case of booking starting within the 15 minute period or similar\n                // if(moment(vm.new_booking.start_datetime).add(30, \"minutes\") < moment()){\n                //     alert(\"This booking starts in the past - you cannot create a booking in the past.\");\n                //     return false;\n                // }\n\n\n                // //console.log(\"START\", booking.start);\n                // //console.log(\"END\", booking.end);\n\n                ////console.log(\"PLANE\", vm.new_booking.plane);\n                booking.resourceId = vm.new_booking.plane.id;\n\n                if(vm.new_booking.plane.id.toString().indexOf(\"w\") > -1){\n                    booking.changed_to_waiting_list = true;\n                    booking.resourceId = vm.new_booking.plane.id.slice(0, -1);\n                }\n\n                if(!vm.booking_self){\n                    booking.user_id = vm.new_booking.user.user_id;\n                    booking.instructor_id = (vm.new_booking.instructor) ? vm.new_booking.instructor.id : 0;\n                } else {\n                    booking.user_id = vm.user.id;\n                    booking.instructor_id = (vm.new_booking.instructor) ? vm.new_booking.instructor.id : 0;\n                }\n                \n                console.log(\"vm.new_booking.plane\", vm.new_booking);\n\n                booking.plane_id = vm.new_booking.plane.id;\n                booking.override = (vm.new_booking.override) ? vm.new_booking.override : 0;\n                booking.club_id = vm.new_booking.club_id;\n\n                // //console.log(\"====> booking to be sent = \", booking);\n\n                check_before_changing_event(booking);\n\n        }\n\n    }\n\n    $scope.update_club = function(){\n            console.log(\"we changed club here\");\n            vm.club_id = vm.change_club.id;\n                // //console.log(\"CLUB ID IS :\", vm.club_id);\n                if(vm.user.access.instructor.indexOf(vm.club_id) > -1){\n                    // //console.log(\"THIS IS AN INSTRUCTOR IN THIS CLUB...\");\n                    vm.booking_self = false;\n                }\n            //now we need to update the planes the user can see on the calendar! \n            update_bookings();\n\n    }\n\n    function update_bookings(){\n\n\n         // BookingService.GetAllUserClub(vm.user.id,vm.club_id, moment().format(\"Y-M-D\"), \"\")\n         //        .then(function(data){\n                   \n         //            $scope.all_events = data.events;\n         //            $scope.all_resources = data.resources;\n\n         //        });\n\n         // //console.log(\"UPDATE BOOKINGS \");\n         BookingService.GetAll(vm.user.id, moment().format(\"Y-MM-DD\"), \"\")\n        .then(function(data){\n            // //console.log(data);\n\n            $scope.all_events = data.events;\n            $scope.all_resources = data.resources;\n\n            // //console.log(\"hello\", $scope.all_events);\n            // //console.log(\"hello\", $scope.all_resources);\n\n            return data;\n\n        });\n\n    }\n\n    /* alert on eventClick */\n    $scope.alertOnEventClick = function( date, jsEvent, view){\n        //alert(\"cliekd \");\n        $scope.alertMessage = (date.title + ' was clicked ');\n        // //console.log(\"HELLO BOOBIES\");\n        // //console.log(event);\n        //show event details\n\n    };\n\n    /* alert on Drop */\n     $scope.alertOnDrop = function(event, delta, revertFunc, jsEvent, ui, view){\n  \n\n        if(event.resourceId){\n            if(event.resourceId.toString().indexOf(\"w\") > -1){\n                event.changed_to_waiting_list = true;\n                event.resourceId = event.resourceId.slice(0, -1);\n            }\n        } else if(event.resourceIds){\n            for(var i=0;i<event.resourceIds.length;i++){\n                if(event.resourceIds[i].toString().indexOf(\"w\") > -1){\n                    event.changed_to_waiting_list = true;\n                    event.resourceIds[i] = event.resourceIds[i].slice(0, -1); //remove the w and set as w?\n                }\n            }\n\n        }\n        \n\n        // //console.log(\"HELLO BOOBIES\", event);\n\n\n        check_before_changing_event(event);\n       \n    };\n\n\n    /* alert on Resize */\n    $scope.alertOnResize = function(event, delta, revertFunc, jsEvent, ui, view ){\n        \n        check_before_changing_event(event);\n\n    };\n\n\n\n    $scope.override_booking_change = function(override){\n\n        vm.error_event[override] = true;\n        //vm.error_event.override = true;\n\n        check_before_changing_event(vm.error_event, true);\n\n\n    }\n\n    $scope.override_booking_change2 = function(override){\n\n        vm.error_event.admin_override = true;\n        //vm.error_event.override = true;\n\n        check_before_changing_event(vm.error_event, true);\n\n\n    }\n\n    $scope.decline_booking_change = function(){\n\n        vm.booking_errors = {};\n        vm.error_event = {};\n        $('#calendar').fullCalendar('removeEvents');\n        $('#calendar').fullCalendar('addEventSource', all_events);\n\n    }\n\n\n    function check_before_changing_event(event, err=null){\n        //the important bit is the eventID \n\n       if(err){\n         vm.booking_errors = {};\n            vm.error_event = {};\n       }\n\n        var evnt = jQuery.extend({}, event);\n\n        // evnt.start = moment(evnt.start).format(\"YYYY-MM-DD HH:mm\");\n        // evnt.end = moment(evnt.end).format(\"YYYY-MM-DD HH:mm\");\n        \n        // console.log(\"here\");\n\n        //this covers the change of plane for the booking...\n        if(event.resourceId && event.resourceId !== \"\"){\n            evnt.plane_id = event.resourceId;\n        } else if(event.resourceIds && event.resourceIds.length > 0){\n            for(var i=0;i<event.resourceIds.length;i++){\n                if(event.resourceIds[i].indexOf(\"fi\") == -1){\n                    evnt.plane_id = event.resourceIds[i];\n                }\n            }\n        } else {\n            console.log(\"EVENT HAS AN ISSUE WITH RESORUCE ID...\");\n        }\n        \n        if(event.instructor_id !== \"\"){\n            evnt.instructor_id = event.instructor_id;\n        } else {\n            evnt.instructor_id = \"0\";\n        }\n        //updatable bits:\n\n        delete evnt._start;\n        delete evnt._end;\n        delete evnt._id;\n        delete evnt.source;\n        delete evnt._allDay;\n        delete evnt.allDay;\n        delete evnt.className;\n        delete evnt.plane;\n        delete evnt.title;\n        delete evnt.editable;\n        delete evnt.resourceId;\n        delete evnt.resourceIds;\n        evnt.update_rental_items = true;\n\n        // //console.log(\"EVENT CHANGE\", evnt);\n\n        var original_event;\n        for(var i=0; i<$scope.all_events.length;i++){\n            if($scope.all_events[i].id == evnt.id){\n                original_event = $scope.all_events[i];\n                // //console.log(\"original EVENT\", original_event);\n            }\n        }\n\n\n        // //console.log(\"original end: \", moment(original_event.end).unix());\n        // //console.log(\"new end is : \", evnt.end.unix());\n\n        // //console.log(\"1original start: \", original_event.start);\n        // //console.log(\"1new start is : \", evnt.start);\n\n        // //console.log(\"2original start: \", moment(original_event.start).unix());\n        // //console.log(\"2new start is : \", evnt.start.unix());\n\n        // //console.log(\"1original start again: \", original_event.start);\n\n\n        //event in the past cannot be amended AFTER the booking - but the booking can be exte\n\n        // //console.log(\"all_events\", $scope.all_events);\n\n        if(moment(Date.parse(evnt.end)) < moment()){\n            alert(\"This booking ends in the past - you cannot amend a booking in the past.\");\n            return false;\n        }\n        // 30 mintues leeway in case of booking starting within the 15 minute period or similar\n        if(moment(evnt.start).add(30, \"minutes\") < moment()){\n                // //console.log(\"start is older than 30 minutes ago\");\n                // //console.log(\"1original start again: \", original_event.start);\n\n            if(moment(original_event.end) !== evnt.end){\n                // //console.log(\"end is not the same end\");\n                // //console.log(\"original end: \", moment(original_event.end).unix());\n                // //console.log(\"new end is : \", evnt.end.unix());\n\n                var p = confirm(\"This booking starts in the past - you cannot amend the start date or time of a booking in the past, would you like to amend the end time along with any other changes you have made?\");\n                if(p){  \n                    // //console.log(\"START UPDATE = \",evnt.start );\n                    evnt.start = original_event.start;\n                    // //console.log(\"START UPDATE = \",evnt.start );\n                } else {\n                    return false;\n                }\n\n            }\n\n\n\n\n            //let's reset the booking'start time\n\n           \n\n\n\n\n           // return false;\n        }\n\n        // //console.log(\"UPDATE CONTENT BEFORE\", evnt);\n\n        BookingService.updateBooking(evnt, vm.user.id)\n        .then(function(data){\n            // //console.log(data);\n\n            if(data.success == true){\n                // //console.log(\"the booking did not need to be altered and has been updated successfully.\", evnt);\n\n                //only if the edition is being made from the \"edit\" otherwise the changes are already reflected appropriately.\n                if(evnt.edit_booking == 1){\n                    //$scope.$parent.updateEvents(evnt.start, evnt.end);\n                }\n                \n                alert(\"Your changes were saved successfully\");\n                \n                if(vm.return_to == \"bookout\") {\n                    // //console.log(\"WE ARE AT THE BOOKOUT BIT - SO RETURN THERE!!!\");\n                    $state.go('dashboard.my_account.bookout_with_booking', { \"booking_id\": event.id });\n                } else {\n                    // //console.log(\"NORMAL booking\");\n                    $state.go('dashboard.add_booking');\n                }\n\n\n\n            } else {\n                //display the error\n                //console.log(\"The booking cannot remain the same due to : \"+data.message);\n\n                //hollow :::     $(\"#calendar\").fullCalendar('refetchEvents');\n\n\n                //I have decided to do this as a sequential check / accept / decline as opposed to combined\n                //this can be altered at a later date to be combined, with accept / decline on each error\n                //but this is more work than i can do right now!\n\n                var errors = [];\n                if(data.instructor !== true){\n                    errors.push({\n                        type: \"instructor\",\n                        message: \"It looks like your instructor is not available on the updated date and time\",\n                        api: data.instructor,\n                        override: \"instructor_override\",\n                        can_override: data.can_override,\n                        button: \"OVERRIDE INSTRUCTOR AVAILABILITY\" \n                    });\n                } else if(data.check_user !== true){\n\n                    if(data.check_user.indexOf(\"self-certify\") > -1){\n\n                        errors.push({\n                            type: \"check_user\",\n                            message: \"It would appear that you are not within the currency requirements to book this aircraft for this flight.\",\n                            api: data.check_user,\n                            override: \"currency_override\",\n                            button: \"I am Current\" \n                        });\n\n\n                    } else {\n                        errors.push({\n                            type: \"check_user\",\n                            message: \"It looks like your user account does not allow this booking to happen\",\n                            api: data.check_user,\n                            override: \"currency_override\",\n                            can_override: data.can_override,\n                            button: \"\" \n                        });\n                    }\n\n                   \n                } else if(data.rental_items !== true){\n                    errors.push({\n                        type: \"rental_items\",\n                        message: \"It looks like some of the rental items are not available\",\n                        api: data.rental_items,\n                        override: \"update_rental_items\",\n                        button: \"Confirm Changes\" \n                    });\n                }\n\n\n                //show the errors:::\n\n                // alert(\"ERROR FOUND IN ALTERING THE BOOKING\");\n\n                vm.booking_errors = errors;\n                //console.log(\"ERRORS ARE : \", vm.booking_errors);\n                vm.error_event = evnt;\n\n                //on GO--> check_before_changing_event(evnt)    \n\n\n                //if CANCEL?\n                //this would reset the change... do we want this?\n                //$(\"#calendar\").fullCalendar('refetchEvents');\n\n\n\n            }\n\n            return data;\n\n        });\n\n    }\n\n    $scope.wholeDay = function(){\n\n       if($scope.whole_day_booking == true){\n            $scope.whole_day_booking = false;\n            $scope.myDatetimeRange.time.from = defaultStartTime;\n            $scope.myDatetimeRange.time.to = defaultEndTime;\n       } else {\n            $scope.whole_day_booking = true;\n            $scope.myDatetimeRange.time.from = 0;\n            $scope.myDatetimeRange.time.to = 1440;\n       }\n       \n\n    }\n\n    //Changing the view of the calendar\n    $scope.changeView = function(view,calendar) {\n      uiCalendarConfig.calendars[calendar].fullCalendar('changeView',view);\n    };\n\n    /* Change View */\n    $scope.renderCalender = function(calendar) {\n      $timeout(function() {\n        if(uiCalendarConfig.calendars[calendar]){\n          uiCalendarConfig.calendars[calendar].fullCalendar('render');\n        }\n      });\n    };\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n    /* THIS SECTION IS ABOUT THE ADD / EDIT OF THE CALENDAR EVENTS VIA THE EDIT / ADD NEW BOOKING */\n\n    /* ADD OR EDIT THE BOOKING */\n\n    function figure_out_steps(){\n        // //console.log(\"OPTIONS\", vm.dateTimeRangePickerOptions);\n        vm.new_booking.options = vm.dateTimeRangePickerOptions;\n         for(var i=0;i<24;i+=vm.new_booking.options.hour_step){\n\n            if(vm.new_booking.options.minute_step && vm.new_booking.options.minute_step > 0){\n                for(var j=0; j<(60/vm.new_booking.options.minute_step); j++){\n                    var k = vm.new_booking.options.minute_step * j;\n                    k = ((k < 10) ? '0' : '') + k;\n                    vm.start_times.push({time: i+\":\"+k, disabled: check_business_hours(i, k)});\n                    vm.end_times.push({time: i+\":\"+k, disabled: check_business_hours(i, k), duration: \"\"});\n                }\n            } else {\n                vm.start_times.push({time: i+\":00\", disabled: check_business_hours(i)});\n                vm.end_times.push({time: i+\":00\", disabled: check_business_hours(i), duration: \"\"});\n            }\n\n        }\n    }\n\n    function init_times(){\n       for(var i=0;i<24;i+=vm.new_booking.options.hour_step){\n\n            if(vm.new_booking.options.minute_step && vm.new_booking.options.minute_step > 0){\n                for(var j=0; j<(60/vm.new_booking.options.minute_step); j++){\n                    var k = vm.new_booking.options.minute_step * j;\n                    k = ((k < 10) ? '0' : '') + k;\n                    vm.start_times.push({time: i+\":\"+k, disabled: check_business_hours(i, k)});\n                    vm.end_times.push({time: i+\":\"+k, disabled: check_business_hours(i, k), duration: \"\"});\n                }\n            } else {\n                vm.start_times.push({time: i+\":00\", disabled: check_business_hours(i)});\n                vm.end_times.push({time: i+\":00\", disabled: check_business_hours(i), duration: \"\"});\n            }\n\n        } \n    }\n    \n\n    $scope.add_rental_item = function(){\n        if(vm.rental_item && vm.new_booking.rental_items && vm.rental_item.id){\n            var add_to_list = 1;\n            var delete_this = 0;\n            for(var j=0; j<vm.new_booking.rental_items.length; j++){\n                if(vm.new_booking.rental_items[j].id == vm.rental_item.id){\n                    add_to_list = 0;\n                    delete_this = vm.new_booking.rental_items[j];\n                    // //console.log(\"item was already found there...\");\n                }\n            }\n            if(add_to_list == 1){\n                //then its not already in teh list!\n                vm.new_booking.rental_items.push(vm.rental_item);\n                delete vm.rental_item;\n\n            }\n\n        } else {\n            if(vm.rental_item){\n                // //console.log(\"rental_item is: \", vm.rental_item);\n                if(!vm.new_booking.rental_items){\n                    //init here if its the first item...\n                    vm.new_booking.rental_items = [];\n                }\n                vm.new_booking.rental_items.push(vm.rental_item);\n                delete vm.rental_item;\n            }\n               \n        }\n\n    }\n\n\n    $scope.rental_item_remove = function(id){\n        //as this is before we actually do the shizzle!\n        vm.new_booking.rental_items = $.grep(vm.new_booking.rental_items, function(e){ \n                return e.id != id; \n        });\n    }\n\n\n\n    $scope.getPlaneInstructors = function(){\n\n\n        // //console.log(\"CHANGE OF PLANE HERE\");\n\n\n        if((vm.user.access.instructor.indexOf(vm.club_id) > -1) || (vm.user.access.manager.indexOf(vm.club_id) > -1) ){\n            // //console.log(\"NOT BOOKING FOR SELF?\");\n            vm.booking_self = false;\n            prepare_add_edit();\n        }\n\n        if( vm.user.access.manager.indexOf(vm.club_id) > -1 ){\n            vm.booking_admin = true;\n\n        }\n\n        // vm.init_passengers();\n        $scope.check_rental_items();\n\n         //FROM TO\n        // var from = moment.utc( vm.new_booking.start_datetime ).toISOString();//luxon.DateTime.fromISO(moment(vm.new_booking.start_datetime).toISOString()).setZone(\"Europe/London\").toFormat(\"YYYY-MM-DDThh:mm:ssZ\");\n        // var to = moment.utc( vm.new_booking.end_datetime ).toISOString();//luxon.DateTime.fromISO(moment(vm.new_booking.start_datetime).toISOString()).setZone(\"Europe/London\").toFormat(\"YYYY-MM-DDThh:mm:ssZ\");\n        //var to = luxon.DateTime.fromISO(vm.new_booking.end_datetime).setZone(\"Europe/London\").toFormat(\"YYYY-MM-DDThh:mm:ssZ\");\n        // console.log(\"FROM : \", from);\n        // console.log(\"TO : \", to);\n\n        var from = new Date(vm.new_booking.start_datetime).toISOString();//moment.utc( vm.new_booking.start_datetime ).toISOString();//luxon.DateTime.fromISO(moment(vm.new_booking.start_datetime).toISOString()).setZone(\"Europe/London\").toFormat(\"YYYY-MM-DDThh:mm:ssZ\");\n        var to = new Date(vm.new_booking.end_datetime).toISOString();// moment.utc( vm.new_booking.end_datetime ).toISOString();//luxon.DateTime.fromISO(moment(vm.new_booking.start_datetime).toISOString()).setZone(\"Europe/London\").toFormat(\"YYYY-MM-DDThh:mm:ssZ\");\n        \n\n        if(vm.action == \"add\"){\n\n          \n           \n            var show_all = (vm.is_edit_show_all) ? 1 : ( (vm.booking_self)? 0 : 1 );\n\n            BookingService.GetPlaneInstructors(vm.user.id, vm.new_booking.plane.id, from, to, show_all)\n            .then(function(data){\n                // //console.log(data);\n                // //console.log(\"NEW INSTRUCTORS ARE : \", data);\n                vm.instructors = data;\n\n                var reset_chosen = 1;\n                if(vm.new_booking.instructor){\n                    for(var i = 0; i<vm.instructors.length; i++){\n                        if(vm.instructors[i].id == vm.new_booking.instructor.id){\n                            reset_chosen = 0;\n                        }\n                    }\n                    if(reset_chosen == 1){\n                        //then we just need to clear currently selected plane\n                        vm.new_booking.instructor = {};\n                        delete(vm.new_booking.instructor);\n                    }\n                    //otherwise we can leave that we've already done! :)\n                }\n                free_places();\n            });\n\n\n        } else {\n            //must be edit... sooooooo\n            var show_all = (vm.is_edit_show_all) ? 1 : ( (vm.booking_self)? 0 : 1 );\n            //(vm.booking_self)? 0 : 1\n            BookingService.GetPlaneInstructorsEdit(vm.user.id, vm.new_booking.plane.id, from,  to, show_all, vm.new_booking.id)\n            .then(function(data){\n                // //console.log(data);\n                // //console.log(\"NEW INSTRUCTORS ARE : \", data);\n\n\n                vm.instructors = data;\n\n                var reset_chosen = 1;\n                if(vm.new_booking.instructor){\n                    for(var i = 0; i<vm.instructors.length; i++){\n                        if(vm.instructors[i].id == vm.new_booking.instructor.id){\n                            reset_chosen = 0;\n                        }\n                    }\n                    if(reset_chosen == 1){\n                        //then we just need to clear currently selected plane\n                        vm.new_booking.instructor = {};\n                        delete(vm.new_booking.instructor);\n                    }\n                    //otherwise we can leave that we've already done! :)\n                }\n                free_places();\n            });\n\n        }\n\n\n        // InstructorCharges.GetByClubId(vm.new_booking.plane.club_id)\n        //         .then(function(data){\n        //             vm.instructor_charges = data.items;  \n        //             ////console.log(\"====> \", data); \n        //         });\n\n         CourseService.GetCoursesByClubId(vm.new_booking.plane.club_id)\n                    .then(function(data){\n                        vm.courses = data.items;   \n                    });\n\n\n        // //console.log(\"vm.new_booking.plane.club_id\", vm.new_booking.plane.club_id);\n        // //console.log(\"vm.new_booking.plane.club_id\", vm.user.access.instructor);\n        // //console.log(\"INDEX :: \", vm.user.access.instructor.indexOf(parseInt(vm.new_booking.plane.club_id)));\n        \n        // if(vm.user.access.instructor.indexOf(parseInt(vm.new_booking.plane.club_id)) > -1){\n        //     //console.log(\"THIS IS AN INSTRUCTOR IN THIS CLUB...\");\n        //     vm.booking_self = false;\n        // }\n\n\n\n        var end_dt = new Date(vm.new_booking.end_datetime);\n        \n\n        //if is_current getPlaneInstructors\n        BookingService.GetIfCurrent(vm.user_id, vm.new_booking.plane.id, end_dt.toISOString())\n        .then(function (data) {\n            ////console.log(data);\n            if(data.success){\n                //use GB airfields first...\n                vm.is_current = data.is_current;\n                // //console.log(\"CURRENCY \", vm.is_current);\n\n                vm.currency_type = data.requirements.currency_type;\n                vm.currency_days = data.requirements.currency_days;\n            } else {\n            }\n        });\n        \n\n        \n\n    }\n\n\n    function free_places(){\n        // //console.log(\"UPDATE FREE PLACES...\", vm.new_booking.passengers.length);\n        // //console.log(\"UPDATE FREE PLACES...\", vm.new_booking.instructor);\n\n        vm.free_seats = [];\n        console.log(\"NEW_BOOKING - PLANE: \", vm.new_booking.plane);\n        var seats = parseInt(vm.new_booking.plane.seats) - 1;\n\n        if(vm.new_booking.instructor){\n            if(vm.new_booking.instructor.id > 0){\n                // //console.log(\"the instructor was selected for this flight...\");\n                seats--;\n            }\n        }\n\n        if(vm.new_booking.passengers.length > 0){\n            for(var i=0;i<vm.new_booking.passengers.length;i++){\n                if(vm.new_booking.passengers[i] && vm.new_booking.passengers[i][\"email\"] !== \"\"){\n                    seats--;\n                }\n            }\n        }\n\n        vm.free_seats = [];\n        for(var i=0; i<seats;i++){\n            vm.free_seats.push(i);\n        }\n\n        // //console.log(\"free seats now...\", vm.free_seats);\n\n        // $scope.$apply();\n\n    }\n\n\n    $scope.clear_booking = function(){\n        vm.new_booking = {\n            start_date: today,\n            end_date: today,\n            free_seats: [],\n            passengers: [],\n            instructor: undefined,\n            options: vm.dateTimeRangePickerOptions\n        };\n        $scope.submitted = false;\n    }\n\n    function calculate_duration(){\n        if(vm.new_booking.start_date && vm.new_booking.start_time){\n            var start_datetime = new Date(vm.new_booking.start_date);\n            var start_time = vm.new_booking.start_time.time.split(\":\");\n            start_datetime.setHours(start_time[0]);\n            start_datetime.setMinutes(start_time[1]);\n            start_datetime.setSeconds(0);\n            // //console.log(\"START DATETIME\", start_datetime);  \n\n            vm.end_times.forEach(function(time, i){ \n                //no need to go through each element if its not required to be shown!\n                if(time.disabled == 0){\n\n                    var end_datetime = new Date(vm.new_booking.end_date);\n                    var end_time = time.time.split(\":\");\n                    end_datetime.setHours(end_time[0]);\n                    end_datetime.setMinutes(end_time[1]);  \n                    end_datetime.setSeconds(0);\n                    // //console.log(\"END DATETIME\", end_datetime);  \n\n                    var difference = moment(moment(end_datetime).startOf(\"minute\")).diff(moment(start_datetime).startOf(\"minute\"));\n\n                    //now we need to calculate the difference in datetime\n                    // //console.log(\"d: \"+moment.duration(difference).days()+\" h: \"+moment.duration(difference).hours()+\" m: \"+moment.duration(difference).minutes());\n                    var human_str = get_duration_str(difference);\n                    // //console.log(\"human string\", human_str);\n                    if(human_str == \"\"){\n                        vm.end_times[i].disabled = 1;\n                    } else {\n                        vm.end_times[i].duration = \"( \"+human_str+\" )\";\n                    }\n\n\n                } else {\n                    vm.end_times[i].duration = \"\";\n                }\n              //if(time.time == moment(future).format(\"H:mm\")){ id = i; return true;}; \n            });\n        }\n    }\n\n    vm.seats_in_plane = function(){\n            free_places();\n\n            //base\n            var no_seats = vm.new_booking.plane.seats;\n\n            //check if instructor aboard?\n            if(vm.new_booking.instructor){   \n                no_seats--;\n            }\n\n            //include self\n            no_seats--;\n\n            // //console.log(\"seats left\", no_seats);\n\n\n            //return final number\n            return no_seats;\n        }\n\n        // vm.adding_a_member = function(){\n        //     // //console.log(\"ADDING ONE?\");\n        //     //vm.init_passengers();\n        //     vm.new_booking.passengers.push({\n        //             first_name: \"\",\n        //             last_name: \"\",\n        //             email: \"\",\n        //             status: \"\"\n        //         });\n        // }\n\n        // vm.init_passengers = function(){\n        //     var no_of_seats = vm.seats_in_plane();\n        //     // var already_filled = 0;\n        //     // for(var i=0;i<vm.new_booking.passengers.length;i++){\n        //     //         if(vm.new_booking.passengers[i] && vm.new_booking.passengers[i][\"email\"] !== \"\"){\n        //     //             already_filled++;\n        //     //         }          \n        //     // };\n        //     // var cc = no_of_seats - already_filled;\n        //     // // //console.log(\"CCCC seats -> \",no_of_seats);\n        //     // // //console.log(\"CCCC already_filled -> \",already_filled);\n        //     // // //console.log(\"CCCC -> \",cc);\n        //     // if(cc > 0){\n        //     if(vm.new_booking.passengers.length == 0){\n        //         // console.log(\"original push\");\n        //         vm.new_booking.passengers.push({\n        //             first_name: \"\",\n        //             last_name: \"\",\n        //             email: \"\",\n        //             status: \"\"\n        //         });\n        //     } else {\n        //         // console.log(\"new push\");\n        //         for(var i=0;i<=vm.new_booking.passengers.length;i++){\n        //             // console.log(\"pax forloop\");\n        //             if(vm.new_booking.passengers[i] && vm.new_booking.passengers[i].email == '' && vm.new_booking.passengers[i].status == ''){\n        //                 //all good\n        //                 // console.log('we have an empty one');\n\n        //             } else {\n        //                 if(vm.new_booking.passengers.length == i){\n        //                     // console.log('add new blank');\n        //                     vm.new_booking.passengers.push({\n        //                         first_name: \"\",\n        //                         last_name: \"\",\n        //                         email: \"\",\n        //                         status: \"\"\n        //                     });\n        //                     break;\n        //                 } else {\n        //                     // console.log(\"no need?\");\n        //                 }\n        //             }\n        //         }\n        //     }\n            \n        // }\n\n        var setting_new_member;\n\n\n        vm.invite_new_passenger = function(index){\n\n            // //console.log(\"HERE\");\n            // //console.log(vm.new_pax);\n\n             if(vm.new_pax && vm.new_pax.email !== \"\" && vm.new_pax.is_member == false){\n\n\n                 //send a single invitation to join the gang....\n                 vm.new_pax.invited_by = vm.user.id;\n\n\n                 BookoutService.AddPassenger(vm.new_pax, $stateParams.booking_id)\n                .then(function (data) {\n                    // //console.log(data);\n                    if(data.success){\n                       alert(\"INVITATION SENT!\");\n                        vm.update_passenger_list();\n                        vm.show_new_passenger_invitation = false;\n                    }\n                });\n\n\n\n\n\n\n             } else {\n                 alert(\"Please enter a valid email address to send the invitation to.\");\n             }\n           \n\n\n        }\n\n\n\n\n\n        vm.add_new_passenger = function(index){\n\n            console.log(\"ADD NEW PAX\");\n            console.log(vm.new_pax);\n\n            if(vm.new_pax.is_member){\n\n\n                //then we already have everything we need and we just invite them separately\n                // var to_send = {\n                //     booking_id: $stateParams.booking_id,\n                //     club_id: vm.club_id\n                // }\n                vm.new_pax.club_id = vm.club_id;\n                vm.new_pax.invited_by = vm.user.id;\n\n\n                vm.new_booking.passengers.push(vm.new_pax);\n\n                // //add passenger to booking\n                // BookoutService.AddPassenger(vm.new_pax, $stateParams.booking_id)\n                // .then(function (data) {\n                //     // //console.log(data);\n                //     if(data.success){\n                       \n\n\n                //         //let's call the update on the passengers\n                //         vm.update_passenger_list();\n\n\n\n\n                //     }\n                // });\n\n\n\n\n            } else {\n                vm.show_new_passenger_invitation = true;\n            }\n\n           \n\n\n        }\n\n\n        vm.new_pax = {\n                        id: 0,\n                        email: \"\",\n                        first_name: \"\",\n                        last_name: \"\",\n                        is_member: false,\n                        status: \"\",\n                        not_found: true\n                    };\n\n        vm.close_passenger_invitation = function(){\n            vm.show_new_passenger_invitation = false;\n        }\n\n\n        var set_new_member = function(email, index){\n            // //console.log(\"SET MEMBER NOW 123\");\n            vm.new_booking.passengers[index] = {\n                                id: 0,\n                                email: email,\n                                first_name: \"\",\n                                last_name: \"\",\n                                is_member: false,\n                                status: \"to_invite\"\n                            };\n            // //console.log(\"HELLO\");\n            //vm.init_passengers();\n            free_places();\n        }\n\n        vm.get_pax_class = function(status, is_member){\n            console.log(\"STATUS:: \", status);\n            /*\n              <i class=\"fa fa-envelope fastatus\" ng-if=\"vm.new_booking.passengers[$index].status == 'to_invite'\"></i>\n              <i class=\"fa fa-envelope-open-text fastatus\" ng-if=\"vm.new_booking.passengers[$index].status == 'invited'\"></i>\n              <i class=\"fa fa-check-square fastatus ok\" ng-if=\"vm.new_booking.passengers[$index].status == 'member'\"></i>\n              <i class=\"fa fa-check-square fastatus ok\" ng-if=\"vm.new_booking.passengers[$index].status == 'accepted'\"></i>\n              <i class=\"fa fa-check-square fastatus ok\" ng-if=\"vm.new_booking.passengers[$index].is_member\"></i>\n              <i class=\"fa fa-times fastatus\" ng-if=\"vm.new_booking.passengers[$index].status == 'declined'\"></i>\n    .success_pax_invitation{\n    background: rgba(80, 175, 70, 0.7);\n    border-radius: 10px;\n    padding: 10px;\n    margin: 10px 0;\n}\n\n.waiting_pax_invitation{\n    background: rgba(255, 230, 108, 0.7);\n    border-radius: 10px;\n    padding: 10px;\n    margin: 10px 0;\n}\n\n.declined_pax_invitation{\n    background: rgba(217, 83, 79, 0.7);\n    border-radius: 10px;\n    padding: 10px;\n    margin: 10px 0;\n}\n\n\n            */\n            if(status == 'to_invite'){\n                return 'waiting_pax_invitation';\n            } else if(status == 'invited'){\n                return 'waiting_pax_invitation';\n            } else if(status == 'member'){\n                return 'success_pax_invitation';\n            } else if(status == 'accepted'){\n                return 'success_pax_invitation';\n            } else if(status == 'is_member'){\n                return 'success_pax_invitation';\n            } else if(status == 'declined'){\n                return 'declined_pax_invitation';\n            }\n\n            if(!status && is_member){\n                return 'success_pax_invitation';\n            }\n\n\n            return 'new_pax_invitation';\n        }\n\n        vm.new_passenger_invite_ready = function(index){\n\n            //let's check the email address -->\n             // \n            var email_regex = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n            \n            //vm.new_pax ??\n            //then add vm.new_pax to the passengers?\n\n            if(email_regex.test(vm.new_pax.email)){\n\n                // //console.log(\"SET MEMBER NOW 123\");\n                vm.new_pax.is_member = false;\n                vm.new_pax.status = \"to_invite\";\n\n                vm.new_booking.passengers.push(vm.new_pax);\n\n\n                vm.new_pax = {\n                    id: 0,\n                    email: \"\",\n                    first_name: \"\",\n                    last_name: \"\",\n                    is_member: false,\n                    status: \"\",\n                    not_found: true\n                };\n\n                // //console.log(\"HELLO\");\n                //vm.init_passengers();\n               // free_places();\n                vm.show_new_passenger_invitation = false;\n            } else {\n                alert(\"The email address appears to be incorrect - please double check the email address entered.\");\n                return false;\n            }\n        }\n\n        vm.remove_passenger = function(index){\n            console.log(\"hi\");\n            vm.new_booking.passengers.splice(index, 1);\n\n        }\n\n\n        $scope.cancel_booking = function(booking_id){\n\n            //HOW DO WE CANCEL A BOOKING???\n            //at some point we need to define the booking cancellation reasons here (and make a nice popup style cancel)\n\n            var a = prompt(\"Are you sure you wish to cancel this booking? Please type YES in the box below to confirm.\");\n            if(a == \"YES\"){\n                //then we need to delete the booking... \n\n            BookingService.DeleteBooking(vm.user.id, booking_id)\n            .then(function(data){\n                // //console.log(data);\n                alert(\"booking cancelled\");\n\n                if(data.success){\n                    $state.go('dashboard.add_booking');\n                    \n                     $scope.all_events = $.grep($scope.all_events, function(e){ \n                        return e.id != booking_id; \n                    });\n\n                    $('#calendar').fullCalendar('refetchEvents');\n                    $('#calendar').fullCalendar('removeEvents');\n                    $('#calendar').fullCalendar('addEventSource', $scope.all_events);\n\n                } else {\n                    alert(\"an error occurred...\");\n                    // //console.log(\"ERROR\", data);\n                }\n\n            });\n\n\n            } else {\n                $state.go('dashboard.add_booking');\n            }\n\n        }\n\n        var get_all_members = function(){\n            console.log(\"hello\", vm.club_id);\n\n                 MemberService.GetAllByClub(vm.club_id)\n                .then(function (data) {\n                    ////console.log(data);\n                        //use GB airfields first...\n                        vm.members = data;\n                        for(var i=0;i<vm.members.length;i++){\n                            vm.members[i].is_member = true;\n                        }\n\n                        vm.all_members = data;\n                        for(var i=0;i<vm.all_members.length;i++){\n                            vm.all_members[i].is_member = true;\n                        }\n                        console.log(vm.all_members);\n                \n                });\n\n            \n        }\n\n        setTimeout(function(){\n            get_all_members();\n\n        }, 200);\n\n\n        vm.invite_passenger = function(email, i){\n            ////console.log(\"SEND INVITE\", vm.bookout.passengers[i]);\n\n            var passenger_membership_id = 9;\n            //interesting - this may not be required?\n\n            vm.new_booking.passengers.push(vm.new_pax);\n\n\n            // UserService.InvitePassenger(vm.new_booking.passengers[i].email, vm.user_id, vm.club_id, passenger_membership_id, vm.new_booking.booking_id)\n            //     .then(function (data) {\n            //             //use GB airfields first...\n            //             ////console.log(\"INVITE IS \", data);\n            //             vm.new_booking.passengers[i].status = data.invite.status;\n            //             vm.new_booking.passengers[i].invitation_token = data.invite.invitation_token;\n                \n            //     });\n\n\n        }\n\n        vm.refresh_passenger = function(member, i){\n            ////console.log(\"SEND REFRESH\");\n            UserService.GetInvite(vm.new_booking.passengers[i].invitation_token)\n                .then(function (data) {\n                        //use GB airfields first...\n                        // //console.log(\"INVITED IS \", data);\n                        vm.new_booking.passengers[i].status = data.status;\n                        vm.new_booking.passengers[i].user_id = data.user_id;\n                        vm.new_booking.passengers[i].first_name = data.first_name;\n                        vm.new_booking.passengers[i].last_name = data.last_name;\n                });\n            //vm.bookout.passengers[i].status = \"accepted\";\n        }\n\n        vm.update_passenger_list = function(){\n\n            //let's get ALL the ones required\n             BookoutService.GetPassengers($stateParams.booking_id)\n                .then(function (data) {\n                    ////console.log(data);\n                    if(data.success){\n                       //alert(\"GET\");\n                       ////console.log(\"PAX\", data.passengers);\n                       vm.new_booking.passengers = data.passengers;\n\n                       vm.new_pax = {\n                            id: 0,\n                            email: \"\",\n                            first_name: \"\",\n                            last_name: \"\",\n                            is_member: false,\n                            status: \"\",\n                            not_found: true\n                        };\n\n                    }\n                });\n\n        }\n\n        vm.resend_invitation = function(obj){\n\n            var to_resend = obj;\n             BookingService.ResendInvitation(to_resend, to_resend.id)\n                .then(function(data){\n                    // //console.log(data);\n                    if(data.success == true){\n                        alert(data.message);\n                    } else {\n                        alert(data.message);\n                    }\n\n                });\n        }\n\n\n        vm.refresh_all_passenger = function(){\n            var i = 0;\n             function next() {\n                i++;\n                if(i < vm.new_booking.passengers.length) {\n                    // //console.log(\"SEND REFRESH EVERYTHING\");\n                    if(vm.new_booking.passengers[i] && vm.new_booking.passengers[i].status == \"invited\" && vm.new_booking.passengers[i].invitation_token !== \"\"){\n\n                         UserService.GetInvite(vm.new_booking.passengers[i].invitation_token)\n                            .then(function (data) {\n                                    // //console.log(\"INVITED IS \", data);\n                                    // //console.log(\"INVITED IS \", vm.bookout.passengers[i]);\n                                    vm.new_booking.passengers[i].status = data.status;\n                                    vm.new_booking.passengers[i].user_id = data.user_id;\n                                    vm.new_booking.passengers[i].first_name = data.first_name;\n                                    vm.new_booking.passengers[i].last_name = data.last_name;\n                            });\n                    }\n                } else {\n                   /// nothing\n                }\n            }\n            next();\n         \n            //vm.bookout.passengers[i].status = \"accepted\";\n        }\n\n\n        vm.get_passenger_status = function(member){\n            // //console.log(\"MEMBER\", member);\n            if(member){\n\n\n                if(member.is_member){\n                    // //console.log(\"this one is true\");\n                    return \"OK - is already club member\";\n                } else {\n\n                    if(member.status == \"accepted\"){\n                        return \"OK - passenger has accepted the terms\";\n                    } else if(member.status == \"declined\"){\n                        return \"NO - passenger declined the offer\";\n                    } else if(member.status == \"invited\"){\n                        return \"Waiting for user response\";\n                    } else {\n                        return \"\";\n                    }\n                }\n\n                return \"\";\n            }\n\n        }\n\n       \n                         ////console.log(\"ACCESS : \", vm.user.access);\n        // const delay = (delayInms) => {\n        //   return new Promise(resolve => setTimeout(resolve, delayInms));\n        // };\n\n        function prepare_add_edit(club_id=null, after_booking_end=null){\n\n            var cid = (club_id) ? club_id : vm.club_id;\n            var bed = (after_booking_end) ? after_booking_end : vm.new_booking.end_datetime;\n\n            if(cid > 0 && bed){\n\n                    var bed2 = new Date(bed).toISOString();\n\n                 MemberService.GetAllActiveByClub(cid, bed2)\n                    .then(function (data) {\n                        // //console.log(\"CLUB ID IS :\", vm.club_id);\n\n                        if(vm.user.access.instructor.indexOf(vm.club_id) > -1 || vm.user.access.manager.indexOf(vm.club_id) > -1){\n                            // //console.log(\"THIS IS AN INSTRUCTOR IN THIS CLUB...\");\n                            vm.booking_self = false;\n                            vm.show_self_option = true;\n                        }\n\n                        // if(vm.user.access.instructor.indexOf(vm.club_id) > -1){\n                        //     // //console.log(\"THIS IS AN INSTRUCTOR IN THIS CLUB...\");\n                        //     vm.booking_self = false;\n                        //     vm.show_self_option = true;\n                        // }\n\n                        //use GB airfields first...\n                        //vm.members = data;\n                        vm.get_members();\n\n                        if(vm.new_booking.instructor && vm.new_booking.instructor.id == vm.user.id){\n                            vm.show_self_option = true;\n                            vm.booking_self = false;\n                        }\n\n                        if(!vm.new_booking.user){\n                            // vm.booking_self = false;\n                            //set the member\n\n                            if(!vm.all_members){\n                                 MemberService.GetAllByClub(vm.club_id)\n                                    .then(function (data) {\n                                       \n\n                                            vm.all_members = data;\n                                            for(var i=0;i<vm.all_members.length;i++){\n                                                vm.all_members[i].is_member = true;\n                                            }\n\n                                             vm.new_booking.user = vm.all_members.find(function(member, index) {\n                                                                    if(member.user_id == vm.new_booking.user_id)\n                                                                        return true;\n                                                                });\n\n                                    });\n\n\n                            } else {\n                                vm.new_booking.user = vm.all_members.find(function(member, index) {\n                                                                    if(member.user_id == vm.new_booking.user_id)\n                                                                        return true;\n                                                                });\n                            }\n\n                            //console.log(\"MEMBERS: \", vm.all_members);\n                           \n\n                        }\n\n\n                        if(vm.members && vm.members.length > 0){\n                            for(var i=0;i<vm.members.length;i++){\n                                vm.members[i].is_member = true;\n                            }\n                        }\n                       \n                        // //console.log(vm.members);\n                    \n                    });\n\n            }\n\n           \n        }\n\n\n\n        vm.remove_invite = function(i){\n\n\n                vm.new_booking.passengers.splice(i, 1);\n                vm.init_passengers();\n\n\n        }\n\n\n        // vm.remove_passenger = function(i){\n\n\n        //     var to_remove = vm.new_booking.passengers[i];\n        //     if( vm.pax_invited(to_remove) ){\n\n        //         //full removal from the backend\n        //         BookingService.DeleteInvitation(to_remove, to_remove.id)\n        //         .then(function(data){\n        //             // //console.log(data);\n        //             if(data.success == true){\n        //                 //alert(data.message);\n        //                 vm.new_booking.passengers.splice(i, 1);\n        //                 vm.init_passengers();\n        //             } else {\n        //                 alert(data.message);\n        //             }\n\n        //         });\n\n\n\n\n        //     } else {\n\n        //         //this pax was not YET saved - hence just remove from list\n\n        //         vm.new_booking.passengers.splice(i, 1);\n        //         vm.init_passengers();\n\n        //     }\n\n        //         //below YES --> but needs to remove the invitation as well.\n\n        //         // vm.new_booking.passengers.splice(i, 1);\n        //         // vm.init_passengers();\n\n        // }\n\n        vm.resend_invitation = function(i){\n\n\n            var to_resend = vm.new_booking.passengers[i];\n             BookingService.ResendInvitation(to_resend, to_resend.id)\n                .then(function(data){\n                    // //console.log(data);\n                    if(data.success == true){\n                        alert(data.message);\n                    } else {\n                        alert(data.message);\n                    }\n\n                });\n\n\n        }\n\n        vm.pax_invited = function(pax){\n            if(pax.status == \"\" || pax.status == \"to_invite\"){\n                return false;\n            }\n            return true;\n        }\n\n        vm.get_passenger_status = function(member){\n            // //console.log(\"MEMBER\", member);\n            if(member){\n\n                if(member.is_member){\n                    // //console.log(\"this one is true\");\n                    return \"This passenger is already club member and hence is ready for flight\";\n                } else {\n\n                    if(member.status == \"accepted\"){\n                        return \"This passenger has accepted the terms and is ready for flight\";\n                    } else if(member.status == \"declined\"){\n                        return \"This passenger has declined the terms\";\n                    } else if(member.status == \"to_invite\"){\n                        return \"Invitation will be sent once the booking is saved.\";\n                    } else if(member.status == \"invited\"){\n                        return \"This passenger has been invited but has not yet responded.\";\n                    } else {\n                        return \"\";\n                    }\n                }\n\n                return \"\";\n            }\n\n        }\n\n        vm.get_passenger_status_edit = function(member){\n            // //console.log(\"MEMBER\", member);\n            if(member){\n\n                if(member.is_member){\n                    // //console.log(\"this one is true\");\n                    return \"This passenger is already club member and hence is ready for flight\";\n                } else {\n\n                    if(member.status == \"accepted\"){\n                        return \"This passenger has accepted the terms and is ready for flight\";\n                    } else if(member.status == \"declined\"){\n                        return \"This passenger has declined the terms\";\n                    } else if(member.status == \"to_invite\"){\n                        return \"Invitation will be sent once the booking is saved.\";\n                    } else if(member.status == \"member\"){\n                        return \"This passenger is a member\";\n                    } else if(member.status == \"invited\"){\n                        return \"This passenger has been invited but has not yet accepted.\";\n                    }else {\n                        return \"\";\n                    }\n                }\n\n                return \"\";\n            }\n\n        }\n\n        vm.invite_new_passenger = function(index){\n\n            // //console.log(\"HERE\");\n            // //console.log(vm.new_booking.passengers[index]);\n\n            vm.show_new_passenger_invitation = true;\n            vm.new_pax = index;\n\n            vm.new_booking.passengers.push({\n                    first_name: \"\",\n                    last_name: \"\",\n                    email: \"\",\n                    status: \"\"\n                });\n\n\n        }\n\n        vm.close_passenger_invitation = function(){\n            vm.new_pax = -1;\n            vm.show_new_passenger_invitation = false;\n        }\n\n\n        vm.get_members = function(name, i){\n\n\n            // console.log(\"GET MEMBER\", name);\n            // console.log(\"GET vm.club_id : \", vm.club_id);\n            // console.log(\"GET vm.new_booking : \", vm.new_booking.club_id);\n            // console.log(\"GET vm.new_booking.plane.club_id : \", vm.new_booking.plane.club_id);\n            ////console.log(\"get members\", name);\n            if((vm.club_id == 0 || !vm.club_id) && vm.new_booking.plane && vm.new_booking.plane.id){\n                vm.club_id = vm.new_booking.plane.club_id;\n            }\n\n            if((vm.club_id == 0 || !vm.club_id) && vm.new_booking && vm.new_booking.club_id && vm.new_booking.club_id > 0){\n                vm.club_id = vm.new_booking.club_id;\n            }\n            console.log(\"GET vm.club_id : \", vm.club_id);\n\n            if(name && name.length > 2){\n\n                 MemberService.GetAllByClubAndName(vm.club_id, name)\n                .then(function (data) {\n                    ////console.log(data);\n                    if(data.success){\n                        //use GB airfields first...\n\n                        //filter the ones that are already there....\n                        // myArray.filter( el => !toRemove.includes( el ) );\n                        // var myArray = data.members.filter( el => !vm.bookout.passengers.includes( el ) ); //filter( ( el ) => !vm.bookout.passengers.includes( el ) );\n\n\n                        var filtered_array = data.members.filter(ar => !vm.new_booking.passengers.find(rm => (rm.email === ar.email) ));\n                        //vm.members = data.members;\n                        vm.members = filtered_array;\n                        ////console.log(\"CHECK JANES\", myArray);\n\n\n                        if(vm.members.length < 1){\n                            // //console.log(\"not found in members\");\n                            // vm.new_pax.not_found = true;\n                            // vm.new_pax.email = \"\";\n                            // vm.new_pax.status = \"\";\n                            // vm.new_pax.first_name = \"\";\n                            // vm.new_pax.last_name = \"\";\n\n                            vm.new_pax = {\n                                id: 0,\n                                email: \"\",\n                                first_name: \"\",\n                                last_name: \"\",\n                                is_member: false,\n                                status: \"\",\n                                not_found: true\n                            };\n\n                            \n                           // var email_regex = /^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\\.[a-zA-Z0-9-]+)*$/;\n\n                            var email_regex = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n                            if(email_regex.test(name)){\n\n                                vm.new_pax.email = name;\n\n                            } else {\n                                if(name.indexOf(\" \") > -1){\n                                    var splits = name.split(\" \");\n                                    vm.new_pax.first_name = splits[0];\n                                    vm.new_pax.last_name = splits[1];\n                                } else {\n                                    vm.new_pax.first_name = name;\n                                }\n                            }\n\n\n                        }\n\n                        return true;\n\n                    } else {\n                        //clear original vals\n                            vm.new_pax.status = \"\";\n                            vm.new_pax.email = \"\";\n                            vm.new_pax.first_name = \"\";\n                            vm.new_pax.last_name = \"\";\n                        //if email add the email here\n\n                             var email_regex = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n                            \n                                       // var email_regex = /^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\\.[a-zA-Z0-9-]+)*$/;\n\n                            if(email_regex.test(name)){\n                                ////console.log(\"here we match?  it is an email?\");\n                                vm.new_pax.email = name;\n                                vm.new_pax.not_found = true;\n\n                            } else {\n                                ////console.log(\"user not found?\");\n                            }\n\n\n                        // var email_regex = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n                        // if(email_regex.test(name)){\n\n                        //         clearTimeout(setting_new_member);\n                        //         setting_new_member = undefined;\n\n                        //         setting_new_member = setTimeout(set_new_member, 900, name, index);\n\n                        // } else {\n                        //     //console.log(\"WOOOPSIES...\");\n                        //     //this should be very very rare...\n                        // }\n                        \n\n                       return false;\n                    }\n\n                });\n\n\n            }\n        }\n\n\n        // $scope.get_members = function(name, index){\n\n\n        //     ////console.log(\"get members\", name);\n        //     if((vm.club_id == 0 || !vm.club_id) && vm.new_booking.plane && vm.new_booking.plane.id){\n        //         vm.club_id = vm.new_booking.plane.club_id;\n        //     }\n\n        //     if(name.length > 2){\n\n        //          MemberService.GetAllByClubAndName(vm.club_id, name)\n        //         .then(function (data) {\n        //             // //console.log(data);\n        //             if(data.success){\n        //                 //use GB airfields first...\n        //                 vm.members = data.members;\n\n        //                 if(vm.members.length < 1){\n        //                     ////console.log(\"not found in members\");\n        //                     vm.new_booking.passengers[index].not_found = true;\n        //                     vm.new_booking.passengers[index].email = \"\";\n        //                     vm.new_booking.passengers[index].status = \"\";\n        //                     vm.new_booking.passengers[index].first_name = \"\";\n        //                     vm.new_booking.passengers[index].last_name = \"\";\n\n                            \n        //                    // var email_regex = /^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\\.[a-zA-Z0-9-]+)*$/;\n\n        //                     var email_regex = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n        //                     if(email_regex.test(name)){\n\n        //                         vm.new_booking.passengers[index].email = name;\n\n        //                     } else {\n        //                         if(name.indexOf(\" \") > -1){\n        //                             var splits = name.split(\" \");\n        //                             vm.new_booking.passengers[index].first_name = splits[0];\n        //                             vm.new_booking.passengers[index].last_name = splits[1];\n        //                         } else {\n        //                             vm.new_booking.passengers[index].first_name = name;\n        //                         }\n        //                     }\n\n\n        //                 }\n\n        //             } else {\n        //                 //clear original vals\n        //                     vm.new_booking.passengers[index].status = \"\";\n        //                     vm.new_booking.passengers[index].email = \"\";\n        //                     vm.new_booking.passengers[index].first_name = \"\";\n        //                     vm.new_booking.passengers[index].last_name = \"\";\n        //                 //if email add the email here\n\n        //                      var email_regex = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n                            \n        //                                // var email_regex = /^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\\.[a-zA-Z0-9-]+)*$/;\n\n        //                     if(email_regex.test(name)){\n        //                         ////console.log(\"here we match?  it is an email?\");\n        //                         vm.new_booking.passengers[index].email = name;\n        //                         vm.new_booking.passengers[index].not_found = true;\n\n        //                     } else {\n        //                         ////console.log(\"user not found?\");\n        //                     }\n\n\n        //                 // var email_regex = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n        //                 // if(email_regex.test(name)){\n\n        //                 //         clearTimeout(setting_new_member);\n        //                 //         setting_new_member = undefined;\n\n        //                 //         setting_new_member = setTimeout(set_new_member, 900, name, index);\n\n        //                 // } else {\n        //                 //     //console.log(\"WOOOPSIES...\");\n        //                 //     //this should be very very rare...\n        //                 // }\n                        \n\n                   \n        //             }\n\n        //         });\n\n\n        //     }\n        // }\n\n        $scope.save = function(){\n            if(vm.action == \"add\"){\n                ////console.log(\"CREATE click\");\n                $scope.create();\n            } else {\n                ////console.log(\"EDIT click\");\n                ////console.log(vm.club.membership);\n                generate_datetimes();\n                $scope.update();\n            }\n        }\n\n        $scope.update = function() {\n            var d = new Date();\n            d.setHours( 14 );\n            d.setMinutes( 0 );\n            $scope.mytime = d;\n        };\n\n        vm.show_self_option = false;\n\n        $scope.select_plane = function(val){\n            $scope.check_rental_items();\n            free_places();\n\n            ////console.log(\"AIRCRAFT SELECTED\");\n            if( (vm.user.access.instructor.indexOf(vm.club_id) > -1) || (vm.user.access.manager.indexOf(vm.club_id) > -1) ){\n                vm.show_self_option = true;\n            } else {\n                vm.show_self_option = false;\n            }\n\n\n            if(vm.user.access.instructor.indexOf(vm.club_id) > -1){\n                // //console.log(\"THIS IS AN INSTRUCTOR IN THIS CLUB...\");\n                vm.booking_self = false;\n            }\n\n            \n        }\n\n        function generate_datetimes(){\n            var start = new Date(vm.new_booking.start_date);\n            var c = new Date();\n            var start_split = (vm.new_booking.start_time) ? vm.new_booking.start_time.time.split(\":\") : [c.getHours(), c.getMinutes()];\n            // var start_split = vm.new_booking.start_time.time.split(\":\");\n\n            start.setHours(start_split[0]);\n            start.setMinutes(start_split[1]);\n            start.setSeconds(0);\n\n            var end = new Date(vm.new_booking.end_date);\n            //var end_split = vm.new_booking.end_time.time.split(\":\");\n            var end_split = (vm.new_booking.end_time) ? vm.new_booking.end_time.time.split(\":\") : [c.getHours(), c.getMinutes()];\n\n            end.setHours(end_split[0]);\n            end.setMinutes(end_split[1]);\n            end.setSeconds(0);\n\n            vm.new_booking.start_datetime = start.toISOString();//moment(start).format(\"Y-MM-DD HH:mm\");\n            vm.new_booking.end_datetime = end.toISOString();//moment(end).format(\"Y-MM-DD HH:mm\");\n            // console.log(\"GENERATE DATETIME ==> \", vm.new_booking.start_datetime);\n            // console.log(\"GENERATE DATETIME ==> \", vm.new_booking.end_datetime);\n        }\n\n        function get_times(data, tofrom){\n            var date = $scope.myDatetimeRange.date[tofrom];\n            var d = date.getDate();\n            var m = date.getMonth();\n            var y = date.getFullYear();\n            \n            //need to combuine both\n            var a = data[tofrom];\n            var h = a.slice(0,2);\n            var i = a.slice(3,5);\n            // i = (i == 00)? 0 : i;\n            i = (i.toString() == \"00\")? 0 : i;\n\n            // $scope.myDatetimeRange.date.from = new Date(y, m, d, h, m, 0);\n            // //console.log(\"vars are: \"+y+\", \"+m+\", \"+d+\", \"+h+\", \"+i+\", \"+0+\" soooo\");\n            var date = new Date(y, m, d, h, i, 0);\n            return date;\n        }\n\n        function check_business_hours(i, k = null, start = 0){\n            //i is hours\n            //k is minutes\n            k = parseInt(k);\n            i = parseInt(i);\n\n            var this_step_disabled = 0; \n            if(vm.new_booking.options.business_hours){\n                var split = vm.new_booking.options.business_hours.from.split(\":\");\n                var split2 = vm.new_booking.options.business_hours.to.split(\":\");\n\n                if(start == 0){\n                    //adjust to match times / end min 1 hour slots\n                   // split2[0] = parseInt(split2[0]) + 1;\n                } else {\n                    split2[0] = parseInt(split2[0]) - 1;\n                }\n\n                if(k || k == 0){\n                    \n                    if(i < parseInt(split[0]) ){\n                        // //console.log(\"we disable because \"+i+\":\"+k+\" is before \"+split.join(\":\") );\n                        this_step_disabled = 1;\n                    } else if(i == parseInt(split[0]) && k < parseInt(split[1])){\n                         // //console.log(\"we disable because \"+i+\":\"+k+\" is before \"+split.join(\":\") );\n                        this_step_disabled = 1;\n                    }\n\n                    // if(i >= parseInt(split2[0]) && k >= parseInt(split2[1]) ){\n                    //     // //console.log(\"we disable because \"+i+\":\"+k+\" is after \"+split2.join(\":\") );\n                    //     this_step_disabled = 1;\n                    // } \n\n\n                    if(i > parseInt(split2[0])){\n                        this_step_disabled = 1; \n                    } else if( i == parseInt(split2[0]) && k > parseInt(split2[1])){\n                        this_step_disabled = 1;\n                    }\n\n\n                } else {\n                    if(parseInt(split[0]) < i){\n                        this_step_disabled = 1;\n                    } \n                    if(parseInt(split2[0]) > i){\n                        this_step_disabled = 1;\n                    } \n                }\n            }\n\n            return this_step_disabled;\n        }\n\n\n   \n\n    function clean_times(which, start_end, compared_to = null){\n\n        var compare_date;\n\n        switch(which){\n            case 'today':\n                compare_date = new Date();\n            break;\n            case 'past':\n                //we need to consider the back-dating as possible issue...\n                compare_date = new Date(\"1990-07-26\");\n            break;\n            case 'future':\n                compare_date = new Date(\"1990-07-26\");\n            break;\n            case 'after':\n            //differentiate here\n                compare_date = new Date(compared_to);\n            break;\n            case 'before':\n            //differentiate here\n                compare_date = new Date(compared_to);\n            break;\n        }\n\n            var this_date = new Date(vm.new_booking.start_date);\n\n            // //console.log(\"HERE WE GO this_date!\", this_date);\n            // //console.log(\"HERE WE GO start_end!\", start_end);\n            // //console.log(\"HERE WE GO vm[start_end]!\", vm[start_end]);\n\n            vm[start_end].forEach(function(time, i){\n\n                //this may very well be the case function here to change when the re-do the times            \n                var split_time = time.time.split(\":\");\n                this_date.setHours(split_time[0]);\n                this_date.setMinutes(split_time[1]);\n                this_date.setSeconds(0);\n\n\n                if( moment(this_date).isAfter(moment(compare_date)) ){\n                    //vm[start_end][i].disabled = 0;\n                    vm[start_end][i].disabled = check_business_hours(parseInt(split_time[0]), parseInt(split_time[1]), (start_end == \"start_times\")? 1 : 0);\n                } else {\n                    vm[start_end][i].disabled = 1;\n                }\n            });\n\n        //by definition as we are changing something to cause this function from being called - we need to recalculate the times:\n        calculate_duration();\n\n    }\n\n    function get_duration_str(seconds){\n        //var seconds = Math.floor(seconds);\n        // //console.log(seconds);\n        // //console.log(moment.duration(seconds));\n        // //console.log(\"days: \"+moment.duration(seconds).days());\n        // //console.log(\"hours: \"+moment.duration(seconds).hours());\n        // //console.log(\"minutes: \"+moment.duration(seconds).minutes());\n\n        var days = moment.duration(seconds).days();\n        var hours = moment.duration(seconds).hours();\n        var minutes = moment.duration(seconds).minutes();\n\n        //occasional issue showing 59 minutes - unsure where but this is a fix for it... think moment() has a bug\n        if(minutes == 59){\n            hours++;\n            minutes = 0;\n        }\n\n\n        var string = \"\";\n        if(days > 0){\n            string = string+\" \"+days+\" day\";\n            string = (days > 1)? string+\"s\" : string;\n        }\n        if(hours > 0){\n            string = string+\" \"+hours+\" hour\";\n            string = (hours > 1)? string+\"s\" : string;\n        }\n        if(minutes > 0){\n            string = string+\" \"+minutes+\" minute\";\n            string = (minutes > 1)? string+\"s\" : string;\n        }\n\n         // //console.log(\"STR : \"+string);\n\n        return string;\n\n    }\n\n    function add_hour_to_end(){\n        var a = vm.new_booking.start_time.time.split(\":\");\n        //var b = new Date();\n        var b = new Date(vm.new_booking.start_date);\n        b.setHours(a[0]);\n        b.setMinutes(a[1]);\n        b.setSeconds(0);\n        var future = moment(b).add(1, \"hour\").format();\n       // clean_times('after', 'end_times', future);\n       //\n\n         //clean_times(check_relative_date(vm.new_booking.end_date, \"end\"), 'end_times', future);\n\n\n\n        if(parseInt(a[0]) >= 23){\n            if(moment(vm.new_booking.start_date).isSame(moment(vm.new_booking.end_date))){\n                 // //console.log(\"THIS ADD DAY\");\n                // //console.log(\"start\", vm.new_booking.start_date);\n                // //console.log(\"end\", vm.new_booking.end_date);\n                 // //console.log(\"after or = 11pm - then we need to change the date that follows the same pattern\");\n                vm.new_booking.end_date = new Date(moment(vm.new_booking.end_date).add(1, \"day\").format());\n                clean_times('future', 'end_times');\n\n                //set it to 00:00 hours probably a wise thing...\n                vm.new_booking.end_time = vm.end_times[0];\n\n\n            } \n        } else {\n            clean_times('after', 'end_times', b);\n        }\n\n    }\n\n\n    function start_after_end(){\n            var start_after_end = false;\n            if(vm.new_booking.end_time){\n                // //console.log(\"START AFTER END LOOP\");\n                var start_datetime = new Date(vm.new_booking.start_date);\n                var start_time = vm.new_booking.start_time.time.split(\":\");\n                start_datetime.setHours(start_time[0]);\n                start_datetime.setMinutes(start_time[1]);\n                start_datetime.setSeconds(0);\n\n                var end_datetime = new Date(vm.new_booking.end_date);\n                var end_time = vm.new_booking.end_time.time.split(\":\");\n                end_datetime.setHours(end_time[0]);\n                end_datetime.setMinutes(end_time[1]);\n                end_datetime.setSeconds(0);\n\n                if(moment(start_datetime).isAfter(moment(end_datetime)) || moment(start_datetime).isSame(end_datetime) || end_datetime == start_datetime){\n                    start_after_end = true;\n                }\n\n\n            }\n            return start_after_end;\n    }\n\n\n    function booking_today(){\n        if(moment(vm.new_booking.start_date).format(\"DD/MM/YYYY\") == moment().format(\"DD/MM/YYYY\")){\n            // //console.log(\"WE ARE TODAY?\");\n            clean_times('today', 'start_times');\n\n        } else {\n            // //console.log(\"should get full day\");\n            if(moment(vm.new_booking.start_date).isAfter(moment()) ){\n                clean_times('future', 'start_times');\n            }\n        }\n\n        if(moment(vm.new_booking.end_date).format(\"DD/MM/YYYY\") == moment().format(\"DD/MM/YYYY\")){\n            if(vm.new_booking.start_time){\n               // //console.log(\"START TIME\", vm.new_booking.start_time);\n                add_hour_to_end(); \n            }\n            clean_times(check_relative_date(vm.new_booking.start_date), 'end_times');\n        }\n\n\n        if(vm.new_booking.end_date == vm.new_booking.start_date){\n                // //console.log(\"booking today where end = start\");\n                if(vm.new_booking.start_time){\n                    var a = vm.new_booking.start_time.time.split(\":\");\n                    var b = new Date(vm.new_booking.start_date);\n                    b.setHours(a[0]);\n                    b.setMinutes(a[1]);\n                    b.setSeconds(0);\n\n                    //we need to check the times give\n                    if(start_after_end()){\n                        clean_times(check_relative_date(vm.new_booking.start_date), 'start_times');\n                        // //console.log(\"UPDATE END BITS IF START > END required?\");\n                        clean_times(check_relative_date(vm.new_booking.end_date, \"end\"), 'end_times', b);\n                        add_hour_to_end();\n                    } else {\n                        // //console.log(\"UPDATE END BITS IF START > END 2\", check_relative_date(vm.new_booking.start_date, \"end\"));\n                        clean_times(check_relative_date(vm.new_booking.end_date, \"end\"), 'end_times', b);\n                    }\n\n\n                }\n        }\n\n    }\n\n    // clean_times('today', 'start_times');\n    booking_today();\n\n\n    function check_relative_date(date, start_end = \"start\"){\n        var relative = \"today\";\n        // //console.log(\"RELATIVE TIME CHECK\", date);\n        if(moment(moment(date).format(\"YYYY/MM/DD\")).isAfter(moment().format(\"YYYY/MM/DD\"))){\n            relative = \"future\";\n\n            //then is after today\n            // the catch is that if date == start / end date --> THEN we need to present that it is today even though it isnt - this is premise\n            // that is valid only for the \"END\" cases (so that we return AFTER rather than today) --> otherwise the end_times available won't reflect\n            //the fact that the start_times have been selected allowing the user to select an end time before start time (which is silly really...)\n\n            if(vm.new_booking.start_date && vm.new_booking.end_date && start_end == \"end\"){\n                if(moment(vm.new_booking.start_date).isSame(moment(vm.new_booking.end_date))){\n                    relative = \"after\"; // because we need to act as though it is after in the clean_times (to not be able to select end < start times)\n                }\n            }\n            \n        } else if(moment(date).format(\"YYYY/MM/DD\") == moment().format(\"YYYY/MM/DD\")){\n            //then today\n            relative = (start_end == \"start\") ? \"today\" : \"after\";\n        } else {\n            //must be in the past...\n            relative = \"past\";\n        }\n\n        \n        // //console.log(\"relative is \", relative);\n        return relative;\n    }\n\n\n      if($stateParams.start){\n                    //alert(\"add\");\n                    vm.new_booking.start_date = new Date($stateParams.start);\n                    vm.new_booking.end_date = new Date($stateParams.start);\n                    vm.new_booking.start_time = {time: moment($stateParams.start).format(\"HH:mm\")};\n                    vm.new_booking.end_time = {time: moment($stateParams.start).add(30, \"minutes\").format(\"HH:mm\") };\n                    var default_end = moment($stateParams.start).add(30, \"minutes\");\n\n                    vm.default_date = vm.new_booking.start_date;\n\n                    $(\"#calendar\").fullCalendar(\"gotoDate\", vm.new_booking.start_date );\n\n\n                    setTimeout(function(){\n\n\n\n\n                        var new_event = [{\n                                         \"id\":\"TEMP\",\n                                         \"title\":\"TEMPORARY\",\n                                         \"resourceId\": 7,\n                                         \"start\":$stateParams.start,\n                                         \"end\":default_end,\n                                         \"editable\":false,\n                                         \"color\":\"rgb(255, 110, 110)\",\n                                         \"opacity\":\"1\"\n                                      }];\n                    \n\n                                        $('#calendar').fullCalendar('addEventSource', new_event);\n                                                    setTimeout(function(){\n\n\n\n                                                        //scrolling?\n\n\n                                                    }, 500);\n\n                        $scope.update_dateTime(\"edit2\", $stateParams.plane_id);\n\n\n\n                    }, 500);\n\n                    \n\n\n      \n\n                }\n\n                vm.already_added_temp = false;\n\n\n    // vm.add_booking_event = function(obj){\n\n    //     vm.new_booking.start_date = new Date(obj.start);\n    //     vm.new_booking.end_date = new Date(obj.start);\n    //     vm.new_booking.start_time = {time: moment(obj.start).format(\"HH:mm\")};\n    //     //console.log(\"PLANE => \", vm.planes.find(x => parseInt(x.id) === parseInt(obj.plane_id) ));\n    //     alert(\"HI\");\n    //     vm.new_booking.plane = vm.planes.find(x => parseInt(x.id) === parseInt(obj.plane_id) );\n\n    //     vm.new_booking.end_time = {time: moment(obj.start).add(30, \"minutes\").format(\"HH:mm\") };\n    //     var default_end = moment(obj.start).add(30, \"minutes\");\n\n    //     vm.default_date = vm.new_booking.start_date;\n\n    //       var new_event = {\n    //                          \"id\":\"TEMP\",\n    //                          \"title\":\"TEMPORARY\",\n    //                          \"resourceId\": 7,\n    //                          \"start\":obj.start,\n    //                          \"end\":default_end,\n    //                          \"editable\":false,\n    //                          \"color\":\"rgb(255, 110, 110)\",\n    //                          \"opacity\":\"1\"\n    //                       };\n                   \n\n    //     if(vm.already_added_temp){\n\n    //             $('#calendar').fullCalendar(\"removeEvents\", \"TEMP\")\n           \n\n    //                 setTimeout(function(){\n\n    //                     $scope.update_dateTime(\"edit\");\n\n\n    //                     $('#calendar').fullCalendar('renderEvent', new_event);\n    //                 }, 100);\n\n\n    //     } else {\n\n    //         setTimeout(function(){\n\n           \n        \n\n    //                         $('#calendar').fullCalendar('renderEvent', new_event);\n    //                         vm.already_added_temp = true;\n    //                                     setTimeout(function(){\n\n    //                                         //console.log(\"new_even\", new_event);\n\n    //                                         //scrolling?\n\n\n    //                                     }, 500);\n\n    //         $scope.update_dateTime(\"edit2\", obj.plane_id);\n\n\n\n    //     }, 500);\n\n    //     }\n\n        \n\n        \n\n    // }\n\n\n\n\n    vm.add_booking_event = function(obj){\n\n        vm.new_booking.start_date = new Date(obj.start);\n        vm.new_booking.end_date = new Date(luxon.DateTime.fromISO(new Date(obj.end).toISOString()).plus({minutes: 60}).toISO());//new Date(obj.start).toISOString();\n        vm.new_booking.start_time = {time: moment(obj.start).format(\"HH:mm\")};\n\n\n        vm.new_booking.end_time = {time: moment(obj.start).add(60, \"minutes\").format(\"HH:mm\") };\n        // var default_end = new Date(new Date(obj.start).getTime() + 30*60000); //moment(obj.start).add(30, \"minutes\");\n        // var default_end = luxon.DateTime.fromMillis(obj.start).plus({minutes: 30}).toFormat(\"HH:mm\");\n        // var default_end2 = luxon.DateTime.fromMillis(obj.start).plus({minutes: 30}).toISO();\n        // var default_end3 = luxon.DateTime.fromMillis(obj.start).plus({minutes: 30}).toFormat(\"yyyy-MM-DD HH:mm:ss\");\n\n        // console.log(\"ADD BOOKING EVENT : \", default_end);\n        // console.log(\"ADD BOOKING EVENT : \", obj.start);\n        // console.log(\"ADD BOOKING EVENT : \", luxon.DateTime.fromMillis(obj.start));\n        // console.log(\"ADD BOOKING EVENT : \", luxon.DateTime.fromMillis(obj.start).toFormat(\"HH:mm\"));\n        // console.log(\"ADD BOOKING EVENT 2: \", default_end2);\n        // console.log(\"ADD BOOKING EVENT 3: \", default_end3);\n\n        // console.log(\"ADD BOOKING EVENT s: \", vm.new_booking.start_date);\n        // console.log(\"ADD BOOKING EVENT e: \", vm.new_booking.end_date);\n\n        //luxon.DateTime.fromString(obj.start).toFormat(\"HH:mm\");\n        // console.log(\"CHECK START DATE HERE???\");\n        // console.log(vm.new_booking.start_date);\n        // console.log(vm.new_booking.start_date.toISOString());\n\n         BookingService.GetAllPlanes(vm.user.id, vm.new_booking.start_date.toISOString(), vm.new_booking.end_date.toISOString(), 0, 0)\n            .then(function(data){\n               \n                //this gets the events and bookings for the period checked here...\n                // var events = data.events;\n                vm.planes = data;\n                vm.new_booking.plane = vm.planes.find(x => parseInt(x.id) === parseInt(obj.plane_id) );\n                        $scope.update_dateTime(\"edit2\");\n\n\n            });\n       \n\n\n    }\n\n\n    $scope.calendarOptions = {\n        initialView: 'dayGridMonth'\n    };\n\n    $scope.calendarEvents = [\n        { title: 'Event 1', start: '2024-02-17' },\n        { title: 'Event 2', start: '2024-02-18' }\n    ];\n\n\n    $scope.make_booking = function(isValid){\n\n       //console.log(\"make booking\", isValid);\n            $scope.submitted = true;\n            // check to make sure the form is completely valid\n            if(isValid) {\n                // //console.log('our form is working');\n                //then we send the booking request to the server woooohooooo!\n\n                //clean and prepare the bits that we require\n                var booking = {};\n                var booking = jQuery.extend(true, {}, vm.new_booking); \n                // //console.log(booking);\n                delete booking.options;\n                delete booking.instructor;\n                delete booking.plane;\n                delete booking.start_date;\n                delete booking.start_time;\n                delete booking.end_date;\n                delete booking.end_time;\n                delete booking.start_datetime;\n                delete booking.end_datetime;\n                delete booking.tuition_required;\n                delete booking.user;\n                // //console.log(booking);\n                // //console.log(vm.new_booking);\n\n                //generate_datetimes();\n\n                // //console.log(\"START DATE1 : \", vm.new_booking.start_datetime );\n\n                // //console.log(\"START DATE2 : \", moment(vm.new_booking.start_datetime).isAfter() );\n                // //console.log(\"START DATE3 : \", moment(vm.new_booking.start_datetime).isBefore() );\n\n                // //console.log(\"START DATE4 : \", moment(Date.parse(vm.new_booking.start_datetime)) );\n                // //console.log(\"END DATE : \", moment(vm.new_booking.end_datetime) );\n                // //console.log(\"NOW : \", moment());\n\n                //console.log(vm.new_booking.start_datetime);\n\n                if(moment(Date.parse(vm.new_booking.end_datetime)).add(60, \"minutes\").isBefore()){\n                    alert(\"This booking ends in the past - you cannot create a booking in the past.\");\n                    return false;\n                }\n                //60 mintues leeway in case of booking starting within the 15 minute period or similar\n                if(moment(Date.parse(vm.new_booking.start_datetime)).add(60, \"minutes\").isBefore()){\n                    alert(\"This booking starts in the past - you cannot create a booking in the past.\");\n                    return false;\n                }\n\n\n\n\n\n                booking.override = (vm.new_booking.override) ? vm.new_booking.override : 0;\n\n                if(vm.booking_self){\n                    // //console.log(\"SELF\");\n                    booking.user_id = vm.user.id;\n                    booking.instructor_id = (vm.new_booking.instructor) ? vm.new_booking.instructor.id : 0;\n                    // //console.log(\"USER IS \", booking.user_id);\n                } else {\n                    // //console.log(\"NON SELF\");\n\n                    booking.user_id = vm.new_booking.user.user_id;\n                    if(vm.user.access.manager.indexOf(vm.club_id) > -1){\n                        //admin does not automatically become the instructor...\n                        booking.instructor_id = (vm.new_booking.instructor) ? vm.new_booking.instructor.id : 0;                \n                    } else {\n                        //then its an instructor - so likely booking for student not just member\n                        booking.instructor_id = vm.user.id;                \n                    }\n                    booking.booked_by_admin_instructor = 1;\n                    booking.override = 1;\n\n                }\n               \n\n\n\n\n                booking.free_seats = (vm.new_booking.free_seats.constructor === Array) ? 0 : vm.new_booking.free_seats;\n                booking.start = vm.new_booking.start_datetime;\n                booking.end = vm.new_booking.end_datetime;               \n                booking.plane_id = vm.new_booking.plane.id;\n                booking.club_id = vm.new_booking.plane.club_id;\n                booking.booked_by = vm.user.id;\n                booking.course_id = (vm.new_booking.tuition_required) ? vm.new_booking.tuition_required.id : 0;\n\n                booking.maintenance_flight = vm.new_booking.maintenance_flight;\n                // //console.log(\"UUID \",booking.user_id);\n\n                // return false;\n\n                // //console.log(\"new booking obj to be sent... \",booking);\n\n                //make booking call with new_booking as items to send! :D wooohoooooooo :P\n                BookingService.Create(vm.user.id, booking)\n                .then(function(data){\n\n                    if(data.success == true){\n                        // //console.log(\"WAS SENT HERE! \");\n                        $scope.clear_booking();\n                        \n                        //console.log(\"START IS\", booking.start);\n                        // var split = booking.start.split(\"-\");\n                        // var month = (parseInt(split[1]) > 9) ? split[1] : \"0\"+split[1];\n                        // var day_split = split[2].split(\" \");\n                        // var day = (parseInt(day_split[0]) > 9) ? day_split[0] : \"0\"+day_split[0];\n                        // var rebuild = split[0]+\"-\"+month+\"-\"+day+\"T\"+day_split[1]+\":00\";\n\n                        // //var split = booking.start.replace(\" \", \"T\")+\":00\";\n\n\n                        // console.log(\"START TO: \", rebuild);\n                        // console.log(\"START TO\", moment(rebuild).format(\"Y-MM-DD\"));\n\n                        // console.log(\"START IS\", moment(booking.start).format(\"Y-MM-D\"));\n\n                        BookingService.GetAll(vm.user.id, moment(booking.start).format(\"Y-MM-DD\"), \"\")\n                            .then(function(data){\n                                       //console.log(data);        \n\n                                alert(\"Booking Created Successfully\");\n\n                                $scope.all_events = data.events;\n                                $scope.all_resources = data.resources;\n\n                                $('#calendar').fullCalendar('refetchEvents');\n                                $('#calendar').fullCalendar('removeEvents');\n                                $('#calendar').fullCalendar('addEventSource', $scope.all_events);\n                            });\n\n                        \n\n                        //$(\"#calendar\").fullCalendar(\"refetchEvents\");\n                        //must have some sort of feedback saying booking was made successfully!\n                        $state.go('dashboard.add_booking');\n                    } else {\n\n                        // //console.log(\"clearly something went wrong here... :'-( \", data.message);\n                        //if it is something about currency - perhaps return the possibility of self-certify or book instructor for this purpose!\n                        \n                        if(data.more && data.more.length > 0){\n                            console.log(\"MORE\", data);\n                            var addon = \"\";\n\n                            for(var i=0;i<data.more.length;i++){\n                                if(data.more[i][\"name\"] == \"differences_verified\"){\n                                    addon += \"\\n - Your differences training sign-offs need to be verified by a member of staff. \\n\";\n                                }\n                                if(data.more[i][\"name\"] == \"licence_verified\"){\n                                    addon += \"\\n - Your licence needs to be verified by a member of staff. \\n\";\n                                }\n                                if(data.more[i][\"name\"] == \"medical_verified\"){\n                                    addon += \"\\n - Your medical needs to be verified by a member of staff. \\n\";\n                                }\n                                if(data.more[i][\"name\"] == \"medical\"){\n                                    addon += \"\\n - You need to upload a copy of your medical. \\n\";\n                                }\n                                if(data.more[i][\"name\"] == \"licence\"){\n                                    addon += \"\\n - You need to upload a copy of your licence. \\n\";\n                                }\n                                if(data.more[i][\"name\"] == \"differences\"){\n                                    addon += \"\\n - You need to upload a copy of your differences training signed off. \\n\";\n                                }\n                                // addon += \"You need to add your \"+data.more[i][0]+\" to book solo\";\n                            }\n                            // //console.log(\"MORE:: \", addon);\n\n                            data.message = data.message + addon;\n                        }\n                        \n                        //console.log(\"NO MORE\", data);\n\n                        if(data.allow_override){\n\n                            if(vm.user.access.manager.indexOf(vm.club_id) > -1){\n                                //admin does not automatically become the instructor...\n                                //alert(\"we can override this\");\n\n                                var errors = [];\n                                if(data.reason == \"instructor\"){\n                                    errors.push({\n                                        type: \"instructor\",\n                                        message: \"It looks like the instructor is not available for this booking\",\n                                        api: data.instructor,\n                                        override: \"instructor_override\",\n                                        button: \"OVERRIDE INSTRUTOR AVAILABILITY\" \n                                    });\n                                } \n\n                                vm.new_booking_errors = errors;\n                                // else if(data.check_user !== true){\n\n                                //     if(data.check_user.indexOf(\"self-certify\") > -1){\n\n                                //         errors.push({\n                                //             type: \"check_user\",\n                                //             message: \"It would appear that you are not within the currency requirements to book this aircraft for this flight.\",\n                                //             api: data.check_user,\n                                //             override: \"currency_override\",\n                                //             button: \"I am Current\" \n                                //         });\n\n\n                                //     } else {\n                                //         errors.push({\n                                //             type: \"check_user\",\n                                //             message: \"It looks like your user account does not allow this booking to happen\",\n                                //             api: data.check_user,\n                                //             override: \"currency_override\",\n                                //             button: \"\" \n                                //         });\n                                //     }\n\n                                   \n                                // } else if(data.rental_items !== true){\n                                //     errors.push({\n                                //         type: \"rental_items\",\n                                //         message: \"It looks like some of the rental items are not available\",\n                                //         api: data.rental_items,\n                                //         override: \"update_rental_items\",\n                                //         button: \"Confirm Changes\" \n                                //     });\n                                // }\n\n\n\n                            }\n\n\n                        }\n\n\n\n                        alert(\"Sorry! \\n\\n\"+data.message);\n                    }\n                    \n                });\n\n\n            } else {\n                //console.log(\"NOT SENT - please fix errors\");\n            }\n\n    }\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n        \n        \n\n      \n\n\n\n\n\n\n\n\n\n\n\n\n        // MODALS FOR ALL THE POPUPS TO BE CHANGED INTO --> SAMPLE HERE\n\n        // var warning_msg = \"By deleting this membership, you will also cancel all reservations that this membership currently has.\"\n\n        $scope.popup2 = {\n          opened: false\n        };\n\n        $scope.popup3 = {\n          opened: false\n        };\n\n        $scope.popup4 = {\n          opened: false\n        };\n          \n        $scope.open2 = function() {\n          $scope.popup2.opened = true;\n        };\n\n          $scope.open3 = function() {\n          $scope.popup3.opened = true;\n        };\n\n          $scope.open4 = function() {\n          $scope.popup4.opened = true;\n        };\n\n\n        $scope.open = function (member_id) {\n            var modalInstance = $uibModal.open({\n              animation: true,\n              templateUrl: 'views/modals/deleteModal.html',\n              controller: 'ModalInstanceCtrl',\n              size: \"lg\",\n              resolve: {\n                id: function () {\n                  return member_id;\n                },\n                warning: function(){\n                    return warning_msg;\n                }\n              }\n            });\n            modalInstance.result.then(function (member_id) {\n              $log.info('PRESSED GO: '+member_id);\n              MemberService.Delete(member_id)\n              .then(function(){\n                ////console.log(\"HELLO DELETE\");\n                //update view?\n                 vm.club.members = $.grep(vm.club.members, function(e){ \n                    return e.id != member_id; \n                });\n              })\n            }, function () {\n              $log.info('Modal dismissed at: ' + new Date());\n            });\n          };\n\n         \n\n\n    }\n app.controller('BookingsController', BookingsController);\n\n    BookingsController.$inject = ['UserService', 'MemberService', 'InstructorService', 'MembershipService', 'HolidayService', '$rootScope', '$location', '$scope', '$state', '$stateParams', '$uibModal', '$log', '$window', '$compile', '$timeout', 'uiCalendarConfig', 'BookingService', 'InstructorCharges', 'CourseService'];\n    function BookingsController(UserService, MemberService, InstructorService, MembershipService, HolidayService, $rootScope, $location, $scope, $state, $stateParams, $uibModal, $log, $window, $compile, $timeout, uiCalendarConfig, BookingService, InstructorCharges, CourseService) {\n        \n        var vm = this;\n        var defaultStartTime = 480;\n        var defaultEndTime = 1080;\n\n        $scope.va1 = '123';\n        \n\n        vm.user = $rootScope.globals.currentUser;\n\n        vm.allUsers = [];\n        vm.club = {};\n        vm.page_title = \"\";\n        vm.club.member = {};\n        \n        vm.imported_new_headers = [];\n        vm.see_booking = {};\n\n        vm.is_current = false;\n        vm.currency_type = \"\";\n        vm.currency_days = \"\";\n\n        vm.booking_self = true;\n\n        vm.times_clean_type = \"start_times\";\n\n\n        // vm.club.member.membership_id = {};\n        \n        vm.action = $state.current.data.action;\n        vm.return_to = $state.current.data.return_to;\n        vm.club_id = 0;\n\n        //just in case i missed a changed value...\n        vm.user_id = vm.user.id;\n\n        vm.no_show_cols = [\"membership_start\", \"membership_id\", \"selected\"];\n\n        var newDate = new Date();\n        \n        var h_start = Math.floor( defaultStartTime / 60 );          \n        var i_start = defaultStartTime % 60;\n        var h_end = Math.floor( defaultEndTime / 60 );          \n        var i_end = defaultEndTime % 60;\n\n        var defaultStart = new Date(newDate.getFullYear(), newDate.getMonth(), newDate.getDate(), h_start, i_start, 0);\n        var defaultEnd = new Date(newDate.getFullYear(), newDate.getMonth(), newDate.getDate(), h_end, i_end, 0);\n        vm.default_date =  new Date();\n\n        vm.datepickerOptions = {\n            customClass: getDayClass,\n            format: 'dd/MM/yyyy',\n            showWeeks: false\n        }\n\n        vm.dateTimeRangePickerOptions = {\n            hour_step: 1,\n            minute_step: 30,\n            min_date: today,\n            datepicker:{\n                customClass: getDayClass,\n                format: 'dd/MM/yyyy',\n                showWeeks: false,\n                minDate: today\n            }\n            ,\n            business_hours: {\n                from: \"09:00\",\n                to: \"22:30\"\n            }\n        };\n\n        $scope.whole_day_booking = false;\n\n\n        // BookingService.GetAll(vm.user.id, moment().format(\"Y-M-D\"), \"\")\n        //     .then(function(data){\n        //         $scope.all_events = data.events;\n        //         $scope.all_resources = data.resources;\n        //     });\n\n\n        vm.instructor_charges = [];\n\n\n\n\n        vm.cancellation = { \n                            reasons: [\n                                \"Pilot Unwell\",\n                                \"Pilot Unavailable\",\n                                \"Weather at home base\",\n                                \"Weather at destination\",\n                                \"Plane Unavailable\",\n                                \"Plane Unserviceable\",\n                                \"Plane Returned Too Late by previous booking\",\n                                \"Instructor Not Available\",\n                                \"Airfield Closed\",\n                                \"Airspace Closed\",\n                                \"Other - please specify\"\n                            ],\n                            notes: \"\"\n                        };\n\n\n\n        var today = new Date();\n        today.setMinutes(0);\n        today.setSeconds(0);\n        var end = moment(today);\n        end.add(2, \"hours\");\n        end = new Date(end);\n        end.setSeconds(0);\n\n        var datepicker_today = new Date().format(\"d/M/yyyy\");\n\n\n        vm.start_times = [];\n        vm.end_times = [];\n\n        vm.new_booking = {\n            start_date: today,\n            end_date: today,\n            free_seats: [],\n            passengers: [],\n            options: vm.dateTimeRangePickerOptions\n        };\n\n        $scope.toggle = true;\n        $scope.whentimechangedata = {};\n        $scope.overridePicker = true;\n\n        var date = Date();\n        vm.planes = [];\n        init_times();\n\n      $scope.formats = ['dd/MM/yyyy', 'yyyy/MM/dd', 'dd.MM.yyyy', 'shortDate'];\n      $scope.format = $scope.formats[0];\n        //prepare_add_edit();\n\n\n       \n\n\n        switch(vm.action){\n            case \"add\":\n                //console.log(\"adding a new member please\");\n                vm.page_title = \"Add a Booking\";\n\n                //update_bookings();\n\n                vm.new_booking = {\n                                    start_date: today,\n                                    end_date: today,\n                                    free_seats: [],\n                                    passengers: [],\n                                    options: vm.dateTimeRangePickerOptions\n                };\n                figure_out_steps();\n\n\n\n\n\n            break;\n            case \"edit\":\n                vm.page_title = \"Edit a Booking\";\n                //console.log(\"edit an existing booking\");\n\n                vm.see_booking.visible = 0;\n\n                // vm.default_date = new Date(\"2016-10-11\");\n                vm.new_booking = {\n                                    start_date: today,\n                                    end_date: today,\n                                    free_seats: [],\n                                    passengers: [],\n                                    options: vm.dateTimeRangePickerOptions\n                };\n                figure_out_steps();\n                //vm.new_booking.\n                //get a single events\n                \n                update_bookings();\n\n                if($stateParams.booking_id){\n\n\n\n                     BookingService.GetEdit(vm.user.id, $stateParams.booking_id)\n                        .then(function(data){\n                            //console.log(\"GETTING CONTENT FROM EDIT : \", data);\n\n                            if(data.success){\n\n\n                                //console.log(\"EDIT THIS CONTENT HERE\", data);\n                                //console.log(\"CHECK CONTENT FROM RETURN\", data.booking.instructor);\n\n                                vm.new_booking = data.booking;\n                                //console.log(\"MY INSTRUCTOR HERE: \", vm.new_booking.instructor);\n                                vm.new_booking.options = vm.dateTimeRangePickerOptions;\n                                vm.new_booking.edit_booking = 1;\n\n                                vm.new_booking.start_date = new Date(vm.new_booking.start);\n                                // vm.new_booking.start_time = {time: moment(vm.new_booking.start).format(\"HH:mm\"), disabled: 1};\n                                vm.new_booking.start_time = {time: moment(vm.new_booking.start).format(\"HH:mm\")};\n                                vm.new_booking.end_date = new Date(vm.new_booking.end);\n                                vm.new_booking.end_time = {time: moment(vm.new_booking.end).format(\"HH:mm\")};\n\n                                vm.new_booking.after_booking_end = moment().isAfter(moment(vm.new_booking.end));\n                                \n                                //vm.default_date = new Date(vm.new_booking.start);\n                                \n                                \n                                if(vm.new_booking.instructor && vm.new_booking.instructor.id == vm.user_id){\n                                    vm.booking_self = false;\n                                }\n\n\n                                 //this will require breaking up quite a bit... but to access the parent one...\n                                $scope.$parent.vm.default_date =  vm.new_booking.start_date;\n                                setTimeout(function(){\n                                    $scope.$parent.vm.see_booking.visible = 0;\n                                    $scope.$apply();\n\n\n\n                                }, 1000);\n\n                                // //console.log(\"DEFAULT\", vm.default_date);                               \n\n                                generate_datetimes();\n\n                                $scope.update_dateTime(\"edit\");\n                                \n                                // //console.log(\"EDIT\", vm.new_booking);\n                                // //console.log(\"=== CHECK AT EDIT\", vm.new_booking.instructor);\n                                \n\n                                // InstructorCharges.GetByClubId(vm.new_booking.club_id)\n                                //     .then(function(data){\n\n                                //         vm.instructor_charges = data.items;  \n                                //         // //console.log(\"====> \", data); \n                                //     });\n\n                                //vm.courses\n\n                                CourseService.GetCoursesByClubId(vm.new_booking.club_id)\n                                .then(function(data){\n                                    vm.courses = data.items;   \n                                });\n\n\n\n                                //get all the club members by first and last name and email --> nothing else\n                                //this would only include the members that are for the plane that was selected....\n\n\n                                ////console.log(\"BEFORE GET\", vm.new_booking.end_time);\n                                prepare_add_edit(vm.new_booking.club_id, vm.new_booking.end);\n\n\n\n                                if(vm.new_booking.rental_items){\n                                    //then we may have shizzle to check / update\n                                    for(var i=0;i<vm.new_booking.rental_items.length;i++){\n                                        //first and foremost we need to check the available bits....\n                                        // //console.log(\"NO TO BOOK: \"+vm.new_booking.rental_items[i][\"number_to_book\"]);\n                                        vm.new_booking.rental_items[i][\"number_to_book\"] = parseInt(vm.new_booking.rental_items[i][\"number_to_book\"]);\n                                    }\n                                }\n\n                                if(vm.new_booking.free_seats){\n                                    // //console.log(\"FREE\", vm.new_booking.free_seats);\n                                    vm.new_booking.free_seats = parseInt(vm.new_booking.free_seats);\n                                }\n\n                                if(vm.new_booking.instructor){\n                                    // //console.log(\"MY INSTRUCTOR HERE22: \", vm.new_booking.instructor);\n\n                                }\n\n\n\n\n                                if((vm.club_id == 0 || !vm.club_id) && vm.new_booking.plane && vm.new_booking.plane.id){\n                                    vm.club_id = vm.new_booking.plane.club_id;\n                                }\n\n                                free_places();\n                                \n                                // //console.log(\"MY INSTRUCTOR HERE2244: \", vm.new_booking.instructor);\n\n                            } else {\n                                alert(\"Booking Error \\n \\n\"+data.message);\n                                $state.go('dashboard.bookings.add');\n                            }\n\n                        });\n\n\n                }\n               \n\n\n               \n            break;\n            case \"list\":\n                //need to update this to be part of the authentication\n                //to find out club id\n                // //console.log(\"VM\", vm);\n                // //console.log(\"VM\", $stateParams);\n\n                //alert(\"LIST\");\n                //alert(moment($stateParams.start).add(1, \"hour\").format(\"HH:mm\"));\n\n             \n\n\n                vm.show_no_membership_message = false;\n                vm.hide_dropdown = false; \n                vm.clubs = [];\n\n                //we need to get the memberships that the user is a member of....\n                MemberService.GetUserClubs(vm.user.id)\n                 .then(function(data){\n                        vm.clubs = data.clubs;\n\n                        //console.log(\"CLUBS HERE : \", data);\n\n                        if(vm.clubs && vm.clubs.length > 1){\n                            vm.hide_dropdown = true;\n                        } else if(vm.clubs.length == 1) {\n                            vm.club_id = vm.clubs[0].id;\n                            // //console.log(\"SETTING THE CLUB ID HERE:: \", vm.club_id);\n                        }\n                    \n                        update_bookings();\n\n                    });\n                 \n                 //generate_datetimes();\n\n                //  BookingService.GetAllPlanes(vm.user.id, moment(vm.new_booking.start_datetime).format(\"Y-M-D HH:mm\"), moment(vm.new_booking.end_datetime).format(\"Y-M-D HH:mm\"), 0, 0)\n                // .then(function(data){\n                   \n                //     vm.planes = data;\n                //     // //console.log(\"PLANES NOW SET\", vm.planes);\n                //     if($stateParams.plane_id){\n                //         // //console.log(\"plane_id\", $stateParams.plane_id);\n                //         for(var i=0;i<vm.planes.length;i++){\n                //             // //console.log(\"I\", i);\n                //             // //console.log(\"id 1\", vm.planes[i].id);\n                //             // //console.log(\"I\", i);\n                //             if(parseInt(vm.planes[i].id) == $stateParams.plane_id){\n                //                 vm.new_booking.plane = vm.planes[i];\n                //                 // //console.log(\"found\", vm.planes[i]);\n                //             }\n                //         }\n\n                //     }\n\n                // });\n\n            break;\n            default:\n                //console.log(\"none of the above... redirect somewhere?\");\n            break;\n        }  \n\n\n\n        function getAllPlaneUpdate(){\n            check_times();\n            //$scope.update_dateTime('edit');\n             // BookingService.GetAllPlanes(vm.user.id, vm.new_booking.start_datetime, vm.new_booking.end_datetime, 0, 0)\n             //    .then(function(data){\n                   \n             //        //this gets the events and bookings for the period checked here...\n             //        // var events = data.events;\n             //        vm.planes = data;\n                \n\n             //    });\n        }\n\n        \n       \n        $scope.back = function(){\n            $window.history.back();\n        }\n\n        /* THIS SECTION IS ABOUT THE CALENDAR SHOWN ON ALL PAGES */\n\n\n        /* FUNCTIONS REQUIRED FOR ALL PAGES SHOWING THE BOOKINGS ON CALENDAR */\n\n\n        $scope.test = function(){\n            //console.log(\"UPDATE\");\n            vm.new_booking.instructor = {\n                id: 90,\n                first_name: \"A\",\n                last_name: \"REYNIER\"\n            };\n        }\n    \n\n    $scope.updateEvents = function(start, end){\n        ////console.log(\"start\", start, \"end\", end);\n\n        BookingService.GetAll(vm.user.id, start, end)\n        .then(function(data){\n            //console.log(data);\n\n            $scope.all_events = data.events;\n            $scope.all_resources = data.resources;\n\n            // //console.log(\"hello\", $scope.all_events);\n            // //console.log(\"hello\", $scope.all_resources);\n\n            return data;\n\n        });\n    }\n\n\n\n    /* Render Tooltip */\n    $scope.eventRender = function( event, element, view ) {\n        element.attr({'tooltip': event.title,\n                      'tooltip-append-to-body': true});\n        $compile(element)($scope);\n    };\n\n    \n    $scope.alertOnClicked = function(calEvent, jsEvent, view){\n            \n            vm.see_booking = calEvent;\n\n            vm.see_booking.start_date = moment(vm.see_booking.start).format(\"DD/MM/YYYY\");\n            vm.see_booking.end_date = moment(vm.see_booking.end).format(\"DD/MM/YYYY\");\n            vm.see_booking.start_time = moment(vm.see_booking.start).format(\"HH:mm\");\n            vm.see_booking.end_time = moment(vm.see_booking.end).format(\"HH:mm\");\n\n            vm.see_booking.start_datetime = new Date(new Date(vm.see_booking.start).toUTCString());\n            vm.see_booking.end_datetime = new Date(vm.see_booking.end);\n            vm.see_booking.visible = 1;\n\n            vm.see_booking.after_booking_end = moment().isAfter(moment(vm.see_booking.end));\n\n            $scope.$apply();\n    };\n\n\n    $scope.close_details = function(){\n            vm.see_booking.visible = 0;\n    }\n\n\n    $scope.changeLang = function() {\n    \n        $scope.uiConfig.calendar.dayNames = [\"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\"];\n        $scope.uiConfig.calendar.dayNamesShort = [\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"];\n      \n    };\n\n    $scope.changed = function () {\n        // $log.log('Time changed to: ' + $scope.mytime);\n        $scope.check_plane_availability();\n    };\n\n    function j_changed() {\n        // $log.log('Time changed to: ' + $scope.mytime);\n        $scope.check_plane_availability();\n    };\n\n    $scope.check_plane_availability = function(){\n       \n        generate_datetimes();\n\n        //getALL?\n        var getA = (vm.new_booking.edit_booking == 1)? 1 : 0;\n        var plane_id = (vm.new_booking.plane_id > 0)? vm.new_booking.plane_id : 0;\n        if(vm.new_booking.plane && vm.new_booking.plane.id){\n            plane_id = vm.new_booking.plane.id;\n        }\n\n        console.log(\"START\", vm.new_booking.start_datetime);\n        // console.log(\"START\", moment(vm.new_booking.start_datetime).format(\"Y-M-D HH:mm\"));\n        console.log(\"START iso\", new Date(vm.new_booking.start_datetime).toIsoString());\n        console.log(\"END\", vm.new_booking.end_datetime);\n\n        BookingService.GetAllPlanes(vm.user.id, vm.new_booking.start_datetime, vm.new_booking.end_datetime, 0, plane_id)\n        .then(function(data){\n           \n            //this gets the events and bookings for the period checked here...\n            // var events = data.events;\n            vm.planes = data;\n            \n\n            if(getA == 1){\n                //then I just want to iterate through these and return the plane already selected as \"available...\"\n\n                ////console.log(\"PLANE\", vm.new_booking.plane);\n\n                for(var i = 0; i<vm.planes.length; i++){\n                    if(vm.planes[i].id == vm.new_booking.plane.id){\n                        reset_chosen = 0;\n                        vm.new_booking.plane = vm.planes[i];\n                        //chosen is still available WOOOO\n                        $scope.check_rental_items();\n                    }\n                }\n\n\n\n            } else {\n\n                 //check if anything was already selected...\n                var reset_chosen = 1;\n                if(vm.new_booking.plane){\n                    for(var i = 0; i<vm.planes.length; i++){\n                        if(vm.planes[i].id == vm.new_booking.plane.id){\n                            reset_chosen = 0;\n                            //chosen is still available WOOOO\n                            $scope.check_rental_items();\n                        }\n                    }\n                    if(reset_chosen == 1){\n                        //then we just need to clear currently selected plane\n                        vm.new_booking.plane = {};\n                        delete(vm.new_booking.plane);\n                    }\n                    //otherwise we can leave that we've already done! :)\n                }\n\n\n            }\n\n        });\n\n    }\n\n    $scope.events = [];\n\n    function getDayClass(data) {\n        var date = data.date,\n          mode = data.mode;\n        if (mode === 'day') {\n          var dayToCheck = new Date(date).setHours(0,0,0,0);\n\n          for (var i = 0; i < $scope.events.length; i++) {\n            var currentDay = new Date($scope.events[i].date).setHours(0,0,0,0);\n\n            if (dayToCheck === currentDay) {\n              return $scope.events[i].status;\n            }\n          }\n        }\n\n        return '';\n      }\n\n\n    $scope.addOne = function(start=null, plane_id=null, end=null){\n        // //console.log(\"ADDING HERE --> with \", start);\n\n        if(start && !end){                 \n            end = moment(start).add(1, \"hour\").format();\n        }\n\n        //alert(end);\n        $state.go('dashboard.bookings.add', {\"start\": start, \"plane_id\": plane_id, \"end\": end});\n    }\n\n    $scope.cancel_changes = function(){\n        $state.go('dashboard.bookings.add');\n    }\n\n    $scope.check_rental_items = function(){\n        generate_datetimes();\n\n        vm.rental_items = [];\n\n        if(vm.new_booking.plane){\n\n            var club_id = (vm.new_booking.edit_booking == 1) ? vm.new_booking.club_id : vm.new_booking.plane.club_id;\n\n            BookingService.GetRentalItems(club_id, moment(vm.new_booking.start_datetime).format(\"Y-M-D HH:mm\"), moment(vm.new_booking.end_datetime).format(\"Y-M-D HH:mm\"), 0)\n            .then(function(data){\n           \n                vm.rental_items = data;\n\n                if(vm.new_booking.rental_items){\n                    //then we may have shizzle to check / update\n                    for(var i=0;i<vm.new_booking.rental_items;i++){\n                        //first and foremost we need to check the available bits....\n                        var found = 0;\n                        for(var j=0;j<vm.rental_items.length;j++){\n                            if(vm.rental_items[j][\"id\"] == vm.new_booking.rental_items[i][\"id\"]){\n                                //then we need to check that the current numbers available are still the same as before...\n                                if(parseInt(vm.new_booking.rental_items[i][\"number_to_book\"]) > parseInt(vm.rental_items[j][\"number_available\"])){\n                                    vm.new_booking.rental_items[i][\"number_to_book\"] = parseInt(vm.rental_items[j][\"number_available\"]);\n                                }\n                                vm.new_booking.rental_items[i][\"number_available\"] = parseInt(vm.rental_items[j][\"number_available\"]);\n                                found = 1;\n                                break;\n                            }\n                        }\n                        if(found == 0){\n                            //then we need to remove it...\n                            delete vm.new_booking.rental_items[i];\n                        }\n\n                    }\n\n                }\n\n\n                for(var k=0; k<vm.rental_items.length;k++){\n                    vm.rental_items[k].number = 0;\n                }\n\n                //if there is one already selected?\n                //check if anything was already selected...\n                if(vm.new_booking.rental_items){\n                    for(var j=0; j<vm.new_booking.rental_items; j++){\n                        var reset_chosen = 1;\n                        for(var i = 0; i<vm.rental_items.length; i++){\n                            if(vm.rental_items[i].id == vm.new_booking.rental_items[j].id){\n                                reset_chosen = 0;\n                                //chosen is still available WOOOO\n                            }\n                        }\n                        if(reset_chosen == 1){\n                            //then we just need to clear currently selected plane\n                            delete vm.new_booking.rental_items[j];\n                        }\n                    }\n                    //otherwise we can leave that we've already done! :)\n                }\n\n\n\n\n            });\n\n        }\n    }\n\n    function check_times(clean_type = null){\n\n            var c = new Date();\n            var a = (vm.new_booking.start_time) ? vm.new_booking.start_time.time.split(\":\") : [c.getHours(), c.getMinutes()];\n            var b = new Date(vm.new_booking.start_date);\n            b.setHours(a[0]);\n            b.setMinutes(a[1]);\n            b.setSeconds(0);\n            var future = moment(b).add(1, \"hour\").format();\n\n            //check if the end_time is set && if the end time is > start time...\n            if(start_after_end() || !vm.new_booking.end_time){\n\n                clean_times(check_relative_date(vm.new_booking.end_date, \"end\"), 'end_times', b);\n\n                var id;\n                // vm.end_times.forEach(function(time, i){ \n                //   if(time.time == moment(future).format(\"H:mm\")){ id = i; return true;}; \n                // });\n                vm.end_times.some(function(time, i){ \n                  if(time.time == moment(future).format(\"HH:mm\")){ id = i; return i;};  \n                });\n\n                vm.new_booking.end_time = {};\n                vm.new_booking.end_time = vm.end_times[id];\n\n            } else {\n                if(!clean_type){\n                    clean_times(check_relative_date(vm.new_booking.end_date, \"end\"), 'end_times', b);\n                } \n            }\n\n\n             //need to update the selection of the end time if this has been set\n            if(vm.new_booking.end_time && vm.new_booking.end_time.disabled == 1){\n\n                var id;\n                //used to use a forEach loop but decided to run a some loop instead due to the benefit of not going through all elements\n                // vm.end_times.forEach(function(time, i){ \n                //   if(time.time == moment(future).format(\"HH:mm\")){ id = i; return true;}; \n                // });\n                vm.end_times.some(function(time, i){ \n                  if(time.time == moment(future).format(\"HH:mm\")){ id = i; return i;};  \n                });\n\n                vm.new_booking.end_time = {};\n                vm.new_booking.end_time = vm.end_times[id];\n\n            }\n\n            if(vm.new_booking.start_time && vm.new_booking.start_time.disabled == 1){\n                if(!clean_type){\n               \n                var id;\n                vm.start_times.some(function(time, i){ \n                  if(time.disabled == 0){ id = i; return i;}; \n                });\n\n                vm.new_booking.start_time = {};\n                vm.new_booking.start_time = vm.start_times[id];\n                 } \n\n                calculate_duration();\n            }\n    }\n\n    $scope.update_dateTime = function(which_update, params=null){\n\n        ////console.log(\"UPDATE TIME HERE\", which_update);\n\n        switch(which_update){\n\n            case 'start_date':\n\n                booking_today();\n\n                if(vm.new_booking.start_date > vm.new_booking.end_date){\n                    vm.new_booking.end_date = vm.new_booking.start_date;\n                }\n\n                clean_times(check_relative_date(vm.new_booking.start_date), 'start_times');\n\n                check_times();\n\n                if(start_after_end()){\n                    add_hour_to_end();\n                }\n\n            break;\n\n            case 'end_date':\n\n                 booking_today();\n                \n                check_times();\n\n                if(vm.new_booking.end_date < vm.new_booking.start_date){\n                    vm.new_booking.start_date = vm.new_booking.end_date;\n                    clean_times(check_relative_date(vm.new_booking.start_date), 'start_times');\n                } else {\n                    clean_times(check_relative_date(vm.new_booking.start_date), 'start_times');\n                    clean_times(check_relative_date(vm.new_booking.end_date, \"end\"), 'end_times');\n                }\n\n                if(start_after_end()){\n                    add_hour_to_end();\n                }\n\n\n            break;\n\n            case 'start_time':\n\n                // alert(\"start_time\");\n                //do we need to clean the times? if so.. \n                booking_today();\n\n                check_times();\n\n                //we need to calculate the time in between the start and the end!\n                calculate_duration();\n                \n\n            break;\n\n            case 'end_time':\n                // vm.times_clean_type = \"start_times\";\n                // if(moment(vm.new_booking.start).unix() < moment().unix()){\n                //     vm.times_clean_type = \"past\";\n                // }\n                if(vm.times_clean_type == \"past\"){\n                    //alert(\"end_time\");\n                    check_times(\"edit\");\n                } else {\n                    check_times();\n                }\n\n\n            break;\n\n            case 'edit':\n\n                // //this is the edit function that needs to be setup.\n                // booking_today();\n\n                // //number 1 = we have set start and end of the current date....\n                // // setTimeout(function(){\n                // //     check_times();\n                // //     // calculate_duration();\n                // // }, 5000);\n                // //console.log(\"ASD \",vm.new_booking.start_date);\n                // // clean_times(check_relative_date(vm.new_booking.start_date), 'start_times');\n                // check_times();\n                // calculate_duration();\n                //alert(\"EDIT 1\");\n\n\n //start_times\n                vm.times_clean_type = \"start_times\";\n                if(moment(vm.new_booking.start).unix() < moment().unix()){\n                    vm.times_clean_type = \"past\";\n                    //clean_times(check_relative_date(vm.new_booking.start_date), \"end_times\");\n                                \n\n\n                } else {\n                                check_times();\n                    booking_today();\n                }\n                calculate_duration();\n\n                setTimeout(function(){\n                    //do we need to clean the times? if so.. \n                    // pre_select_value_id(\"start_times\", vm.new_booking.start_time);\n                    pre_select_value_id();\n                    //we need to calculate the time in between the start and the end!\n                }, 500);\n\n\n\n\n                //we need to set the previously selected plane here...\n\n\n            break;\n\n            case 'edit2':\n\n                // //this is the edit function that needs to be setup.\n                // booking_today();\n\n                // //number 1 = we have set start and end of the current date....\n                // // setTimeout(function(){\n                // //     check_times();\n                // //     // calculate_duration();\n                // // }, 5000);\n                // //console.log(\"ASD \",vm.new_booking.start_date);\n                // // clean_times(check_relative_date(vm.new_booking.start_date), 'start_times');\n                // check_times();\n                // calculate_duration();\n\n                booking_today();\n\n                clean_times(check_relative_date(vm.new_booking.start_date), 'start_times');\n\n                check_times();\n\n                calculate_duration();\n\n                setTimeout(function(){\n                    //do we need to clean the times? if so.. \n                    // pre_select_value_id(\"start_times\", vm.new_booking.start_time);\n                    pre_select_value_id();\n                    //we need to calculate the time in between the start and the end!\n\n                     if(params){\n                        // alert(\"plane\");\n                        // alert(params);\n                        // //console.log(\"SELECT ME \", vm.planes);\n                                for(var i=0;i<vm.planes.length;i++){\n                                    // //console.log(\"I\", i);\n                                    // //console.log(\"id 1\", vm.planes[i].id);\n                                    // //console.log(\"I\", i);\n                                    if(parseInt(vm.planes[i].id) == params){\n                                        vm.new_booking.plane = vm.planes[i];\n                                        $scope.getPlaneInstructors(vm.new_booking.plane.id);\n                                         ////console.log(\"found\", vm.new_booking);\n                                         $scope.$apply();\n                                    }\n                                }\n                    }\n                    \n                }, 500);\n\n\n\n\n                //we need to set the previously selected plane here...\n\n\n            break;\n\n\n        }\n\n\n        //an update on the form would require an update of the plane / waiting lists available\n        $scope.check_plane_availability();\n\n        if(vm.new_booking.plane){\n            //then we check what is available for these guys!\n            $scope.check_rental_items();\n        }\n\n        //if the plane was already selected - then we can also update the instructors so as to not require\n        //the user to have to re-select the plane\n        if(vm.new_booking.plane){\n            $scope.getPlaneInstructors();\n        }\n\n\n    }\n\n\n\n\n    function pre_select_value_id(){\n\n        vm.start_times.forEach(function(times, i){\n            // //console.log(times.time+\" == \"+vm.new_booking.start_time.time);\n            if(times.time == vm.new_booking.start_time.time){\n                // //console.log(\"THIS I \", i);\n                vm.new_booking.start_time = vm.start_times[i];\n            }\n\n        });\n        // //console.log(\"END\", vm.end_times);\n\n         vm.end_times.forEach(function(times, i){\n\n            if(times.time == vm.new_booking.end_time.time){\n                // //console.log(\"THIS I \", i);\n                vm.new_booking.end_time = vm.end_times[i];\n            }\n\n        });\n\n        $scope.$apply();\n\n    }\n\n\n\n    $scope.update_booking = function(valid){\n\n\n        //alert(\"UPDATE\");\n\n        generate_datetimes();\n\n        if(valid){\n\n                // //console.log(\"VALID SUBMISSION\");\n                // //console.log(\"START\", vm.new_booking.start_datetime);\n                // //console.log(\"END\", vm.new_booking.end_datetime);\n\n                var booking = {};\n                var booking = jQuery.extend(true, {}, vm.new_booking); \n                // //console.log(booking);\n                delete booking.options;\n                delete booking.instructor;\n                delete booking.plane;\n                delete booking.start_date;\n                delete booking.start_time;\n                delete booking.end_date;\n                delete booking.end_time;\n                delete booking.start_datetime;\n                delete booking.end_datetime;\n                delete booking.tuition_required;\n                delete booking.after_booking_end;\n                // //console.log(booking);\n                // //console.log(vm.new_booking);\n                booking.free_seats = (vm.new_booking.free_seats.constructor === Array) ? 0 : vm.new_booking.free_seats;\n                booking.start = vm.new_booking.start_datetime;\n                booking.end = vm.new_booking.end_datetime;\n                booking.course_id = vm.new_booking.tuition_required.id;\n\n\n// Date.parse(vm.new_booking.start_datetime)\n\n                if(moment(Date.parse(vm.new_booking.end_datetime)).add(1, \"hour\").isBefore()){\n                    alert(\"This booking ends in the past by more than an hour - you cannot amend a booking that finished in the past.\");\n                    return false;\n                }\n                //30 mintues leeway in case of booking starting within the 15 minute period or similar\n                // if(moment(vm.new_booking.start_datetime).add(30, \"minutes\") < moment()){\n                //     alert(\"This booking starts in the past - you cannot create a booking in the past.\");\n                //     return false;\n                // }\n\n\n\n\n\n\n                // //console.log(\"START\", booking.start);\n                // //console.log(\"END\", booking.end);\n\n                ////console.log(\"PLANE\", vm.new_booking.plane);\n                booking.resourceId = vm.new_booking.plane.id;\n\n                if(vm.new_booking.plane.id.toString().indexOf(\"w\") > -1){\n                    booking.changed_to_waiting_list = true;\n                    booking.resourceId = vm.new_booking.plane.id.slice(0, -1);\n                }\n\n                if(!vm.booking_self){\n                    booking.user_id = vm.new_booking.user.user_id;\n                    booking.instructor_id = (vm.new_booking.instructor) ? vm.new_booking.instructor.id : vm.user.id;\n                } else {\n                    booking.user_id = vm.user.id;\n                    booking.instructor_id = (vm.new_booking.instructor) ? vm.new_booking.instructor.id : 0;\n                }\n                \n                \n\n\n                booking.plane_id = vm.new_booking.plane.id;\n                booking.override = (vm.new_booking.override) ? vm.new_booking.override : 0;\n                booking.club_id = vm.new_booking.plane.club_id;\n\n                // //console.log(\"====> booking to be sent = \", booking);\n\n                check_before_changing_event(booking);\n\n        }\n\n    }\n\n    $scope.update_club = function(){\n            //console.log(\"we changed club here\");\n            vm.club_id = vm.change_club.id;\n                //console.log(\"CLUB ID IS :\", vm.club_id);\n                if(vm.user.access.instructor.indexOf(vm.club_id) > -1){\n                    //console.log(\"THIS IS AN INSTRUCTOR IN THIS CLUB...\");\n                    vm.booking_self = false;\n                }\n            //now we need to update the planes the user can see on the calendar! \n            update_bookings();\n\n    }\n\n    function update_bookings(){\n\n\n         // BookingService.GetAllUserClub(vm.user.id,vm.club_id, moment().format(\"Y-M-D\"), \"\")\n         //        .then(function(data){\n                   \n         //            $scope.all_events = data.events;\n         //            $scope.all_resources = data.resources;\n\n         //        });\n\n         //console.log(\"UPDATE BOOKINGS \");\n         BookingService.GetAll(vm.user.id, moment().format(\"Y-M-D\"), \"\")\n        .then(function(data){\n            //console.log(data);\n\n            $scope.all_events = data.events;\n            $scope.all_resources = data.resources;\n\n            //console.log(\"hello\", $scope.all_events);\n            //console.log(\"hello\", $scope.all_resources);\n\n            return data;\n\n        });\n\n    }\n\n    /* alert on eventClick */\n    $scope.alertOnEventClick = function( date, jsEvent, view){\n        $scope.alertMessage = (date.title + ' was clicked ');\n        //console.log(\"HELLO BOOBIES\");\n        //console.log(event);\n        //show event details\n\n    };\n\n    /* alert on Drop */\n     $scope.alertOnDrop = function(event, delta, revertFunc, jsEvent, ui, view){\n  \n\n\n        if(event.resourceId.toString().indexOf(\"w\") > -1){\n            event.changed_to_waiting_list = true;\n            event.resourceId = event.resourceId.slice(0, -1);\n        }\n\n        // //console.log(\"HELLO BOOBIES\", event);\n\n\n        check_before_changing_event(event);\n       \n    };\n\n\n    /* alert on Resize */\n    $scope.alertOnResize = function(event, delta, revertFunc, jsEvent, ui, view ){\n        \n        check_before_changing_event(event);\n\n    };\n\n\n\n    $scope.override_booking_change = function(override){\n\n        vm.error_event[override] = true;\n        //vm.error_event.override = true;\n\n        check_before_changing_event(vm.error_event, true);\n\n\n    }\n\n    $scope.decline_booking_change = function(){\n\n        vm.booking_errors = {};\n        vm.error_event = {};\n        $('#calendar').fullCalendar('removeEvents');\n        $('#calendar').fullCalendar('addEventSource', all_events);\n\n    }\n\n\n    function check_before_changing_event(event, err=null){\n        //the important bit is the eventID \n\n       if(err){\n         vm.booking_errors = {};\n            vm.error_event = {};\n       }\n\n        var evnt = jQuery.extend({}, event);\n\n        // evnt.start = moment(evnt.start).format(\"YYYY-MM-DD HH:mm\");\n        // evnt.end = moment(evnt.end).format(\"YYYY-MM-DD HH:mm\");\n        \n        //this covers the change of plane for the booking...\n        evnt.plane_id = event.resourceId;\n        if(event.instructor_id !== \"\"){\n            evnt.instructor_id = event.instructor_id;\n        } else {\n            evnt.instructor_id = \"0\";\n        }\n        //updatable bits:\n\n        delete evnt._start;\n        delete evnt._end;\n        delete evnt._id;\n        delete evnt.source;\n        delete evnt._allDay;\n        delete evnt.allDay;\n        delete evnt.className;\n        delete evnt.plane;\n        delete evnt.title;\n        delete evnt.editable;\n        delete evnt.resourceIds;\n        evnt.update_rental_items = true;\n\n        // //console.log(\"EVENT CHANGE\", evnt);\n\n        var original_event;\n        for(var i=0; i<$scope.all_events.length;i++){\n            if($scope.all_events[i].id == evnt.id){\n                original_event = $scope.all_events[i];\n                // //console.log(\"original EVENT\", original_event);\n            }\n        }\n\n\n        // //console.log(\"original end: \", moment(original_event.end).unix());\n        // //console.log(\"new end is : \", evnt.end.unix());\n\n        // //console.log(\"1original start: \", original_event.start);\n        // //console.log(\"1new start is : \", evnt.start);\n\n        // //console.log(\"2original start: \", moment(original_event.start).unix());\n        // //console.log(\"2new start is : \", evnt.start.unix());\n\n        // //console.log(\"1original start again: \", original_event.start);\n\n\n        //event in the past cannot be amended AFTER the booking - but the booking can be exte\n\n        // //console.log(\"all_events\", $scope.all_events);\n\n        if(moment(Date.parse(evnt.end)) < moment()){\n            alert(\"This booking ends in the past - you cannot amend a booking in the past.\");\n            return false;\n        }\n        // 30 mintues leeway in case of booking starting within the 15 minute period or similar\n        if(moment(evnt.start).add(30, \"minutes\") < moment()){\n                // //console.log(\"start is older than 30 minutes ago\");\n                // //console.log(\"1original start again: \", original_event.start);\n\n            if(moment(original_event.end) !== evnt.end){\n                // //console.log(\"end is not the same end\");\n                // //console.log(\"original end: \", moment(original_event.end).unix());\n                // //console.log(\"new end is : \", evnt.end.unix());\n\n                var p = confirm(\"This booking starts in the past - you cannot amend the start date or time of a booking in the past, would you like to amend the end time along with any other changes you have made?\");\n                if(p){  \n                    // //console.log(\"START UPDATE = \",evnt.start );\n                    evnt.start = original_event.start;\n                    // //console.log(\"START UPDATE = \",evnt.start );\n                } else {\n                    return false;\n                }\n\n            }\n\n\n\n\n            //let's reset the booking'start time\n\n           \n\n\n\n\n           // return false;\n        }\n\n        // //console.log(\"UPDATE CONTENT BEFORE\", evnt);\n\n        BookingService.updateBooking(evnt, vm.user.id)\n        .then(function(data){\n            //console.log(data);\n\n            if(data.success == true){\n                //console.log(\"the booking did not need to be altered and has been updated successfully.\", evnt);\n\n                //only if the edition is being made from the \"edit\" otherwise the changes are already reflected appropriately.\n                if(evnt.edit_booking == 1){\n                    $scope.$parent.updateEvents(evnt.start, evnt.end);\n                }\n                \n                alert(\"Your changes were saved successfully\");\n                \n                if(vm.return_to == \"bookout\") {\n                    //console.log(\"WE ARE AT THE BOOKOUT BIT - SO RETURN THERE!!!\");\n                    $state.go('dashboard.my_account.bookout_with_booking', { \"booking_id\": event.id });\n                } else {\n                    //console.log(\"NORMAL booking\");\n                    $state.go('dashboard.bookings.add');\n                }\n\n\n\n            } else {\n                //display the error\n                //console.log(\"The booking cannot remain the same due to : \"+data.message);\n\n                //hollow :::     $(\"#calendar\").fullCalendar('refetchEvents');\n\n\n                //I have decided to do this as a sequential check / accept / decline as opposed to combined\n                //this can be altered at a later date to be combined, with accept / decline on each error\n                //but this is more work than i can do right now!\n\n                var errors = [];\n                if(data.instructor !== true){\n                    errors.push({\n                        type: \"instructor\",\n                        message: \"It looks like your instructor is not available on the updated date and time\",\n                        api: data.instructor,\n                        override: \"instructor_override\",\n                        button: \"\" \n                    });\n                } else if(data.check_user !== true){\n\n                    if(data.check_user.indexOf(\"self-certify\") > -1){\n\n                        errors.push({\n                            type: \"check_user\",\n                            message: \"It would appear that you are not within the currency requirements to book this aircraft for this flight.\",\n                            api: data.check_user,\n                            override: \"currency_override\",\n                            button: \"I am Current\" \n                        });\n\n\n                    } else {\n                        errors.push({\n                            type: \"check_user\",\n                            message: \"It looks like your user account does not allow this booking to happen\",\n                            api: data.check_user,\n                            override: \"currency_override\",\n                            button: \"\" \n                        });\n                    }\n\n                   \n                } else if(data.rental_items !== true){\n                    errors.push({\n                        type: \"rental_items\",\n                        message: \"It looks like some of the rental items are not available\",\n                        api: data.rental_items,\n                        override: \"update_rental_items\",\n                        button: \"Confirm Changes\" \n                    });\n                }\n\n\n                //show the errors:::\n\n                // alert(\"ERROR FOUND IN ALTERING THE BOOKING\");\n\n                vm.booking_errors = errors;\n                //console.log(\"ERRORS ARE : \", vm.booking_errors);\n                vm.error_event = evnt;\n\n                //on GO--> check_before_changing_event(evnt)    \n\n\n                //if CANCEL?\n                //this would reset the change... do we want this?\n                //$(\"#calendar\").fullCalendar('refetchEvents');\n\n\n\n            }\n\n            return data;\n\n        });\n\n    }\n\n    $scope.wholeDay = function(){\n\n       if($scope.whole_day_booking == true){\n            $scope.whole_day_booking = false;\n            $scope.myDatetimeRange.time.from = defaultStartTime;\n            $scope.myDatetimeRange.time.to = defaultEndTime;\n       } else {\n            $scope.whole_day_booking = true;\n            $scope.myDatetimeRange.time.from = 0;\n            $scope.myDatetimeRange.time.to = 1440;\n       }\n       \n\n    }\n\n    //Changing the view of the calendar\n    $scope.changeView = function(view,calendar) {\n      uiCalendarConfig.calendars[calendar].fullCalendar('changeView',view);\n    };\n\n    /* Change View */\n    $scope.renderCalender = function(calendar) {\n      $timeout(function() {\n        if(uiCalendarConfig.calendars[calendar]){\n          uiCalendarConfig.calendars[calendar].fullCalendar('render');\n        }\n      });\n    };\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n    /* THIS SECTION IS ABOUT THE ADD / EDIT OF THE CALENDAR EVENTS VIA THE EDIT / ADD NEW BOOKING */\n\n    /* ADD OR EDIT THE BOOKING */\n\n    function figure_out_steps(){\n        //console.log(\"OPTIONS\", vm.dateTimeRangePickerOptions);\n        vm.new_booking.options = vm.dateTimeRangePickerOptions;\n         for(var i=0;i<24;i+=vm.new_booking.options.hour_step){\n\n            if(vm.new_booking.options.minute_step && vm.new_booking.options.minute_step > 0){\n                for(var j=0; j<(60/vm.new_booking.options.minute_step); j++){\n                    var k = vm.new_booking.options.minute_step * j;\n                    k = ((k < 10) ? '0' : '') + k;\n                    vm.start_times.push({time: i+\":\"+k, disabled: check_business_hours(i, k)});\n                    vm.end_times.push({time: i+\":\"+k, disabled: check_business_hours(i, k), duration: \"\"});\n                }\n            } else {\n                vm.start_times.push({time: i+\":00\", disabled: check_business_hours(i)});\n                vm.end_times.push({time: i+\":00\", disabled: check_business_hours(i), duration: \"\"});\n            }\n\n        }\n    }\n\n    function init_times(){\n       for(var i=0;i<24;i+=vm.new_booking.options.hour_step){\n\n            if(vm.new_booking.options.minute_step && vm.new_booking.options.minute_step > 0){\n                for(var j=0; j<(60/vm.new_booking.options.minute_step); j++){\n                    var k = vm.new_booking.options.minute_step * j;\n                    k = ((k < 10) ? '0' : '') + k;\n                    vm.start_times.push({time: i+\":\"+k, disabled: check_business_hours(i, k)});\n                    vm.end_times.push({time: i+\":\"+k, disabled: check_business_hours(i, k), duration: \"\"});\n                }\n            } else {\n                vm.start_times.push({time: i+\":00\", disabled: check_business_hours(i)});\n                vm.end_times.push({time: i+\":00\", disabled: check_business_hours(i), duration: \"\"});\n            }\n\n        } \n    }\n    \n\n    $scope.add_rental_item = function(){\n        if(vm.rental_item && vm.new_booking.rental_items && vm.rental_item.id){\n            var add_to_list = 1;\n            var delete_this = 0;\n            for(var j=0; j<vm.new_booking.rental_items.length; j++){\n                if(vm.new_booking.rental_items[j].id == vm.rental_item.id){\n                    add_to_list = 0;\n                    delete_this = vm.new_booking.rental_items[j];\n                    //console.log(\"item was already found there...\");\n                }\n            }\n            if(add_to_list == 1){\n                //then its not already in teh list!\n                vm.new_booking.rental_items.push(vm.rental_item);\n                delete vm.rental_item;\n\n            }\n\n        } else {\n            if(vm.rental_item){\n                //console.log(\"rental_item is: \", vm.rental_item);\n                if(!vm.new_booking.rental_items){\n                    //init here if its the first item...\n                    vm.new_booking.rental_items = [];\n                }\n                vm.new_booking.rental_items.push(vm.rental_item);\n                delete vm.rental_item;\n            }\n               \n        }\n\n    }\n\n\n    $scope.rental_item_remove = function(id){\n        //as this is before we actually do the shizzle!\n        vm.new_booking.rental_items = $.grep(vm.new_booking.rental_items, function(e){ \n                return e.id != id; \n        });\n    }\n\n\n\n    $scope.getPlaneInstructors = function(){\n\n\n        //console.log(\"CHANGE OF PLANE HERE\");\n\n\n        if((vm.user.access.instructor.indexOf(vm.club_id) > -1) || (vm.user.access.manager.indexOf(vm.club_id) > -1) ){\n            //console.log(\"NOT BOOKING FOR SELF?\");\n            vm.booking_self = false;\n            prepare_add_edit();\n        }\n\n        if( vm.user.access.manager.indexOf(vm.club_id) > -1 ){\n            vm.booking_admin = true;\n\n        }\n\n        vm.init_passengers();\n        $scope.check_rental_items();\n\n\n        if(vm.action == \"add\"){\n\n          \n\n\n            BookingService.GetPlaneInstructors(vm.user.id, vm.new_booking.plane.id, vm.new_booking.start_datetime, vm.new_booking.end_datetime, (vm.booking_self)? 0 : 1)\n            .then(function(data){\n                //console.log(data);\n                //console.log(\"NEW INSTRUCTORS ARE : \", data);\n                vm.instructors = data;\n\n                var reset_chosen = 1;\n                if(vm.new_booking.instructor){\n                    for(var i = 0; i<vm.instructors.length; i++){\n                        if(vm.instructors[i].id == vm.new_booking.instructor.id){\n                            reset_chosen = 0;\n                        }\n                    }\n                    if(reset_chosen == 1){\n                        //then we just need to clear currently selected plane\n                        vm.new_booking.instructor = {};\n                        delete(vm.new_booking.instructor);\n                    }\n                    //otherwise we can leave that we've already done! :)\n                }\n                free_places();\n            });\n\n\n        } else {\n            //must be edit... sooooooo\n\n            BookingService.GetPlaneInstructorsEdit(vm.user.id, vm.new_booking.plane.id, vm.new_booking.start_datetime, vm.new_booking.end_datetime, (vm.booking_self)? 0 : 1, vm.new_booking.id)\n            .then(function(data){\n                //console.log(data);\n                //console.log(\"NEW INSTRUCTORS ARE : \", data);\n\n\n                vm.instructors = data;\n\n                var reset_chosen = 1;\n                if(vm.new_booking.instructor){\n                    for(var i = 0; i<vm.instructors.length; i++){\n                        if(vm.instructors[i].id == vm.new_booking.instructor.id){\n                            reset_chosen = 0;\n                        }\n                    }\n                    if(reset_chosen == 1){\n                        //then we just need to clear currently selected plane\n                        vm.new_booking.instructor = {};\n                        delete(vm.new_booking.instructor);\n                    }\n                    //otherwise we can leave that we've already done! :)\n                }\n                free_places();\n            });\n\n        }\n\n\n        // InstructorCharges.GetByClubId(vm.new_booking.plane.club_id)\n        //         .then(function(data){\n        //             vm.instructor_charges = data.items;  \n        //             ////console.log(\"====> \", data); \n        //         });\n\n         CourseService.GetCoursesByClubId(vm.new_booking.plane.club_id)\n                    .then(function(data){\n                        vm.courses = data.items;   \n                    });\n\n\n        //console.log(\"vm.new_booking.plane.club_id\", vm.new_booking.plane.club_id);\n        //console.log(\"vm.new_booking.plane.club_id\", vm.user.access.instructor);\n        //console.log(\"INDEX :: \", vm.user.access.instructor.indexOf(parseInt(vm.new_booking.plane.club_id)));\n        \n        // if(vm.user.access.instructor.indexOf(parseInt(vm.new_booking.plane.club_id)) > -1){\n        //     //console.log(\"THIS IS AN INSTRUCTOR IN THIS CLUB...\");\n        //     vm.booking_self = false;\n        // }\n\n\n\n\n\n        //if is_current getPlaneInstructors\n        BookingService.GetIfCurrent(vm.user_id, vm.new_booking.plane.id, vm.new_booking.end_datetime)\n        .then(function (data) {\n            ////console.log(data);\n            if(data.success){\n                //use GB airfields first...\n                vm.is_current = data.is_current;\n                //console.log(\"CURRENCY \", vm.is_current);\n\n                vm.currency_type = data.requirements.currency_type;\n                vm.currency_days = data.requirements.currency_days;\n            } else {\n            }\n        });\n        \n\n        \n\n    }\n\n\n    function free_places(){\n        // //console.log(\"UPDATE FREE PLACES...\", vm.new_booking.passengers.length);\n        // //console.log(\"UPDATE FREE PLACES...\", vm.new_booking.instructor);\n\n        vm.free_seats = [];\n\n        var seats = vm.new_booking.plane.seats - 1;\n\n        if(vm.new_booking.instructor){\n            if(vm.new_booking.instructor.id > 0){\n                // //console.log(\"the instructor was selected for this flight...\");\n                seats--;\n            }\n        }\n\n        if(vm.new_booking.passengers.length > 0){\n            for(var i=0;i<vm.new_booking.passengers.length;i++){\n                if(vm.new_booking.passengers[i] && vm.new_booking.passengers[i][\"email\"] !== \"\"){\n                    seats--;\n                }\n            }\n        }\n\n        for(var i=0; i<seats;i++){\n            vm.free_seats.push(i);\n        }\n\n        // //console.log(\"free seats now...\", vm.free_seats);\n\n        // $scope.$apply();\n\n    }\n\n\n    $scope.clear_booking = function(){\n        vm.new_booking = {\n            start_date: today,\n            end_date: today,\n            free_seats: [],\n            passengers: [],\n            instructor: undefined,\n            options: vm.dateTimeRangePickerOptions\n        };\n        $scope.submitted = false;\n    }\n\n    function calculate_duration(){\n        if(vm.new_booking.start_date && vm.new_booking.start_time){\n            var start_datetime = new Date(vm.new_booking.start_date);\n            var start_time = vm.new_booking.start_time.time.split(\":\");\n            start_datetime.setHours(start_time[0]);\n            start_datetime.setMinutes(start_time[1]);\n            start_datetime.setSeconds(0);\n            // //console.log(\"START DATETIME\", start_datetime);  \n\n            vm.end_times.forEach(function(time, i){ \n                //no need to go through each element if its not required to be shown!\n                if(time.disabled == 0){\n\n                    var end_datetime = new Date(vm.new_booking.end_date);\n                    var end_time = time.time.split(\":\");\n                    end_datetime.setHours(end_time[0]);\n                    end_datetime.setMinutes(end_time[1]);  \n                    end_datetime.setSeconds(0);\n                    // //console.log(\"END DATETIME\", end_datetime);  \n\n                    var difference = moment(moment(end_datetime).startOf(\"minute\")).diff(moment(start_datetime).startOf(\"minute\"));\n\n                    //now we need to calculate the difference in datetime\n                    // //console.log(\"d: \"+moment.duration(difference).days()+\" h: \"+moment.duration(difference).hours()+\" m: \"+moment.duration(difference).minutes());\n                    var human_str = get_duration_str(difference);\n                    // //console.log(\"human string\", human_str);\n                    if(human_str == \"\"){\n                        vm.end_times[i].disabled = 1;\n                    } else {\n                        vm.end_times[i].duration = \"( \"+human_str+\" )\";\n                    }\n\n\n                } else {\n                    vm.end_times[i].duration = \"\";\n                }\n              //if(time.time == moment(future).format(\"H:mm\")){ id = i; return true;}; \n            });\n        }\n    }\n\n    vm.seats_in_plane = function(){\n            free_places();\n\n            //base\n            var no_seats = vm.new_booking.plane.seats;\n\n            //check if instructor aboard?\n            if(vm.new_booking.instructor){   \n                no_seats--;\n            }\n\n            //include self\n            no_seats--;\n\n            // //console.log(\"seats left\", no_seats);\n\n\n            //return final number\n            return no_seats;\n        }\n\n        vm.adding_a_member = function(){\n            //console.log(\"ADDING ONE?\");\n            vm.init_passengers();\n        }\n\n        vm.init_passengers = function(){\n            var no_of_seats = vm.seats_in_plane();\n            // var already_filled = 0;\n            // for(var i=0;i<vm.new_booking.passengers.length;i++){\n            //         if(vm.new_booking.passengers[i] && vm.new_booking.passengers[i][\"email\"] !== \"\"){\n            //             already_filled++;\n            //         }          \n            // };\n            // var cc = no_of_seats - already_filled;\n            // // //console.log(\"CCCC seats -> \",no_of_seats);\n            // // //console.log(\"CCCC already_filled -> \",already_filled);\n            // // //console.log(\"CCCC -> \",cc);\n            // if(cc > 0){\n                vm.new_booking.passengers.push({\n                    first_name: \"\",\n                    last_name: \"\",\n                    email: \"\",\n                    status: \"\"\n                });\n            // }\n            \n        }\n\n        var setting_new_member;\n\n\n        var set_new_member = function(email, index){\n            // //console.log(\"SET MEMBER NOW 123\");\n            vm.new_booking.passengers[index] = {\n                                id: 0,\n                                email: email,\n                                first_name: \"\",\n                                last_name: \"\",\n                                is_member: false,\n                                status: \"to_invite\"\n                            };\n            // //console.log(\"HELLO\");\n            vm.init_passengers();\n            free_places();\n        }\n\n        vm.new_passenger_invite_ready = function(index){\n\n            //let's check the email address -->\n             // \n            var email_regex = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n\n            if(email_regex.test(vm.new_booking.passengers[index].email)){\n\n                // //console.log(\"SET MEMBER NOW 123\");\n                vm.new_booking.passengers[index].is_member = false;\n                vm.new_booking.passengers[index].status = \"to_invite\";\n\n                // //console.log(\"HELLO\");\n                vm.init_passengers();\n                free_places();\n                vm.show_new_passenger_invitation = false;\n            } else {\n                alert(\"The email address appears to be incorrect - please double check the email address entered.\");\n                return false;\n            }\n        }\n\n\n        $scope.cancel_booking = function(booking_id){\n\n            //HOW DO WE CANCEL A BOOKING???\n            //at some point we need to define the booking cancellation reasons here (and make a nice popup style cancel)\n\n            var a = prompt(\"Are you sure you wish to cancel this booking? Please type YES in the box below to confirm.\");\n            if(a == \"YES\"){\n                //then we need to delete the booking... \n\n            BookingService.DeleteBooking(vm.user.id, booking_id)\n            .then(function(data){\n                //console.log(data);\n                alert(\"booking cancelled\");\n\n                if(data.success){\n                    $state.go('dashboard.bookings.add');\n                    \n                     $scope.all_events = $.grep($scope.all_events, function(e){ \n                        return e.id != booking_id; \n                    });\n\n                    $('#calendar').fullCalendar('refetchEvents');\n                    $('#calendar').fullCalendar('removeEvents');\n                    $('#calendar').fullCalendar('addEventSource', $scope.all_events);\n\n                } else {\n                    alert(\"an error occurred...\");\n                    //console.log(\"ERROR\", data);\n                }\n\n            });\n\n\n            } else {\n                $state.go('dashboard.bookings.add');\n            }\n\n        }\n\n       \n\n\n        function prepare_add_edit(club_id=null, after_booking_end=null){\n\n            var cid = (club_id) ? club_id : vm.club_id;\n            var bed = (after_booking_end) ? after_booking_end : vm.new_booking.end_datetime;\n\n            if(cid > 0 && bed){\n\n                 MemberService.GetAllActiveByClub(cid, bed)\n                    .then(function (data) {\n                        //console.log(\"members are : \", data);\n                        //console.log(\"CLUB ID IS :\", vm.club_id);\n\n                        if(vm.user.access.instructor.indexOf(vm.club_id) > -1){\n                            //console.log(\"THIS IS AN INSTRUCTOR IN THIS CLUB...\");\n                            vm.booking_self = false;\n                        }\n\n                        //use GB airfields first...\n                        vm.members = data;\n\n\n                        if(vm.new_booking.instructor && vm.new_booking.instructor.id == vm.user.id){\n                            vm.booking_self = false;\n                        }\n\n                        if(!vm.new_booking.user){\n                            // vm.booking_self = false;\n                            //set the member\n\n                            vm.new_booking.user = vm.members.find(function(member, index) {\n                                                                    if(member.user_id == vm.new_booking.user_id)\n                                                                        return true;\n                                                                });\n\n                        }\n\n\n\n                        for(var i=0;i<vm.members.length;i++){\n                            vm.members[i].is_member = true;\n                        }\n                        //console.log(vm.members);\n                    \n                    });\n\n            }\n\n           \n        }\n\n\n\n        vm.remove_invite = function(i){\n\n\n                vm.new_booking.passengers.splice(i, 1);\n                vm.init_passengers();\n\n\n        }\n\n\n        vm.remove_passenger = function(i){\n\n\n            var to_remove = vm.new_booking.passengers[i];\n            if( vm.pax_invited(to_remove) ){\n\n                //full removal from the backend\n                BookingService.DeleteInvitation(to_remove, to_remove.id)\n                .then(function(data){\n                    //console.log(data);\n                    if(data.success == true){\n                        //alert(data.message);\n                        vm.new_booking.passengers.splice(i, 1);\n                        vm.init_passengers();\n                    } else {\n                        alert(data.message);\n                    }\n\n                });\n\n\n\n\n            } else {\n\n                //this pax was not YET saved - hence just remove from list\n\n                vm.new_booking.passengers.splice(i, 1);\n                vm.init_passengers();\n\n            }\n\n                //below YES --> but needs to remove the invitation as well.\n\n                // vm.new_booking.passengers.splice(i, 1);\n                // vm.init_passengers();\n\n        }\n\n        vm.resend_invitation = function(i){\n\n\n            var to_resend = vm.new_booking.passengers[i];\n             BookingService.ResendInvitation(to_resend, to_resend.id)\n                .then(function(data){\n                    //console.log(data);\n                    if(data.success == true){\n                        alert(data.message);\n                    } else {\n                        alert(data.message);\n                    }\n\n                });\n\n\n        }\n\n        vm.pax_invited = function(pax){\n            if(pax.status == \"\" || pax.status == \"to_invite\"){\n                return false;\n            }\n            return true;\n        }\n\n        vm.get_passenger_status = function(member){\n            // //console.log(\"MEMBER\", member);\n            if(member){\n\n                if(member.is_member){\n                    // //console.log(\"this one is true\");\n                    return \"This passenger is already club member and hence is ready for flight\";\n                } else {\n\n                    if(member.status == \"accepted\"){\n                        return \"This passenger has accepted the terms and is ready for flight\";\n                    } else if(member.status == \"declined\"){\n                        return \"This passenger has declined the terms\";\n                    } else if(member.status == \"to_invite\"){\n                        return \"Invitation will be sent once the booking is saved.\";\n                    } else if(member.status == \"invited\"){\n                        return \"This passenger has been invited but has not yet responded.\";\n                    } else {\n                        return \"\";\n                    }\n                }\n\n                return \"\";\n            }\n\n        }\n\n        vm.get_passenger_status_edit = function(member){\n            // //console.log(\"MEMBER\", member);\n            if(member){\n\n                if(member.is_member){\n                    // //console.log(\"this one is true\");\n                    return \"This passenger is already club member and hence is ready for flight\";\n                } else {\n\n                    if(member.status == \"accepted\"){\n                        return \"This passenger has accepted the terms and is ready for flight\";\n                    } else if(member.status == \"declined\"){\n                        return \"This passenger has declined the terms\";\n                    } else if(member.status == \"to_invite\"){\n                        return \"Invitation will be sent once the booking is saved.\";\n                    } else if(member.status == \"member\"){\n                        return \"This passenger is a member\";\n                    } else if(member.status == \"invited\"){\n                        return \"This passenger has been invited but has not yet accepted.\";\n                    }else {\n                        return \"\";\n                    }\n                }\n\n                return \"\";\n            }\n\n        }\n\n        vm.invite_new_passenger = function(index){\n\n            //console.log(\"HERE\");\n            //console.log(vm.new_booking.passengers[index]);\n\n            vm.show_new_passenger_invitation = true;\n            vm.new_pax = index;\n\n\n        }\n\n        vm.close_passenger_invitation = function(){\n            vm.new_pax = -1;\n            vm.show_new_passenger_invitation = false;\n        }\n\n        $scope.get_members = function(name, index){\n\n\n            ////console.log(\"get members\", name);\n            if((vm.club_id == 0 || !vm.club_id) && vm.new_booking.plane && vm.new_booking.plane.id){\n                vm.club_id = vm.new_booking.plane.club_id;\n            }\n\n            if(name.length > 2){\n\n                 MemberService.GetAllByClubAndName(vm.club_id, name)\n                .then(function (data) {\n                    //console.log(data);\n                    if(data.success){\n                        //use GB airfields first...\n                        vm.members = data.members;\n\n                        if(vm.members.length < 1){\n                            ////console.log(\"not found in members\");\n                            vm.new_booking.passengers[index].not_found = true;\n                            vm.new_booking.passengers[index].email = \"\";\n                            vm.new_booking.passengers[index].status = \"\";\n                            vm.new_booking.passengers[index].first_name = \"\";\n                            vm.new_booking.passengers[index].last_name = \"\";\n\n                            \n                           // var email_regex = /^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\\.[a-zA-Z0-9-]+)*$/;\n\n                            var email_regex = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n                            if(email_regex.test(name)){\n\n                                vm.new_booking.passengers[index].email = name;\n\n                            } else {\n                                if(name.indexOf(\" \") > -1){\n                                    var splits = name.split(\" \");\n                                    vm.new_booking.passengers[index].first_name = splits[0];\n                                    vm.new_booking.passengers[index].last_name = splits[1];\n                                } else {\n                                    vm.new_booking.passengers[index].first_name = name;\n                                }\n                            }\n\n\n                        }\n\n                    } else {\n                        //clear original vals\n                            vm.new_booking.passengers[index].status = \"\";\n                            vm.new_booking.passengers[index].email = \"\";\n                            vm.new_booking.passengers[index].first_name = \"\";\n                            vm.new_booking.passengers[index].last_name = \"\";\n                        //if email add the email here\n\n                             var email_regex = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n                            \n                                       // var email_regex = /^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\\.[a-zA-Z0-9-]+)*$/;\n\n                            if(email_regex.test(name)){\n                                ////console.log(\"here we match?  it is an email?\");\n                                vm.new_booking.passengers[index].email = name;\n                                vm.new_booking.passengers[index].not_found = true;\n\n                            } else {\n                                ////console.log(\"user not found?\");\n                            }\n\n\n                        // var email_regex = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n                        // if(email_regex.test(name)){\n\n                        //         clearTimeout(setting_new_member);\n                        //         setting_new_member = undefined;\n\n                        //         setting_new_member = setTimeout(set_new_member, 900, name, index);\n\n                        // } else {\n                        //     //console.log(\"WOOOPSIES...\");\n                        //     //this should be very very rare...\n                        // }\n                        \n\n                   \n                    }\n\n                });\n\n\n            }\n        }\n\n        $scope.save = function(){\n            if(vm.action == \"add\"){\n                ////console.log(\"CREATE click\");\n                $scope.create();\n            } else {\n                ////console.log(\"EDIT click\");\n                ////console.log(vm.club.membership);\n                generate_datetimes();\n                $scope.update();\n            }\n        }\n\n        $scope.update = function() {\n            var d = new Date();\n            d.setHours( 14 );\n            d.setMinutes( 0 );\n            $scope.mytime = d;\n        };\n\n        vm.show_self_option = false;\n\n        $scope.select_plane = function(val){\n            $scope.check_rental_items();\n            free_places();\n\n            ////console.log(\"AIRCRAFT SELECTED\");\n            if( (vm.user.access.instructor.indexOf(vm.club_id) > -1) || (vm.user.access.manager.indexOf(vm.club_id) > -1) ){\n                vm.show_self_option = true;\n            } else {\n                vm.show_self_option = false;\n            }\n\n\n            if(vm.user.access.instructor.indexOf(vm.club_id) > -1){\n                //console.log(\"THIS IS AN INSTRUCTOR IN THIS CLUB...\");\n                vm.booking_self = false;\n            }\n\n            \n        }\n\n        function generate_datetimes(){\n            var start = new Date(vm.new_booking.start_date);\n            var c = new Date();\n            var start_split = (vm.new_booking.start_time) ? vm.new_booking.start_time.time.split(\":\") : [c.getHours(), c.getMinutes()];\n            // var start_split = vm.new_booking.start_time.time.split(\":\");\n\n            start.setHours(start_split[0]);\n            start.setMinutes(start_split[1]);\n            start.setSeconds(0);\n\n            var end = new Date(vm.new_booking.end_date);\n            //var end_split = vm.new_booking.end_time.time.split(\":\");\n            var end_split = (vm.new_booking.end_time) ? vm.new_booking.end_time.time.split(\":\") : [c.getHours(), c.getMinutes()];\n\n            end.setHours(end_split[0]);\n            end.setMinutes(end_split[1]);\n            end.setSeconds(0);\n\n            vm.new_booking.start_datetime = moment(start).format(\"Y-M-D HH:mm\");\n            vm.new_booking.end_datetime = moment(end).format(\"Y-M-D HH:mm\");\n        }\n\n        function get_times(data, tofrom){\n            var date = $scope.myDatetimeRange.date[tofrom];\n            var d = date.getDate();\n            var m = date.getMonth();\n            var y = date.getFullYear();\n            \n            //need to combuine both\n            var a = data[tofrom];\n            var h = a.slice(0,2);\n            var i = a.slice(3,5);\n            // i = (i == 00)? 0 : i;\n            i = (i.toString() == \"00\")? 0 : i;\n\n            // $scope.myDatetimeRange.date.from = new Date(y, m, d, h, m, 0);\n            // //console.log(\"vars are: \"+y+\", \"+m+\", \"+d+\", \"+h+\", \"+i+\", \"+0+\" soooo\");\n            var date = new Date(y, m, d, h, i, 0);\n            return date;\n        }\n\n        function check_business_hours(i, k = null, start = 0){\n            //i is hours\n            //k is minutes\n            k = parseInt(k);\n            i = parseInt(i);\n\n            var this_step_disabled = 0; \n            if(vm.new_booking.options.business_hours){\n                var split = vm.new_booking.options.business_hours.from.split(\":\");\n                var split2 = vm.new_booking.options.business_hours.to.split(\":\");\n\n                if(start == 0){\n                    //adjust to match times / end min 1 hour slots\n                   // split2[0] = parseInt(split2[0]) + 1;\n                } else {\n                    split2[0] = parseInt(split2[0]) - 1;\n                }\n\n                if(k || k == 0){\n                    \n                    if(i < parseInt(split[0]) ){\n                        // //console.log(\"we disable because \"+i+\":\"+k+\" is before \"+split.join(\":\") );\n                        this_step_disabled = 1;\n                    } else if(i == parseInt(split[0]) && k < parseInt(split[1])){\n                         // //console.log(\"we disable because \"+i+\":\"+k+\" is before \"+split.join(\":\") );\n                        this_step_disabled = 1;\n                    }\n\n                    // if(i >= parseInt(split2[0]) && k >= parseInt(split2[1]) ){\n                    //     // //console.log(\"we disable because \"+i+\":\"+k+\" is after \"+split2.join(\":\") );\n                    //     this_step_disabled = 1;\n                    // } \n\n\n                    if(i > parseInt(split2[0])){\n                        this_step_disabled = 1; \n                    } else if( i == parseInt(split2[0]) && k > parseInt(split2[1])){\n                        this_step_disabled = 1;\n                    }\n\n\n                } else {\n                    if(parseInt(split[0]) < i){\n                        this_step_disabled = 1;\n                    } \n                    if(parseInt(split2[0]) > i){\n                        this_step_disabled = 1;\n                    } \n                }\n            }\n\n            return this_step_disabled;\n        }\n\n\n   \n\n    function clean_times(which, start_end, compared_to = null){\n\n        var compare_date;\n\n        switch(which){\n            case 'today':\n                compare_date = new Date();\n            break;\n            case 'past':\n                //we need to consider the back-dating as possible issue...\n                compare_date = new Date(\"1990-07-26\");\n            break;\n            case 'future':\n                compare_date = new Date(\"1990-07-26\");\n            break;\n            case 'after':\n            //differentiate here\n                compare_date = new Date(compared_to);\n            break;\n            case 'before':\n            //differentiate here\n                compare_date = new Date(compared_to);\n            break;\n        }\n\n            var this_date = new Date(vm.new_booking.start_date);\n\n            //console.log(\"HERE WE GO this_date!\", this_date);\n            //console.log(\"HERE WE GO start_end!\", start_end);\n            //console.log(\"HERE WE GO vm[start_end]!\", vm[start_end]);\n\n            vm[start_end].forEach(function(time, i){\n\n                //this may very well be the case function here to change when the re-do the times            \n                var split_time = time.time.split(\":\");\n                this_date.setHours(split_time[0]);\n                this_date.setMinutes(split_time[1]);\n                this_date.setSeconds(0);\n\n\n                if( moment(this_date).isAfter(moment(compare_date)) ){\n                    //vm[start_end][i].disabled = 0;\n                    vm[start_end][i].disabled = check_business_hours(parseInt(split_time[0]), parseInt(split_time[1]), (start_end == \"start_times\")? 1 : 0);\n                } else {\n                    vm[start_end][i].disabled = 1;\n                }\n            });\n\n        //by definition as we are changing something to cause this function from being called - we need to recalculate the times:\n        calculate_duration();\n\n    }\n\n    function get_duration_str(seconds){\n        //var seconds = Math.floor(seconds);\n        // //console.log(seconds);\n        // //console.log(moment.duration(seconds));\n        // //console.log(\"days: \"+moment.duration(seconds).days());\n        // //console.log(\"hours: \"+moment.duration(seconds).hours());\n        // //console.log(\"minutes: \"+moment.duration(seconds).minutes());\n\n        var days = moment.duration(seconds).days();\n        var hours = moment.duration(seconds).hours();\n        var minutes = moment.duration(seconds).minutes();\n\n        //occasional issue showing 59 minutes - unsure where but this is a fix for it... think moment() has a bug\n        if(minutes == 59){\n            hours++;\n            minutes = 0;\n        }\n\n\n        var string = \"\";\n        if(days > 0){\n            string = string+\" \"+days+\" day\";\n            string = (days > 1)? string+\"s\" : string;\n        }\n        if(hours > 0){\n            string = string+\" \"+hours+\" hour\";\n            string = (hours > 1)? string+\"s\" : string;\n        }\n        if(minutes > 0){\n            string = string+\" \"+minutes+\" minute\";\n            string = (minutes > 1)? string+\"s\" : string;\n        }\n\n         // //console.log(\"STR : \"+string);\n\n        return string;\n\n    }\n\n    function add_hour_to_end(){\n        var a = vm.new_booking.start_time.time.split(\":\");\n        //var b = new Date();\n        var b = new Date(vm.new_booking.start_date);\n        b.setHours(a[0]);\n        b.setMinutes(a[1]);\n        b.setSeconds(0);\n        var future = moment(b).add(1, \"hour\").format();\n       // clean_times('after', 'end_times', future);\n       //\n\n         //clean_times(check_relative_date(vm.new_booking.end_date, \"end\"), 'end_times', future);\n\n\n\n        if(parseInt(a[0]) >= 23){\n            if(moment(vm.new_booking.start_date).isSame(moment(vm.new_booking.end_date))){\n                 // //console.log(\"THIS ADD DAY\");\n                // //console.log(\"start\", vm.new_booking.start_date);\n                // //console.log(\"end\", vm.new_booking.end_date);\n                 // //console.log(\"after or = 11pm - then we need to change the date that follows the same pattern\");\n                vm.new_booking.end_date = new Date(moment(vm.new_booking.end_date).add(1, \"day\").format());\n                clean_times('future', 'end_times');\n\n                //set it to 00:00 hours probably a wise thing...\n                vm.new_booking.end_time = vm.end_times[0];\n\n\n            } \n        } else {\n            clean_times('after', 'end_times', b);\n        }\n\n    }\n\n\n    function start_after_end(){\n            var start_after_end = false;\n            if(vm.new_booking.end_time){\n                // //console.log(\"START AFTER END LOOP\");\n                var start_datetime = new Date(vm.new_booking.start_date);\n                var start_time = vm.new_booking.start_time.time.split(\":\");\n                start_datetime.setHours(start_time[0]);\n                start_datetime.setMinutes(start_time[1]);\n                start_datetime.setSeconds(0);\n\n                var end_datetime = new Date(vm.new_booking.end_date);\n                var end_time = vm.new_booking.end_time.time.split(\":\");\n                end_datetime.setHours(end_time[0]);\n                end_datetime.setMinutes(end_time[1]);\n                end_datetime.setSeconds(0);\n\n                if(moment(start_datetime).isAfter(moment(end_datetime)) || moment(start_datetime).isSame(end_datetime) || end_datetime == start_datetime){\n                    start_after_end = true;\n                }\n\n\n            }\n            return start_after_end;\n    }\n\n\n    function booking_today(){\n        if(moment(vm.new_booking.start_date).format(\"DD/MM/YYYY\") == moment().format(\"DD/MM/YYYY\")){\n            //console.log(\"WE ARE TODAY?\");\n            clean_times('today', 'start_times');\n\n        } else {\n            // //console.log(\"should get full day\");\n            if(moment(vm.new_booking.start_date).isAfter(moment()) ){\n                clean_times('future', 'start_times');\n            }\n        }\n\n        if(moment(vm.new_booking.end_date).format(\"DD/MM/YYYY\") == moment().format(\"DD/MM/YYYY\")){\n            if(vm.new_booking.start_time){\n               //console.log(\"START TIME\", vm.new_booking.start_time);\n                add_hour_to_end(); \n            }\n            clean_times(check_relative_date(vm.new_booking.start_date), 'end_times');\n        }\n\n\n        if(vm.new_booking.end_date == vm.new_booking.start_date){\n                // //console.log(\"booking today where end = start\");\n                if(vm.new_booking.start_time){\n                    var a = vm.new_booking.start_time.time.split(\":\");\n                    var b = new Date(vm.new_booking.start_date);\n                    b.setHours(a[0]);\n                    b.setMinutes(a[1]);\n                    b.setSeconds(0);\n\n                    //we need to check the times give\n                    if(start_after_end()){\n                        clean_times(check_relative_date(vm.new_booking.start_date), 'start_times');\n                        // //console.log(\"UPDATE END BITS IF START > END required?\");\n                        clean_times(check_relative_date(vm.new_booking.end_date, \"end\"), 'end_times', b);\n                        add_hour_to_end();\n                    } else {\n                        // //console.log(\"UPDATE END BITS IF START > END 2\", check_relative_date(vm.new_booking.start_date, \"end\"));\n                        clean_times(check_relative_date(vm.new_booking.end_date, \"end\"), 'end_times', b);\n                    }\n\n\n                }\n        }\n\n    }\n\n    // clean_times('today', 'start_times');\n    booking_today();\n\n\n    function check_relative_date(date, start_end = \"start\"){\n        var relative = \"today\";\n        // //console.log(\"RELATIVE TIME CHECK\", date);\n        if(moment(moment(date).format(\"YYYY/MM/DD\")).isAfter(moment().format(\"YYYY/MM/DD\"))){\n            relative = \"future\";\n\n            //then is after today\n            // the catch is that if date == start / end date --> THEN we need to present that it is today even though it isnt - this is premise\n            // that is valid only for the \"END\" cases (so that we return AFTER rather than today) --> otherwise the end_times available won't reflect\n            //the fact that the start_times have been selected allowing the user to select an end time before start time (which is silly really...)\n\n            if(vm.new_booking.start_date && vm.new_booking.end_date && start_end == \"end\"){\n                if(moment(vm.new_booking.start_date).isSame(moment(vm.new_booking.end_date))){\n                    relative = \"after\"; // because we need to act as though it is after in the clean_times (to not be able to select end < start times)\n                }\n            }\n            \n        } else if(moment(date).format(\"YYYY/MM/DD\") == moment().format(\"YYYY/MM/DD\")){\n            //then today\n            relative = (start_end == \"start\") ? \"today\" : \"after\";\n        } else {\n            //must be in the past...\n            relative = \"past\";\n        }\n\n        \n        // //console.log(\"relative is \", relative);\n        return relative;\n    }\n\n\n      if($stateParams.start){\n                    //alert(\"add\");\n                    vm.new_booking.start_date = new Date($stateParams.start);\n                    vm.new_booking.end_date = new Date($stateParams.start);\n                    vm.new_booking.start_time = {time: moment($stateParams.start).format(\"HH:mm\")};\n                    vm.new_booking.end_time = {time: moment($stateParams.start).add(30, \"minutes\").format(\"HH:mm\") };\n\n                    vm.default_date = vm.new_booking.start_date;\n\n\n\n                    setTimeout(function(){\n\n\n                        //console.log(\"CALL ME HERE BOOBS\");\n\n\n                        var new_event = {\n                                         \"id\":\"TEMP\",\n                                         \"title\":\"TEMPORARY\",\n                                         \"resourceId\": 7,\n                                         \"start\":\"2021-03-21 19:30:00\",\n                                         \"end\":\"2021-03-21 21:00:00\",\n                                         \"editable\":false,\n                                         \"color\":\"#FFcccc\",\n                                         \"opacity\":\"1\"\n                                      };\n                    \n\n                                      $('#calendar').fullCalendar('renderEvent', new_event);\n\n\n                    $scope.update_dateTime(\"edit2\", $stateParams.plane_id);\n\n\n\n                    }, 1000);\n\n                    \n\n\n      \n\n                }\n\n\n\n\n    $scope.make_booking = function(isValid){\n\n        //console.log(\"make booking\", isValid);\n            $scope.submitted = true;\n            // check to make sure the form is completely valid\n            if(isValid) {\n                // //console.log('our form is working');\n                //then we send the booking request to the server woooohooooo!\n\n                //clean and prepare the bits that we require\n                var booking = {};\n                var booking = jQuery.extend(true, {}, vm.new_booking); \n                // //console.log(booking);\n                delete booking.options;\n                delete booking.instructor;\n                delete booking.plane;\n                delete booking.start_date;\n                delete booking.start_time;\n                delete booking.end_date;\n                delete booking.end_time;\n                delete booking.start_datetime;\n                delete booking.end_datetime;\n                delete booking.tuition_required;\n                delete booking.user;\n                // //console.log(booking);\n                // //console.log(vm.new_booking);\n\n                //generate_datetimes();\n\n                // //console.log(\"START DATE1 : \", vm.new_booking.start_datetime );\n\n                // //console.log(\"START DATE2 : \", moment(vm.new_booking.start_datetime).isAfter() );\n                // //console.log(\"START DATE3 : \", moment(vm.new_booking.start_datetime).isBefore() );\n\n                // //console.log(\"START DATE4 : \", moment(Date.parse(vm.new_booking.start_datetime)) );\n                // //console.log(\"END DATE : \", moment(vm.new_booking.end_datetime) );\n                // //console.log(\"NOW : \", moment());\n\n                if(moment(Date.parse(vm.new_booking.start_datetime)).isBefore()){\n                    alert(\"This booking ends in the past - you cannot create a booking in the past.\");\n                    return false;\n                }\n                //30 mintues leeway in case of booking starting within the 15 minute period or similar\n                if(moment(Date.parse(vm.new_booking.start_datetime)).add(30, \"minutes\").isBefore()){\n                    alert(\"This booking starts in the past - you cannot create a booking in the past.\");\n                    return false;\n                }\n\n\n\n\n\n                booking.override = (vm.new_booking.override) ? vm.new_booking.override : 0;\n\n                if(vm.booking_self){\n                    // //console.log(\"SELF\");\n                    booking.user_id = vm.user.id;\n                    booking.instructor_id = (vm.new_booking.instructor) ? vm.new_booking.instructor.id : 0;\n                    // //console.log(\"USER IS \", booking.user_id);\n                } else {\n                    // //console.log(\"NON SELF\");\n\n                    booking.user_id = vm.new_booking.user.user_id;\n                    if(vm.user.access.manager.indexOf(vm.club_id) > -1){\n                        //admin does not automatically become the instructor...\n                        booking.instructor_id = (vm.new_booking.instructor) ? vm.new_booking.instructor.id : 0;                \n                    } else {\n                        //then its an instructor - so likely booking for student not just member\n                        booking.instructor_id = vm.user.id;                \n                    }\n                    booking.booked_by_admin_instructor = 1;\n                    booking.override = 1;\n\n                }\n               \n\n\n\n\n                booking.free_seats = (vm.new_booking.free_seats.constructor === Array) ? 0 : vm.new_booking.free_seats;\n                booking.start = vm.new_booking.start_datetime;\n                booking.end = vm.new_booking.end_datetime;               \n                booking.plane_id = vm.new_booking.plane.id;\n                booking.club_id = vm.new_booking.plane.club_id;\n                booking.booked_by = vm.user.id;\n                booking.course_id = (vm.new_booking.tuition_required) ? vm.new_booking.tuition_required.id : 0;\n\n                // //console.log(\"UUID \",booking.user_id);\n\n                // return false;\n\n                // //console.log(\"new booking obj to be sent... \",booking);\n\n                //make booking call with new_booking as items to send! :D wooohoooooooo :P\n                BookingService.Create(vm.user.id, booking)\n                .then(function(data){\n                    //console.log(data);\n                    if(data.success == true){\n                        // //console.log(\"WAS SENT HERE! \");\n                        $scope.clear_booking();\n                        \n\n                        BookingService.GetAll(vm.user.id, moment(vm.new_booking.start_date).format(\"Y-M-D\"), \"\")\n                            .then(function(data){\n\n                                $scope.all_events = data.events;\n                                $scope.all_resources = data.resources;\n\n                                $('#calendar').fullCalendar('refetchEvents');\n                                $('#calendar').fullCalendar('removeEvents');\n                                $('#calendar').fullCalendar('addEventSource', $scope.all_events);\n                            });\n\n                        \n\n                        //$(\"#calendar\").fullCalendar(\"refetchEvents\");\n                        //must have some sort of feedback saying booking was made successfully!\n                        $state.go('dashboard.bookings.add');\n                    } else {\n\n                        // //console.log(\"clearly something went wrong here... :'-( \", data.message);\n                        //if it is something about currency - perhaps return the possibility of self-certify or book instructor for this purpose!\n                        \n                        if(data.more && data.more.length > 0){\n                            // //console.log(\"MORE\");\n                            var addon = \"\";\n\n                            for(var i=0;i<data.more.length;i++){\n                                if(data.more[i][\"name\"] == \"differences_verified\"){\n                                    addon += \"\\n - Your differences training sign-offs need to be verified by a member of staff. \\n\";\n                                }\n                                if(data.more[i][\"name\"] == \"licence_verified\"){\n                                    addon += \"\\n - Your licence needs to be verified by a member of staff. \\n\";\n                                }\n                                if(data.more[i][\"name\"] == \"medical_verified\"){\n                                    addon += \"\\n - Your medical needs to be verified by a member of staff. \\n\";\n                                }\n                                if(data.more[i][\"name\"] == \"medical\"){\n                                    addon += \"\\n - You need to upload a copy of your medical. \\n\";\n                                }\n                                if(data.more[i][\"name\"] == \"licence\"){\n                                    addon += \"\\n - You need to upload a copy of your licence. \\n\";\n                                }\n                                if(data.more[i][\"name\"] == \"differences\"){\n                                    addon += \"\\n - You need to upload a copy of your differences training signed off. \\n\";\n                                }\n                                // addon += \"You need to add your \"+data.more[i][0]+\" to book solo\";\n                            }\n                            // //console.log(\"MORE:: \", addon);\n\n                            data.message = data.message + addon;\n                        }\n\n                        alert(\"Sorry! \\n\\n\"+data.message);\n                    }\n                    \n                });\n\n\n            } else {\n                //console.log(\"NOT SENT - please fix errors\");\n            }\n\n    }\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n        \n        \n\n      \n\n\n\n\n\n\n\n\n\n\n\n\n        // MODALS FOR ALL THE POPUPS TO BE CHANGED INTO --> SAMPLE HERE\n\n        // var warning_msg = \"By deleting this membership, you will also cancel all reservations that this membership currently has.\"\n\n        $scope.popup2 = {\n          opened: false\n        };\n\n        $scope.popup3 = {\n          opened: false\n        };\n\n        $scope.popup4 = {\n          opened: false\n        };\n          \n        $scope.open2 = function() {\n          $scope.popup2.opened = true;\n        };\n\n          $scope.open3 = function() {\n          $scope.popup3.opened = true;\n        };\n\n          $scope.open4 = function() {\n          $scope.popup4.opened = true;\n        };\n\n\n        $scope.open = function (member_id) {\n            var modalInstance = $uibModal.open({\n              animation: true,\n              templateUrl: 'views/modals/deleteModal.html',\n              controller: 'ModalInstanceCtrl',\n              size: \"lg\",\n              resolve: {\n                id: function () {\n                  return member_id;\n                },\n                warning: function(){\n                    return warning_msg;\n                }\n              }\n            });\n            modalInstance.result.then(function (member_id) {\n              $log.info('PRESSED GO: '+member_id);\n              MemberService.Delete(member_id)\n              .then(function(){\n                //console.log(\"HELLO DELETE\");\n                //update view?\n                 vm.club.members = $.grep(vm.club.members, function(e){ \n                    return e.id != member_id; \n                });\n              })\n            }, function () {\n              $log.info('Modal dismissed at: ' + new Date());\n            });\n          };\n\n         \n\n\n    }\n\n app.controller('BookoutController', BookoutController);\n\n    BookoutController.$inject = ['UserService', 'MemberService', 'InstructorService', 'MembershipService', 'HolidayService', '$rootScope', '$location', '$scope', '$state', '$stateParams', '$uibModal', '$log', '$window', '$compile', '$interval', '$timeout', 'uiCalendarConfig', 'BookingService', 'LicenceService', 'BookoutService', '$filter', 'InstructorCharges', 'PlaneService', '$http', '$cookieStore', 'AuthenticationService', 'CourseService'];\n    function BookoutController(UserService, MemberService, InstructorService, MembershipService, HolidayService, $rootScope, $location, $scope, $state, $stateParams, $uibModal, $log, $window, $compile, $interval, $timeout, uiCalendarConfig, BookingService, LicenceService, BookoutService, $filter, InstructorCharges, PlaneService, $http, $cookieStore, AuthenticationService, CourseService) {\n        \n        var vm = this;\n\n        vm.user = $rootScope.globals.currentUser;\n        vm.user_id = vm.user.id;\n\n        //this club ID needs to reflect the club that has been selected....\n        //vm.club_id = 6;\n        // SAY WHAAAAAT?\n\n        //   {{ $rootScope.globals | json }} to be able to see what club was selected\n\n     //vm.club_id = $rootScope.globals.currentUser.current_club_admin.id;\n\n        // vm.user = $rootScope.globals.currentUser;\n        // vm.user_id = vm.user.id;\n\n        vm.booking = {};\n\n        //base location to sort the airfields below\n        vm.wgs_n = \"51.51\";\n        vm.wgs_e = \"0.12\";\n\n        vm.change_booking = {};\n        vm.show_change_plane = false;\n        //we need to get the booking ID to pull as much data as we can!\n\n        vm.bookout = {\n            start: true,\n            passengers: [],\n            pic: {\n                id: vm.user_id\n            }\n        };\n\n        vm.reported_defects = [];\n      \n        vm.can_authorise = false;\n\n        vm.bookout.plane = {\n            id: 12,\n            registration: \"G-BSXA\",\n            type: \"PA28\",\n            current_tacho: 5112.3,\n            estimated_fuel: 100,\n            consumption: 30,\n            seats: 4,\n            last_tacho: 3941.01,\n            last_position: 12\n        };\n\n\n        \n\n        //vm.custom_users = [];\n\n        vm.dateFormat = 'date:HH:mm \\'on\\' dd/MM/yyyy';\n\n        $scope.show_change_plane = function(){\n            // //console.log(\"change plane\");\n            vm.show_change_plane = true;\n\n        }\n\n        // //console.log(\"PARASM\", $stateParams);\n\n        vm.seats_in_plane = function(){\n\n            //base\n            var no_seats = vm.bookout.plane.seats;\n\n            //check if instructor aboard?\n            if(vm.bookout.pic.id !== vm.user_id){   \n                no_seats--;\n            }\n\n            if(vm.bookout.passengers.length > 0){\n                no_seats = no_seats - vm.bookout.passengers.length;\n            }\n\n            //include self\n            no_seats--;\n\n            // //console.log(no_seats);\n\n            //return final number\n            return no_seats;\n        }\n\n        vm.init_passengers = function(){\n            // var no_of_seats = vm.seats_in_plane();\n\n            // //console.log(\"no_of_seats\", no_of_seats);\n\n            // for(var i=0;i<no_of_seats;i++){\n            //     //console.log(\"-- loop\", i);\n            //     vm.bookout.passengers.push({\n            //         first_name: \"\",\n            //         last_name: \"\",\n            //         email: \"\",\n            //         user_id: i,\n            //         status: \"\"\n            //     });\n            // };\n        }\n        \n\n        $scope.amend_booking = function(){\n            // //console.log(\"AMEND BOOKING NOW\");\n\n        }\n\n\n\n        // BookoutService.GetAirfields(\"EG\")\n        //         .then(function (data) {\n        //             //console.log(data);\n        //             if(data.success){\n        //                 //use GB airfields first...\n        //                 vm.airfields = data.airfields;\n\n        //             } else {\n        //                 //console.log(\"WOOOPSIES...\");\n        //                 //this should be very very rare...\n        //             }\n\n        //         });\n\n\n\n        $scope.accept_defects = function(){\n\n\n            var a = confirm(\"You accept to fly the aircraft despite known defect(s) which have been reported by previous pilots\");\n            if(a){\n                vm.bookout.accept_defects = true;\n            } else {\n                //do nothing\n            }\n\n\n\n        }\n\n        $scope.reject_defects = function(){\n\n            var a = confirm(\"Would you like to cancel this booking?\");\n            if(a){\n                \n            } else {\n                //do nothing\n                vm.bookout.accept_defects = false;\n            }\n        }\n\n\n        $scope.get_hours_from_decimal = function(number){\n\n            // if(time){\n            //      var sign = time < 0 ? \"-\" : \"\";\n            //      var hour = Math.floor(Math.abs(time));\n            //      var min = Math.round((Math.abs(time) * 60) % 60);\n            //      return sign + (hour < 10 ? \"0\" : \"\") + hour + \":\" + (min < 10 ? \"0\" : \"\") + min;\n            //  } else {\n            //      return \"N/A\";\n            //  }\n            var sign = (number >= 0) ? 1 : -1;\n\n            // Set positive value of number of sign negative\n            number = number * sign;\n\n            // Separate the int from the decimal part\n            var hour = Math.floor(number);\n            var decpart = number - hour;\n\n            var min = 1 / 60;\n            // Round to nearest minute\n            decpart = min * Math.round(decpart / min);\n\n            var minute = Math.floor(decpart * 60) + '';\n\n            // Add padding if need\n            if (minute.length < 2) {\n            minute = '0' + minute; \n            }\n\n            // Add Sign in final result\n            sign = sign == 1 ? '' : '-';\n\n            if(minute == 60){\n                hour = hour+1;\n                minute = '00';\n            }\n\n            // Concate hours and minutes\n            var time = sign + hour + ':' + minute;\n\n            return time;\n            \n        }\n\n\n\n\n        $scope.get_airfields = function(name){\n\n            if(name.length > 2 && name.length < 5){\n\n                 BookoutService.GetAirfieldsByCode(name)\n                .then(function (data) {\n                    // //console.log(data);\n                    if(data.success){\n                        //use GB airfields first...\n                        vm.airfields = data.airfields;\n                       \n                         if(vm.airfields.length == 0){\n                            // //console.log(\"SETTINGS HERE\");\n                               vm.airfields = [\n                                    {\n                                        id:0,\n                                        title: \"NOT LISTED : \"+ name,\n                                        code: \"ZZZZ\",\n                                        wgs_n: \"0\",\n                                        wgs_e: \"0\"\n                                    }];\n                        }\n\n                    } else {\n\n\n                         //console.log(\"WOOOPSIES...\");\n                        //this should be very very rare...\n                    }\n\n                });\n\n\n            }\n\n            if(name.length > 4){\n                var code = name.replace(/\\s/g, \"_\");\n                BookoutService.GetAirfields(code)\n                .then(function (data) {\n                    // //console.log(data);\n                    if(data.success){\n                        //use GB airfields first...\n                        vm.airfields = data.airfields;\n\n\n                        if(vm.airfields.length == 0){\n                            // //console.log(\"SETTINGS HERE\");\n                               vm.airfields = [\n                                    {\n                                        id:0,\n                                        title: \"NOT LISTED : \"+ name,\n                                        code: \"ZZZZ\",\n                                        wgs_n: \"0\",\n                                        wgs_e: \"0\"\n                                    }];\n                        }\n\n                    } else {\n                        //console.log(\"WOOOPSIES...\");\n                        //this should be very very rare...\n                    }\n\n                });\n\n            }\n\n\n             \n\n           \n        }\n\n        var setting_new_member;\n\n\n        var set_new_member = function(email, index){\n            // //console.log(\"before change \", vm.bookout.passengers);\n            // //console.log(\"SET MEMBER NOW 123\", vm.bookout.passengers[index]);\n                \n             var user_obj = {\n                                id: 0,\n                                email: email,\n                                first_name: \"\",\n                                last_name: \"\",\n                                is_member: false,\n                                status: \"to_invite\"\n                            };\n\n            if(vm.bookout.passengers[index].email !== \"\"){\n                // //console.log(\"override it? and tell the server about it?\", vm.bookout.passengers[index]);\n\n                UserService.ChangeInvitation({from: vm.bookout.passengers[index], to: user_obj}, vm.bookout.booking_id)\n                .then(function (data) {\n                    if(data.success){\n                        // //console.log(\"OK\");\n\n                    }\n                });\n            \n            }\n           \n\n            // vm.custom_users.push(user_obj);\n            // vm.members = vm.members.concat(vm.custom_users);\n            // //console.log(\"CUSTOMER USERS\", vm.custom_users);\n            vm.bookout.passengers[index] = user_obj;\n        }\n\n\n        $scope.update_pic = function(){\n            // //console.log(\"--> \", vm.user.id);\n            // //console.log(\"--> \", vm.bookout.instructor_id);\n            // //console.log(\"--> \", vm.bookout.pic.user_id);\n\n            if(vm.bookout.pic.user_id == vm.user.id && vm.bookout.instructor_id > 0){\n                //console.log(\"okay... so you want the instructor to be put? interesting...\");\n                //adheres to booking\n\n            } else if(vm.bookout.instructor_id > 0 && vm.bookout.pic.user_id == vm.bookout.instructor_id) {\n                //console.log(\"okay so you now have your booked instructor as the PIC again - nice\");\n                //adheres to booking\n\n            } else {\n                //console.log(\"you've change instructor? what happened?\");\n                //availability has been checked hence we're OK\n\n            }\n        }\n\n\n        // $scope.get_members = function(name, index){\n\n        //     if(name.length > 2){\n\n        //          MemberService.GetAllByClubAndName(vm.club_id, name)\n        //         .then(function (data) {\n        //             //console.log(data);\n        //             if(data.success){\n        //                 //use GB airfields first...\n        //                 // var m = data.members;\n        //                 // var members = m.concat(vm.custom_users);\n        //                 vm.members = data.members;\n\n        //             } else {\n\n\n\n        //                 var email_regex = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n        //                 if(email_regex.test(name)){\n        //                     //console.log(\"valid email address found\");\n        //                     //if entered bit is an email address\n        //                     // vm.members = [\n        //                     // {\n        //                     //     id: 0,\n        //                     //     email: name,\n        //                     //     first_name: \"\",\n        //                     //     last_name: \"\",\n        //                     //     is_member: false\n        //                     // }];\n        //                         //console.log(\"BEFORE\", setting_new_member);\n        //                         clearTimeout(setting_new_member);\n        //                         setting_new_member = undefined;\n        //                         //console.log(\"AFTER\", setting_new_member);\n\n        //                         setting_new_member = setTimeout(set_new_member, 1000, name, index);\n        //                         //console.log(\"again after\", setting_new_member);\n                            \n\n\n        //                 } else {\n        //                 //console.log(\"WOOOPSIES...\");\n        //                 //this should be very very rare...\n        //                 }\n                        \n\n                   \n        //             }\n\n        //         });\n\n\n        //     }\n        // }\n\n\n\n\n\n         vm.invite_new_passenger = function(index){\n\n            // //console.log(\"HERE\");\n            // //console.log(vm.new_pax);\n\n             if(vm.new_pax && vm.new_pax.email !== \"\" && vm.new_pax.is_member == false){\n\n\n                 //send a single invitation to join the gang....\n                 vm.new_pax.invited_by = vm.user.id;\n\n\n                 BookoutService.AddPassenger(vm.new_pax, $stateParams.booking_id)\n                .then(function (data) {\n                    // //console.log(data);\n                    if(data.success){\n                       alert(\"INVITATION SENT!\");\n                        vm.update_passenger_list();\n                        vm.show_new_passenger_invitation = false;\n                    }\n                });\n\n\n\n\n\n\n             } else {\n                 alert(\"Please enter a valid email address to send the invitation to.\");\n             }\n           \n\n\n        }\n\n\n\n\n\n        vm.add_new_passenger = function(index){\n\n            // //console.log(\"HERE\");\n            // //console.log(vm.new_pax);\n\n            if(vm.new_pax.is_member){\n\n\n                //then we already have everything we need and we just invite them separately\n                // var to_send = {\n                //     booking_id: $stateParams.booking_id,\n                //     club_id: vm.club_id\n                // }\n                vm.new_pax.club_id = vm.club_id;\n                vm.new_pax.invited_by = vm.user.id;\n\n                //add passenger to booking\n                BookoutService.AddPassenger(vm.new_pax, $stateParams.booking_id)\n                .then(function (data) {\n                    // //console.log(data);\n                    if(data.success){\n                       \n\n\n                        //let's call the update on the passengers\n                        vm.update_passenger_list();\n\n\n\n\n                    }\n                });\n\n\n\n\n            } else {\n                vm.show_new_passenger_invitation = true;\n            }\n\n           \n\n\n        }\n\n\n        vm.new_pax = {\n                        id: 0,\n                        email: \"\",\n                        first_name: \"\",\n                        last_name: \"\",\n                        is_member: false,\n                        status: \"\",\n                        not_found: true\n                    };\n\n        vm.close_passenger_invitation = function(){\n            vm.show_new_passenger_invitation = false;\n        }\n\n        $scope.get_members = function(name){\n\n            // //console.log(\"GET MEMBER\", name);\n            ////console.log(\"get members\", name);\n            if((vm.club_id == 0 || !vm.club_id) && vm.bookout.plane && vm.bookout.plane.id){\n                vm.club_id = vm.bookout.plane.club_id;\n            }\n\n            if(name.length > 2){\n\n                 MemberService.GetAllByClubAndName(vm.club_id, name)\n                .then(function (data) {\n                    ////console.log(data);\n                    if(data.success){\n                        //use GB airfields first...\n\n                        //filter the ones that are already there....\n                        // myArray.filter( el => !toRemove.includes( el ) );\n                        // var myArray = data.members.filter( el => !vm.bookout.passengers.includes( el ) ); //filter( ( el ) => !vm.bookout.passengers.includes( el ) );\n\n\n                        var filtered_array = data.members.filter(ar => !vm.bookout.passengers.find(rm => (rm.email === ar.email) ));\n                        //vm.members = data.members;\n                        vm.members = filtered_array;\n                        ////console.log(\"CHECK JANES\", myArray);\n\n\n                        if(vm.members.length < 1){\n                            // //console.log(\"not found in members\");\n                            // vm.new_pax.not_found = true;\n                            // vm.new_pax.email = \"\";\n                            // vm.new_pax.status = \"\";\n                            // vm.new_pax.first_name = \"\";\n                            // vm.new_pax.last_name = \"\";\n\n                            vm.new_pax = {\n                                id: 0,\n                                email: \"\",\n                                first_name: \"\",\n                                last_name: \"\",\n                                is_member: false,\n                                status: \"\",\n                                not_found: true\n                            };\n\n                            \n                           // var email_regex = /^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\\.[a-zA-Z0-9-]+)*$/;\n\n                            var email_regex = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n                            if(email_regex.test(name)){\n\n                                vm.new_pax.email = name;\n\n                            } else {\n                                if(name.indexOf(\" \") > -1){\n                                    var splits = name.split(\" \");\n                                    vm.new_pax.first_name = splits[0];\n                                    vm.new_pax.last_name = splits[1];\n                                } else {\n                                    vm.new_pax.first_name = name;\n                                }\n                            }\n\n\n                        }\n\n                    } else {\n                        //clear original vals\n                            vm.new_pax.status = \"\";\n                            vm.new_pax.email = \"\";\n                            vm.new_pax.first_name = \"\";\n                            vm.new_pax.last_name = \"\";\n                        //if email add the email here\n\n                             var email_regex = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n                            \n                                       // var email_regex = /^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\\.[a-zA-Z0-9-]+)*$/;\n\n                            if(email_regex.test(name)){\n                                ////console.log(\"here we match?  it is an email?\");\n                                vm.new_pax.email = name;\n                                vm.new_pax.not_found = true;\n\n                            } else {\n                                ////console.log(\"user not found?\");\n                            }\n\n\n                        // var email_regex = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n                        // if(email_regex.test(name)){\n\n                        //         clearTimeout(setting_new_member);\n                        //         setting_new_member = undefined;\n\n                        //         setting_new_member = setTimeout(set_new_member, 900, name, index);\n\n                        // } else {\n                        //     //console.log(\"WOOOPSIES...\");\n                        //     //this should be very very rare...\n                        // }\n                        \n\n                   \n                    }\n\n                });\n\n\n            }\n        }\n\n        var get_all_members = function(){\n\n\n                 MemberService.GetAllByClub(vm.club_id)\n                .then(function (data) {\n                    ////console.log(data);\n                        //use GB airfields first...\n                        vm.members = data;\n                        for(var i=0;i<vm.members.length;i++){\n                            vm.members[i].is_member = true;\n                        }\n                        // //console.log(vm.members);\n                \n                });\n\n            \n        }\n\n        get_all_members();\n\n\n        vm.invite_passenger = function(email, i){\n            ////console.log(\"SEND INVITE\", vm.bookout.passengers[i]);\n\n            var passenger_membership_id = 9;\n\n            UserService.InvitePassenger(vm.bookout.passengers[i].email, vm.user_id, vm.club_id, passenger_membership_id, vm.bookout.booking_id)\n                .then(function (data) {\n                        //use GB airfields first...\n                        ////console.log(\"INVITE IS \", data);\n                        vm.bookout.passengers[i].status = data.invite.status;\n                        vm.bookout.passengers[i].invitation_token = data.invite.invitation_token;\n                \n                });\n\n\n        }\n\n        vm.refresh_passenger = function(member, i){\n            ////console.log(\"SEND REFRESH\");\n            UserService.GetInvite(vm.bookout.passengers[i].invitation_token)\n                .then(function (data) {\n                        //use GB airfields first...\n                        // //console.log(\"INVITED IS \", data);\n                        vm.bookout.passengers[i].status = data.status;\n                        vm.bookout.passengers[i].user_id = data.user_id;\n                        vm.bookout.passengers[i].first_name = data.first_name;\n                        vm.bookout.passengers[i].last_name = data.last_name;\n                });\n            //vm.bookout.passengers[i].status = \"accepted\";\n        }\n\n        vm.update_passenger_list = function(){\n\n            //let's get ALL the ones required\n             BookoutService.GetPassengers($stateParams.booking_id)\n                .then(function (data) {\n                    ////console.log(data);\n                    if(data.success){\n                       //alert(\"GET\");\n                       ////console.log(\"PAX\", data.passengers);\n                       vm.bookout.passengers = data.passengers;\n\n                       vm.new_pax = {\n                            id: 0,\n                            email: \"\",\n                            first_name: \"\",\n                            last_name: \"\",\n                            is_member: false,\n                            status: \"\",\n                            not_found: true\n                        };\n\n                    }\n                });\n\n        }\n\n        vm.resend_invitation = function(obj){\n\n            var to_resend = obj;\n             BookingService.ResendInvitation(to_resend, to_resend.id)\n                .then(function(data){\n                    // //console.log(data);\n                    if(data.success == true){\n                        alert(data.message);\n                    } else {\n                        alert(data.message);\n                    }\n\n                });\n        }\n\n\n        vm.refresh_all_passenger = function(){\n            var i = 0;\n             function next() {\n                i++;\n                if(i < vm.bookout.passengers.length) {\n                    // //console.log(\"SEND REFRESH EVERYTHING\");\n                    if(vm.bookout.passengers[i] && vm.bookout.passengers[i].status == \"invited\" && vm.bookout.passengers[i].invitation_token !== \"\"){\n\n                         UserService.GetInvite(vm.bookout.passengers[i].invitation_token)\n                            .then(function (data) {\n                                    // //console.log(\"INVITED IS \", data);\n                                    // //console.log(\"INVITED IS \", vm.bookout.passengers[i]);\n                                    vm.bookout.passengers[i].status = data.status;\n                                    vm.bookout.passengers[i].user_id = data.user_id;\n                                    vm.bookout.passengers[i].first_name = data.first_name;\n                                    vm.bookout.passengers[i].last_name = data.last_name;\n                            });\n                    }\n                } else {\n                   /// nothing\n                }\n            }\n            next();\n         \n            //vm.bookout.passengers[i].status = \"accepted\";\n        }\n\n\n        vm.get_passenger_status = function(member){\n            // //console.log(\"MEMBER\", member);\n            if(member){\n\n\n                if(member.is_member){\n                    // //console.log(\"this one is true\");\n                    return \"OK - is already club member\";\n                } else {\n\n                    if(member.status == \"accepted\"){\n                        return \"OK - passenger has accepted the terms\";\n                    } else if(member.status == \"declined\"){\n                        return \"NO - passenger declined the offer\";\n                    } else if(member.status == \"invited\"){\n                        return \"Waiting for user response\";\n                    } else {\n                        return \"\";\n                    }\n                }\n\n                return \"\";\n            }\n\n        }\n\n\n        \n\n        vm.pics = [\n            \n        ];\n\n\n        // the ARRIVAL option should be automatically filled in when there was a departure prior to the flight and home airfield was\n        //entered as the destination\n\n        vm.flight_types = [\n            {\n                id: 1,\n                title: \"Local\"\n            }, \n            {\n                id: 2,\n                title: \"Departure\"\n            },\n            {\n                id: 3,\n                title: \"Circuits\"\n            },\n            {\n                id: 4,\n                title: \"Other\"\n            }\n        ];\n\n\n        vm.biggin_hill = {\n\n            routes: [\n                {\n                    id: 1,\n                    title: \"Kenley\"\n                },\n                {\n                    id: 2,\n                    title: \"Sevenoaks\"\n                },\n                {\n                    id: 3,\n                    title: \"Swanley\"\n                },\n                {\n                    id: 4,\n                    title: \"Other\"\n                }\n            ],\n            parking: \"\"\n\n        }\n\n        vm.flight_rules = [\n            {\n                id: 1,\n                title: \"VFR\"\n            },\n            {\n                id: 2,\n                title: \"IFR\"\n            }\n        ];\n\n\n\n       \n\n\n        function clean_times(which, start_end, compared_to = null){\n\n            var compare_date;\n\n            switch(which){\n                case 'today':\n                    compare_date = new Date();\n                break;\n                case 'past':\n                    //we need to consider the back-dating as possible issue...\n                    compare_date = new Date(\"1990-07-26\");\n                break;\n                case 'future':\n                    compare_date = new Date(\"1990-07-26\");\n                break;\n                case 'after':\n                //differentiate here\n                    compare_date = new Date(compared_to);\n                break;\n                case 'before':\n                //differentiate here\n                    compare_date = new Date(compared_to);\n                break;\n            }\n\n            var this_date = new Date();\n\n\n            vm[start_end].forEach(function(time, i){\n\n                        //this may very well be the case function here to change when the re-do the times            \n                        var split_time = time.time.split(\":\");\n                        this_date.setHours(split_time[0]);\n                        this_date.setMinutes(split_time[1]);\n                        this_date.setSeconds(0);\n\n\n                        if( moment(this_date).isAfter(moment(compare_date)) ){\n                            vm[start_end][i].disabled = 0;\n                            //we should / could be checking airport opening hours...?\n                            //vm[start_end][i].disabled = check_business_hours(parseInt(split_time[0]), parseInt(split_time[1]), (start_end == \"start_times\")? 1 : 0);\n                        } else {\n                            vm[start_end][i].disabled = 1;\n                        }\n                    });\n\n                //by definition as we are changing something to cause this function from being called - we need to recalculate the times:\n                //calculate_duration();\n\n        }\n\n\n        vm.start_times = [];\n        vm.all_times = [];\n\n        for(var i=0;i<24;i++){\n\n                for(var j=0; j<(60/5); j++){\n                    var k = 5 * j;\n                    k = ((k < 10) ? '0' : '') + k;\n                    vm.start_times.push({time: i+\":\"+k, disabled: false});\n                }\n\n                for(var j=0; j<(60/10); j++){\n                    var k = 10 * j;\n                    k = ((k < 10) ? '0' : '') + k;\n                    vm.all_times.push({time: i+\":\"+k, disabled: false});\n                }\n           \n\n        }\n        clean_times('today', 'start_times');\n        clean_times('future', 'all_times');\n        vm.init_passengers();\n        // vm.bookout.pic = vm.pics[0];\n        vm.currency_days = 28;\n        vm.extra_information_required = false;\n        vm.filing_flightplan = false;\n\n        vm.instructor_charges = [];\n\n        vm.club = {\n            plane: {}\n        };\n\n        switch($state.current.data.action){\n            case \"add\":\n                console.log(\"ADD\");\n                    //vm.selected_rating = vm.ratings[0];\n                    //vm.selected_rating = \n\n                    // //console.log(\"AA\", vm.selected_rating);\n                // //console.log(\"booking_id\", $stateParams.booking_id);\n                //so now we can load the BOOKING with this ID, and therefore can sort it all out :)\n                // let us preload the content required from the booking - fetch the booking\n                // //console.log(\"FETCH THE BOOKING\");\n\n                BookingService.GetForBookout(vm.user.id, $stateParams.booking_id)\n                 .then(function (data) {\n                    // //console.log(\"data is : \", data);\n                    if(data.success){\n                        // //console.log(\"success\");\n                        vm.booking = data.booking;\n                        MemberService.GetAllByPicsBookinout(data.booking.id, data.booking.club_id, vm.user.id)\n                            .then(function (pics) {\n                                    //use GB airfields first...\n                                    ////console.log(\"PICS ARE\", pics);\n\n                                    // if(data.booking.course_id){\n                                    //      CourseService.GetChargesByCourseId(data.booking.course_id)\n                                    //     .then(function(data){\n                                    //         vm.instructor_charges = data.items;  \n                                    //     });\n                                    // } else {\n                                    //      InstructorCharges.GetByClubId(data.booking.club_id)\n                                    //     .then(function(data){\n                                    //         vm.instructor_charges = data.items;  \n                                    //     });\n                                    // }\n                                   \n\n\n                                    PlaneService.GetByIdMaintenance(vm.booking.plane.id, data.booking.club_id)\n                                    .then(function(data){\n                                        vm.club.plane = data;  \n                                        \n                                        status();\n\n                                        //console.log(\"BOOOO - get all maintenance....\", vm.club.plane);\n                                        // vm.page_title = \"Edit a Plane Maintenance - \"+vm.club.plane.registration;\n                                    });\n\n\n                                    vm.pics = pics;\n                                    //vm.bookout.pic\n                                    process_booking_to_bookout(data.booking);\n\n                            });\n\n                    }\n                });\n\n                \n\n\n\n\n            break;\n            case \"edit\":\n\n            console.log(\"EDIT ONE\");\n            // //console.log(\"PARAMS: \", $stateParams);\n\n             LicenceService.GetById($stateParams.licence_id)\n                .then(function (data) {\n                    if(data.success){\n                        vm.licence = data.licence;\n                        vm.licence.licence_issue_date = new Date(vm.licence.licence_issue_date);\n                        vm.licence.licence_expiry_date = new Date(vm.licence.licence_expiry_date);\n                        // //console.log(\"licence\", vm.licence);\n\n                        vm.licence.licence_type = $.grep(vm.licence_types, function(e){ return e.id == vm.licence.licence_id; })[0];\n                        vm.licence.state_of_issue = $.grep(vm.authority, function(e){ return e.id == vm.licence.authority_id; })[0];\n                        // //console.log(\"SET\", vm.licence.state_of_issue);\n\n                        //pre-selection bits?\n                        // //console.log(\"NEW RATINGS\", vm.licence.ratings);\n                        for(var i=0;i<vm.licence.ratings.length;i++){\n                            delete vm.licence.ratings[i].id;\n                            vm.licence.ratings[i].id = vm.licence.ratings[i].rating_id;\n                            delete vm.licence.ratings[i].rating_id;\n                            vm.licence.ratings[i].test_date = new Date(vm.licence.ratings[i].test_date);\n                            vm.licence.ratings[i].expiry_date = new Date(vm.licence.ratings[i].expiry_date);\n\n                            //need to remove the rating from the ratings lists too :)\n                            vm.ratings = $.grep(vm.ratings, function(e){ \n                                return e.id != vm.licence.ratings[i].id; \n                            });\n\n                        }\n\n\n\n                    } else {\n                        //console.log(\"WOOOPSIES...\");\n                        //this should be very very rare...\n                    }\n\n                });\n\n\n\n            break;\n            case \"list\":\n\n                // //console.log(\"LIST ALL\");\n\n                 //1 get the user's licence...\n                 //list stuff\n\n                LicenceService.GetByUserId(vm.user_id)\n                .then(function (data) {\n                    // //console.log(data);\n                    if(data.success){\n                        vm.user_licences = data.licences;\n\n                    } else {\n                        // //console.log(\"WOOOPSIES...\");\n                        //this should be very very rare...\n                    }\n\n                });\n\n\n            break;\n            default:\n                 //console.log(\"none of the above... redirect somewhere?\");\n            break;\n        }  \n\n\n        function base64ToBlob(base64) {\n          const binaryString = window.atob(base64);\n          const len = binaryString.length;\n          const bytes = new Uint8Array(len);\n          for (let i = 0; i < len; ++i) {\n            bytes[i] = binaryString.charCodeAt(i);\n          }\n\n          return new Blob([bytes], { type: 'application/pdf' });\n        };\n\n\n        $scope.show_file_now = false;\n        $scope.show_file_url = \"\";\n\n        // $scope.show_file = function(url){\n        //    // var url = \"api/v1/plane_radio_licence/show_file/\"+url;\n        //    //1559216525VmmkQHNrVx6yuTZzDz0h0Q7.jpg.jpg\n\n        //     var ddd = url.replace(/^.*[\\\\\\/]/, '');\n\n\n        //    var url = \"api/v1/plane_documents/show_file/\"+ddd;\n        //     $http.get(url).\n        //       success(function(data, status, headers, config) {\n        //         // 400/500 errors show up here\n        //         //console.log(\"STATUS\", status);\n        //         if (status == 404 || status == 401)\n        //         {\n        //             alert(\"file not found\");\n        //             //console.log('Should never happen');\n\n        //         }\n        //         if(status == 200){\n\n        //            $scope.show_file_url = url;\n        //           // $scope.expression = '<embed src=\"'+url+'\" width=\"100%\" height=\"auto\" />';\n        //             $scope.show_file_now = true;\n\n        //             setTimeout(function(){\n        //                 var divElement = angular.element(document.querySelector('#add_embed'));\n        //                 var htmlElement = angular.element('<embed src=\"'+url+'\" width=\"100%\" height=\"auto\" />');\n        //                 divElement.append(htmlElement);\n        //                 $compile(divElement)($scope);\n        //             }, 500)\n\n                    \n\n\n        //         }\n        //       }).\n        //       error(function(data, status, headers, config) {\n        //         // never reached even for 400/500 status codes\n        //         //console.log(\"STATUS\", status);\n        //          if (status == 404 || status == 401)\n        //         {\n        //             alert(\"file not found\");\n        //             //console.log('Should never happen');\n\n        //         }\n        //       });\n        // }      \n\n\n        // $scope.show_file = function(doc) {\n        //     var data = $.param({\n        //         id: doc\n        //     });\n\n        //     var ddd = doc.replace(/^.*[\\\\\\/]/, '');\n\n        //     $http.get('api/v1/plane_documents/show_file/'+ddd, {\n        //             responseType: 'arraybuffer'\n        //         })\n        //         .success(function(data, status, headers) {\n        //             var zipName = processArrayBufferToBlob(data, headers);\n\n        //             //Delete file from temp folder in server - file needs to remain open until blob is created\n        //             //deleteFileFromServerTemp(zipName);\n        //         }).error(function(data, status) {\n        //             alert(\"There was an error downloading the selected document(s).\");\n        //         })\n        // };\n\n        $scope.show_file = function(doc, type) {\n            var data = $.param({\n                id: doc\n            });\n\n            //alert(\"type\", type);\n\n            var controller = \"plane_documents\";\n\n            switch(type){\n                 case \"radio\": \n                    controller = \"plane_radio_licence\";\n                break;\n                 case \"insurance\": \n                    controller = \"plane_insurance\";\n                break;\n                 case \"certificate\": \n                    controller = \"plane_certificate\";\n                break;\n                case \"noise\": \n                    controller = \"plane_documents\";\n                break;\n                case \"docs\": \n                    controller = \"plane_documents\";\n                break;\n                default:\n                    controller = \"plane_documents\";\n                break;\n            }\n\n            var ddd = doc.replace(/^.*[\\\\\\/]/, '');\n\n            $http.get('api/v1/'+controller+'/show_file/'+ddd, {\n                    responseType: 'arraybuffer'\n                })\n                .success(function(data, status, headers) {\n                    var zipName = processArrayBufferToBlob(data, headers);\n\n                    //Delete file from temp folder in server - file needs to remain open until blob is created\n                    //deleteFileFromServerTemp(zipName);\n                }).error(function(data, status) {\n                    alert(\"There was an error downloading the selected document(s).\");\n                })\n        };\n\n         function processArrayBufferToBlob(data, headers) {\n            var octetStreamMime = 'application/octet-stream';\n            var success = false;\n\n            // Get the headers\n            headers = headers();\n            //var ttt = title.toLowerCase().replace(/\\W/g, '_');\n            // Get the filename from the x-filename header or default to \"download.bin\"\n            var filename = headers['x-filename'] || 'download.zip';\n\n            // Determine the content type from the header or default to \"application/octet-stream\"\n            var contentType = headers['content-type'] || octetStreamMime;\n\n            try {\n                // Try using msSaveBlob if supported\n                var blob = new Blob([data], {\n                    type: contentType\n                });\n                if (navigator.msSaveBlob)\n                    navigator.msSaveBlob(blob, filename);\n                else {\n                    // Try using other saveBlob implementations, if available\n                    var saveBlob = navigator.webkitSaveBlob || navigator.mozSaveBlob || navigator.saveBlob;\n                    if (saveBlob === undefined) throw \"Not supported\";\n                    saveBlob(blob, filename);\n                }\n                success = true;\n            } catch (ex) {\n                $log.info(\"saveBlob method failed with the following exception:\");\n                $log.info(ex);\n            }\n\n            if (!success) {\n                // Get the blob url creator\n                var urlCreator = window.URL || window.webkitURL || window.mozURL || window.msURL;\n                if (urlCreator) {\n                    // Try to use a download link\n                    var link = document.createElement('a');\n                    if ('download' in link) {\n                        // Try to simulate a click\n                        try {\n                            // Prepare a blob URL\n                            var blob = new Blob([data], {\n                                type: contentType\n                            });\n                            var url = urlCreator.createObjectURL(blob);\n                            link.setAttribute('href', url);\n\n                            // Set the download attribute (Supported in Chrome 14+ / Firefox 20+)\n                            link.setAttribute(\"download\", filename);\n\n                            // Simulate clicking the download link\n                            var event = document.createEvent('MouseEvents');\n                            event.initMouseEvent('click', true, true, window, 1, 0, 0, 0, 0, false, false, false, false, 0, null);\n                            link.dispatchEvent(event);\n                            success = true;\n\n                        } catch (ex) {\n                            $log.info(\"Download link method with simulated click failed with the following exception:\");\n                            $log.info(ex);\n                        }\n                    }\n\n                    if (!success) {\n                        // Fallback to window.location method\n                        try {\n                            // Prepare a blob URL\n                            // Use application/octet-stream when using window.location to force download\n                            var blob = new Blob([data], {\n                                type: octetStreamMime\n                            });\n                            var url = urlCreator.createObjectURL(blob);\n                            window.location = url;\n                            success = true;\n                        } catch (ex) {\n                            $log.info(\"Download link method with window.location failed with the following exception:\");\n                            $log.info(ex);\n                        }\n                    }\n                }\n            }\n\n            if (!success) {\n                // Fallback to window.open method\n                $log.info(\"No methods worked for saving the arraybuffer, using last resort window.open\");\n                window.open(httpPath, '_blank', '');\n            }\n            return filename;\n        };\n\n\n        $scope.close_file = function(){\n            $scope.show_file_now = false;\n            $scope.show_file_url = \"\";\n        }\n\n        $scope.applyFilter = function(model, filter) {\n            if(filter){\n\n                var pieces = filter.split(':');\n\n                var filterName = pieces[0];\n\n                var params = [model];\n\n                if(pieces.length>1){\n                    \n                    // //console.log(\"hello\", pieces.slice(1).join(\":\"));\n                    if(filterName.toLowerCase() == \"date\"){\n                       params.push( pieces.slice(1).join(\":\") );\n                    }\n                    //params = params.slice(1, -1);\n                    // //console.log(\"contact it\", params);\n\n                } else {\n                    params = params.concat(pieces.slice(1));\n                }\n\n                return $filter(filterName).apply(this,params);\n            }else{\n                return model;\n            }\n        }\n\n        $scope.status = {\n            days: \"\",\n            hours: \"\",\n            insurance: \"\",\n            certificate: \"\",\n            radio_licence: \"\",\n        };\n\n        function status(){\n\n            var plane = vm.club.plane;\n\n            if(plane.maintenance){\n\n                $scope.status.days = (plane.maintenance.days_remaining > 0)? \"ok\" : \"expired\";\n                $scope.status.hours = (plane.maintenance.hours_remaining > 0)? \"ok\" : \"expired\";\n\n            }\n\n            $scope.status.certificate = (plane.certificate.days_to_expiry > 0)? \"ok\" : \"expired\";\n            $scope.status.insurance = (plane.insurance.days_to_expiry > 0)? \"ok\" : \"expired\";\n            $scope.status.radio_licence = (plane.radio_licence.days_to_expiry > 0)? \"ok\" : \"expired\";\n\n\n\n        }\n\n        vm.update_course = function(){\n\n            if(vm.bookout.selected_course && vm.bookout.selected_course.id > 0){\n                //let us set it\n                // console.log(\"ONE COURSE?\", vm.bookout.selected_course.id);\n                 CourseService.GetChargesByCourseId(vm.bookout.selected_course.id)\n                                        .then(function(data){\n                                            vm.instructor_charges = data.items; \n\n                                            if(vm.instructor_charges.length == 1){\n                                                vm.bookout.tuition_required = vm.instructor_charges[0];\n                                            }\n\n                                        });\n\n            } else {\n                // console.log(\"MORE COURSE?\");\n                //let us clear it?\n                 InstructorCharges.GetByClubId(vm.bookout.club_id)\n                                        .then(function(data){\n                                            vm.instructor_charges = data.items; \n\n                                            if(vm.instructor_charges.length == 1){\n                                                vm.bookout.tuition_required = vm.instructor_charges[0];\n                                            }\n                                             \n                                        });\n                                           \n            }\n\n        }\n\n        function process_booking_to_bookout(booking){\n\n\n            //vm.bookout is where we want to fill the content....\n            vm.bookout.booking_id = booking.id;\n            vm.bookout.club_id = booking.club_id;\n            vm.bookout.user_id = booking.user_id;\n            vm.bookout.plane = booking.plane;\n            vm.club_id = booking.club_id;\n            vm.bookout.return = new Date(booking.end);\n            vm.bookout.booking_start = new Date(booking.start);\n\n\n            if((vm.user.access.instructor.indexOf(vm.club_id) > -1) || (vm.user.access.manager.indexOf(vm.club_id) > -1) ){\n                //console.log(\"NOT BOOKING FOR SELF?\");\n                vm.can_authorise = true;\n                //prepare_add_edit();\n            }\n\n\n             PlaneService.GetOpenIssues(booking.plane.id)\n            .then(function (data) {\n                    ////console.log(\"data is : \", data);\n                   vm.reported_defects = data;\n                });\n\n            //to be able to update the content of the members on the lists...\n            get_all_members();\n\n            //we need to update the PICS now...\n\n\n            //we need to know where the plane was last booked-in at \n            //(ie: if last flight bookout was completed - where the plane landed at last)\n            //if the last booking was not yet completed, then we can assume that this last flight was returning to base.\n\n\n\n            if(booking.instructor && booking.instructor.id > 0){\n                // then we need to set the PIC as the instructor\n                //select from pics where user_id = booking.user_id;\n                var selected_pic = vm.pics.find(item => item.user_id === booking.instructor.id);\n                //set the PIC now...\n                vm.bookout.pic = selected_pic;\n                vm.bookout.instructor_id = booking.instructor.id;\n                vm.bookout.instructor = booking.instructor;\n                vm.bookout.course_id = booking.course_id;\n\n               \n                //set the tuition now... \n                //console.log(\"BOOKING HERE IS : \", booking);\n                vm.bookout.tuition_required = booking.tuition_required;\n\n                // vm.bookout.tuition_required\n                CourseService.GetCoursesByClubId(vm.bookout.club_id)\n                                .then(function(data){\n                                    vm.courses = data.items;   \n                                     console.log(\"COURSES\", vm.courses);\n                                     console.log(\"COURSES\", vm.bookout.course_id);\n\n                                    //set new_booking.tuition-required \n                                    vm.bookout.selected_course = vm.courses.find(function(course, index) {\n                                                                    if(course.id == vm.bookout.course_id)\n                                                                        return true;\n                                                                });\n\n                                    //link to instructor charges??\n\n                                    //auto-fill??\n                                    console.log(\"vm.bookout.course_id\", vm.bookout.course_id);\n                                    vm.update_course();\n\n\n\n                 });\n\n                 // vm.bookout.tuition_required = vm.courses.find(function(course, index) {\n                 //                                                    if(course.id == vm.bookout.course_id)\n                 //                                                        return true;\n                 //                                                });\n\n                var selected_put = vm.pics.find(item => item.user_id === booking.user_id);\n                vm.bookout.put = selected_put;\n                //console.log(\"PICS ARE : \", vm.pics);\n                //console.log(\"INSTRUCTOR IS : \", vm.bookout.instructor);\n                //console.log(\"user IS : \", booking.user_id);\n                //console.log(\"PIC IS : \", booking.pic);\n                //console.log(\"PUT IS : \", vm.bookout.put);\n\n            } else {\n                //then the user is the PIC\n                var selected_pic = vm.pics.find(item => item.user_id === booking.user_id);\n                vm.bookout.pic = selected_pic;\n\n            }\n\n            //preload the pax\n            vm.bookout.passengers = booking.passengers;\n            //setup the pax addition on the bookout page\n            vm.init_passengers();\n\n\n            if(booking && booking.plane_details && booking.plane_details.location && booking.plane_details.location.wgs_n){\n                vm.wgs_n = booking.plane_details.location.wgs_n\n                vm.wgs_e = booking.plane_details.location.wgs_e;\n            }\n            var location_default = \"\";\n\n            if(booking && booking.plane_details && booking.plane_details.location && booking.plane_details.location.code){\n                location_default = booking.plane_details.location.code.slice(0, -1);\n            } else {\n                location_default = \"EG\";\n            }\n\n\n            BookoutService.GetAirfieldsByCode(location_default)\n                .then(function (data) {\n                    if(data.success){\n                        //use GB airfields first...\n                        vm.airfields = data.airfields;\n                        var selected_location = vm.airfields.find(item => item.id === booking.plane_details.location.id);\n                        //console.log(\"selected_location\", selected_location);\n                        vm.bookout.from_airfield = selected_location;\n                       }\n                    });\n\n          \n            //booking.plane_details.location.id\n            // vm.bookout.pic = selected_pic;\n\n\n        }\n\n\n        $scope.selected_airfield_check = function(){\n            //console.log(\"airfield has been selected\", vm.bookout.from_airfield.id);\n            if(vm.bookout.from_airfield.id == 150 || (vm.bookout.to_airfield && vm.bookout.to_airfield.id == 150)){\n                //console.log(\"extra information required\");\n                vm.extra_information_required = true;\n            } else {\n                if(!vm.filing_flightplan && vm.bookout.from_airfield.id !== 150){\n                    if(vm.bookout.to_airfield && vm.bookout.to_airfield.id){\n                        if(vm.bookout.to_airfield.id !== 150){\n                            //console.log(\"not going to biggin and no need for filing a flightplan so wa can ignore this\");\n                            vm.extra_information_required = false;\n                        }\n                    } else {\n                        //console.log(\"not going to biggin and no need for filing a flightplan so wa can ignore this\");\n                        vm.extra_information_required = false;\n                    }\n                    \n                }\n            }\n\n        }\n\n\n            $scope.add_rating = function(){\n\n                //remove from first array\n                vm.ratings = $.grep(vm.ratings, function(e){ \n                    return e.id != vm.selected_rating.id; \n                });\n\n                vm.licence.ratings.push(vm.selected_rating);\n\n                //clear selected\n                delete vm.selected_rating;\n                \n                //clean the array to show what we want to show :)\n                //delete $scope.formData.license.add_to[bit_type];\n\n            }\n\n            $scope.remove_rating = function(index){\n\n                //add to dropdown\n                vm.ratings.push(vm.licence.ratings[index]);\n                vm.licence.ratings.splice(index,1)\n\n                //$scope.formData.license[bit_type] = $scope.formData.license[bit_type].filter(Boolean);\n\n                //  //console.log($scope.formData.license[bit_type]);\n                //  $scope.formData.license[bit_type].push($scope.formData.license.add_to[bit_type]);\n            }\n\n            //default add the first rating required...\n            \n\n            $scope.bookout_plane = function(){\n\n                ////console.log(\"PAX \", vm.bookout.passengers);\n                //flight type\n                if(!vm.bookout.flight_type || vm.bookout.flight_type.id < 1){\n                    alert(\"You need to select a flight type - is this a local flight? Or a departure?\");\n                    return false;\n                }\n\n                if(!vm.bookout.pic || vm.bookout.pic.id < 1){\n                    alert(\"You need to select a Pilot In Command (PIC)\");\n                    return false;\n                }\n\n                if( (!vm.bookout.is_current || vm.bookout.is_current == 0) && vm.bookout.instructor_id < 1 ){\n                    alert(\"Please confirm that you are current according to the club rules, as you do not have an instructor booked.\");\n                    return false;\n                }\n\n\n\n\n\n\n\n                //check the destination is entered if required\n                if(vm.bookout.flight_type.id == 2 && (!vm.bookout.to_airfield || (vm.bookout.to_airfield.id < 1 && vm.bookout.to_airfield.title == \"\" ) )){\n                    alert(\"As you selected this flight to be a departure, please select a destination airfield\");\n                    return false;\n                }\n\n\n\n\n\n\n\n\n\n\n                if(!vm.bookout.accept_defects && vm.reported_defects.length > 0){\n                    alert(\"You must state that you have read the defects currently reported and accept to fly the plane in the condition provided prior to booking out the plane.\");\n                    return false;\n                }\n\n                //checking the pax are either member or accepted the invitation\n                vm.refresh_all_passenger();\n\n                var pax = vm.bookout.passengers;\n                for(var i=0;i<pax.length;i++){\n                    if(pax[i][\"status\"] == \"to_invite\"){\n                        alert(\"You need to press the invitation button for your passenger who isn't already a member before booking out.\");\n                        return false;\n                    }\n                    if(pax[i][\"status\"] == \"invited\" && pax[i][\"aboard\"]){\n                        alert(\"You need to make sure that your passenger has completed his membership and has agreed to the terms of your flight before you go flying.\");\n                        return false;\n                    }\n                }\n\n                //then we compose our object for the server...\n\n                var bookout_obj = {\n                    club_id: vm.bookout.club_id,\n                    plane_id: vm.bookout.plane.id,\n                    user_id: vm.bookout.user_id,\n                    pic_id: vm.bookout.pic.user_id,\n                    booking_id: vm.bookout.booking_id,\n                    is_pilot_current: vm.bookout.is_current,\n                    dual_flight: (vm.bookout.instructor_id > 0 && vm.bookout.pic.id == vm.bookout.instructor.id) ? 1 : 0,\n                    instructor_id: vm.bookout.instructor_id,\n                    tuition_id: (vm.bookout.instructor_id > 0 && vm.bookout.tuition_required && !vm.bookout.authorised_solo) ? vm.bookout.tuition_required.id : 0,\n                    detail_type_id: vm.bookout.flight_type.id,\n                    from_airport_id: vm.bookout.from_airfield.id,\n                    to_airport_id: (vm.bookout.flight_type.id == 1 || vm.bookout.flight_type.id == 3) ? vm.bookout.from_airfield.id : vm.bookout.to_airfield.id,\n                    booked_out: 1,\n                    booked_in: 0,\n                    flight_date: new Date(vm.bookout.booking_start),\n                    passengers: vm.bookout.passengers,\n                    authorised_solo: (vm.bookout.authorised_solo)? true : false,\n                    authorised_by: (vm.bookout.authorised_solo)? vm.user.id : 0,\n                    //optional for Biggin / flightplan...\n                    endurance_time: vm.bookout.endurance,\n                    estimated_enroute_time: vm.bookout.en_route,\n                    flight_rules: vm.bookout.flight_rule,\n                    flight_notes: vm.bookout.additional_details,\n                    parking_note: vm.bookout.parking_note,\n                    estimated_departure: vm.bookout.departure,\n                    routing_via_id: (vm.bookout.routing_via) ? vm.bookout.routing_via.id : 0\n                }\n\n\n\n                 if(bookout_obj.to_airport_id == 0){\n                    bookout_obj.new_to_airport = vm.bookout.to_airfield;\n                    bookout_obj.new_to_airport.title = bookout_obj.new_to_airport.title.replace(\"NOT LISTED : \", \"\");\n                }\n\n                if(bookout_obj.from_airport_id == 0){\n                    bookout_obj.new_from_airport = vm.bookout.from_airfield;\n                    bookout_obj.new_from_airport.title = bookout_obj.new_from_airport.title.replace(\"NOT LISTED : \", \"\");\n                }    \n\n\n                // console.log(\"READY WITH: \", bookout_obj);\n                // return false;\n\n                BookoutService.SendBookout(vm.user.id, bookout_obj)\n                .then(function(data){\n                    ////console.log(\"sending returned data\", data);\n                        $state.go('dashboard.my_account.booked_out', {booking_id: vm.bookout.booking_id});\n                    // if(data.success){\n\n                    //     $state.go('dashboard.bookout.booked_out', {booking_id: vm.bookout.booking_id});\n\n                    // } else {\n                    //     alert(data.message);\n                    // }\n                });\n\n\n                //console.log(\"OBJECT HERE\", bookout_obj);\n\n            }\n\n\n\n\n/*\n\nOLD VERSION FOR LEGACY PURPOSES\n\n  $scope.add_element = function(bit_type){\n\n                //remove from first array\n                $scope[bit_type][bit_type] = $.grep($scope[bit_type][bit_type], function(e){ \n                    return e.id != $scope.formData.license.add_to[bit_type].id; \n                });\n\n                if(bit_type == \"differences\"){\n                    $scope.formData.license.add_to[bit_type].day = true;\n                    $scope.formData.license.add_to[bit_type].vfr = true;\n                }\n                //console.log($scope.formData.license.add_to[bit_type]);\n\n                $scope.formData.license[bit_type].push($scope.formData.license.add_to[bit_type]);\n                \n                //clean the array to show what we want to show :)\n                delete $scope.formData.license.add_to[bit_type];\n\n            }\n\n\n            $scope.remove_element = function(bit_type, index){\n\n                //add to dropdown\n                $scope[bit_type][bit_type].push($scope.formData.license[bit_type][index]);\n            \n                $scope.formData.license[bit_type].splice(index,1)\n\n                $scope.formData.license[bit_type] = $scope.formData.license[bit_type].filter(Boolean);\n                //console.log($scope.formData.license[bit_type]);\n                //$scope.formData.license[bit_type].push($scope.formData.license.add_to[bit_type]);\n            }\n\n\n*/\n\n\n            //nice looking date pickers\n\n\n            $scope.popup = [];\n\n            $scope.open = function(id, $event) {\n                //console.log(\"THIS\", id);\n                //this comment would allow the event not to be affect by clicking it again... not sure this is a good idea\n                if($scope.popup[id] && $scope.popup[id].opened == true){\n                    $event.preventDefault();\n                    $event.stopPropagation();\n                } else {\n                    $scope.popup[id] = {opened: true};\n                }\n            };\n\n            $scope.formats = ['dd/MM/yyyy', 'yyyy/MM/dd', 'dd.MM.yyyy', 'shortDate'];\n            $scope.format = $scope.formats[0];\n\n            $scope.datePickerOptions = {\n                                        format: 'dd/MM/yyyy',\n                                        showWeeks: false\n                                    };\n\n           \n\n           $scope.remove_real_file = function(file){\n\n                //remove_file\n\n                vm.licence.images = $.grep(vm.licence.images, function(e){ \n                        return e.id != file.id; \n                    });\n\n                //no need to actually remove the file as it will be archived accordingly on the backend whilst it is missing! :)\n                \n\n          }\n\n\n          \n          $scope.remove_file = function(file, current_files){\n\n            //remove_file\n            var j = JSON.parse(file.file_return);\n            //console.log(\"REMOVE: \", j);\n            //console.log(\"REMOVE: \", j.saved_url);\n\n            //to delete the temp file created: j.saved_url\n            //tmp_rm.php POST tmp = filename\n            \n            LicenceService.DeleteTmp(j.saved_url)\n                .then(function (data) {\n                    //console.log(data);\n                    if(data.success){\n                        //console.log(\"HUZZAH\", current_files);\n                        //then we need to remove this from the list of files...\n                        //clear files\n                        vm.licence_images = [];\n                        //and re-process available files\n                        $scope.processFiles(current_files);\n\n                    } else {\n                        //console.log(\"WOOOPSIES...\");\n                        //this should be very very rare...\n                    }\n\n                });\n\n          }\n          \n\n            $scope.processFiles = function(files){\n                // //console.log(\"files\", files);\n\n                for(var i=0; i<files.length; i++){\n                    // //console.log(\"JSON\", files[i].file_return);\n                    var j = JSON.parse(files[i].file_return);\n                    // //console.log(\"PARSED\", j);\n                    files[i].file.temp_path = j.saved_url;\n                    // //console.log(\"file\", files[i].file);\n                    vm.licence_images.push(files[i].file);\n                }\n               \n            }\n\n\n\n            $scope.delete_licence = function(id){\n\n\n                var a = prompt(\"Are you sure you wish to delete this licence? \\n\\n This change is irreversible! To confirm please type YES in the box below.\");\n                if(a == \"YES\"){\n                    //console.log(\"WE DELETE IT\");\n\n\n                    LicenceService.Delete(vm.user_id, id)\n                        .then(function (data) {\n                            //console.log(data);\n                            if(data.success){\n                                //console.log(\"HUZZAH\", data);\n                                //then we need to remove this from the list of files...\n                                vm.user_licences = $.grep(vm.user_licences, function(e){ \n                                    return e.id != id; \n                                });\n                                \n                                //refresh?\n                                $state.reload();\n                                $state.go('dashboard.my_account.licence');\n\n                            } else {\n\n                                alert(\"Something went terribly wrong... \\n\\n \"+data.message);\n\n                            }\n\n                        });\n\n\n\n                } else {\n                    //console.log(\"ignore\");\n                }\n\n\n            }\n\n\n\n\n            $scope.save_licence = function(isValid){\n\n                if(vm.licence_images.length < 1 && vm.licence.images.length < 1){\n\n                    $(\".drop\").focus();\n                    alert(\"You must at least have 1 image of your licence!\");\n\n                    return false;   \n                }\n\n\n                if(!vm.licence.licence_type){\n                    $(\"#licence_type\").focus();\n                    alert(\"You must select a licence type\");\n\n                    return false;\n                }\n\n\n                if(!vm.licence.state_of_issue){\n                    $(\"#state_of_issue\").focus();\n                    alert(\"You must select a licence state of issue\");\n\n                    return false;\n                }\n\n\n                if(vm.licence.ratings.length < 1){\n\n                    $(\"#ratings\").focus();\n                    alert(\"You must at least have 1 rating!\");\n                    \n                    return false;   \n                }\n\n                //console.log(\"FLOW: \", vm.licence_images);\n\n\n\n                //compile the required elements YAY\n\n                //console.log(\"LICENCE GOOD TO GO \", vm.licence);\n\n\n                 //clean shizzle before sending\n                 //why keep sending back heavy data?\n\n                    for(var i=0;i<vm.licence.images.length;i++){\n                        delete vm.licence.images[i].data_uri;\n                    }\n\n                    // vm.licence.images = vm.licence_images;\n                    vm.licence.images = vm.licence.images.concat(vm.licence_images);\n\n                    vm.licence.licence_id = vm.licence.licence_type.id;\n                    vm.licence.authority_id = vm.licence.state_of_issue.id;\n                    vm.licence.user_id = vm.user_id;\n\n                    delete vm.licence.licence_type;\n                    delete vm.licence.state_of_issue;\n\n\n                if(vm.licence.id){\n                    //then its an udpate\n\n                    //merge the images left?\n                    LicenceService.Update(vm.licence)\n                        .then(function (data) {\n                            //console.log(data);\n                            if(data.success){\n                                //console.log(\"HUZZAH\", vm.licence);\n                                //console.log(\"HUZZAH\", data);\n                                //then we need to remove this from the list of files...\n                                \n                                \n                                //move somewhere?\n                                $state.go('dashboard.my_account.licence', {}, { reload: true });\n\n\n\n\n\n                            } else {\n\n                                alert(\"Something went terribly wrong... \\n\\n \"+data.message);\n\n                            }\n\n                        });\n\n                } else {\n\n\n                   \n\n\n                    //then its a create\n                    //console.log(vm.licence);\n\n                    LicenceService.Create(vm.licence)\n                        .then(function (data) {\n                            //console.log(data);\n                            if(data.success){\n                                //console.log(\"HUZZAH\", vm.licence);\n                                //console.log(\"HUZZAH\", data);\n                                //then we need to remove this from the list of files...\n                                \n                                \n                                //move somewhere?\n                                $state.reload();\n                                $state.go('dashboard.my_account.licence', {}, { reload: true });\n\n\n                            } else {\n\n                                alert(\"Something went terribly wrong... \\n\\n \"+data.message);\n\n                            }\n\n                        });\n\n\n                }\n\n\n\n            };\n\n\n\n\n            $scope.logout = function(){\n                //alert(\"LOG ME OUT\");\n                AuthenticationService.Logout(function(data){\n\n                               AuthenticationService.ClearCredentials();\n                                 \n                                $cookieStore.remove('globals');\n                                $cookieStore.remove('session');\n\n                                $location.path('/login');\n\n\n                             \n                            \n                        });\n            }\n\n            $scope.go_flying = function(){\n                //alert(\"LOG ME OUT\");\n             \n\n                $state.go('dashboard.my_account', {}, { reload: true });\n\n\n                       \n            }\n\n\n\n\n\n\n\n            //EDITING OF THE BOOKING FROM THE BOOKOUT...\n             /* THIS SECTION IS ABOUT THE ADD / EDIT OF THE CALENDAR EVENTS VIA THE EDIT / ADD NEW BOOKING */\n\n            // vm.dateTimeRangePickerOptions = {\n            //     hour_step: 1,\n            //     minute_step: 30,\n            //     min_date: today,\n            //     datepicker:{\n            //         customClass: getDayClass,\n            //         format: 'dd/MM/yyyy',\n            //         showWeeks: false,\n            //         minDate: today\n            //     }\n            //     ,\n            //     business_hours: {\n            //         from: \"09:00\",\n            //         to: \"22:30\"\n            //     }\n            // };\n\n\n            // /* ADD OR EDIT THE BOOKING */\n\n            // function figure_out_steps(){\n            //     //console.log(\"OPTIONS\", vm.dateTimeRangePickerOptions);\n            //     vm.new_booking.options = vm.dateTimeRangePickerOptions;\n            //      for(var i=0;i<24;i+=vm.new_booking.options.hour_step){\n\n            //         if(vm.new_booking.options.minute_step && vm.new_booking.options.minute_step > 0){\n            //             for(var j=0; j<(60/vm.new_booking.options.minute_step); j++){\n            //                 var k = vm.new_booking.options.minute_step * j;\n            //                 k = ((k < 10) ? '0' : '') + k;\n            //                 vm.start_times.push({time: i+\":\"+k, disabled: check_business_hours(i, k)});\n            //                 vm.end_times.push({time: i+\":\"+k, disabled: check_business_hours(i, k), duration: \"\"});\n            //             }\n            //         } else {\n            //             vm.start_times.push({time: i+\":00\", disabled: check_business_hours(i)});\n            //             vm.end_times.push({time: i+\":00\", disabled: check_business_hours(i), duration: \"\"});\n            //         }\n\n            //     }\n            // }\n\n            // function init_times(){\n            //    for(var i=0;i<24;i+=vm.new_booking.options.hour_step){\n\n            //         if(vm.new_booking.options.minute_step && vm.new_booking.options.minute_step > 0){\n            //             for(var j=0; j<(60/vm.new_booking.options.minute_step); j++){\n            //                 var k = vm.new_booking.options.minute_step * j;\n            //                 k = ((k < 10) ? '0' : '') + k;\n            //                 vm.start_times.push({time: i+\":\"+k, disabled: check_business_hours(i, k)});\n            //                 vm.end_times.push({time: i+\":\"+k, disabled: check_business_hours(i, k), duration: \"\"});\n            //             }\n            //         } else {\n            //             vm.start_times.push({time: i+\":00\", disabled: check_business_hours(i)});\n            //             vm.end_times.push({time: i+\":00\", disabled: check_business_hours(i), duration: \"\"});\n            //         }\n\n            //     } \n            // }\n\n\n        \n\n\n\n\n\n\n\n\n\n\n\n\n        \n\n\n    }\napp.controller('CategoriesController', CategoriesController);\n \n    CategoriesController.$inject = ['UserService', 'CategoryService', '$location', '$rootScope', 'FlashService', '$routeParams', '$scope'];\n    function CategoriesController(UserService, CategoryService, $location, $rootScope, FlashService, $routeParams, $scope) {\n        var vm = this;\n\n        // vm.cats = [\n        // \t{\"title\": \"art\", \"id\": 1},\n        // \t{\"title\": \"fashion\", \"id\": 2},\n        // \t{\"title\": \"glass\", \"id\": 3},\n        // \t{\"title\": \"metal\", \"id\": 4}\n        // ];\n       \n         CategoryService.GetAll()\n                .then(function (data) {\n                    vm.cats = data;\n                });\n\n       \tvm.id = 1;\n       \tvm.myModel = 'Click here and delete me';\n\t\t$scope.myUpdateHandler = function(id, category){\n\t\t  // check your console\n\t\t  //console.log('value of '+id+' your model is now: ' + category);\n\t\t  var update = {\"id\": id, \"title\": category};\n\t\t  CategoryService.Update(update)\n                .then(function (data) {\n                    //console.log(\"SAVED :)\");\n                });\n\t\t};\n\n\t\t$scope.addCategory = function(){\n\t\t\t//console.log(\"ADD ONE \"+vm.new_category);\n\t\t\t//need to call the outside world here and now :0\n\t\t\tvar add_one = {\"title\": vm.new_category};\n\t\t\tCategoryService.Create(add_one)\n                .then(function (data) {\n                    vm.cats.push(data);\n                    //reset\n\t\t\t\t\tvm.new_category = \"\";\n                });\n\t\t}\n\n\t\t$scope.deleteCategory = function(id){\n\n\t\t\tCategoryService.Delete(id)\n                .then(function (data) {\n                    vm.cats = $.grep(vm.cats, function(e){ \n\t\t\t\t\t     return e.id != id; \n\t\t\t\t\t});\n                });\n\n\t\t}\n\n    }\n app.controller('ClaimAFlightController', ClaimAFlightController);\n\n    ClaimAFlightController.$inject = ['UserService', 'FoxService', '$rootScope', '$scope', '$stateParams', '$location'];\n    function ClaimAFlightController(UserService, FoxService, $rootScope, $scope, $stateParams, $location) {\n        var vm = this;\n\n        vm.user = $rootScope.globals.currentUser;\n        vm.unclaimed = [];\n\n        vm.looking_for = $stateParams.registration;\n        if(vm.looking_for){\n            $scope.my_search2 = vm.looking_for;\n        }\n\n        // vm.allUsers = [];\n        // vm.deleteUser = deleteUser;\n\n        initController();\n\n        function initController() {\n            // loadCurrentUser();\n            console.log(\"init claim a flight controller\");\n            GetFoxEntries();\n            // loadAllUsers();\n        }\n\n        function GetFoxEntries() {\n            //is this a club_id ? OR is this a USER id --> therefore return all clubs with all un-claimed flights?\n            FoxService.GetFoxEntries($rootScope.globals.currentUser.id)\n                .then(function (data) {\n                    console.log(\"GetFoxEntries was called here\");\n                    vm.unclaimed = data;\n                    console.log(\"vm.unclaimed\", vm.unclaimed);\n                });\n        }\n\n        // function loadAllUsers() {\n        //     UserService.GetAll()\n        //         .then(function (data) {\n        //             vm.allUsers = data.users;\n        //         });\n        // }\n\n       \n        // function deleteUser(id) {\n        //     UserService.Delete(id)\n        //     .then(function(data) {\n        //         if(data.success){\n\t       //          $location.path('/');\n        //         }\n        //     });\n        // }\n\n        $scope.search = function(row){\n            ////console.log(\"hi\", (angular.lowercase(row.title).indexOf(angular.lowercase($scope.my_search) || '') !== -1));\n            return (angular.lowercase(row.title).indexOf(angular.lowercase($scope.my_search) || '') !== -1);\n        };\n\n        $scope.search2 = function(row){\n            return (angular.lowercase(row.registration).indexOf(angular.lowercase($scope.my_search2) || '') !== -1);\n        };\n\n        $scope.getMySearchCount = function(str){\n            var docs = str.documents;\n            var total = 0;\n            for(var i=0;i<docs.length;i++){\n                if($scope.search(docs[i])){\n                    total++;\n                }\n            }\n            return total;\n        }\n        \n        vm.clean_times = function(time){\n                return time.substring(0,5);\n        }\n\n        vm.difference_times = function(to, from){\n            var to_datetime = moment(to);\n            var from_datetime = moment(from);\n            // console.log(\"to datetime\", to_datetime);\n            // console.log(\"from datetime\", from_datetime);\n            var duration = moment.duration(from_datetime.diff(to_datetime));\n            var hours = duration.asHours();\n            //now to hours and seconds??\n            var hour = Math.floor(Math.abs(hours));\n            var min = Math.round((Math.abs(hours) * 60) % 60);\n            return (hour < 10 ? \"0\" : \"\") + hour + \":\" + (min < 10 ? \"0\" : \"\") + min;\n            //return hours;\n        }\n\n        vm.difference_times_decimal = function(to, from){\n            var to_datetime = moment(to);\n            var from_datetime = moment(from);\n            var duration = moment.duration(from_datetime.diff(to_datetime));\n            var hours = duration.asHours();\n            return hours;\n        }\n\n        vm.airborne_decimal = function(seconds){\n             var hours = seconds / 60 / 60;\n             return hours;\n        }\n\n        vm.airborne_to_hours = function(seconds){\n             var hours = seconds / 60 / 60;\n             var hour = Math.floor(Math.abs(hours));\n             var min = Math.round((Math.abs(hours) * 60) % 60);\n             if(min == 60){\n                 hour = hour +1;\n                 min = 0;\n             }\n             return (hour < 10 ? \"0\" : \"\") + hour + \":\" + (min < 10 ? \"0\" : \"\") + min;\n        }\n\n        $scope.get_hours_from_decimal = function(time){\n\n            if(time){\n                 var sign = time < 0 ? \"-\" : \"\";\n                 var hour = Math.floor(Math.abs(time));\n                 var min = Math.round((Math.abs(time) * 60) % 60);\n                 if(min == 60){\n                     hour++;\n                     min = 0;\n                 }\n                 return sign + (hour < 10 ? \"0\" : \"\") + hour + \":\" + (min < 10 ? \"0\" : \"\") + min;\n             } else {\n                 return \"N/A\";\n             }\n        }\n\n\n    }\n app.controller('ClubDocumentsController', ClubDocumentsController);\n\n    ClubDocumentsController.$inject = ['UserService', 'MemberService', 'InstructorService', 'MembershipService', 'HolidayService', '$rootScope', '$location', '$scope', '$state', '$stateParams', '$uibModal', '$log', '$window', '$compile', '$timeout', 'uiCalendarConfig', 'BookingService', 'LicenceService', 'ClubDocumentService', '$http'];\n    function ClubDocumentsController(UserService, MemberService, InstructorService, MembershipService, HolidayService, $rootScope, $location, $scope, $state, $stateParams, $uibModal, $log, $window, $compile, $timeout, uiCalendarConfig, BookingService, LicenceService, ClubDocumentService, $http) {\n        \n        var vm = this;\n        vm.licence_images = [];\n        vm.documents = [];\n        vm.licence = {\n                images: [],\n                ratings: []\n        };\n        // vm.user_id = 59;\n        // vm.club_id = 6;\n\n\n        vm.club_id = $rootScope.globals.currentUser.current_club_admin.id;\n        vm.user = $rootScope.globals.currentUser;\n        vm.user_id = vm.user.id;\n\n\n        vm.uploaded_document = {};\n\n        //GetByClubId\n\n        // LicenceService.GetLicenceTypes()\n        //         .then(function (data) {\n        //             vm.licence_types = data;\n        //             //console.log(\"licence_types: \", vm.licence_types);\n        //         });\n\n        // LicenceService.GetRatings()\n        //     .then(function (data) {\n        //         vm.ratings = data;\n        //         //console.log(\"ratings: \", vm.ratings);\n\n        //         if($state.current.data.action == \"add\"){\n\n        //             vm.selected_rating = $.grep(vm.ratings, function(e){ return e.id == 7; })[0];\n        //             $scope.add_rating();\n\n        //             // for(var i=0;i<vm.ratings.length; i++){\n        //             //     //console.log(\"LOOP\", vm.ratings[i]);\n        //             //     if(vm.ratings[i].id == 7){\n        //             //         vm.selected_rating = vm.ratings[i];\n        //             //         //console.log(\"FOUND\", vm.selected_rating);\n        //             //         $scope.add_rating();\n        //             //         break;\n        //             //     }\n        //             // }\n        //         }\n               \n\n\n        //     });\n\n        // LicenceService.GetAuthority()\n        //     .then(function (data) {\n        //         vm.authority = data;\n        //         //console.log(\"authority: \", vm.authority);\n        //     });\n\n\n        switch($state.current.data.action){\n            case \"add\":\n\n                    //vm.selected_rating = vm.ratings[0];\n                    //vm.selected_rating = \n                    \n\n                    // //console.log(\"AA\", vm.selected_rating);\n\n            \n\n            break;\n            case \"edit\":\n\n            // //console.log(\"EDIT ONE\");\n            // //console.log(\"PARAMS: \", $stateParams);\n\n             ClubDocumentService.GetById($stateParams.document_id)\n                .then(function (data) {\n                    if(data.success){\n                        //console.log(\"WE GOT data\", data);\n                        vm.document = data.document;\n                        vm.uploaded_document = {file: vm.document.document};\n                    } else {\n                        //console.log(\"WOOOPSIES...\");\n                        //this should be very very rare...\n                    }\n\n                });\n\n\n\n            break;\n            case \"list\":\n\n                //console.log(\"LIST ALL\");\n\n                 //1 get the user's licence...\n                 //list stuff\n\n                ClubDocumentService.GetByClubId(vm.club_id)\n                .then(function (data) {\n                    //console.log(data);\n                    if(data.success){\n                        vm.club_documents = data.club_documents;\n\n                    } else {\n                        //console.log(\"WOOOPSIES...\");\n                        //this should be very very rare...\n                    }\n\n                });\n\n\n            break;\n            default:\n                //console.log(\"none of the above... redirect somewhere?\");\n            break;\n        }  \n\n\n\n            $scope.add_rating = function(){\n\n                //remove from first array\n                vm.ratings = $.grep(vm.ratings, function(e){ \n                    return e.id != vm.selected_rating.id; \n                });\n\n                vm.licence.ratings.push(vm.selected_rating);\n\n                //clear selected\n                delete vm.selected_rating;\n                \n                //clean the array to show what we want to show :)\n                //delete $scope.formData.license.add_to[bit_type];\n\n            }\n\n            $scope.remove_rating = function(index){\n\n                //add to dropdown\n                vm.ratings.push(vm.licence.ratings[index]);\n                vm.licence.ratings.splice(index,1)\n\n                //$scope.formData.license[bit_type] = $scope.formData.license[bit_type].filter(Boolean);\n\n                //  //console.log($scope.formData.license[bit_type]);\n                //  $scope.formData.license[bit_type].push($scope.formData.license.add_to[bit_type]);\n            }\n\n            //default add the first rating required...\n            \n\n\n\n/*\n\nOLD VERSION FOR LEGACY PURPOSES\n\n  $scope.add_element = function(bit_type){\n\n                //remove from first array\n                $scope[bit_type][bit_type] = $.grep($scope[bit_type][bit_type], function(e){ \n                    return e.id != $scope.formData.license.add_to[bit_type].id; \n                });\n\n                if(bit_type == \"differences\"){\n                    $scope.formData.license.add_to[bit_type].day = true;\n                    $scope.formData.license.add_to[bit_type].vfr = true;\n                }\n                //console.log($scope.formData.license.add_to[bit_type]);\n\n                $scope.formData.license[bit_type].push($scope.formData.license.add_to[bit_type]);\n                \n                //clean the array to show what we want to show :)\n                delete $scope.formData.license.add_to[bit_type];\n\n            }\n\n\n            $scope.remove_element = function(bit_type, index){\n\n                //add to dropdown\n                $scope[bit_type][bit_type].push($scope.formData.license[bit_type][index]);\n            \n                $scope.formData.license[bit_type].splice(index,1)\n\n                $scope.formData.license[bit_type] = $scope.formData.license[bit_type].filter(Boolean);\n                //console.log($scope.formData.license[bit_type]);\n                //$scope.formData.license[bit_type].push($scope.formData.license.add_to[bit_type]);\n            }\n\n\n*/\n\n\n            //nice looking date pickers\n\n\n            $scope.popup = [];\n\n            $scope.open = function(id, $event) {\n                //console.log(\"THIS\", id);\n                //this comment would allow the event not to be affect by clicking it again... not sure this is a good idea\n                if($scope.popup[id] && $scope.popup[id].opened == true){\n                    $event.preventDefault();\n                    $event.stopPropagation();\n                } else {\n                    $scope.popup[id] = {opened: true};\n                }\n            };\n\n            $scope.formats = ['dd/MM/yyyy', 'yyyy/MM/dd', 'dd.MM.yyyy', 'shortDate'];\n            $scope.format = $scope.formats[0];\n\n            $scope.datePickerOptions = {\n                                        format: 'dd/MM/yyyy',\n                                        showWeeks: false\n                                    };\n\n           \n\n          //  $scope.remove_real_file = function(file){\n\n          //       //remove_file\n\n          //       vm.licence.images = $.grep(vm.licence.images, function(e){ \n          //               return e.id != file.id; \n          //           });\n\n          //       //no need to actually remove the file as it will be archived accordingly on the backend whilst it is missing! :)\n                \n\n          // }\n\n\n          \n          $scope.remove_file = function(file, current_files){\n\n            //remove_file\n            var j = JSON.parse(file.file_return);\n            //console.log(\"REMOVE: \", j);\n            //console.log(\"REMOVE: \", j.saved_url);\n\n            //to delete the temp file created: j.saved_url\n            //tmp_rm.php POST tmp = filename\n            \n            LicenceService.DeleteTmp(j.saved_url)\n                .then(function (data) {\n                    //console.log(data);\n                    if(data.success){\n                        //console.log(\"HUZZAH\", current_files);\n                        //then we need to remove this from the list of files...\n                        //clear files\n                        vm.licence_images = [];\n                        //and re-process available files\n                        $scope.processFiles(current_files);\n\n                    } else {\n                        //console.log(\"WOOOPSIES...\");\n                        //this should be very very rare...\n                    }\n\n                });\n\n          }\n          \n\n            // $scope.processFiles = function(files){\n            //     // //console.log(\"files\", files);\n\n            //     for(var i=0; i<files.length; i++){\n            //         // //console.log(\"JSON\", files[i].file_return);\n            //         var j = JSON.parse(files[i].file_return);\n            //         // //console.log(\"PARSED\", j);\n            //         files[i].file.temp_path = j.saved_url;\n            //         // //console.log(\"file\", files[i].file);\n            //         vm.documents.push(files[i].file);\n            //     }\n               \n            // }\n            $scope.processFiles = function(files){\n                // //console.log(\"files\", files);\n\n                for(var i=0; i<files.length; i++){\n                    // //console.log(\"JSON\", files[i].file_return);\n                    var j = JSON.parse(files[i].file_return);\n                    // //console.log(\"PARSED\", j);\n                    //console.log(\"J is : \",j);\n                    //console.log(\"name is : \", j.files.file.name);\n\n                    files[i].file.temp_path = j.saved_url;\n                    files[i].file.save_name = j.files.file.name;\n                    var ft = j.files.file.name;\n                    ft = ft.split('.').pop();\n                    files[i].file.extension = ft;\n\n                    // //console.log(\"file\", files[i].file);\n                    vm.documents.push(files[i].file);\n                }\n\n\n            }\n\n\n\n            $scope.delete_licence = function(id){\n\n\n                var a = prompt(\"Are you sure you wish to delete this licence? \\n\\n This change is irreversible! To confirm please type YES in the box below.\");\n                if(a == \"YES\"){\n                    //console.log(\"WE DELETE IT\");\n\n\n                    ClubDocumentService.Delete(vm.user_id, id)\n                        .then(function (data) {\n                            //console.log(data);\n                            if(data.success){\n                                //console.log(\"HUZZAH\", data);\n                                //then we need to remove this from the list of files...\n                                vm.club_documents = $.grep(vm.club_documents, function(e){ \n                                    return e.id != id; \n                                });\n                                \n                                //refresh?\n                                $state.reload();\n                                $state.go('dashboard.manage_club.documents');\n\n                            } else {\n\n                                alert(\"Something went terribly wrong... \\n\\n \"+data.message);\n\n                            }\n\n                        });\n\n\n\n                } else {\n                    //console.log(\"ignore\");\n                }\n\n\n            }\n\n\n\n\n            $scope.save_licence = function(isValid){\n                //console.log(\"HERE ALEX\", vm.document);\n                if(vm.documents.length < 1 && vm.document.document == \"\"){\n\n                    $(\".drop\").focus();\n                    alert(\"You must at least have 1 pdf!\");\n\n                    return false;\n                }\n\n\n                //console.log(\"LICENCE GOOD TO GO \", vm.documents);\n\n\n                 //clean shizzle before sending\n                 //why keep sending back heavy data?\n\n                    // for(var i=0;i<vm.documents.images.length;i++){\n                    //     delete vm.documents.images[i].data_uri;\n                    // }\n\n                    // // vm.licence.images = vm.licence_images;\n                    // vm.documents.images = vm.documents.images.concat(vm.documents);\n\n                    //vm.documents.images = vm.documents.images[0];\n\n                \n\n                if(vm.document.id){\n                    //then its an udpate\n\n                    //merge the images left?\n                    ClubDocumentService.Update(vm.document)\n                        .then(function (data) {\n                            //console.log(data);\n                            if(data.success){\n                                //console.log(\"HUZZAH\", vm.document);\n                                //console.log(\"HUZZAH\", data);\n                                //then we need to remove this from the list of files...\n                                \n                                \n                                //move somewhere?\n                                $state.go('dashboard.manage_club.documents', {}, { reload: true });\n\n\n\n\n\n                            } else {\n\n                                alert(\"Something went terribly wrong... \\n\\n \"+data.message);\n\n                            }\n\n                        });\n\n                } else {\n\n\n                   \n\n\n                    //then its a create\n                    //console.log(\"ONE\", vm.documents[0]);\n\n                    var the_file = vm.documents[0];\n                    //console.log(\"TWO\", the_file);\n\n                    var to_send = {\n                        my_file: the_file,\n                        title: vm.document.title,\n                        description: vm.document.description,\n                        club_id: vm.club_id\n                    };\n\n                    //console.log(\"tosend\", to_send);\n\n                    ClubDocumentService.Create(to_send)\n                        .then(function (data) {\n                            //console.log(data);\n                            if(data.success){\n\n                                //console.log(\"HUZZAH\", data);\n                                //then we need to remove this from the list of files...\n                                \n                                \n                                //move somewhere?\n                                $state.reload();\n                                $state.go('dashboard.manage_club.documents', {}, { reload: true });\n\n\n                            } else {\n\n                                alert(\"Something went terribly wrong... \\n\\n \"+data.message);\n\n                            }\n\n                        });\n\n\n                }\n\n\n\n            };\n\n\n\n   var warning_msg = \"By deleting this document no other member will be able to see it.\"\n\n          $scope.open = function (doc_id) {\n            var modalInstance = $uibModal.open({\n              animation: true,\n              templateUrl: 'views/modals/deleteModal.html',\n              controller: 'ModalInstanceCtrl',\n              size: \"lg\",\n              resolve: {\n                id: function () {\n                  return doc_id;\n                },\n                params: function() {\n                  return {id: doc_id};\n                },\n                warning: function(){\n                    return warning_msg;\n                }\n              }\n            });\n            modalInstance.result.then(function (doc) {\n                var id = doc.id;\n              $log.info('PRESSED GO: ', id);\n              ClubDocumentService.Delete(vm.user_id, id)\n                        .then(function (data) {\n                            //console.log(data);\n                            if(data.success){\n                                //console.log(\"HUZZAH\", data);\n                                //then we need to remove this from the list of files...\n                                vm.club_documents = $.grep(vm.club_documents, function(e){ \n                                    return e.id != id; \n                                });\n\n                                \n                                //refresh?\n                                $state.reload();\n                                $state.go('dashboard.manage_club.documents');\n\n                            } else {\n\n                                alert(\"Something went terribly wrong... \\n\\n \"+data.message);\n\n                            }\n\n                        });\n              // ItemService.Delete(vm.user_id, plane_id.id)\n              // .then(function(){\n              //   //console.log(\"HELLO DELETE\");\n              //   //update view?\n              //    vm.club.items = $.grep(vm.club.items, function(e){ \n              //       return e.id != plane_id.id; \n              //   });\n              // })\n            }, function () {\n              $log.info('Modal dismissed at: ' + new Date());\n            });\n          };\n\n            $scope.get_icon = function(file){\n\n                var ft = file.name;\n                ft = ft.split('.').pop();\n                var icon_name = \"\";\n\n                // //console.log(\"FILE:\", ft);\n                // //console.log(\"index : \", ft.indexOf(\"pdf\"));\n                switch(true){\n                    case (ft.indexOf(\"pdf\") > -1):\n                        icon_name = \"pdf.png\";\n                    break;\n                    case (ft.indexOf(\"doc\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"docx\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"xls\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"xlsx\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"ppt\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"pptx\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"jpg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"jpeg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"png\") > -1):\n                        icon_name = \"png.png\";\n                    break;\n                    case (ft.indexOf(\"gif\") > -1):\n                        icon_name = \"gif.png\";\n                    break;\n                    case (ft.indexOf(\"zip\") > -1):\n                        icon_name = \"zip.png\";\n                    break;\n                    case (ft.indexOf(\"avi\") > -1):\n                        icon_name = \"avi.png\";\n                    break;\n                    case (ft.indexOf(\"mp4\") > -1):\n                        icon_name = \"mp4.png\";\n                    break;\n                    default:\n                        icon_name = \"file.png\";\n                    break;\n                }\n\n                // //console.log(\"FILE:\", icon_name);\n\n                return \"images/file_icons/\"+icon_name;\n            }\n\n\n            $scope.get_icon2 = function(file){\n\n                var ft = file.split('.').pop();\n                // //console.log(\"ICON 2 : \", ft);\n                var icon_name = \"\";\n\n                // //console.log(\"FILE:\", ft);\n                // //console.log(\"index : \", ft.indexOf(\"pdf\"));\n                switch(true){\n                    case (ft.indexOf(\"pdf\") > -1):\n                        icon_name = \"pdf.png\";\n                    break;\n                    case (ft.indexOf(\"doc\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"docx\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"xls\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"xlsx\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"ppt\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"pptx\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"jpg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"jpeg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"png\") > -1):\n                        icon_name = \"png.png\";\n                    break;\n                    case (ft.indexOf(\"gif\") > -1):\n                        icon_name = \"gif.png\";\n                    break;\n                    case (ft.indexOf(\"zip\") > -1):\n                        icon_name = \"zip.png\";\n                    break;\n                    case (ft.indexOf(\"avi\") > -1):\n                        icon_name = \"avi.png\";\n                    break;\n                    case (ft.indexOf(\"mp4\") > -1):\n                        icon_name = \"mp4.png\";\n                    break;\n                    default:\n                        icon_name = \"file.png\";\n                    break;\n                }\n\n                // //console.log(\"FILE:\", icon_name);\n\n                return \"images/file_icons/\"+icon_name;\n            }\n\n\n\n            $scope.downloadDocument = function(doc) {\n            var data = $.param({\n                id: doc\n            });\n\n            var ddd = doc.replace(/^.*[\\\\\\/]/, '');\n\n            $http.get('api/v1/plane_documents/show_file/'+ddd, {\n                    responseType: 'arraybuffer'\n                })\n                .success(function(data, status, headers) {\n                    var zipName = processArrayBufferToBlob(data, headers);\n\n                    //Delete file from temp folder in server - file needs to remain open until blob is created\n                    //deleteFileFromServerTemp(zipName);\n                }).error(function(data, status) {\n                    alert(\"There was an error downloading the selected document(s).\");\n                })\n        };\n\n\n\n        $scope.downloadClubDocument = function(doc) {\n            var data = $.param({\n                id: doc\n            });\n\n            var ddd = doc.replace(/^.*[\\\\\\/]/, '');\n\n            $http.get('api/v1/club_documents/show_file/'+ddd, {\n                    responseType: 'arraybuffer'\n                })\n                .success(function(data, status, headers) {\n                    var zipName = processArrayBufferToBlob(data, headers);\n\n                    //Delete file from temp folder in server - file needs to remain open until blob is created\n                    //deleteFileFromServerTemp(zipName);\n                }).error(function(data, status) {\n                    alert(\"There was an error downloading the selected document(s).\");\n                })\n        };\n\n\n\n        function processArrayBufferToBlob(data, headers) {\n            var octetStreamMime = 'application/octet-stream';\n            var success = false;\n\n            // Get the headers\n            headers = headers();\n            //var ttt = title.toLowerCase().replace(/\\W/g, '_');\n            // Get the filename from the x-filename header or default to \"download.bin\"\n            var filename = headers['x-filename'] || 'download.zip';\n\n            // Determine the content type from the header or default to \"application/octet-stream\"\n            var contentType = headers['content-type'] || octetStreamMime;\n\n            try {\n                // Try using msSaveBlob if supported\n                var blob = new Blob([data], {\n                    type: contentType\n                });\n                if (navigator.msSaveBlob)\n                    navigator.msSaveBlob(blob, filename);\n                else {\n                    // Try using other saveBlob implementations, if available\n                    var saveBlob = navigator.webkitSaveBlob || navigator.mozSaveBlob || navigator.saveBlob;\n                    if (saveBlob === undefined) throw \"Not supported\";\n                    saveBlob(blob, filename);\n                }\n                success = true;\n            } catch (ex) {\n                $log.info(\"saveBlob method failed with the following exception:\");\n                $log.info(ex);\n            }\n\n            if (!success) {\n                // Get the blob url creator\n                var urlCreator = window.URL || window.webkitURL || window.mozURL || window.msURL;\n                if (urlCreator) {\n                    // Try to use a download link\n                    var link = document.createElement('a');\n                    if ('download' in link) {\n                        // Try to simulate a click\n                        try {\n                            // Prepare a blob URL\n                            var blob = new Blob([data], {\n                                type: contentType\n                            });\n                            var url = urlCreator.createObjectURL(blob);\n                            link.setAttribute('href', url);\n\n                            // Set the download attribute (Supported in Chrome 14+ / Firefox 20+)\n                            link.setAttribute(\"download\", filename);\n\n                            // Simulate clicking the download link\n                            var event = document.createEvent('MouseEvents');\n                            event.initMouseEvent('click', true, true, window, 1, 0, 0, 0, 0, false, false, false, false, 0, null);\n                            link.dispatchEvent(event);\n                            success = true;\n\n                        } catch (ex) {\n                            $log.info(\"Download link method with simulated click failed with the following exception:\");\n                            $log.info(ex);\n                        }\n                    }\n\n                    if (!success) {\n                        // Fallback to window.location method\n                        try {\n                            // Prepare a blob URL\n                            // Use application/octet-stream when using window.location to force download\n                            var blob = new Blob([data], {\n                                type: octetStreamMime\n                            });\n                            var url = urlCreator.createObjectURL(blob);\n                            window.location = url;\n                            success = true;\n                        } catch (ex) {\n                            $log.info(\"Download link method with window.location failed with the following exception:\");\n                            $log.info(ex);\n                        }\n                    }\n                }\n            }\n\n            if (!success) {\n                // Fallback to window.open method\n                $log.info(\"No methods worked for saving the arraybuffer, using last resort window.open\");\n                window.open(httpPath, '_blank', '');\n            }\n            return filename;\n        };\n\n        \n        \n\n\n    }\n app.controller('ClubPaymentsController', ClubPaymentsController);\n\n    ClubPaymentsController.$inject = ['UserService', 'MemberService', 'InstructorService', 'MembershipService', 'HolidayService', '$rootScope', '$location', '$scope', '$state', '$stateParams', '$uibModal', '$log', '$window', '$compile', '$timeout', 'uiCalendarConfig', 'PaymentService', 'PoidService'];\n    function ClubPaymentsController(UserService, MemberService, InstructorService, MembershipService, HolidayService, $rootScope, $location, $scope, $state, $stateParams, $uibModal, $log, $window, $compile, $timeout, uiCalendarConfig, PaymentService, PoidService) {\n        \n        var vm = this;        \n\n        vm.poid_images = [];\n        vm.poid = {\n                images: []\n        };\n        \n        // vm.user_id = 59;\n        vm.user = $rootScope.globals.currentUser;\n        vm.user_id = vm.user.id;\n\n        vm.customer_token = \"\";\n\n\n        // function stripeResponseHandler(status, response) {\n        //   // Grab the form:\n        //   var $form = $('#payment-form');\n\n        //   if (response.error) { // Problem!\n\n        //     // Show the errors on the form:\n        //     $form.find('.payment-errors').text(response.error.message);\n        //     $form.find('.submit').prop('disabled', false); // Re-enable submission\n\n        //   } else { // Token was created!\n\n        //     // Get the token ID:\n        //     var token = response.id;\n\n        //     //console.log(\"CARD TOKEN IS: \"+token);\n\n        //     // Insert the token ID into the form so it gets submitted to the server:\n        //     $form.append($('<input type=\"hidden\" name=\"stripeToken\">').val(token));\n\n        //     // Submit the form:\n        //     //$form.get(0).submit();\n        //   }\n        // };\n\n\n        $scope.get_addresses = function(){\n\n            //  trial key\n            //  auth: api-key: BP-8KOdw8ka3F2eDU-Zz-g5865   \n            //  https://api.getAddress.io/v2/uk/{postcode}\n            // PaymentService.getAddress()\n\n            PaymentService.GetAddresses(vm.postcode)\n                .then(function (data) {\n                    if(data.success){\n\n                        //console.log(\"addresses: \"+data.addresses);\n                        vm.addresses = data.addresses;\n                        //fill the drop down menu\n\n                    } else {\n                        //console.log(\"WOOOPSIES...\");\n                        //this should be very very rare...\n\n                    }\n                });\n\n\n\n        }\n\n\n        // $scope.add_card = function () {\n           \n        //         var $form = $('#payment-form');\n        //         $form.submit(function(event) {\n        //         // Disable the submit button to prevent repeated clicks:\n        //         $form.find('.submit').prop('disabled', true);\n\n        //         // Request a token from Stripe:\n        //         Stripe.card.createToken($form, stripeResponseHandler);\n\n        //         Stripe.bankAccount.createToken('bank_account', {\n        //           country: 'gb',\n        //           currency: 'gbp',\n        //           routing_number: '110000000',\n        //           account_number: '000123456789',\n        //           account_holder_name: 'Jenny Rosen',\n        //           account_holder_type: 'individual',\n        //         }).then(function(result) {\n        //           // handle result.error or result.token\n        //         });\n\n\n\n        //         // Prevent the form from being submitted:\n        //         return false;\n        //       });\n\n\n        // };\n\n\n\n        switch($state.current.data.action){\n            case \"add\":\n\n                    //vm.selected_component = vm.components[0];\n                    //vm.selected_component = \n                    \n\n                    // //console.log(\"AA\", vm.selected_component);\n\n            \n\n            break;\n            case \"edit\":\n\n            // //console.log(\"EDIT ONE\");\n            // //console.log(\"PARAMS: \", $stateParams);\n\n             PoidService.GetById($stateParams.card_id)\n                .then(function (data) {\n                    if(data.success){\n                        vm.poid = data.poid;\n                        vm.poid.expiry_date = new Date(vm.poid.expiry_date);\n\n                        \n                    } else {\n                        //console.log(\"WOOOPSIES...\");\n                        //this should be very very rare...\n                    }\n\n                });\n\n\n\n            break;\n            case \"list\":\n\n                //console.log(\"LIST ALL\");\n\n                 //list stuff\n\n                PaymentService.GetByUserId(vm.user_id)\n                .then(function (data) {\n                    //console.log(data);\n                    if(data.success){\n                        vm.cards = data.cards;\n                        //console.log(\"CARDS\", vm.cards);\n\n                    } else {\n                        //console.log(\"WOOOPSIES...\");\n                        //this should be very very rare...\n                    }\n\n                });\n\n\n            break;\n            default:\n                //console.log(\"none of the above... redirect somewhere?\");\n            break;\n        }  \n        \n\n\n    }\napp.controller('ClubSignupController', ClubSignupController);\n\n    ClubSignupController.$inject = ['ClubService', 'MemberService', 'UserService', 'GoCardService', '$rootScope', '$location', '$scope', '$state', '$stateParams', '$cookies', '$http' ];\n    function ClubSignupController(ClubService, MemberService, UserService, GoCardService, $rootScope, $location, $scope, $state, $stateParams, $cookies, $http) {\n        \n\n    \t\tvar vm = this;\n\n\n    \t\t$scope.companies = [];\n\n    \t\t$scope.selected_company;\n\n    \t\t$scope.selected_phone;\n\n    \t\t\n\n    \t\t$scope.verified_mobile = false;\n    \t\t$scope.text_verification = \"\";\n\n    \t\tvm.check_id = 12;\n\n    \t\t$scope.link = \"\";\n\n    \t\t//country code for text messages\n\n    \t\t$scope.prefix = \"\";\n\n\n    \t\t$scope.countries = [\n {\n   \"CountryCode\": \"+247\",\n   \"CountryCodeISO\": \"SH\",\n   \"Country\": \"Ascension\"\n },\n {\n   \"CountryCode\": \"+246\",\n   \"CountryCodeISO\": \"DG\",\n   \"Country\": \"Diego Garcia\"\n },\n {\n   \"CountryCode\": \"+291\",\n   \"CountryCodeISO\": \"ER\",\n   \"Country\": \"Eritrea\"\n },\n {\n   \"CountryCode\": \"+500\",\n   \"CountryCodeISO\": \"FK\",\n   \"Country\": \"Falkland (Malvinas) Islands\"\n },\n {\n   \"CountryCode\": \"+692\",\n   \"CountryCodeISO\": \"MH\",\n   \"Country\": \"Marshall Islands\"\n },\n {\n   \"CountryCode\": \"+691\",\n   \"CountryCodeISO\": \"FM\",\n   \"Country\": \"Micronesia\"\n },\n {\n   \"CountryCode\": \"+683\",\n   \"CountryCodeISO\": \"NU\",\n   \"Country\": \"Niue Island\"\n },\n {\n   \"CountryCode\": \"+290\",\n   \"CountryCodeISO\": \"SH\",\n   \"Country\": \"Saint Helena\"\n },\n {\n   \"CountryCode\": \"+508\",\n   \"CountryCodeISO\": \"PM\",\n   \"Country\": \"Saint Pierre and Miquelon\"\n },\n {\n   \"CountryCode\": \"+690\",\n   \"CountryCodeISO\": \"TK\",\n   \"Country\": \"Tokelau\"\n },\n {\n   \"CountryCode\": \"+688\",\n   \"CountryCodeISO\": \"TV\",\n   \"Country\": \"Tuvalu\"\n },\n {\n   \"CountryCode\": \"+379\",\n   \"CountryCodeISO\": \"VA\",\n   \"Country\": \"Vatican City\"\n },\n {\n   \"CountryCode\": \"+681\",\n   \"CountryCodeISO\": \"WF\",\n   \"Country\": \"Wallis and Futuna\"\n },\n {\n   \"CountryCode\": \"+1\",\n   \"CountryCodeISO\": \"AS\",\n   \"Country\": \"American Samoa\"\n },\n {\n   \"CountryCode\": \"+1\",\n   \"CountryCodeISO\": \"CA\",\n   \"Country\": \"Canada\"\n },\n {\n   \"CountryCode\": \"+61\",\n   \"CountryCodeISO\": \"AU\",\n   \"Country\": \"Australia\"\n },\n {\n   \"CountryCode\": \"+93\",\n   \"CountryCodeISO\": \"AF\",\n   \"Country\": \"Afghanistan\"\n },\n {\n   \"CountryCode\": \"+355\",\n   \"CountryCodeISO\": \"AL\",\n   \"Country\": \"Albania\"\n },\n {\n   \"CountryCode\": \"+213\",\n   \"CountryCodeISO\": \"DZ\",\n   \"Country\": \"Algeria\"\n },\n {\n   \"CountryCode\": \"+376\",\n   \"CountryCodeISO\": \"AD\",\n   \"Country\": \"Andorra\"\n },\n {\n   \"CountryCode\": \"+244\",\n   \"CountryCodeISO\": \"AO\",\n   \"Country\": \"Angola\"\n },\n {\n   \"CountryCode\": \"+54\",\n   \"CountryCodeISO\": \"AR\",\n   \"Country\": \"Argentina\"\n },\n {\n   \"CountryCode\": \"+374\",\n   \"CountryCodeISO\": \"AM\",\n   \"Country\": \"Armenia\"\n },\n {\n   \"CountryCode\": \"+297\",\n   \"CountryCodeISO\": \"AW\",\n   \"Country\": \"Aruba\"\n },\n {\n   \"CountryCode\": \"+43\",\n   \"CountryCodeISO\": \"AT\",\n   \"Country\": \"Austria\"\n },\n {\n   \"CountryCode\": \"+994\",\n   \"CountryCodeISO\": \"AZ\",\n   \"Country\": \"Azerbaijan\"\n },\n {\n   \"CountryCode\": \"+973\",\n   \"CountryCodeISO\": \"BH\",\n   \"Country\": \"Bahrain\"\n },\n {\n   \"CountryCode\": \"+880\",\n   \"CountryCodeISO\": \"BD\",\n   \"Country\": \"Bangladesh\"\n },\n {\n   \"CountryCode\": \"+375\",\n   \"CountryCodeISO\": \"BY\",\n   \"Country\": \"Belarus\"\n },\n {\n   \"CountryCode\": \"+32\",\n   \"CountryCodeISO\": \"BE\",\n   \"Country\": \"Belgium\"\n },\n {\n   \"CountryCode\": \"+501\",\n   \"CountryCodeISO\": \"BZ\",\n   \"Country\": \"Belize\"\n },\n {\n   \"CountryCode\": \"+229\",\n   \"CountryCodeISO\": \"BJ\",\n   \"Country\": \"Benin\"\n },\n {\n   \"CountryCode\": \"+975\",\n   \"CountryCodeISO\": \"BT\",\n   \"Country\": \"Bhutan\"\n },\n {\n   \"CountryCode\": \"+591\",\n   \"CountryCodeISO\": \"BO\",\n   \"Country\": \"Bolivia\"\n },\n {\n   \"CountryCode\": \"+387\",\n   \"CountryCodeISO\": \"BA\",\n   \"Country\": \"Bosnia and Herzegovina\"\n },\n {\n   \"CountryCode\": \"+267\",\n   \"CountryCodeISO\": \"BW\",\n   \"Country\": \"Botswana\"\n },\n {\n   \"CountryCode\": \"+55\",\n   \"CountryCodeISO\": \"BR\",\n   \"Country\": \"Brazil\"\n },\n {\n   \"CountryCode\": \"+673\",\n   \"CountryCodeISO\": \"BN\",\n   \"Country\": \"Brunei\"\n },\n {\n   \"CountryCode\": \"+359\",\n   \"CountryCodeISO\": \"BG\",\n   \"Country\": \"Bulgaria\"\n },\n {\n   \"CountryCode\": \"+226\",\n   \"CountryCodeISO\": \"BF\",\n   \"Country\": \"Burkina Faso\"\n },\n {\n   \"CountryCode\": \"+257\",\n   \"CountryCodeISO\": \"BI\",\n   \"Country\": \"Burundi\"\n },\n {\n   \"CountryCode\": \"+855\",\n   \"CountryCodeISO\": \"KH\",\n   \"Country\": \"Cambodia\"\n },\n {\n   \"CountryCode\": \"+237\",\n   \"CountryCodeISO\": \"CM\",\n   \"Country\": \"Cameroon\"\n },\n {\n   \"CountryCode\": \"+238\",\n   \"CountryCodeISO\": \"CV\",\n   \"Country\": \"Cape Verde\"\n },\n {\n   \"CountryCode\": \"+236\",\n   \"CountryCodeISO\": \"CF\",\n   \"Country\": \"Central African Republic\"\n },\n {\n   \"CountryCode\": \"+235\",\n   \"CountryCodeISO\": \"TD\",\n   \"Country\": \"Chad\"\n },\n {\n   \"CountryCode\": \"+56\",\n   \"CountryCodeISO\": \"CL\",\n   \"Country\": \"Chile\"\n },\n {\n   \"CountryCode\": \"+86\",\n   \"CountryCodeISO\": \"CN\",\n   \"Country\": \"China\"\n },\n {\n   \"CountryCode\": \"+57\",\n   \"CountryCodeISO\": \"CO\",\n   \"Country\": \"Colombia\"\n },\n {\n   \"CountryCode\": \"+269\",\n   \"CountryCodeISO\": \"KM\",\n   \"Country\": \"Comoros\"\n },\n {\n   \"CountryCode\": \"+242\",\n   \"CountryCodeISO\": \"CG\",\n   \"Country\": \"Congo\"\n },\n {\n   \"CountryCode\": \"+682\",\n   \"CountryCodeISO\": \"CK\",\n   \"Country\": \"Cook Islands\"\n },\n {\n   \"CountryCode\": \"+506\",\n   \"CountryCodeISO\": \"CR\",\n   \"Country\": \"Costa Rica\"\n },\n {\n   \"CountryCode\": \"+385\",\n   \"CountryCodeISO\": \"HR\",\n   \"Country\": \"Croatia\"\n },\n {\n   \"CountryCode\": \"+53\",\n   \"CountryCodeISO\": \"CU\",\n   \"Country\": \"Cuba\"\n },\n {\n   \"CountryCode\": \"+357\",\n   \"CountryCodeISO\": \"CY\",\n   \"Country\": \"Cyprus\"\n },\n {\n   \"CountryCode\": \"+420\",\n   \"CountryCodeISO\": \"CZ\",\n   \"Country\": \"Czech Republic\"\n },\n {\n   \"CountryCode\": \"+243\",\n   \"CountryCodeISO\": \"CD\",\n   \"Country\": \"Democratic Republic of Congo\"\n },\n {\n   \"CountryCode\": \"+45\",\n   \"CountryCodeISO\": \"DK\",\n   \"Country\": \"Denmark\"\n },\n {\n   \"CountryCode\": \"+253\",\n   \"CountryCodeISO\": \"DJ\",\n   \"Country\": \"Djibouti\"\n },\n {\n   \"CountryCode\": \"+670\",\n   \"CountryCodeISO\": \"TL\",\n   \"Country\": \"East Timor\"\n },\n {\n   \"CountryCode\": \"+593\",\n   \"CountryCodeISO\": \"EC\",\n   \"Country\": \"Ecuador\"\n },\n {\n   \"CountryCode\": \"+20\",\n   \"CountryCodeISO\": \"EG\",\n   \"Country\": \"Egypt\"\n },\n {\n   \"CountryCode\": \"+503\",\n   \"CountryCodeISO\": \"SV\",\n   \"Country\": \"El Salvador\"\n },\n {\n   \"CountryCode\": \"+240\",\n   \"CountryCodeISO\": \"GQ\",\n   \"Country\": \"Equatorial Guinea\"\n },\n {\n   \"CountryCode\": \"+372\",\n   \"CountryCodeISO\": \"EE\",\n   \"Country\": \"Estonia\"\n },\n {\n   \"CountryCode\": \"+251\",\n   \"CountryCodeISO\": \"ET\",\n   \"Country\": \"Ethiopia\"\n },\n {\n   \"CountryCode\": \"+298\",\n   \"CountryCodeISO\": \"FO\",\n   \"Country\": \"Faroe Islands\"\n },\n {\n   \"CountryCode\": \"+679\",\n   \"CountryCodeISO\": \"FJ\",\n   \"Country\": \"Fiji\"\n },\n {\n   \"CountryCode\": \"+358\",\n   \"CountryCodeISO\": \"FI\",\n   \"Country\": \"Finland\"\n },\n {\n   \"CountryCode\": \"+33\",\n   \"CountryCodeISO\": \"FR\",\n   \"Country\": \"France\"\n },\n {\n   \"CountryCode\": \"+594\",\n   \"CountryCodeISO\": \"GF\",\n   \"Country\": \"French Guiana\"\n },\n {\n   \"CountryCode\": \"+689\",\n   \"CountryCodeISO\": \"PF\",\n   \"Country\": \"French Polynesia\"\n },\n {\n   \"CountryCode\": \"+241\",\n   \"CountryCodeISO\": \"GA\",\n   \"Country\": \"Gabon\"\n },\n {\n   \"CountryCode\": \"+220\",\n   \"CountryCodeISO\": \"GM\",\n   \"Country\": \"Gambia\"\n },\n {\n   \"CountryCode\": \"+995\",\n   \"CountryCodeISO\": \"GE\",\n   \"Country\": \"Georgia\"\n },\n {\n   \"CountryCode\": \"+49\",\n   \"CountryCodeISO\": \"DE\",\n   \"Country\": \"Germany\"\n },\n {\n   \"CountryCode\": \"+233\",\n   \"CountryCodeISO\": \"GH\",\n   \"Country\": \"Ghana\"\n },\n {\n   \"CountryCode\": \"+350\",\n   \"CountryCodeISO\": \"GI\",\n   \"Country\": \"Gibraltar\"\n },\n {\n   \"CountryCode\": \"+30\",\n   \"CountryCodeISO\": \"GR\",\n   \"Country\": \"Greece\"\n },\n {\n   \"CountryCode\": \"+299\",\n   \"CountryCodeISO\": \"GL\",\n   \"Country\": \"Greenland\"\n },\n {\n   \"CountryCode\": \"+590\",\n   \"CountryCodeISO\": \"GP\",\n   \"Country\": \"Guadeloupe\"\n },\n {\n   \"CountryCode\": \"+502\",\n   \"CountryCodeISO\": \"GT\",\n   \"Country\": \"Guatemala\"\n },\n {\n   \"CountryCode\": \"+224\",\n   \"CountryCodeISO\": \"GN\",\n   \"Country\": \"Guinea\"\n },\n {\n   \"CountryCode\": \"+245\",\n   \"CountryCodeISO\": \"GW\",\n   \"Country\": \"Guinea-Bissau\"\n },\n {\n   \"CountryCode\": \"+592\",\n   \"CountryCodeISO\": \"GY\",\n   \"Country\": \"Guyana\"\n },\n {\n   \"CountryCode\": \"+509\",\n   \"CountryCodeISO\": \"HT\",\n   \"Country\": \"Haiti\"\n },\n {\n   \"CountryCode\": \"+504\",\n   \"CountryCodeISO\": \"HN\",\n   \"Country\": \"Honduras\"\n },\n {\n   \"CountryCode\": \"+852\",\n   \"CountryCodeISO\": \"HK\",\n   \"Country\": \"Hong Kong\"\n },\n {\n   \"CountryCode\": \"+36\",\n   \"CountryCodeISO\": \"HU\",\n   \"Country\": \"Hungary\"\n },\n {\n   \"CountryCode\": \"+354\",\n   \"CountryCodeISO\": \"IS\",\n   \"Country\": \"Iceland\"\n },\n {\n   \"CountryCode\": \"+91\",\n   \"CountryCodeISO\": \"IN\",\n   \"Country\": \"India\"\n },\n {\n   \"CountryCode\": \"+62\",\n   \"CountryCodeISO\": \"ID\",\n   \"Country\": \"Indonesia\"\n },\n {\n   \"CountryCode\": \"+98\",\n   \"CountryCodeISO\": \"IR\",\n   \"Country\": \"Iran\"\n },\n {\n   \"CountryCode\": \"+964\",\n   \"CountryCodeISO\": \"IQ\",\n   \"Country\": \"Iraq\"\n },\n {\n   \"CountryCode\": \"+353\",\n   \"CountryCodeISO\": \"IE\",\n   \"Country\": \"Ireland\"\n },\n {\n   \"CountryCode\": \"+972\",\n   \"CountryCodeISO\": \"IL\",\n   \"Country\": \"Israel\"\n },\n {\n   \"CountryCode\": \"+39\",\n   \"CountryCodeISO\": \"IT\",\n   \"Country\": \"Italy\"\n },\n {\n   \"CountryCode\": \"+225\",\n   \"CountryCodeISO\": \"CI\",\n   \"Country\": \"Ivory Coast\"\n },\n {\n   \"CountryCode\": \"+81\",\n   \"CountryCodeISO\": \"JP\",\n   \"Country\": \"Japan\"\n },\n {\n   \"CountryCode\": \"+962\",\n   \"CountryCodeISO\": \"JO\",\n   \"Country\": \"Jordan\"\n },\n {\n   \"CountryCode\": \"+254\",\n   \"CountryCodeISO\": \"KE\",\n   \"Country\": \"Kenya\"\n },\n {\n   \"CountryCode\": \"+686\",\n   \"CountryCodeISO\": \"KI\",\n   \"Country\": \"Kiribati\"\n },\n {\n   \"CountryCode\": \"+965\",\n   \"CountryCodeISO\": \"KW\",\n   \"Country\": \"Kuwait\"\n },\n {\n   \"CountryCode\": \"+996\",\n   \"CountryCodeISO\": \"KG\",\n   \"Country\": \"Kyrgyzstan\"\n },\n {\n   \"CountryCode\": \"+856\",\n   \"CountryCodeISO\": \"LA\",\n   \"Country\": \"Laos\"\n },\n {\n   \"CountryCode\": \"+371\",\n   \"CountryCodeISO\": \"LV\",\n   \"Country\": \"Latvia\"\n },\n {\n   \"CountryCode\": \"+961\",\n   \"CountryCodeISO\": \"LB\",\n   \"Country\": \"Lebanon\"\n },\n {\n   \"CountryCode\": \"+266\",\n   \"CountryCodeISO\": \"LS\",\n   \"Country\": \"Lesotho\"\n },\n {\n   \"CountryCode\": \"+231\",\n   \"CountryCodeISO\": \"LR\",\n   \"Country\": \"Liberia\"\n },\n {\n   \"CountryCode\": \"+218\",\n   \"CountryCodeISO\": \"LY\",\n   \"Country\": \"Libya\"\n },\n {\n   \"CountryCode\": \"+423\",\n   \"CountryCodeISO\": \"LI\",\n   \"Country\": \"Liechtenstein\"\n },\n {\n   \"CountryCode\": \"+370\",\n   \"CountryCodeISO\": \"LT\",\n   \"Country\": \"Lithuania\"\n },\n {\n   \"CountryCode\": \"+352\",\n   \"CountryCodeISO\": \"LU\",\n   \"Country\": \"Luxembourg\"\n },\n {\n   \"CountryCode\": \"+853\",\n   \"CountryCodeISO\": \"MO\",\n   \"Country\": \"Macau\"\n },\n {\n   \"CountryCode\": \"+389\",\n   \"CountryCodeISO\": \"MK\",\n   \"Country\": \"Macedonia\"\n },\n {\n   \"CountryCode\": \"+261\",\n   \"CountryCodeISO\": \"MG\",\n   \"Country\": \"Madagascar\"\n },\n {\n   \"CountryCode\": \"+265\",\n   \"CountryCodeISO\": \"MW\",\n   \"Country\": \"Malawi\"\n },\n {\n   \"CountryCode\": \"+60\",\n   \"CountryCodeISO\": \"MY\",\n   \"Country\": \"Malaysia\"\n },\n {\n   \"CountryCode\": \"+960\",\n   \"CountryCodeISO\": \"MV\",\n   \"Country\": \"Maldives\"\n },\n {\n   \"CountryCode\": \"+223\",\n   \"CountryCodeISO\": \"ML\",\n   \"Country\": \"Mali\"\n },\n {\n   \"CountryCode\": \"+356\",\n   \"CountryCodeISO\": \"MT\",\n   \"Country\": \"Malta\"\n },\n {\n   \"CountryCode\": \"+596\",\n   \"CountryCodeISO\": \"MQ\",\n   \"Country\": \"Martinique\"\n },\n {\n   \"CountryCode\": \"+222\",\n   \"CountryCodeISO\": \"MR\",\n   \"Country\": \"Mauritania\"\n },\n {\n   \"CountryCode\": \"+230\",\n   \"CountryCodeISO\": \"MU\",\n   \"Country\": \"Mauritius\"\n },\n {\n   \"CountryCode\": \"+262\",\n   \"CountryCodeISO\": \"RE\",\n   \"Country\": \"Reunion\"\n },\n {\n   \"CountryCode\": \"+52\",\n   \"CountryCodeISO\": \"MX\",\n   \"Country\": \"Mexico\"\n },\n {\n   \"CountryCode\": \"+373\",\n   \"CountryCodeISO\": \"MD\",\n   \"Country\": \"Moldova\"\n },\n {\n   \"CountryCode\": \"+377\",\n   \"CountryCodeISO\": \"MC\",\n   \"Country\": \"Monaco\"\n },\n {\n   \"CountryCode\": \"+976\",\n   \"CountryCodeISO\": \"MN\",\n   \"Country\": \"Mongolia\"\n },\n {\n   \"CountryCode\": \"+382\",\n   \"CountryCodeISO\": \"ME\",\n   \"Country\": \"Montenegro\"\n },\n {\n   \"CountryCode\": \"+212\",\n   \"CountryCodeISO\": \"MA\",\n   \"Country\": \"Morocco\"\n },\n {\n   \"CountryCode\": \"+258\",\n   \"CountryCodeISO\": \"MZ\",\n   \"Country\": \"Mozambique\"\n },\n {\n   \"CountryCode\": \"+95\",\n   \"CountryCodeISO\": \"MM\",\n   \"Country\": \"Myanmar\"\n },\n {\n   \"CountryCode\": \"+264\",\n   \"CountryCodeISO\": \"NA\",\n   \"Country\": \"Namibia\"\n },\n {\n   \"CountryCode\": \"+674\",\n   \"CountryCodeISO\": \"NR\",\n   \"Country\": \"Nauru\"\n },\n {\n   \"CountryCode\": \"+977\",\n   \"CountryCodeISO\": \"NP\",\n   \"Country\": \"Nepal\"\n },\n {\n   \"CountryCode\": \"+31\",\n   \"CountryCodeISO\": \"NL\",\n   \"Country\": \"Netherlands\"\n },\n {\n   \"CountryCode\": \"+599\",\n   \"CountryCodeISO\": \"AN\",\n   \"Country\": \"Netherlands Antilles\"\n },\n {\n   \"CountryCode\": \"+687\",\n   \"CountryCodeISO\": \"NC\",\n   \"Country\": \"New Caledonia\"\n },\n {\n   \"CountryCode\": \"+64\",\n   \"CountryCodeISO\": \"NZ\",\n   \"Country\": \"New Zealand\"\n },\n {\n   \"CountryCode\": \"+505\",\n   \"CountryCodeISO\": \"NI\",\n   \"Country\": \"Nicaragua\"\n },\n {\n   \"CountryCode\": \"+227\",\n   \"CountryCodeISO\": \"NE\",\n   \"Country\": \"Niger\"\n },\n {\n   \"CountryCode\": \"+234\",\n   \"CountryCodeISO\": \"NG\",\n   \"Country\": \"Nigeria\"\n },\n {\n   \"CountryCode\": \"+850\",\n   \"CountryCodeISO\": \"KP\",\n   \"Country\": \"North Korea\"\n },\n {\n   \"CountryCode\": \"+47\",\n   \"CountryCodeISO\": \"NO\",\n   \"Country\": \"Norway\"\n },\n {\n   \"CountryCode\": \"+968\",\n   \"CountryCodeISO\": \"OM\",\n   \"Country\": \"Oman\"\n },\n {\n   \"CountryCode\": \"+92\",\n   \"CountryCodeISO\": \"PK\",\n   \"Country\": \"Pakistan\"\n },\n {\n   \"CountryCode\": \"+680\",\n   \"CountryCodeISO\": \"PW\",\n   \"Country\": \"Palau\"\n },\n {\n   \"CountryCode\": \"+507\",\n   \"CountryCodeISO\": \"PA\",\n   \"Country\": \"Panama\"\n },\n {\n   \"CountryCode\": \"+675\",\n   \"CountryCodeISO\": \"PG\",\n   \"Country\": \"Papua New Guinea\"\n },\n {\n   \"CountryCode\": \"+595\",\n   \"CountryCodeISO\": \"PY\",\n   \"Country\": \"Paraguay\"\n },\n {\n   \"CountryCode\": \"+51\",\n   \"CountryCodeISO\": \"PE\",\n   \"Country\": \"Peru\"\n },\n {\n   \"CountryCode\": \"+63\",\n   \"CountryCodeISO\": \"PH\",\n   \"Country\": \"Philippines\"\n },\n {\n   \"CountryCode\": \"+48\",\n   \"CountryCodeISO\": \"PL\",\n   \"Country\": \"Poland\"\n },\n {\n   \"CountryCode\": \"+351\",\n   \"CountryCodeISO\": \"PT\",\n   \"Country\": \"Portugal\"\n },\n {\n   \"CountryCode\": \"+974\",\n   \"CountryCodeISO\": \"QA\",\n   \"Country\": \"Qatar\"\n },\n {\n   \"CountryCode\": \"+40\",\n   \"CountryCodeISO\": \"RO\",\n   \"Country\": \"Romania\"\n },\n {\n   \"CountryCode\": \"+7\",\n   \"CountryCodeISO\": \"KZ\",\n   \"Country\": \"Kazakhstan\"\n },\n {\n   \"CountryCode\": \"+250\",\n   \"CountryCodeISO\": \"RW\",\n   \"Country\": \"Rwanda\"\n },\n {\n   \"CountryCode\": \"+685\",\n   \"CountryCodeISO\": \"WS\",\n   \"Country\": \"Samoa\"\n },\n {\n   \"CountryCode\": \"+378\",\n   \"CountryCodeISO\": \"SM\",\n   \"Country\": \"San Marino\"\n },\n {\n   \"CountryCode\": \"+239\",\n   \"CountryCodeISO\": \"ST\",\n   \"Country\": \"Sao Tome and Principe\"\n },\n {\n   \"CountryCode\": \"+966\",\n   \"CountryCodeISO\": \"SA\",\n   \"Country\": \"Saudi Arabia\"\n },\n {\n   \"CountryCode\": \"+221\",\n   \"CountryCodeISO\": \"SN\",\n   \"Country\": \"Senegal\"\n },\n {\n   \"CountryCode\": \"+381\",\n   \"CountryCodeISO\": \"RS\",\n   \"Country\": \"Serbia\"\n },\n {\n   \"CountryCode\": \"+248\",\n   \"CountryCodeISO\": \"SC\",\n   \"Country\": \"Seychelles\"\n },\n {\n   \"CountryCode\": \"+232\",\n   \"CountryCodeISO\": \"SL\",\n   \"Country\": \"Sierra Leone\"\n },\n {\n   \"CountryCode\": \"+65\",\n   \"CountryCodeISO\": \"SG\",\n   \"Country\": \"Singapore\"\n },\n {\n   \"CountryCode\": \"+421\",\n   \"CountryCodeISO\": \"SK\",\n   \"Country\": \"Slovakia\"\n },\n {\n   \"CountryCode\": \"+386\",\n   \"CountryCodeISO\": \"SI\",\n   \"Country\": \"Slovenia\"\n },\n {\n   \"CountryCode\": \"+677\",\n   \"CountryCodeISO\": \"SB\",\n   \"Country\": \"Solomon Islands\"\n },\n {\n   \"CountryCode\": \"+252\",\n   \"CountryCodeISO\": \"SO\",\n   \"Country\": \"Somalia\"\n },\n {\n   \"CountryCode\": \"+27\",\n   \"CountryCodeISO\": \"ZA\",\n   \"Country\": \"South Africa\"\n },\n {\n   \"CountryCode\": \"+82\",\n   \"CountryCodeISO\": \"KR\",\n   \"Country\": \"South Korea\"\n },\n {\n   \"CountryCode\": \"+34\",\n   \"CountryCodeISO\": \"ES\",\n   \"Country\": \"Spain\"\n },\n {\n   \"CountryCode\": \"+94\",\n   \"CountryCodeISO\": \"LK\",\n   \"Country\": \"Sri Lanka\"\n },\n {\n   \"CountryCode\": \"+249\",\n   \"CountryCodeISO\": \"SD\",\n   \"Country\": \"Sudan\"\n },\n {\n   \"CountryCode\": \"+597\",\n   \"CountryCodeISO\": \"SR\",\n   \"Country\": \"Suriname\"\n },\n {\n   \"CountryCode\": \"+268\",\n   \"CountryCodeISO\": \"SZ\",\n   \"Country\": \"Swaziland\"\n },\n {\n   \"CountryCode\": \"+46\",\n   \"CountryCodeISO\": \"SE\",\n   \"Country\": \"Sweden\"\n },\n {\n   \"CountryCode\": \"+41\",\n   \"CountryCodeISO\": \"CH\",\n   \"Country\": \"Switzerland\"\n },\n {\n   \"CountryCode\": \"+963\",\n   \"CountryCodeISO\": \"SY\",\n   \"Country\": \"Syria\"\n },\n {\n   \"CountryCode\": \"+886\",\n   \"CountryCodeISO\": \"TW\",\n   \"Country\": \"Taiwan\"\n },\n {\n   \"CountryCode\": \"+992\",\n   \"CountryCodeISO\": \"TJ\",\n   \"Country\": \"Tajikistan\"\n },\n {\n   \"CountryCode\": \"+255\",\n   \"CountryCodeISO\": \"TZ\",\n   \"Country\": \"Tanzania\"\n },\n {\n   \"CountryCode\": \"+66\",\n   \"CountryCodeISO\": \"TH\",\n   \"Country\": \"Thailand\"\n },\n {\n   \"CountryCode\": \"+228\",\n   \"CountryCodeISO\": \"TG\",\n   \"Country\": \"Togo\"\n },\n {\n   \"CountryCode\": \"+216\",\n   \"CountryCodeISO\": \"TN\",\n   \"Country\": \"Tunisia\"\n },\n {\n   \"CountryCode\": \"+90\",\n   \"CountryCodeISO\": \"TR\",\n   \"Country\": \"Turkey\"\n },\n {\n   \"CountryCode\": \"+993\",\n   \"CountryCodeISO\": \"TM\",\n   \"Country\": \"Turkmenistan\"\n },\n {\n   \"CountryCode\": \"+256\",\n   \"CountryCodeISO\": \"UG\",\n   \"Country\": \"Uganda\"\n },\n {\n   \"CountryCode\": \"+380\",\n   \"CountryCodeISO\": \"UA\",\n   \"Country\": \"Ukraine\"\n },\n {\n   \"CountryCode\": \"+971\",\n   \"CountryCodeISO\": \"AE\",\n   \"Country\": \"United Arab Emirates\"\n },\n {\n   \"CountryCode\": \"+44\",\n   \"CountryCodeISO\": \"GB\",\n   \"Country\": \"United Kingdom\"\n },\n {\n   \"CountryCode\": \"+1\",\n   \"CountryCodeISO\": \"VI\",\n   \"Country\": \"U.S. Virgin Islands\"\n },\n {\n   \"CountryCode\": \"+598\",\n   \"CountryCodeISO\": \"UY\",\n   \"Country\": \"Uruguay\"\n },\n {\n   \"CountryCode\": \"+998\",\n   \"CountryCodeISO\": \"UZ\",\n   \"Country\": \"Uzbekistan\"\n },\n {\n   \"CountryCode\": \"+678\",\n   \"CountryCodeISO\": \"VU\",\n   \"Country\": \"Vanuatu\"\n },\n {\n   \"CountryCode\": \"+58\",\n   \"CountryCodeISO\": \"VE\",\n   \"Country\": \"Venezuela\"\n },\n {\n   \"CountryCode\": \"+84\",\n   \"CountryCodeISO\": \"VN\",\n   \"Country\": \"Vietnam\"\n },\n {\n   \"CountryCode\": \"+967\",\n   \"CountryCodeISO\": \"YE\",\n   \"Country\": \"Yemen\"\n },\n {\n   \"CountryCode\": \"+260\",\n   \"CountryCodeISO\": \"ZM\",\n   \"Country\": \"Zambia\"\n },\n {\n   \"CountryCode\": \"+263\",\n   \"CountryCodeISO\": \"ZW\",\n   \"Country\": \"Zimbabwe\"\n },\n {\n   \"CountryCode\": \"+262\",\n   \"CountryCodeISO\": \"YT\",\n   \"Country\": \"Mayotte\"\n },\n {\n   \"CountryCode\": \"+7\",\n   \"CountryCodeISO\": \"RU\",\n   \"Country\": \"Russian Federation\"\n },\n {\n   \"CountryCode\": \"+1\",\n   \"CountryCodeISO\": \"AI\",\n   \"Country\": \"Anguilla\"\n },\n {\n   \"CountryCode\": \"+1\",\n   \"CountryCodeISO\": \"AG\",\n   \"Country\": \"Antigua and Barbuda\"\n },\n {\n   \"CountryCode\": \"+1\",\n   \"CountryCodeISO\": \"BS\",\n   \"Country\": \"Bahamas\"\n },\n {\n   \"CountryCode\": \"+1\",\n   \"CountryCodeISO\": \"BB\",\n   \"Country\": \"Barbados\"\n },\n {\n   \"CountryCode\": \"+1\",\n   \"CountryCodeISO\": \"BM\",\n   \"Country\": \"Bermuda\"\n },\n {\n   \"CountryCode\": \"+1\",\n   \"CountryCodeISO\": \"VG\",\n   \"Country\": \"British Virgin Islands\"\n },\n {\n   \"CountryCode\": \"+1\",\n   \"CountryCodeISO\": \"KY\",\n   \"Country\": \"Cayman Islands\"\n },\n {\n   \"CountryCode\": \"+1\",\n   \"CountryCodeISO\": \"DM\",\n   \"Country\": \"Dominica\"\n },\n {\n   \"CountryCode\": \"+1\",\n   \"CountryCodeISO\": \"DO\",\n   \"Country\": \"Dominican Republic\"\n },\n {\n   \"CountryCode\": \"+1\",\n   \"CountryCodeISO\": \"GD\",\n   \"Country\": \"Grenada\"\n },\n {\n   \"CountryCode\": \"+1\",\n   \"CountryCodeISO\": \"GU\",\n   \"Country\": \"Guam\"\n },\n {\n   \"CountryCode\": \"+1\",\n   \"CountryCodeISO\": \"JM\",\n   \"Country\": \"Jamaica\"\n },\n {\n   \"CountryCode\": \"+1\",\n   \"CountryCodeISO\": \"MS\",\n   \"Country\": \"Montserrat\"\n },\n {\n   \"CountryCode\": \"+1\",\n   \"CountryCodeISO\": \"MP\",\n   \"Country\": \"Northern Marianas\"\n },\n {\n   \"CountryCode\": \"+1\",\n   \"CountryCodeISO\": \"PR\",\n   \"Country\": \"Puerto Rico\"\n },\n {\n   \"CountryCode\": \"+1\",\n   \"CountryCodeISO\": \"KN\",\n   \"Country\": \"Saint Kitts and Nevis\"\n },\n {\n   \"CountryCode\": \"+1\",\n   \"CountryCodeISO\": \"LC\",\n   \"Country\": \"Saint Lucia\"\n },\n {\n   \"CountryCode\": \"+1\",\n   \"CountryCodeISO\": \"VC\",\n   \"Country\": \"Saint Vincent and the Grenadines\"\n },\n {\n   \"CountryCode\": \"+1\",\n   \"CountryCodeISO\": \"TT\",\n   \"Country\": \"Trinidad and Tobago\"\n },\n {\n   \"CountryCode\": \"+1\",\n   \"CountryCodeISO\": \"TC\",\n   \"Country\": \"Turks and Caicos Islands\"\n },\n {\n   \"CountryCode\": \"+676\",\n   \"CountryCodeISO\": \"TO\",\n   \"Country\": \"Tonga\"\n },\n {\n   \"CountryCode\": \"+1\",\n   \"CountryCodeISO\": \"US\",\n   \"Country\": \"United States of America\"\n },\n {\n   \"CountryCode\": \"+970\",\n   \"CountryCodeISO\": \"PS\",\n   \"Country\": \"Palestine\"\n },\n {\n   \"CountryCode\": \"+211\",\n   \"CountryCodeISO\": \"SS\",\n   \"Country\": \"South Sudan\"\n },\n {\n   \"CountryCode\": \"+44\",\n   \"CountryCodeISO\": \"IM\",\n   \"Country\": \"Isle of Man\"\n }\n];\n\n\n    \t\t\n\n\n    \t\tvar loc = $location.path().split(\"/\");\n\n    \t\tif(loc[loc.length -3] == \"verified\"){\n    \t\t\n\t    \t\tvar last = loc[loc.length -1];\n\t    \t\tvar pre = loc[loc.length -2];\n\n\t            //console.log(\"THIS IS A VERIFY TOKEN VERIFICATION\", pre);\n\n\t    \t\tif(last && pre){\n\n\t\t            //console.log(\"THIS IS A VERIFY TOKEN VERIFICATION\", last);\n\n\t\t             UserService.Verify(last, pre)\n\t\t                .then(function (response) {\n\t\t                    if (response.success) {\n\t\t                    \t//alert(\"verified\");\n\n\t\t                    \t//lets create a temp create cookie here...\n\n\t\t                        // vm.title = \"Thank You!\";\n\t\t                        // vm.verify_status = \"Your email address has been verified.\";\n\t\t                    } else {\n\t\t                    \talert(\"Sorry - your verification link seems to be incorrect.\")\n\t\t                        // vm.title = \"Sorry!\";\n\t\t                        // vm.verify_status = \"Sorry - something went wrong here! Please try clicking the link your email again. Should this still be a problem, please contact support.\";\n\t\t                    }\n\t\t                });\n\n\t\t        }            \n    \t\t}\n\n\n    \t\tif(loc[loc.length -1].split(\"?\")[0] == \"payment_setup_confirmation\"){\n\n    \t\t\t// //console.log(\"PARAMS1231\", $location.search());\n\t    \t\t// //console.log(\"PARAMSCODE123\", $location.search().code);\n\n\t    \t\tvar mid = $cookies.get('mid');\n\t    \t\tvar bid = $cookies.get('bid');\n\n\t    \t\t// //console.log(\"PARAMS123123\", mid);\n\n\t    \t\t GoCardService.SetupGoCard({mid: mid, bid: bid, code: $location.search().code})\n\t\t                .then(function (response) {\n\t\t                \t//console.log(\"response\", response);\n\t\t                    if (response.success) {\n\t\t                    \t//alert(\"verified\");\n\t\t                    \t\n\t\t                    \t//SetupGoCard\n\n\t\t                        // vm.title = \"Thank You!\";\n\t\t                        // vm.verify_status = \"Your email address has been verified.\";\n\t\t                    } else {\n\t\t                    \talert(\"Sorry - we were unable to setup your connection to our payment provider GoCardless.\")\n\t\t                        // vm.title = \"Sorry!\";\n\t\t                        // vm.verify_status = \"Sorry - something went wrong here! Please try clicking the link your email again. Should this still be a problem, please contact support.\";\n\t\t                    }\n\t\t                });\n\n\n\n\n    \t\t}\n\n    \t\t$scope.go_to_login = function(){\n\t\t\t\t$state.go(\"login\");\n    \t\t}\n\n    \t\t\n\n    \t\t$scope.verify_mobile = function(text_verification){\n    \t\t\t//console.log(\"called\", vm.text_verification);\n\n    \t\t\tif(vm.text_verification.length == 4){\n    \t\t\t\t//then we check\n\n    \t\t\t\t// //console.log(\"4 chars\", vm.text_verification);\n    \t\t\t\t// //console.log(\"4 chars\", last);\n\n    \t\t\t\tMemberService.VerifyPhone(vm.text_verification, last)\n\t\t                .then(function (data) {\n\t\t                    // //console.log(data);\n\t\t                    if(data.success){\n\t\t                        //use GB airfields first...\n\t\t                        $scope.verified_mobile = true;\n\n\t\t                        $scope.link = data.link.url;\n\t\t                    \t$cookies.put('mid', last);\n\t\t                    \t$cookies.put('bid', data.bid);\n\n\n\n\n\t\t                    } else {\n\t\t                    \talert(\"Your verification code is incorrect...\");\n    \t\t\t\t\t\t\t$scope.verified_mobile = false;\n\t\t                    }\n\n\t\t                });\n\n    \t\t\t\t// if(text_verification == \"1234\"){\n\n    \t\t\t\t// \t$scope.verified_mobile = true;\n    \t\t\t\t// }\n\n    \t\t\t} else {\n    \t\t\t\t//do nothing\n    \t\t\t}\n\n    \t\t}\n\n\n\n    \t\t$scope.get_companies = function(name){\n\t\t         \n\t\t            if(name.length > 2){\n\n\t\t             MemberService.GetCompany(name)\n\t\t                .then(function (data) {\n\t\t                    //console.log(data);\n\t\t                    if(data.success){\n\t\t                        //use GB airfields first...\n\t\t                        $scope.companies = data.items;\n\n\t\t                    } else {\n\n\n\t\t                            //console.log(\"WOOOPSIES...\");\n\t\t                            //this should be very very rare...\n\t\t                        \n\t\t                        \n\t\t                   \n\t\t                    }\n\n\t\t                });\n\n\n\t\t            }\n\t\t        }\n\n\t\t        $scope.prefix_length = 0;\n\t\t        $scope.prefix = \"\";\n\n\t\t        $scope.set_prefix = function(){\n\n\t\t        \t//$scope.prefix = \n\n\t\t        \t// var current_phone = $scope.formData.user.phone;\n\t\t        \t// if($scope.prefix_length > 0){\n\t\t        \t// \tcurrent_phone = current_phone.substring($scope.prefix_length);\n\t\t        \t// }\n\t\t        \t// $scope.prefix_length = vm.selected_phone.CountryCode.length;\n\t\t        \t// $scope.prefix = vm.selected_phone.CountryCode + \"\" + current_phone;\n\n\t\t        }\n\n\t\t        $scope.set_company = function(){\n\t\t        \t\n\n\t\t        \t MemberService.GetCompanyDetail(vm.selected_company.company_number)\n\t\t                .then(function (data) {\n\t\t                    //console.log(data);\n\t\t                    if(data.success){\n\t\t                        //use GB airfields first...\n\t\t                        //console.log(\"detail\", data);\n\t\t                        $scope.company = data;\n\n\t\t                        sort_company_data(data);\n\n\n\n\n\t\t                    } else {\n\n\n\t\t                            //console.log(\"WOOOPSIES...\");\n\t\t                            //this should be very very rare...\n\t\t                        \n\t\t                        \n\t\t                   \n\t\t                    }\n\n\t\t                });\n\n\t\t        }\n\n         \t// we will store all of our form data in this object\n\t\t    $scope.formData = {\n\t\t    \tclub: {\n\t\t    \t\tis_company: true\n\t\t    \t},\n\t\t    \tuser: {\n\t\t    \t\tphone: \"\"\n\t\t    \t}\n\t\t    };\n\n\n\n\t\t    function sort_company_data(data){\n\n\t\t    \tvm.officers = data.officer;\n\t\t    \tvm.company_details = data.company;\n\n\t\t    \t//match the firstname and last name entered with a director of the company\n\t\t    \tvar user_is_named_on_company_selected = false;\n\n\t\t    \tvar fname = $scope.formData.user.first_name.toLowerCase();\n\t\t    \tvar lname = $scope.formData.user.last_name.toLowerCase();\n\t\t    \tvar matched = 0;\n\n\n\n\n\t\t    \tfor(var i=0; i<vm.officers.length;i++){\n\n\t\t    \t\tif(vm.officers[i].name.toLowerCase().indexOf(fname) > -1 && vm.officers[i].name.toLowerCase().indexOf(lname) > -1){\n\n\t\t    \t\t\tuser_is_named_on_company_selected = true;\n\t\t    \t\t\tmatched = i;\n\n\t\t    \t\t}\n\n\t\t    \t}\n\n\n\t\t    \tif(user_is_named_on_company_selected){\n\n\t\t    \t\talert(\"We have matched you!\");\n\n\t\t    \t\t//now that we have some basic setup then we can get into the nitty gritty of adding\n\t\t    \t\t$scope.formData.club = {};\n\n\t\t    \t\t$scope.formData.club.company_name = data.company.company_name;\n\t\t    \t\t$scope.formData.club.trading_as = data.company.company_name;\n\t\t    \t\t$scope.formData.club.title = data.company.company_name.replace(\"LTD\", \"\").replace(\"LIMITED\", \"\").replace(\"LLC\", \"\");\n\t\t    \t\t$scope.formData.club.company_number = data.company.company_number;\n\t\t    \t\t$scope.formData.club.date_of_creation = data.company.date_of_creation;\n\t\t    \t\t$scope.formData.club.address_line_1 = data.company.registered_office_address.address_line_1;\n\t\t    \t\t$scope.formData.club.address_line_2 = data.company.registered_office_address.address_line_2;\n\t\t    \t\t$scope.formData.club.city = data.company.registered_office_address.locality;\n\t\t    \t\t$scope.formData.club.post_code = data.company.registered_office_address.postal_code;\n\n\t\t    \t\t$scope.formData.user.dob_year = data.officer[matched].date_of_birth.year;\n\t\t    \t\t$scope.formData.user.dob_month = data.officer[matched].date_of_birth.month;\n\t\t    \t\t$scope.formData.user.role = data.officer[matched].officer_role;\n\t\t    \t\t$scope.formData.club.is_company = true;\n\t\t    \t\t\n\n\n\n\t\t    \t} else {\n\n\t\t    \t\talert(\"Unfortunately we cannot match your personal details with any of the company directors. Did you select the correct company from the drop-down list?\");\n\n\t\t    \t}\n\n\n\n\n\n\n\t\t    }\n\n\t\t    $scope.setup_direct_debit = function(){\n\t\t    \t//console.log($scope.link);\n\t\t    \twindow.open($scope.link);\n\t\t    \t//window.location = $scope.link;\n\n\t\t    }\n\t\t    \n\t\t    $scope.checkValid = function(){\n\t\t    \tconsole.log(\"CLICK\");\n\t\t    \t//console.log($('#signup-form')[0].checkValidity());\n\n\n          //console.log(\"HERE WE GO?\");\n\n            //let's check the passwords match first...\n            if($scope.formData.user.password !== $scope.formData.user.password2){\n              $(\"input[type='password']\").removeClass(\"ng-pristine\").addClass(\"ng-invalid\");\n              alert(\"Your passwords do not match\");\n              return false;\n            }\n\n            //check the password length > 8 characters\n            var strongPassword = new RegExp('(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[^A-Za-z0-9])(?=.{8,})')\n            if(strongPassword.test($scope.formData.user.password)) {\n              //console.log(\"password strength OK\");\n            } else {\n              $(\"input[type='password']\").removeClass(\"ng-pristine\").addClass(\"ng-invalid\");\n              alert(\"Your password must be at least 8 characters in length, contain 1 uppercase, 1 lowercase, 1 number, and 1 special character\");\n              return false;\n            }\n\n\n\n\t\t    \tif(! $('#signup-form')[0].checkValidity()){\n\t\t    \t\t$(\".ng-pristine\").not(\".ng-valid\").removeClass(\"ng-pristine\").addClass(\"ng-invalid\");\n\t\t    \t\t$(\"input:checkbox:not(:checked)\").addClass(\"ng-checkbox-unchecked\");\n\t\t    \t\t//console.log(\"STOP\");\n\t\t    \t\treturn false;\n\t\t    \t} else {\n\t\t    \t\t//console.log(\"HERE\");\n\t\t    \t\t$(\"input:checkbox:not(:checked)\").removeClass(\"ng-checkbox-unchecked\");\n\t\t    \t\tif(!$scope.formData.user){\n\t\t    \t\t\t//console.log(\"missing first bit...\");\n\t\t\t\t    \t$state.go(\"club_signup.my_profile\");\n\t\t    \t\t\treturn false;\n\t\t    \t\t}\n\n\t\t    \t\tif(!vm.selected_phone.CountryCode){\n\t\t\t    \t\talert(\"Please select the country prefix of the mobile phone entered from the drop-down menu, this will ensure that the text messages we send will be sent to the correct telephone number.\");\n\t\t\t    \t\treturn false;\n\t\t\t    \t}\n\t\t\t    \tvar mobile = $scope.formData.user.phone;\n\n\t\t\t    \tif($scope.formData.user.phone.slice(0,1) == 0){\n\t\t\t    \t\talert(\"Your telephone number seems to start with a 0, as we will be using your international phone number, the first zero will be stripped automatically.\");\n\t\t\t    \t\t$scope.formData.user.phone.phone = $scope.formData.user.phone.phone.substring(1);\n\t\t\t    \t}\n\n\t\t    \t\tif(!$scope.formData.club || !$scope.formData.club.title){\n\t\t    \t\t\t//console.log(\"missing second bit...\");\n\t\t\t\t    \t$state.go(\"club_signup.my_club\");\n\t\t    \t\t\treturn false;\n\t\t    \t\t}\n\t\t    \t\tif(!$scope.formData.tnc){\n\t\t    \t\t\t//console.log(\"missing third bit...\");\n\t\t\t\t    \t$state.go(\"club_signup.terms\");\n\t\t    \t\t\treturn false;\n\t\t    \t\t}\n\n            \n            \n\t\t    \t\tif($scope.formData.user.password == $scope.formData.user.password2){\n\t\t\t    \t\tvar next = $(\".btn-info\").attr(\"one-ui-sref\");\n\t\t\t    \t\t\t//console.log(\"NEXT\", next);\n\t\t\t    \t\tif(next == \"club_signup.verify\"){\n\t\t\t    \t\t\t//console.log(\"verifying account\");\n\t\t\t    \t\t\t$scope.processForm();\n\t\t\t    \t\t} else {\n\t\t\t\t    \t\t$state.go(next);\n\t\t\t    \t\t}\n\t\t    \t\t} else {\n\t\t\t    \t\t$(\"input[type='password']\").removeClass(\"ng-pristine\").addClass(\"ng-invalid\");\n\t\t    \t\t\treturn false;\n\t\t    \t\t}\n\t\t    \t}\n\t\t    }\n\n\n\t\t    // function to process the form\n\t\t    $scope.processForm = function() {\n\t\t         if ($scope.formData) {\n\t                //contact the service to create a new club! :)\n\n\t                //sort out the phone number: \n\t                $scope.formData.user.phone = vm.selected_phone.CountryCode + $scope.formData.user.phone;\n\n \t\t\t\t\t//console.log(\"GO!\");\n \t\t\t\t\tClubService.Create($scope.formData)\n\t\t                .then(function(data){\n\t\t                    //console.log(data);\n\t\t                    if(data.success){\n\t\t\t                    $state.go(\"club_signup.verify\");\n\t\t\t                    $scope.formData = {};\n\t\t                    } else {\n\t\t                    \t$(\"#error_message\").html(data.message);\n\t\t                    }\n\t\t                });\n\n\t            } else {\n\t            \talert(\"Something went wrong...\");\n\t            }\n\t\t    };\n\n\n\n\n\n\n\t\t$scope.downloadClubDocument = function(doc) {\n            var data = $.param({\n                id: doc\n            });\n\n            var ddd = doc.replace(/^.*[\\\\\\/]/, '');\n            $http.defaults.headers.common['Api-Key'] = \"eW91a25vd25vdGhpbmdqb25zbm93\";\n\n            $http.get('api/v1/term_documents/show_file/'+ddd, {\n                    responseType: 'arraybuffer'\n                })\n                .success(function(data, status, headers) {\n                    var zipName = processArrayBufferToBlob(data, headers);\n\n                    //Delete file from temp folder in server - file needs to remain open until blob is created\n                    //deleteFileFromServerTemp(zipName);\n                }).error(function(data, status) {\n                    alert(\"There was an error downloading the selected document(s).\");\n                })\n        };\n\n\n        function titlepath(path,name){\n\n        //In this path defined as your pdf url and name (your pdf name)\n            var prntWin = window.open();\n            prntWin.document.write(\"<html><head><title>\"+name+\"</title></head><body>\"\n                + '<embed width=\"100%\" height=\"100%\" name=\"plugin\" src=\"'+ path+ '\" '\n                + 'type=\"application/pdf\" internalinstanceid=\"21\"></body></html>');\n            prntWin.document.close();\n        }\n\n        function processArrayBufferToBlob(data, headers) {\n            var octetStreamMime = 'application/octet-stream';\n            var success = false;\n\n            // Get the headers\n            headers = headers();\n            //var ttt = title.toLowerCase().replace(/\\W/g, '_');\n            // Get the filename from the x-filename header or default to \"download.bin\"\n            var filename = headers['x-filename'] || 'download.zip';\n\n            // Determine the content type from the header or default to \"application/octet-stream\"\n            var contentType = headers['content-type'] || octetStreamMime;\n\n            try {\n                // Try using msSaveBlob if supported\n                var blob = new Blob([data], {\n                    //type: contentType\n                    type: 'application/pdf'\n                });\n\n                var fileURL = URL.createObjectURL(blob);\n                titlepath(fileURL, \"Secure Documents\");\n\n                // if (navigator.msSaveBlob)\n                //     navigator.msSaveBlob(blob, filename);\n                // else {\n                //     // Try using other saveBlob implementations, if available\n                //     var saveBlob = navigator.webkitSaveBlob || navigator.mozSaveBlob || navigator.saveBlob;\n                //     if (saveBlob === undefined) throw \"Not supported\";\n                //     saveBlob(blob, filename);\n                // }\n                success = true;\n            } catch (ex) {\n                $log.info(\"saveBlob method failed with the following exception:\");\n                $log.info(ex);\n            }\n\n            if (!success) {\n                // Get the blob url creator\n                var urlCreator = window.URL || window.webkitURL || window.mozURL || window.msURL;\n                if (urlCreator) {\n                    // Try to use a download link\n                    var link = document.createElement('a');\n                    if ('download' in link) {\n                        // Try to simulate a click\n                        try {\n                            // Prepare a blob URL\n                            var blob = new Blob([data], {\n                                type: contentType\n                            });\n                            var url = urlCreator.createObjectURL(blob);\n                            link.setAttribute('href', url);\n\n                            // Set the download attribute (Supported in Chrome 14+ / Firefox 20+)\n                            link.setAttribute(\"download\", filename);\n\n                            // Simulate clicking the download link\n                            var event = document.createEvent('MouseEvents');\n                            event.initMouseEvent('click', true, true, window, 1, 0, 0, 0, 0, false, false, false, false, 0, null);\n                            link.dispatchEvent(event);\n                            success = true;\n\n                        } catch (ex) {\n                            $log.info(\"Download link method with simulated click failed with the following exception:\");\n                            $log.info(ex);\n                        }\n                    }\n\n                    if (!success) {\n                        // Fallback to window.location method\n                        try {\n                            // Prepare a blob URL\n                            // Use application/octet-stream when using window.location to force download\n                            var blob = new Blob([data], {\n                                type: octetStreamMime\n                            });\n                            var url = urlCreator.createObjectURL(blob);\n                            window.location = url;\n                            success = true;\n                        } catch (ex) {\n                            $log.info(\"Download link method with window.location failed with the following exception:\");\n                            $log.info(ex);\n                        }\n                    }\n                }\n            }\n\n            if (!success) {\n                // Fallback to window.open method\n                $log.info(\"No methods worked for saving the arraybuffer, using last resort window.open\");\n                window.open(httpPath, '_blank', '');\n            }\n            return filename;\n        };\n\n\n\n\n\n\n\n\n\n\n\n    }\napp.controller('CreateGalleryController', CreateGalleryController);\n \n    CreateGalleryController.$inject = ['UserService', 'ArtpiecesService', 'ImagesService', 'KeywordsService', 'CategoryService', '$location', '$rootScope', 'FlashService', '$routeParams', '$scope', 'LocalDataService', 'GalleryService'];\n    function CreateGalleryController(UserService, ArtpiecesService, ImagesService, KeywordsService, CategoryService, $location, $rootScope, FlashService, $routeParams, $scope, LocalDataService, GalleryService) {\n        var vm = this;\n\n        vm.gallery = {\n            is_protected: \"false\",\n            download_low: \"false\",\n            download_medium: \"false\",\n            download_high: \"false\",\n            gallery_link: \"\",\n            fullscreen: \"false\"\n        };\n\n        //get all galleries to check if name is already in use...\n        GalleryService.GetAll()\n                .then(function(data){\n                     vm.all_galleries = data;\n                });\n\n\n\n        vm.images = LocalDataService.data.selected_images;\n\n        //this is where we do the selection of images\n        $scope.remove_image = function(image){\n            //check if set selected\n            //well its selected - so we deselect right?\n            vm.images = $.grep(vm.images, function(e){ \n                return e.id != image.id; \n            });\n            //console.log(vm.images);\n            LocalDataService.SetSelectedImages(vm.images);\n        }\n\n        $scope.check_link_unique = function(){\n            for(var i = 0; i < vm.all_galleries.length; i++){\n                if(vm.all_galleries[i].link===vm.gallery.link){\n                    return false;\n                }\n            }\n        }\n\n\n        $scope.generate_gallery = function(){\n            //console.log(\"CLICKED GALLERY BIT\");\n            //console.log(LocalDataService.data.selected_images);\n            //we need to set the ORDER as organise in the vm.images\n            var organise = 0;\n            for(var i = 0; i < vm.images.length; i++){\n                vm.images[i].organise = i;\n            }\n            //console.log(\"ORGANISE BELOW?\");\n            //console.log(vm.images);\n\n            vm.gallery.images = vm.images;\n            //console.log(vm.gallery);\n            GalleryService.Create(vm.gallery)\n                .then(function(data){\n                    //console.log(data);\n                    $location.path(\"/gallery/\"+data.gallery_link);\n                });\n        }\n\n       \n\n\n\n    }\n app.controller('DashboardClubAirframeLogbookController', DashboardClubAirframeLogbookController);\n\n    DashboardClubAirframeLogbookController.$inject = ['UserService', 'PlaneService', '$rootScope', '$location', '$scope', '$state', '$stateParams', '$uibModal', '$log', '$window', 'LicenceService', 'MedicalService', 'DifferencesService', 'PlaneDocumentService', '$http'];\n    function DashboardClubAirframeLogbookController(UserService, PlaneService, $rootScope, $location, $scope, $state, $stateParams, $uibModal, $log, $window, LicenceService, MedicalService, DifferencesService, PlaneDocumentService, $http) {\n        var vm = this;\n\n       \n        \n        switch(vm.action){\n            case \"add\":\n                // //console.log(\"adding a new plane please\");\n                vm.page_title = \"Add a New Plane\";\n            break;\n            case \"edit\":\n                // //console.log(\"edit an existing plane\");\n                \n                PlaneService.GetByIdMaintenance2($stateParams.plane_id, vm.club_id)\n                    .then(function(data){\n                        vm.club.plane = data;  \n                        vm.this_plane_id = $stateParams.plane_id; \n\n                        if(vm.club.plane && vm.club.plane.maintenance){\n                            //console.log(\"vm.club.plane == > \", vm.club.plane);\n                            vm.obj.hours_remaining = vm.club.plane.maintenance.hours_remaining;\n                            vm.obj.next_check = new Date(vm.club.plane.maintenance.next_maintenance);\n                            vm.obj.check_date = new Date();\n                            vm.obj.extension_granted = new Date();\n                        }\n                       \n\n                        // vm.club.plane.requirements = {\n                        //         licence: [],\n                        //         medical: [],\n                        //         differences: [],\n                        //         hours: []\n                        // };\n                        // //console.log(\"BOOOO - get all planes....\");\n                        vm.page_title = \"Edit a Plane Maintenance - \"+vm.club.plane.registration;\n                    });\n\n                PlaneService.GetOpenIssues($stateParams.plane_id)\n                    .then(function (data) {\n                            ////console.log(\"data is : \", data);\n                           vm.reported_defects = data;\n                        });\n\n\n               \n\n\n            break;\n            case \"list\":\n                //need to update this to be part of the authentication\n                //to find out club id\n                // PlaneService.GetAllByClubMaintenance(vm.club_id)\n                //     .then(function(data){\n                //         vm.club.planes = data;   \n                //         // //console.log(vm.club.planes);\n                //     });\n            break;\n            default:\n                //console.log(\"none of the above... redirect somewhere?\");\n            break;\n        }  \n\n       \n\n        $scope.get_hours_from_decimal = function(time){\n\n            if(time){\n                 var sign = time < 0 ? \"-\" : \"\";\n                 var hour = Math.floor(Math.abs(time));\n                 var min = Math.round((Math.abs(time) * 60) % 60);\n                 if(min == 60){\n                     hour++;\n                     min = 0;\n                 }\n                 return sign + (hour < 10 ? \"0\" : \"\") + hour + \":\" + (min < 10 ? \"0\" : \"\") + min;\n             } else {\n                 return \"N/A\";\n             }\n            \n\n        }\n\n        vm.prop_no = \"\";\n\n        // PlaneService.GetAircraftJourneyLogs($stateParams.plane_id, 0, 25)\n        //     .then(function (data) {\n        //             // //console.log(\"ALL is : \", data);\n        //            // vm.logs = data.logs;\n        //            vm.aircraft = data.aircraft;\n        //            if(vm.aircraft.propeller_2_id > 0){\n\n        //                    // console.log(vm.aircraft);\n\n        //                if(vm.aircraft.propeller_2_id == $stateParams.prop_id){\n        //                    // console.log(\"show 2\");\n        //                    vm.prop_no = \"2\";\n        //                } else {\n        //                    // console.log(\"show 1\");\n        //                    vm.prop_no = \"1\";\n        //                }\n        //            }\n\n\n        //         });\n\n\n            vm.getAge = function(dateString) {\n                var today = new Date();\n                var birthDate = dateString;\n                var age = today.getFullYear() - dateString;\n                // var m = today.getMonth() - birthDate.getMonth();\n                // if (m < 0 || (m === 0 && today.getDate() < birthDate.getDate())) {\n                //     age--;\n                // }\n                return age;\n            }\n\n\n            PlaneService.GetAirframeLogs( $stateParams.plane_id, 0, 25)\n            .then(function (data) {\n                    // //console.log(\"ALL is : \", data);\n                   vm.logs = data.logs;\n                   vm.plane = data.plane;\n\n\n                });\n\n            vm.current_offset = 0;\n            vm.loaded_per_batch = 25;\n            vm.all_loaded = false;\n\n            vm.load_more = function(){\n                vm.current_offset = vm.current_offset + vm.loaded_per_batch;\n                PlaneService.GetAirframeLogs($stateParams.plane_id, vm.current_offset, vm.loaded_per_batch)\n                .then(function (data) {\n                        // //console.log(\"ALL is : \", data);\n                        if(data.logs.length > 0){\n                            data.logs.forEach(log => vm.logs.push(log));\n                        } else {\n                            vm.all_loaded = true;\n                        }\n                       //vm.logs = data.logs;\n                       vm.plane = data.plane;\n\n\n                    });\n\n            }\n\n            vm.update_logbooks = function(){\n                \n\n                PlaneService.UpdateAircraftLogbooks($stateParams.plane_id)\n                .then(function (data) {\n                        \n                        if(data.success){\n\n                           PlaneService.GetAirframeLogs( $stateParams.plane_id, 0, 25)\n                            .then(function (data) {\n                                    // //console.log(\"ALL is : \", data);\n                                   vm.logs = data.logs;\n                                   vm.plane = data.plane;\n\n\n                                });\n\n                        }\n\n\n                    });\n            }\n\n            vm.get_initial = function(text){\n                return text.charAt(0);\n            }\n\n\n            vm.clean_times = function(time){\n                if(time == \"00:00:00\"){\n                    return \" - \";\n                }\n                return time.substring(0,5);\n            }\n\n\n\n\n\n        $scope.update_this_file = function(file){\n            //console.log(\"==== update is : \", file.id);\n            if(update_this_file.indexOf(file.id) === -1){\n                update_this_file.push(file.id)\n            } else {\n               ////console.log(\"This item already exists\"); \n            } \n        }\n\n\n         $scope.remove_real_file = function(file){\n\n                //remove_file\n\n                vm.club.plane.plane_documents = $.grep(vm.club.plane.plane_documents, function(e){ \n                        return e.id != file.id; \n                    });\n\n                //no need to actually remove the file as it will be archived accordingly on the backend whilst it is missing! :)\n                PlaneDocumentService.Delete(vm.user_id, file.id)\n                .then(function (data) {\n                    // //console.log(data);\n                    if(data.success){\n                        // //console.log(\"HUZZAH\", current_files);\n                        //then we need to remove this from the list of files...\n                        //clear files\n                        vm.plane_documents = [];\n                        //and re-process available files\n                        $scope.processFiles(current_files);\n\n                    } else {\n                        //console.log(\"WOOOPSIES...\");\n                        //this should be very very rare...\n                    }\n\n                });\n\n          }\n\n\n          \n          $scope.remove_file = function(file, current_files){\n\n            //remove_file\n            var j = JSON.parse(file.file_return);\n            // //console.log(\"REMOVE: \", j);\n            // //console.log(\"REMOVE: \", j.saved_url);\n\n            //to delete the temp file created: j.saved_url\n            //tmp_rm.php POST tmp = filename\n            \n\n            //this SHOULD BE TO THE CURRENT POSITION\n\n            // PoidService.DeleteTmp(j.saved_url)\n            //     .then(function (data) {\n            //         //console.log(data);\n            //         if(data.success){\n            //             //console.log(\"HUZZAH\", current_files);\n            //             //then we need to remove this from the list of files...\n            //             //clear files\n            //             vm.plane_documents = [];\n            //             //and re-process available files\n            //             $scope.processFiles(current_files);\n\n            //         } else {\n            //             //console.log(\"WOOOPSIES...\");\n            //             //this should be very very rare...\n            //         }\n\n            //     });\n\n          }\n          \n\n          // $scope.$on('flow::fileAdded', function (event, $flow, flowFile) {\n          //     event.preventDefault();//prevent file from uploading\n          //     //console.log(\"FILE ADDED\");\n          //     //console.log($flow);\n          //   });\n\n            vm.files = {\n                radio: [],\n                cert: [],\n                insurance: []\n            }\n\n\n            $scope.processFiles = function(files, location){\n                // //console.log(\"files\", files);\n\n                for(var i=0; i<files.length; i++){\n                    // //console.log(\"JSON\", files[i].file_return);\n                    var j = JSON.parse(files[i].file_return);\n                    // //console.log(\"PARSED\", j);\n                    // //console.log(\"J is : \",j);\n                    // //console.log(\"name is : \", j.files.file.name);\n\n                    files[i].file.temp_path = j.saved_url;\n                    files[i].file.save_name = j.files.file.name;\n                    var ft = j.files.file.name;\n                    ft = ft.split('.').pop();\n                    files[i].file.extension = ft;\n\n                    // //console.log(\"file\", files[i].file);\n                    vm.files[location].push(files[i].file);\n                }\n\n\n            }\n\n\n             $scope.processFile = function(files, location){\n                 //console.log(\"files\", files[0].file_return);\n\n                    // //console.log(\"JSON\", files[i].file_return);\n                    var j = JSON.parse(files[0].file_return);\n                    // //console.log(\"PARSED\", j);\n                    // //console.log(\"J is : \",j);\n                    // //console.log(\"name is : \", j.files.file.name);\n\n                    files[0].file.temp_path = j.saved_url;\n                    files[0].file.save_name = j.files.file.name;\n\n                    var ft = j.files.file.name;\n                    // //console.log(\"ft\", ft);\n                    var fft = ft.split('.').pop();\n                    files[0].file.extension = fft;\n                    // //console.log(\"FILE is : \", files[0]);\n\n                    // //console.log(\"file\", files[i].file);\n                    vm.files[location].push(files[0]);\n\n\n            }\n\n            $scope.set_title = function(file){\n                // //console.log(\"return\", file);\n                return file.save_name;\n            }\n\n            $scope.get_icon = function(file){\n\n                var ft = file.name;\n                ft = ft.split('.').pop();\n                var icon_name = \"\";\n\n                // //console.log(\"FILE:\", ft);\n                // //console.log(\"index : \", ft.indexOf(\"pdf\"));\n                switch(true){\n                    case (ft.indexOf(\"pdf\") > -1):\n                        icon_name = \"pdf.png\";\n                    break;\n                    case (ft.indexOf(\"doc\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"docx\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"xls\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"xlsx\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"ppt\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"pptx\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"jpg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"jpeg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"png\") > -1):\n                        icon_name = \"png.png\";\n                    break;\n                    case (ft.indexOf(\"gif\") > -1):\n                        icon_name = \"gif.png\";\n                    break;\n                    case (ft.indexOf(\"zip\") > -1):\n                        icon_name = \"zip.png\";\n                    break;\n                    case (ft.indexOf(\"avi\") > -1):\n                        icon_name = \"avi.png\";\n                    break;\n                    case (ft.indexOf(\"mp4\") > -1):\n                        icon_name = \"mp4.png\";\n                    break;\n                    default:\n                        icon_name = \"file.png\";\n                    break;\n                }\n\n                // //console.log(\"FILE:\", icon_name);\n\n                return \"images/file_icons/\"+icon_name;\n            }\n\n\n            $scope.get_icon2 = function(file){\n                ////console.log(\"FILE\", file);\n                if(!file || file == \"\"){\n                    return \"\";\n                }\n                var ft = file.split('.').pop();\n                // //console.log(\"ICON 2 : \", ft);\n                var icon_name = \"\";\n\n                // //console.log(\"FILE:\", ft);\n                // //console.log(\"index : \", ft.indexOf(\"pdf\"));\n                switch(true){\n                    case (ft.indexOf(\"pdf\") > -1):\n                        icon_name = \"pdf.png\";\n                    break;\n                    case (ft.indexOf(\"doc\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"docx\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"xls\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"xlsx\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"ppt\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"pptx\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"jpg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"jpeg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"png\") > -1):\n                        icon_name = \"png.png\";\n                    break;\n                    case (ft.indexOf(\"gif\") > -1):\n                        icon_name = \"gif.png\";\n                    break;\n                    case (ft.indexOf(\"zip\") > -1):\n                        icon_name = \"zip.png\";\n                    break;\n                    case (ft.indexOf(\"avi\") > -1):\n                        icon_name = \"avi.png\";\n                    break;\n                    case (ft.indexOf(\"mp4\") > -1):\n                        icon_name = \"mp4.png\";\n                    break;\n                    default:\n                        icon_name = \"file.png\";\n                    break;\n                }\n\n                // //console.log(\"FILE:\", icon_name);\n\n                return \"images/file_icons/\"+icon_name;\n            }\n\n\n            vm.defect_severity;\n                vm.defect_severities = [\n                    { title: \"No Fly Item - Ground the plane\"},\n                    { title: \"Flyable - needs to be checked at next maintenance\"},\n                    { title: \"Not urgent - but needs noting\"},\n                    { title: \"Unsure of severity\"}\n                ]; \n\n\n            $scope.delete_poid = function(id){\n\n              \n                var a = prompt(\"Are you sure you wish to delete this poid? \\n\\n This change is irreversible! To confirm please type YES in the box below.\");\n                if(a == \"YES\"){\n\n\n                    //console.log(\"WE DELETE IT\");\n\n\n                    // PoidService.Delete(vm.user_id, id)\n                    //     .then(function (data) {\n                    //         //console.log(data);\n                    //         if(data.success){\n                    //             //console.log(\"HUZZAH\", data);\n                    //             //then we need to remove this from the list of files...\n                    //             vm.user_poids = $.grep(vm.user_poids, function(e){ \n                    //                 return e.id != id; \n                    //             });\n                                \n                    //             //refresh?\n                    //             $state.reload();\n                    //             $state.go('dashboard.my_account.poid');\n\n                    //         } else {\n\n                    //             alert(\"Something went terribly wrong... \\n\\n \"+data.message);\n\n                    //         }\n\n                    //     });\n\n\n\n                } else {\n                    //console.log(\"ignore123\");\n                }\n\n\n            }\n\n\n\n\n            $scope.save_plane_documents = function(){\n\n               \n              \n\n                // //console.log(\"plane_documents: \", vm.plane_documents);\n\n\n                //compile the required elements YAY\n\n                // //console.log(\"plane_document \", vm.plane_document);\n\n\n                 //clean shizzle before sending\n                 //why keep sending back heavy data?\n\n                    // for(var i=0;i<vm.plane_document.images.length;i++){\n                    //     delete vm.plane_document.images[i].data_uri;\n                    // }\n\n                    // // vm.plane_document.images = vm.plane_documents;\n                    // vm.plane_document.images = vm.plane_document.images.concat(vm.plane_documents);\n                    // vm.plane_document.user_id = vm.user_id;\n\n\n\n\n            //     if(vm.plane_document.id){\n            //         //then its an udpate\n\n            //         //merge the images left?\n            //         PoidService.Update(vm.plane_document)\n            //             .then(function (data) {\n            //                 //console.log(data);\n            //                 if(data.success){\n            //                     //console.log(\"HUZZAH\", vm.plane_document);\n            //                     //console.log(\"HUZZAH\", data);\n            //                     //then we need to remove this from the list of files...\n                                \n                                \n            //                     //move somewhere?\n            //                     $state.go('dashboard.my_account.poid', {}, { reload: true });\n\n\n\n\n\n            //                 } else {\n\n            //                     alert(\"Something went terribly wrong... \\n\\n \"+data.message);\n\n            //                 }\n\n            //             });\n\n            //     } else {\n\n\n                   \n\n\n            //         //then its a create\n            //         //console.log(vm.plane_document);\n\n            //         PoidService.Create(vm.plane_document)\n            //             .then(function (data) {\n            //                 //console.log(data);\n            //                 if(data.success){\n            //                     //console.log(\"HUZZAH\", vm.plane_document);\n            //                     //console.log(\"HUZZAH\", data);\n            //                     //then we need to remove this from the list of files...\n                                \n                                \n            //                     //move somewhere?\n            //                    // $state.reload();\n            //                    // $state.go('dashboard.my_account.poid', {}, { reload: true });\n\n\n            //                 } else {\n\n            //                     alert(\"Something went terribly wrong... \\n\\n \"+data.message);\n\n            //                 }\n\n            //             });\n\n\n            //     }\n\n\n\n             };\n\n\n\n\n             $scope.change_file_name = function(file){\n                \n                //this is terribly ineficient... unfortunately... can't \n                //work out how else to do it! (lol)\n\n                // //console.log(\"TO BE CHANGED\", file);\n\n                // //console.log(\"BEFORE BEFORE\", vm.plane_documents);\n\n                vm.plane_documents = $.grep(vm.plane_documents, function(e){ \n                    return e.temp_path != file.temp_path; \n                });\n\n                // //console.log(\"BEFORE\", vm.plane_documents);\n\n                vm.plane_documents.push(file);\n\n                // //console.log(\"AFTER\", vm.plane_documents);\n\n             }\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n        initController();\n\n        function initController() {\n           //console.log(\"check if access is okay\");\n        }\n\n\n          //var warning_msg = \"By deleting this plane, you will also cancel all reservations that this plane currently has.\"\n\n          // $scope.open = function (plane_id) {\n          //   var modalInstance = $uibModal.open({\n          //     animation: true,\n          //     templateUrl: 'views/modals/deleteModal.html',\n          //     controller: 'ModalInstanceCtrl',\n          //     //params: {},\n          //     size: \"lg\",\n          //     resolve: {\n          //       id: function () {\n          //         return plane_id;\n          //       },\n          //       warning: function(){\n          //           return warning_msg;\n          //       }\n          //     }\n          //   });\n          //   modalInstance.result.then(function (plane_id) {\n          //     $log.info('PRESSED GO: '+plane_id);\n          //     PlaneService.Delete(plane_id)\n          //     .then(function(){\n          //       //console.log(\"HELLO DELETE\");\n          //       //update view?\n          //        vm.club.planes = $.grep(vm.club.planes, function(e){ \n          //           return e.plane_id != plane_id; \n          //       });\n          //     })\n          //   }, function () {\n          //     $log.info('Modal dismissed at: ' + new Date());\n          //   });\n          // };\n\n            $scope.open = function (club_plane_id) {\n            var modalInstance = $uibModal.open({\n              animation: true,\n              templateUrl: 'views/modals/deleteModal.html',\n              controller: 'ModalInstanceCtrl',\n              size: \"lg\",\n              resolve: {\n                id: function () {\n                  return club_plane_id;\n                },\n                params: function() {\n                  return {id: club_plane_id};\n                },\n                warning: function(){\n                    return warning_msg;\n                }\n              }\n            });\n            modalInstance.result.then(function (plane) {\n                var id = plane.id;\n              $log.info('PRESSED GO: ', id);\n              \n              PlaneService.Delete(id)\n              .then(function(){\n                // //console.log(\"HELLO DELETE\");\n                //update view?\n                 vm.club.planes = $.grep(vm.club.planes, function(e){ \n                    return e.id != id; \n                });\n             });\n\n            }, function () {\n              $log.info('Modal dismissed at: ' + new Date());\n            });\n\n\n          };\n         \n          \n\n\n        //   $scope.downloadCertificate = function(doc) {\n        //     var data = $.param({\n        //         id: doc\n        //     });\n\n        //     var ddd = doc.replace(/^.*[\\\\\\/]/, '');\n\n        //     $http.get('api/v1/plane_certificate/show_file/'+ddd, {\n        //             responseType: 'arraybuffer'\n        //         })\n        //         .success(function(data, status, headers) {\n        //             var zipName = processArrayBufferToBlob(data, headers);\n\n        //             //Delete file from temp folder in server - file needs to remain open until blob is created\n        //             //deleteFileFromServerTemp(zipName);\n        //         }).error(function(data, status) {\n        //             alert(\"There was an error downloading the selected document(s).\");\n        //         })\n        // };\n\n\n        // $scope.downloadInsurance = function(doc) {\n        //     var data = $.param({\n        //         id: doc\n        //     });\n\n        //     var ddd = doc.replace(/^.*[\\\\\\/]/, '');\n\n        //     $http.get('api/v1/plane_insurance/show_file/'+ddd, {\n        //             responseType: 'arraybuffer'\n        //         })\n        //         .success(function(data, status, headers) {\n        //             var zipName = processArrayBufferToBlob(data, headers);\n\n        //             //Delete file from temp folder in server - file needs to remain open until blob is created\n        //             //deleteFileFromServerTemp(zipName);\n        //         }).error(function(data, status) {\n        //             alert(\"There was an error downloading the selected document(s).\");\n        //         })\n        // };\n\n\n\n\n        $scope.downloadDocument = function(doc, type = 'docs') {\n            var data = $.param({\n                id: doc\n            });\n\n            var controller = \"plane_documents\";\n\n            switch(type){\n                 case \"radio\": \n                    controller = \"plane_radio_licence\";\n                break;\n                 case \"insurance\": \n                    controller = \"plane_insurance\";\n                break;\n                 case \"certificate\": \n                    controller = \"plane_certificate\";\n                break;\n                case \"noise\": \n                    controller = \"plane_noise_certificate\";\n                break;\n                case \"docs\": \n                    controller = \"plane_documents\";\n                break;\n                default:\n                    controller = \"plane_documents\";\n                break;\n\n            }\n\n\n\n            var ddd = doc.replace(/^.*[\\\\\\/]/, '');\n\n            $http.get('api/v1/'+controller+'/show_file/'+ddd, {\n                    responseType: 'arraybuffer'\n                })\n                .success(function(data, status, headers) {\n                    var zipName = processArrayBufferToBlob(data, headers);\n\n                    //Delete file from temp folder in server - file needs to remain open until blob is created\n                    //deleteFileFromServerTemp(zipName);\n                }).error(function(data, status) {\n                    alert(\"There was an error downloading the selected document(s).\");\n                })\n        };\n\n        $scope.downloadClubDocument = function(doc) {\n            var data = $.param({\n                id: doc\n            });\n\n            var ddd = doc.replace(/^.*[\\\\\\/]/, '');\n\n            $http.get('api/v1/club_documents/show_file/'+ddd, {\n                    responseType: 'arraybuffer'\n                })\n                .success(function(data, status, headers) {\n                    var zipName = processArrayBufferToBlob(data, headers);\n\n                    //Delete file from temp folder in server - file needs to remain open until blob is created\n                    //deleteFileFromServerTemp(zipName);\n                }).error(function(data, status) {\n                    alert(\"There was an error downloading the selected document(s).\");\n                })\n        };\n\n        function processArrayBufferToBlob(data, headers) {\n            var octetStreamMime = 'application/octet-stream';\n            var success = false;\n\n            // Get the headers\n            headers = headers();\n            //var ttt = title.toLowerCase().replace(/\\W/g, '_');\n            // Get the filename from the x-filename header or default to \"download.bin\"\n            var filename = headers['x-filename'] || 'download.zip';\n\n            // Determine the content type from the header or default to \"application/octet-stream\"\n            var contentType = headers['content-type'] || octetStreamMime;\n\n            try {\n                // Try using msSaveBlob if supported\n                var blob = new Blob([data], {\n                    type: contentType\n                });\n                if (navigator.msSaveBlob)\n                    navigator.msSaveBlob(blob, filename);\n                else {\n                    // Try using other saveBlob implementations, if available\n                    var saveBlob = navigator.webkitSaveBlob || navigator.mozSaveBlob || navigator.saveBlob;\n                    if (saveBlob === undefined) throw \"Not supported\";\n                    saveBlob(blob, filename);\n                }\n                success = true;\n            } catch (ex) {\n                $log.info(\"saveBlob method failed with the following exception:\");\n                $log.info(ex);\n            }\n\n            if (!success) {\n                // Get the blob url creator\n                var urlCreator = window.URL || window.webkitURL || window.mozURL || window.msURL;\n                if (urlCreator) {\n                    // Try to use a download link\n                    var link = document.createElement('a');\n                    if ('download' in link) {\n                        // Try to simulate a click\n                        try {\n                            // Prepare a blob URL\n                            var blob = new Blob([data], {\n                                type: contentType\n                            });\n                            var url = urlCreator.createObjectURL(blob);\n                            link.setAttribute('href', url);\n\n                            // Set the download attribute (Supported in Chrome 14+ / Firefox 20+)\n                            link.setAttribute(\"download\", filename);\n\n                            // Simulate clicking the download link\n                            var event = document.createEvent('MouseEvents');\n                            event.initMouseEvent('click', true, true, window, 1, 0, 0, 0, 0, false, false, false, false, 0, null);\n                            link.dispatchEvent(event);\n                            success = true;\n\n                        } catch (ex) {\n                            $log.info(\"Download link method with simulated click failed with the following exception:\");\n                            $log.info(ex);\n                        }\n                    }\n\n                    if (!success) {\n                        // Fallback to window.location method\n                        try {\n                            // Prepare a blob URL\n                            // Use application/octet-stream when using window.location to force download\n                            var blob = new Blob([data], {\n                                type: octetStreamMime\n                            });\n                            var url = urlCreator.createObjectURL(blob);\n                            window.location = url;\n                            success = true;\n                        } catch (ex) {\n                            $log.info(\"Download link method with window.location failed with the following exception:\");\n                            $log.info(ex);\n                        }\n                    }\n                }\n            }\n\n            if (!success) {\n                // Fallback to window.open method\n                $log.info(\"No methods worked for saving the arraybuffer, using last resort window.open\");\n                window.open(httpPath, '_blank', '');\n            }\n            return filename;\n        };\n\n\n\n        $scope.search2 = function(row){\n            //(angular.lowercase(row.first_name).indexOf(angular.lowercase($scope.my_search2) || '') !== -1)  || (angular.lowercase(row.last_name).indexOf(angular.lowercase($scope.my_search2) || '') !== -1)\n            ////console.log(\"answer\", (angular.lowercase(row.flight_date).indexOf(angular.lowercase($scope.my_search2) || '') !== -1));\n            // return ((angular.lowercase(row.flight_date).indexOf(angular.lowercase($scope.my_search2) || (angular.lowercase(row.flight_time).indexOf(angular.lowercase($scope.my_search2)) || '') !== -1)));\n            //(angular.lowercase(row.flight_date).indexOf(angular.lowercase($scope.my_search2) || '') !== -1)\n           \n            // if( (test_date($scope.my_search2, row.flight_date)) || (angular.lowercase(row.destination_airport).indexOf(angular.lowercase($scope.my_search2) || '') !== -1) || (angular.lowercase(row.departure_airport).indexOf(angular.lowercase($scope.my_search2) || '') !== -1) || (angular.lowercase(row.destination_airport_code).indexOf(angular.lowercase($scope.my_search2) || '') !== -1) || (angular.lowercase(row.departure_airport_code).indexOf(angular.lowercase($scope.my_search2) || '') !== -1)){\n            //     return true;\n            // } else {\n            //     return false;\n            // }test_aircraft\n\n            //console.log(\"TEST \" , test_date($scope.my_search2));\n\n            ////console.log($scope.my_search2);\n            if(!$scope.my_search2 || ($scope.my_search2 == \"\")){\n                return true;\n            } else if(test_date($scope.my_search2, row.entry_date)){\n                return true;\n            } else {\n                return false;\n            }\n\n            // we are testing for the date, the pilot, the departure and destination.\n\n            // return (angular.lowercase(row.flight_date).indexOf(angular.lowercase($scope.my_search2) || '') !== -1); // ? (angular.lowercase(row.flight_date).indexOf(angular.lowercase($scope.my_search2) || '') !== -1) : (angular.lowercase(row.flight_time).indexOf(angular.lowercase($scope.my_search2) || '') !== -1);\n\n        };\n\n        function test_date(search, date){\n\n\n            if(search.length < 2){\n                return false;\n            }\n\n            if(search && search.length <= 3){\n                if(date.indexOf(search) > -1){\n                    return true;\n                }\n            } else {\n                var parsed_date = \"\";\n                var b = moment(search);\n                if(b.isValid() && b.format(\"YYYY\") != \"2001\"){\n                    parsed_date = b.format(\"YYYY-MM-DD\");\n                } else if(b.isValid()){\n                    parsed_date = b.format(\"MM-DD\");\n                }\n\n\n                var search_type = 0;\n\n                if(parsed_date !== \"\" && date.indexOf(parsed_date) > -1){\n                    // //console.log(\"found\");\n                    return true;\n                } else {\n\n                    //backup in case of wrong parsing data::;\n                    //european method\n\n                    if(search.length <= 5 && search.length >= 4){\n\n                        var c = moment(search, \"DDMM\");\n                        // //console.log(\"C is : \", c);\n                        if(c.isValid()){\n                            var c2 = c.format(\"MM-DD\");\n                            if(date.indexOf(c2) > -1){\n                                return true;\n                            }\n                        }\n\n                    } else if(search.length == 8 || search.length == 10){\n                        \n                        var c = moment(search, \"DDMMYYYY\");\n                        // //console.log(\"C is : \", c);\n                        if(c.isValid()){\n                            var c2 = c.format(\"YYYY-MM-DD\");\n                            if(date.indexOf(c2) > -1){\n                                return true;\n                            }\n                        }\n\n                    }\n\n                    // //console.log(\"not found\");\n                    return false;\n                }\n            }\n\n        }\n\n        $scope.getMySearchCount = function(str){\n            var docs = str.documents;\n            var total = 0;\n            for(var i=0;i<docs.length;i++){\n                if($scope.search(docs[i])){\n                    total++;\n                }\n            }\n            return total;\n        }\n\n        $scope.getMySearchCount2 = function(str){\n            var charges = str.charges;\n            var total = 0;\n            for(var i=0;i<charges.length;i++){\n                if($scope.search(charges[i])){\n                    total++;\n                }\n            }\n            return total;\n        }\n\n\n    }\n app.controller('DashboardClubCourseController', DashboardClubCourseController);\n\n    DashboardClubCourseController.$inject = ['UserService', '$rootScope', '$location', '$scope', '$state', '$stateParams', '$uibModal', '$log', '$window', 'CourseService'];\n    function DashboardClubCourseController(UserService, $rootScope, $location, $scope, $state, $stateParams, $uibModal, $log, $window, CourseService) {\n        var vm = this;\n\n           //    /* PLEASE DO NOT COPY AND PASTE THIS CODE. */(function(){var w=window,C='___grecaptcha_cfg',cfg=w[C]=w[C]||{},N='grecaptcha';var gr=w[N]=w[N]||{};gr.ready=gr.ready||function(f){(cfg['fns']=cfg['fns']||[]).push(f);};(cfg['render']=cfg['render']||[]).push('explicit');(cfg['onload']=cfg['onload']||[]).push('initRecaptcha');w['__google_recaptcha_client']=true;var d=document,po=d.createElement('script');po.type='text/javascript';po.async=true;po.src='https://www.gstatic.com/recaptcha/releases/JPZ52lNx97aD96bjM7KaA0bo/recaptcha__en.js';var e=d.querySelector('script[nonce]'),n=e&&(e['nonce']||e.getAttribute('nonce'));if(n){po.setAttribute('nonce',n);}var s=d.getElementsByTagName('script')[0];s.parentNode.insertBefore(po, s);})();\n\n           // var initRecaptcha = function () { \n           //     // document.getElementById(\"SearchModule\").scope().vm.parent.isGrecaptchaLoaded = !0, \n           //     // document.getElementById(\"SearchModule\").scope().vm.showRecaptcha();\n           //     vm.showRecaptcha();\n           // };\n              \n\n\n        vm.charge_type = [\"brakes\", \"session\", \"plane\", \"brakes_rounded\"];\n\n        vm.user = null;\n        vm.allUsers = [];\n        vm.club = {\n            course: {\n                \n            }\n        };\n\n        vm.page_title = \"\";\n        \n        vm.course_document = {};\n        vm.course_documents = [];\n\n        var update_this_file = [];\n        \n       \n\n        vm.action = $state.current.data.action;\n        vm.user = $rootScope.globals.currentUser;\n        // //console.log(\"$rootScope.globals.currentUser : \", $rootScope.globals.currentUser);\n        vm.club_id = $rootScope.globals.currentUser.current_club_admin.id;\n        vm.user_id = vm.user.id;\n\n\n        vm.course_certificate = {};\n        vm.course_noise = {};\n        vm.course_radio = {};\n        vm.course_maintenance = {};\n        vm.course_insurance = {};\n\n        vm.club.lessons = [];\n        vm.exams = [];\n        vm.tags = [];\n        vm.instructor_charges = [];\n\n        // //console.log(vm.action);\n        // //console.log($stateParams);\n        // //console.log($stateParams.id);\n\n\n        vm.editing = false;\n        vm.edit_course = false;\n\n        switch(vm.action){\n            case \"add\":\n                //console.log(\"adding a new course please\");\n                vm.page_title = \"Add a New Course\";\n            break;\n            case \"edit\":\n                vm.editing = true;\n                vm.edit_course = true;\n                //console.log(\"edit an existing course\");\n\n\n                CourseService.GetCourseById($stateParams.course_id)\n                    .then(function(data){\n                        vm.club.course = data.item;   \n            \n                        vm.page_title = \"Edit a Course - \"+vm.club.course.title;\n                    });\n \n                    CourseService.GetLessonsByCourseId($stateParams.course_id)\n                    .then(function(data){\n                        vm.club.lessons = data.items;   \n            \n\n\n                    });\n\n                      refresh_exams();\n                      refresh_tags();\n                      refresh_charges();\n\n\n\n            break;\n            case \"list\":\n                //need to update this to be part of the authentication\n                //to find out club id\n                CourseService.GetCoursesByClubId(vm.club_id)\n                    .then(function(data){\n                        vm.club.courses = data.items;   \n                        //console.log(vm.club.courses);\n                    });\n            break;\n            default:\n                //console.log(\"none of the above... redirect somewhere?\");\n            break;\n        }  \n\n        function refresh_exams(){\n             CourseService.GetExamsByCourseId($stateParams.course_id)\n                    .then(function(data){\n                        vm.exams = data.items;   \n                \n\n\n                    });\n        }\n\n        function refresh_tags(){\n             CourseService.GetTagsByCourseId($stateParams.course_id)\n                    .then(function(data){\n                        vm.tags = data.items;   \n                \n\n\n                    });\n        }\n\n        function refresh_charges(){\n\n                 CourseService.GetChargesByCourseId($stateParams.course_id)\n                    .then(function(data){\n                        vm.instructor_charges = data.items;   \n                \n\n\n                    });\n        }\n\n        //'9' needs to refer the the user's account set to manage\n       \n        $scope.back = function(){\n            $window.history.back();\n        }\n\n\n\n        $scope.save = function(){\n            if(vm.action == \"add\"){\n                //console.log(\"CREATE click\");\n                $scope.create();\n            } else {\n                //console.log(\"EDIT click\");\n                //console.log(vm.club.course);\n                $scope.update();\n            }\n        }\n\n        \n        $scope.save_lesson_order = function(){\n            // //console.log(\"hiya\");\n            var update_order = [];\n            for(var i=0; i < vm.club.lessons.length;i++){\n                var me = {\n                    id: vm.club.lessons[i].id,\n                    organise: i\n                }\n                update_order.push(me);\n            }\n            // //console.log(\"organised: \", update_order);\n\n            CourseService.UpdateLessonOrder({\"order\": update_order})\n                .then(function(data){\n                    //console.log(data);\n\n                    // vm.items = data.items;\n                    //$state.go('dashboard.manage_club.edit_lesson', {course_id: vm.club.lesson.course_id, lesson_id: data.id, reload: true});\n\n                });\n\n        }\n\n        vm.delete_lesson = function(id, index){\n\n            if(confirm(\"Are you sure you wish to delete this lesson? This is irreversible.\")){\n                CourseService.DeleteLesson(id)\n                .then(function(data){\n                    //console.log(data);\n                    if(data.success){\n                        vm.club.lessons.splice(index, 1);\n                    } else {\n                        alert(\"An error occurred...\");\n                    }\n                    //$state.go('dashboard.manage_club.edit_lesson', {course_id: vm.club.lesson.course_id, lesson_id: data.id, reload: true});\n                });\n            }\n\n            \n        }\n\n        vm.update_exam = function(exam, index){\n\n            delete(exam.edit_me);\n\n            CourseService.UpdateExam(exam)\n                .then(function(data){\n                    //console.log(data);\n                    if(data.success){\n\n                        vm.exams[index].edit_me = false;\n\n                    } else {\n                        alert(\"An error occurred...\");\n                    }\n                    //refresh_tem();\n                    //$state.go('dashboard.manage_club.edit_lesson', {course_id: vm.club.lesson.course_id, lesson_id: data.id, reload: true});\n                });\n        }\n\n        vm.update_cancel = function(index){\n            refresh_exams();\n        }\n\n        vm.edit_exam = function(index){\n\n            vm.exams[index].edit_me = true;\n\n        }\n\n        vm.delete_exam = function(exam, index){\n            // //console.log(\"EXAM\", exam);\n            if(confirm(\"Are you sure you wish to delete this exam? This is irreversible.\")){\n\n                CourseService.DeleteExam(exam.id)\n                    .then(function(data){\n                        //console.log(data);\n                        if(data.success){\n                            vm.exams.splice(index, 1);\n                        } else {\n                            alert(\"An error occurred...\");\n                        }\n                        //$state.go('dashboard.manage_club.edit_lesson', {course_id: vm.club.lesson.course_id, lesson_id: data.id, reload: true});\n                    });\n            }\n        }\n\n       \n        \n        vm.add_exam = function(){\n\n            vm.new_exam.course_id = $stateParams.course_id; \n            vm.new_exam.club_id = vm.club_id; \n\n            CourseService.CreateExam(vm.new_exam)\n                .then(function(data){\n                    //console.log(data);\n                    if(data.success){\n\n                        vm.exams.push(data.item);\n\n                        vm.new_exam = {\n                            title: \"\",\n                            description: \"\"\n                        }\n\n                    } else {\n                        alert(\"An error occurred...\");\n                    }\n\n                    //$state.go('dashboard.manage_club.edit_lesson', {course_id: vm.club.lesson.course_id, lesson_id: data.id, reload: true});\n\n                });\n        }\n\n\n\n\n\n\n        vm.update_tag = function(tag, index){\n\n            alert(\"This tag being removed will not remove the tag from previous flights where this tag was already applied.\");\n\n            delete(tag.edit_me);\n\n            CourseService.UpdateTags(tag)\n                .then(function(data){\n                    //console.log(data);\n                    if(data.success){\n\n                        vm.tags[index].edit_me = false;\n\n                    } else {\n                        alert(\"An error occurred...\");\n                    }\n                    //refresh_tem();\n                    //$state.go('dashboard.manage_club.edit_lesson', {course_id: vm.club.lesson.course_id, lesson_id: data.id, reload: true});\n                });\n        }\n\n        vm.update_cancel_tag = function(index){\n            refresh_tags();\n        }\n\n        vm.edit_tag = function(index){\n\n            vm.tags[index].edit_me = true;\n\n        }\n\n        vm.delete_tag = function(tag, index){\n            // //console.log(\"EXAM\", exam);\n            if(confirm(\"Are you sure you wish to delete this tag? If this tag has already been assigned to particular flight(s) this will not remove these from existing flights.\")){\n\n                CourseService.DeleteTags(tag.id)\n                    .then(function(data){\n                        //console.log(data);\n                        if(data.success){\n                            vm.tags.splice(index, 1);\n                        } else {\n                            alert(\"An error occurred...\");\n                        }\n                        //$state.go('dashboard.manage_club.edit_lesson', {course_id: vm.club.lesson.course_id, lesson_id: data.id, reload: true});\n                    });\n            }\n        }\n\n       \n        \n        vm.add_tag = function(){\n\n            vm.new_tag.course_id = $stateParams.course_id; \n            vm.new_tag.club_id = vm.club_id; \n\n            CourseService.CreateTags(vm.new_tag)\n                .then(function(data){\n                    //console.log(data);\n                    if(data.success){\n\n                        vm.tags.push(data.item);\n\n                        vm.new_tag = {\n                            title: \"\"\n                        }\n\n                    } else {\n                        alert(\"An error occurred...\");\n                    }\n\n                    //$state.go('dashboard.manage_club.edit_lesson', {course_id: vm.club.lesson.course_id, lesson_id: data.id, reload: true});\n\n                });\n        }\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n        vm.update_charge = function(charge, index){\n\n            delete(charge.edit_me);\n\n            CourseService.UpdateCharge(charge)\n                .then(function(data){\n                    //console.log(data);\n                    if(data.success){\n\n                        vm.instructor_charges[index].edit_me = false;\n\n                    } else {\n                        alert(\"An error occurred...\");\n                    }\n                    //refresh_tem();\n                    //$state.go('dashboard.manage_club.edit_lesson', {course_id: vm.club.lesson.course_id, lesson_id: data.id, reload: true});\n                });\n        }\n\n        vm.update_cancel_charge = function(index){\n            refresh_charges();\n        }\n\n        vm.edit_charge = function(index){\n\n            vm.instructor_charges[index].edit_me = true;\n\n        }\n\n        vm.delete_charge = function(charge, index){\n            // //console.log(\"EXAM\", exam);\n            if(confirm(\"Are you sure you wish to delete this instructor charge? This is irreversible.\")){\n\n                CourseService.DeleteCharge(charge.id)\n                    .then(function(data){\n                        //console.log(data);\n                        if(data.success){\n                            vm.instructor_charges.splice(index, 1);\n                        } else {\n                            alert(\"An error occurred...\");\n                        }\n                        //$state.go('dashboard.manage_club.edit_lesson', {course_id: vm.club.lesson.course_id, lesson_id: data.id, reload: true});\n                    });\n            }\n        }\n\n       \n        \n        vm.add_charge = function(){\n\n            vm.new_charge.course_id = $stateParams.course_id; \n            vm.new_charge.club_id = vm.club_id; \n\n            CourseService.CreateCharge(vm.new_charge)\n                .then(function(data){\n                    //console.log(data);\n                    if(data.success){\n\n                        vm.instructor_charges.push(data.item);\n\n                        vm.new_charge = {\n                            title: \"\",\n                            charge_type: \"\",\n                            price: \"\"\n                        }\n\n                    } else {\n                        alert(\"An error occurred...\");\n                    }\n\n                    //$state.go('dashboard.manage_club.edit_lesson', {course_id: vm.club.lesson.course_id, lesson_id: data.id, reload: true});\n\n                });\n        }\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n         vm.delete_course = function(id, index){\n            if(confirm(\"Are you sure you wish to delete this course? This is irreversible.\")){\n\n                CourseService.DeleteCourse(id)\n                    .then(function(data){\n                        //console.log(data);\n                        if(data.success){\n                            vm.club.courses.splice(index, 1);\n                        } else {\n                            alert(\"An error occurred...\");\n                        }\n                        //$state.go('dashboard.manage_club.edit_lesson', {course_id: vm.club.lesson.course_id, lesson_id: data.id, reload: true});\n                    });\n            } \n        }\n\n        $scope.create = function(){\n            ////console.log(\"CREATE ME NOW\");\n         \n            //return false;\n            //return false;\n            vm.club.course.club_id = vm.club_id;\n\n            CourseService.CreateCourse(vm.club.course)\n                .then(function(data){\n                    ////console.log(data);\n                    if(data.success){\n                        $state.go('dashboard.manage_club.edit_course', {course_id: data.id, reload: true});\n                    }\n\n                });\n\n\n        }\n\n        $scope.delete = function(){\n            //console.log(\"CLICK\");\n            alert(\"Are you sure you would like to delete this course?\");\n            CourseService.DeleteCourse(vm.club.course.id)\n                .then(function(data){\n                    //console.log(data);\n                });\n        }\n\n        function get_update_docs(){\n            var documents = [];\n\n            for(var i=0;i<update_this_file.length;i++){\n                var id = update_this_file[i];\n                //console.log(\"looking for : \", id);\n                //console.log(\"in: \", vm.course_documents);\n\n                for(var k=0;k<vm.club.course.course_documents.length;k++){\n                    //console.log(\"comparing to : \", vm.club.course.course_documents[k].id);\n                    if(vm.club.course.course_documents[k].id == id){\n                        documents.push(vm.club.course.course_documents[k]);\n                    }\n                }\n\n            }\n\n            // //console.log(\"DOCS TO UPDATE : \", documents);\n\n            return documents;\n        }\n\n        $scope.update = function(){\n            //console.log(\"CLICK\");\n         \n\n            CourseService.UpdateCourse(vm.club.course)\n                .then(function(data){\n                    //console.log(data);\n                    //console.log(\"saved\");\n                    $state.go('dashboard.manage_club.courses');\n                });\n        }\n\n\n        function containsObject(obj, list, params) {\n\n            // //console.log(\"obj\", obj);\n            // //console.log(\"list\", list);\n            // //console.log(\"params\", params);\n\n            for(var i=0; i<list.length; i++) {\n                // //console.log(\"list i : \", list[i]);\n                // //console.log(\"obj is: \", obj);\n\n                var count_success = 0;\n                for(var j=0;j<params.length;j++){\n                    if(list[i][params[j]] && obj[params[j]] && list[i][params[j]] == obj[params[j]]){\n                        count_success++;\n                    }\n                }\n\n                if(count_success === params.length) {                    \n                    return true;\n                }\n            }\n\n            return false;\n        }\n\n\n       \n\n        $scope.add_item = function(type){\n            //console.log(\"ADD\");\n            switch(type){\n                case \"licence\":\n                    //console.log(\"licence\");\n                    if(vm.temporary.licence && vm.temporary.licence !== \"\" && vm.temporary.rating && vm.temporary.rating !== \"\"){\n                        //then we can add it\n                        //console.log(\"here we go\");\n                        var add_licence = {\n                            licence_id: vm.temporary.licence.id,\n                            licence_title: vm.temporary.licence.abbreviation,\n                            rating_title: vm.temporary.rating.abbreviation,\n                            rating_id: vm.temporary.rating.id\n                        };\n\n                        //check if it doesnt exist first...\n                        if(containsObject(add_licence, vm.club.course.requirements.licence, new Array(\"licence_id\", \"rating_id\")) == false){\n                            vm.club.course.requirements.licence.push(add_licence);\n                        }\n\n                        delete vm.temporary.licence;\n                        delete vm.temporary.rating;\n\n                    } else {\n                        alert(\"Please select a licence and rating that is required to book the course solo!\");\n                    }\n\n                break;\n\n\n                case \"medical\":\n                    //console.log(\"medical\");\n                    if(vm.temporary.medical_authority && vm.temporary.medical_authority !== \"\" && vm.temporary.medical_component && vm.temporary.medical_component !== \"\"){\n                        //then we can add it\n                        //console.log(\"here we go\");\n                        var add_medical = {\n                            authority_id: vm.temporary.medical_authority.id,\n                            authority_title: vm.temporary.medical_authority.abbreviation,\n                            medical_component_id: vm.temporary.medical_component.id,\n                            medical_component_title: vm.temporary.medical_component.title\n                        };\n\n                        //check if it doesnt exist first...\n                        if(containsObject(add_medical, vm.club.course.requirements.medical, new Array(\"authority_id\", \"medical_component_id\")) == false){\n                            vm.club.course.requirements.medical.push(add_medical);\n                        }\n\n                        delete vm.temporary.medical_authority;\n                        delete vm.temporary.medical_component;\n\n                    } else {\n                        alert(\"Please select a medical that is required to book the course solo!\");\n                    }\n\n                break;\n\n\n                case \"differences\":\n                    //console.log(\"difference\");\n                    if(vm.temporary.difference && vm.temporary.difference !== \"\"){\n                        //then we can add it\n                        //console.log(\"here we go\");\n                        var add_difference = {\n                            difference_id: vm.temporary.difference.id,\n                            difference_title: vm.temporary.difference.title\n                        };\n\n                        //check if it doesnt exist first...\n                        if(containsObject(add_difference, vm.club.course.requirements.differences, new Array(\"difference_id\", \"difference_title\")) == false){\n                            vm.club.course.requirements.differences.push(add_difference);\n                        }\n\n                        delete vm.temporary.difference;\n\n                    } else {\n                        alert(\"Please select a difference that is required to book the course solo!\");\n                    }\n\n                break;\n\n\n            }\n\n\n\n        }\n\n\n\n\n\n\n\n\n\n\n\n\n\n        $scope.update_this_file = function(file){\n            //console.log(\"==== update is : \", file.id);\n            if(update_this_file.indexOf(file.id) === -1){\n                update_this_file.push(file.id)\n            } else {\n               ////console.log(\"This item already exists\"); \n            } \n        }\n\n\n         $scope.remove_real_file = function(file){\n\n                //remove_file\n\n                vm.club.course.course_documents = $.grep(vm.club.course.course_documents, function(e){ \n                        return e.id != file.id; \n                    });\n\n                //no need to actually remove the file as it will be archived accordingly on the backend whilst it is missing! :)\n                PlaneDocumentService.Delete(vm.user_id, file.id)\n                .then(function (data) {\n                    //console.log(data);\n                    if(data.success){\n                        //console.log(\"HUZZAH\", current_files);\n                        //then we need to remove this from the list of files...\n                        //clear files\n                        vm.course_documents = [];\n                        //and re-process available files\n                        $scope.processFiles(current_files);\n\n                    } else {\n                        //console.log(\"WOOOPSIES...\");\n                        //this should be very very rare...\n                    }\n\n                });\n\n          }\n\n\n        vm.files = {\n            radio: [],\n            cert: [],\n            insurance: [],\n            noise: []\n        }\n\n\n           $scope.processFile = function(files, location){\n                 //console.log(\"files\", files[0].file_return);\n\n                     // //console.log(\"JSON\", files[i].file_return);\n                    var j = JSON.parse(files[0].file_return);\n                     ////console.log(\"PARSED\", j);\n                    // //console.log(\"J is : \",j);\n                    // //console.log(\"name is : \", j.files.file.name);\n\n                    files[0].file.temp_path = j.saved_url;\n                    files[0].file.save_name = j.files.file.name;\n\n                    var ft = j.files.file.name;\n                    //console.log(\"ft\", ft);\n                    var fft = ft.split('.').pop();\n                    files[0].file.extension = fft;\n                    //console.log(\"FILE is : \", files[0]);\n\n                    // //console.log(\"file\", files[i].file);\n                    vm.files[location].push(files[0].file);\n\n\n            }\n\n            $scope.set_title = function(file){\n                //console.log(\"return\", file);\n                return file.save_name;\n            }\n\n\n          \n          $scope.remove_file = function(file, current_files){\n\n            //remove_file\n            var j = JSON.parse(file.file_return);\n            //console.log(\"REMOVE: \", j);\n            //console.log(\"REMOVE: \", j.saved_url);\n\n            //to delete the temp file created: j.saved_url\n            //tmp_rm.php POST tmp = filename\n            \n            PoidService.DeleteTmp(j.saved_url)\n                .then(function (data) {\n                    //console.log(data);\n                    if(data.success){\n                        //console.log(\"HUZZAH\", current_files);\n                        //then we need to remove this from the list of files...\n                        //clear files\n                        vm.course_documents = [];\n                        //and re-process available files\n                        $scope.processFiles(current_files);\n\n                    } else {\n                        //console.log(\"WOOOPSIES...\");\n                        //this should be very very rare...\n                    }\n\n                });\n\n          }\n          \n\n          // $scope.$on('flow::fileAdded', function (event, $flow, flowFile) {\n          //     event.preventDefault();//prevent file from uploading\n          //     //console.log(\"FILE ADDED\");\n          //     //console.log($flow);\n          //   });\n\n            $scope.processFiles = function(files){\n                // //console.log(\"files\", files);\n\n                for(var i=0; i<files.length; i++){\n                    // //console.log(\"JSON\", files[i].file_return);\n                    var j = JSON.parse(files[i].file_return);\n                    // //console.log(\"PARSED\", j);\n                    //console.log(\"J is : \",j);\n                    //console.log(\"name is : \", j.files.file.name);\n\n                    files[i].file.temp_path = j.saved_url;\n                    files[i].file.save_name = j.files.file.name;\n                    var ft = j.files.file.name;\n                    ft = ft.split('.').pop();\n                    files[i].file.extension = ft;\n\n                    // //console.log(\"file\", files[i].file);\n                    vm.course_documents.push(files[i].file);\n                }\n\n\n            }\n\n            $scope.set_title = function(file){\n                //console.log(\"return\", file);\n                return file.save_name;\n            }\n\n            $scope.get_icon = function(file){\n\n                var ft = file.name;\n                ft = ft.split('.').pop();\n                var icon_name = \"\";\n\n                // //console.log(\"FILE:\", ft);\n                // //console.log(\"index : \", ft.indexOf(\"pdf\"));\n                switch(true){\n                    case (ft.indexOf(\"pdf\") > -1):\n                        icon_name = \"pdf.png\";\n                    break;\n                    case (ft.indexOf(\"doc\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"docx\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"xls\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"xlsx\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"ppt\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"pptx\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"jpg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"jpeg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"png\") > -1):\n                        icon_name = \"png.png\";\n                    break;\n                    case (ft.indexOf(\"gif\") > -1):\n                        icon_name = \"gif.png\";\n                    break;\n                    case (ft.indexOf(\"zip\") > -1):\n                        icon_name = \"zip.png\";\n                    break;\n                    case (ft.indexOf(\"avi\") > -1):\n                        icon_name = \"avi.png\";\n                    break;\n                    case (ft.indexOf(\"mp4\") > -1):\n                        icon_name = \"mp4.png\";\n                    break;\n                    default:\n                        icon_name = \"file.png\";\n                    break;\n                }\n\n                // //console.log(\"FILE:\", icon_name);\n\n                return \"images/file_icons/\"+icon_name;\n            }\n\n\n            $scope.get_icon2 = function(file){\n\n                var ft = file.split('.').pop();\n                // //console.log(\"ICON 2 : \", ft);\n                var icon_name = \"\";\n\n                // //console.log(\"FILE:\", ft);\n                // //console.log(\"index : \", ft.indexOf(\"pdf\"));\n                switch(true){\n                    case (ft.indexOf(\"pdf\") > -1):\n                        icon_name = \"pdf.png\";\n                    break;\n                    case (ft.indexOf(\"doc\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"docx\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"xls\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"xlsx\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"ppt\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"pptx\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"jpg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"jpeg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"png\") > -1):\n                        icon_name = \"png.png\";\n                    break;\n                    case (ft.indexOf(\"gif\") > -1):\n                        icon_name = \"gif.png\";\n                    break;\n                    case (ft.indexOf(\"zip\") > -1):\n                        icon_name = \"zip.png\";\n                    break;\n                    case (ft.indexOf(\"avi\") > -1):\n                        icon_name = \"avi.png\";\n                    break;\n                    case (ft.indexOf(\"mp4\") > -1):\n                        icon_name = \"mp4.png\";\n                    break;\n                    default:\n                        icon_name = \"file.png\";\n                    break;\n                }\n\n                // //console.log(\"FILE:\", icon_name);\n\n                return \"images/file_icons/\"+icon_name;\n            }\n\n\n\n\n\n        initController();\n\n        function initController() {\n           //console.log(\"check if access is okay\");\n        }\n\n\n       \n\n\n    }\n app.controller('DashboardClubEngineLogbookController', DashboardClubEngineLogbookController);\n\n    DashboardClubEngineLogbookController.$inject = ['UserService', 'PlaneService', '$rootScope', '$location', '$scope', '$state', '$stateParams', '$uibModal', '$log', '$window', 'LicenceService', 'MedicalService', 'DifferencesService', 'PlaneDocumentService', '$http'];\n    function DashboardClubEngineLogbookController(UserService, PlaneService, $rootScope, $location, $scope, $state, $stateParams, $uibModal, $log, $window, LicenceService, MedicalService, DifferencesService, PlaneDocumentService, $http) {\n        var vm = this;\n\n       \n        \n        switch(vm.action){\n            case \"add\":\n                // //console.log(\"adding a new plane please\");\n                vm.page_title = \"Add a New Plane\";\n            break;\n            case \"edit\":\n                // //console.log(\"edit an existing plane\");\n                \n                PlaneService.GetByIdMaintenance2($stateParams.plane_id, vm.club_id)\n                    .then(function(data){\n                        vm.club.plane = data;  \n                        vm.this_plane_id = $stateParams.plane_id; \n\n                        if(vm.club.plane && vm.club.plane.maintenance){\n                            //console.log(\"vm.club.plane == > \", vm.club.plane);\n                            vm.obj.hours_remaining = vm.club.plane.maintenance.hours_remaining;\n                            vm.obj.next_check = new Date(vm.club.plane.maintenance.next_maintenance);\n                            vm.obj.check_date = new Date();\n                            vm.obj.extension_granted = new Date();\n                        }\n                       \n\n                        // vm.club.plane.requirements = {\n                        //         licence: [],\n                        //         medical: [],\n                        //         differences: [],\n                        //         hours: []\n                        // };\n                        // //console.log(\"BOOOO - get all planes....\");\n                        vm.page_title = \"Edit a Plane Maintenance - \"+vm.club.plane.registration;\n                    });\n\n                PlaneService.GetOpenIssues($stateParams.plane_id)\n                    .then(function (data) {\n                            ////console.log(\"data is : \", data);\n                           vm.reported_defects = data;\n                        });\n\n\n               \n\n\n            break;\n            case \"list\":\n                //need to update this to be part of the authentication\n                //to find out club id\n                // PlaneService.GetAllByClubMaintenance(vm.club_id)\n                //     .then(function(data){\n                //         vm.club.planes = data;   \n                //         // //console.log(vm.club.planes);\n                //     });\n            break;\n            default:\n                //console.log(\"none of the above... redirect somewhere?\");\n            break;\n        }  \n\n       \n\n        $scope.get_hours_from_decimal = function(time){\n\n            if(time){\n                 var sign = time < 0 ? \"-\" : \"\";\n                 var hour = Math.floor(Math.abs(time));\n                 var min = Math.round((Math.abs(time) * 60) % 60);\n                 if(min == 60){\n                     hour++;\n                     min = 0;\n                 }\n                 return sign + (hour < 10 ? \"0\" : \"\") + hour + \":\" + (min < 10 ? \"0\" : \"\") + min;\n             } else {\n                 return \"N/A\";\n             }\n            \n\n        }\n\n\n        // PlaneService.GetAircraftJourneyLogs($stateParams.plane_id, 0, 25)\n        //     .then(function (data) {\n        //             // //console.log(\"ALL is : \", data);\n        //            // vm.logs = data.logs;\n        //            vm.aircraft = data.aircraft;\n        //             if(vm.aircraft.engine_2_id > 0){\n        //                if(vm.aircraft.engine_2_id == $stateParams.engine_id){\n        //                    vm.multiple = 2;\n        //                } else {\n        //                    vm.multiple = 1;\n        //                }\n        //            }\n\n        //         });\n\n\n            PlaneService.GetEngineLogs($stateParams.engine_id,$stateParams.plane_id, 0, 25)\n            .then(function (data) {\n                    // //console.log(\"ALL is : \", data);\n                   vm.logs = data.logs;\n                   vm.engine = data.engine;\n\n\n                });\n\n            vm.current_offset = 0;\n            vm.loaded_per_batch = 25;\n            vm.all_loaded = false;\n\n            vm.load_more = function(){\n                vm.current_offset = vm.current_offset + vm.loaded_per_batch;\n                PlaneService.GetEngineLogs($stateParams.engine_id,$stateParams.plane_id, vm.current_offset, vm.loaded_per_batch)\n                .then(function (data) {\n                        // //console.log(\"ALL is : \", data);\n                        if(data.logs.length > 0){\n                            data.logs.forEach(log => vm.logs.push(log));\n                        } else {\n                            vm.all_loaded = true;\n                        }\n                       //vm.logs = data.logs;\n                       vm.engine = data.engine;\n\n\n                    });\n\n            }\n\n            vm.get_initial = function(text){\n                return text.charAt(0);\n            }\n\n\n            vm.clean_times = function(time){\n                if(time == \"00:00:00\"){\n                    return \" - \";\n                }\n                return time.substring(0,5);\n            }\n\n            vm.update_logbooks = function(){\n                \n\n                PlaneService.UpdateAircraftLogbooks($stateParams.plane_id)\n                .then(function (data) {\n                        \n                        if(data.success){\n\n                            //lets reload the logbook elements!!\n                            PlaneService.GetEngineLogs($stateParams.engine_id,$stateParams.plane_id, 0, 25)\n                            .then(function (data) {\n                                    // //console.log(\"ALL is : \", data);\n                                   vm.logs = data.logs;\n                                   vm.engine = data.engine;\n                                   alert(\"The logbook has been re-checked\");\n\n                                });\n\n                        }\n\n\n                    });\n            }\n\n\n\n\n\n        $scope.update_this_file = function(file){\n            //console.log(\"==== update is : \", file.id);\n            if(update_this_file.indexOf(file.id) === -1){\n                update_this_file.push(file.id)\n            } else {\n               ////console.log(\"This item already exists\"); \n            } \n        }\n\n\n         $scope.remove_real_file = function(file){\n\n                //remove_file\n\n                vm.club.plane.plane_documents = $.grep(vm.club.plane.plane_documents, function(e){ \n                        return e.id != file.id; \n                    });\n\n                //no need to actually remove the file as it will be archived accordingly on the backend whilst it is missing! :)\n                PlaneDocumentService.Delete(vm.user_id, file.id)\n                .then(function (data) {\n                    // //console.log(data);\n                    if(data.success){\n                        // //console.log(\"HUZZAH\", current_files);\n                        //then we need to remove this from the list of files...\n                        //clear files\n                        vm.plane_documents = [];\n                        //and re-process available files\n                        $scope.processFiles(current_files);\n\n                    } else {\n                        //console.log(\"WOOOPSIES...\");\n                        //this should be very very rare...\n                    }\n\n                });\n\n          }\n\n\n          \n          $scope.remove_file = function(file, current_files){\n\n            //remove_file\n            var j = JSON.parse(file.file_return);\n            // //console.log(\"REMOVE: \", j);\n            // //console.log(\"REMOVE: \", j.saved_url);\n\n            //to delete the temp file created: j.saved_url\n            //tmp_rm.php POST tmp = filename\n            \n\n            //this SHOULD BE TO THE CURRENT POSITION\n\n            // PoidService.DeleteTmp(j.saved_url)\n            //     .then(function (data) {\n            //         //console.log(data);\n            //         if(data.success){\n            //             //console.log(\"HUZZAH\", current_files);\n            //             //then we need to remove this from the list of files...\n            //             //clear files\n            //             vm.plane_documents = [];\n            //             //and re-process available files\n            //             $scope.processFiles(current_files);\n\n            //         } else {\n            //             //console.log(\"WOOOPSIES...\");\n            //             //this should be very very rare...\n            //         }\n\n            //     });\n\n          }\n          \n\n          // $scope.$on('flow::fileAdded', function (event, $flow, flowFile) {\n          //     event.preventDefault();//prevent file from uploading\n          //     //console.log(\"FILE ADDED\");\n          //     //console.log($flow);\n          //   });\n\n            vm.files = {\n                radio: [],\n                cert: [],\n                insurance: []\n            }\n\n\n            $scope.processFiles = function(files, location){\n                // //console.log(\"files\", files);\n\n                for(var i=0; i<files.length; i++){\n                    // //console.log(\"JSON\", files[i].file_return);\n                    var j = JSON.parse(files[i].file_return);\n                    // //console.log(\"PARSED\", j);\n                    // //console.log(\"J is : \",j);\n                    // //console.log(\"name is : \", j.files.file.name);\n\n                    files[i].file.temp_path = j.saved_url;\n                    files[i].file.save_name = j.files.file.name;\n                    var ft = j.files.file.name;\n                    ft = ft.split('.').pop();\n                    files[i].file.extension = ft;\n\n                    // //console.log(\"file\", files[i].file);\n                    vm.files[location].push(files[i].file);\n                }\n\n\n            }\n\n\n             $scope.processFile = function(files, location){\n                 //console.log(\"files\", files[0].file_return);\n\n                    // //console.log(\"JSON\", files[i].file_return);\n                    var j = JSON.parse(files[0].file_return);\n                    // //console.log(\"PARSED\", j);\n                    // //console.log(\"J is : \",j);\n                    // //console.log(\"name is : \", j.files.file.name);\n\n                    files[0].file.temp_path = j.saved_url;\n                    files[0].file.save_name = j.files.file.name;\n\n                    var ft = j.files.file.name;\n                    // //console.log(\"ft\", ft);\n                    var fft = ft.split('.').pop();\n                    files[0].file.extension = fft;\n                    // //console.log(\"FILE is : \", files[0]);\n\n                    // //console.log(\"file\", files[i].file);\n                    vm.files[location].push(files[0]);\n\n\n            }\n\n            $scope.set_title = function(file){\n                // //console.log(\"return\", file);\n                return file.save_name;\n            }\n\n            $scope.get_icon = function(file){\n\n                var ft = file.name;\n                ft = ft.split('.').pop();\n                var icon_name = \"\";\n\n                // //console.log(\"FILE:\", ft);\n                // //console.log(\"index : \", ft.indexOf(\"pdf\"));\n                switch(true){\n                    case (ft.indexOf(\"pdf\") > -1):\n                        icon_name = \"pdf.png\";\n                    break;\n                    case (ft.indexOf(\"doc\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"docx\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"xls\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"xlsx\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"ppt\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"pptx\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"jpg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"jpeg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"png\") > -1):\n                        icon_name = \"png.png\";\n                    break;\n                    case (ft.indexOf(\"gif\") > -1):\n                        icon_name = \"gif.png\";\n                    break;\n                    case (ft.indexOf(\"zip\") > -1):\n                        icon_name = \"zip.png\";\n                    break;\n                    case (ft.indexOf(\"avi\") > -1):\n                        icon_name = \"avi.png\";\n                    break;\n                    case (ft.indexOf(\"mp4\") > -1):\n                        icon_name = \"mp4.png\";\n                    break;\n                    default:\n                        icon_name = \"file.png\";\n                    break;\n                }\n\n                // //console.log(\"FILE:\", icon_name);\n\n                return \"images/file_icons/\"+icon_name;\n            }\n\n\n            $scope.get_icon2 = function(file){\n                ////console.log(\"FILE\", file);\n                if(!file || file == \"\"){\n                    return \"\";\n                }\n                var ft = file.split('.').pop();\n                // //console.log(\"ICON 2 : \", ft);\n                var icon_name = \"\";\n\n                // //console.log(\"FILE:\", ft);\n                // //console.log(\"index : \", ft.indexOf(\"pdf\"));\n                switch(true){\n                    case (ft.indexOf(\"pdf\") > -1):\n                        icon_name = \"pdf.png\";\n                    break;\n                    case (ft.indexOf(\"doc\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"docx\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"xls\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"xlsx\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"ppt\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"pptx\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"jpg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"jpeg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"png\") > -1):\n                        icon_name = \"png.png\";\n                    break;\n                    case (ft.indexOf(\"gif\") > -1):\n                        icon_name = \"gif.png\";\n                    break;\n                    case (ft.indexOf(\"zip\") > -1):\n                        icon_name = \"zip.png\";\n                    break;\n                    case (ft.indexOf(\"avi\") > -1):\n                        icon_name = \"avi.png\";\n                    break;\n                    case (ft.indexOf(\"mp4\") > -1):\n                        icon_name = \"mp4.png\";\n                    break;\n                    default:\n                        icon_name = \"file.png\";\n                    break;\n                }\n\n                // //console.log(\"FILE:\", icon_name);\n\n                return \"images/file_icons/\"+icon_name;\n            }\n\n\n            vm.defect_severity;\n                vm.defect_severities = [\n                    { title: \"No Fly Item - Ground the plane\"},\n                    { title: \"Flyable - needs to be checked at next maintenance\"},\n                    { title: \"Not urgent - but needs noting\"},\n                    { title: \"Unsure of severity\"}\n                ]; \n\n\n            $scope.delete_poid = function(id){\n\n              \n                var a = prompt(\"Are you sure you wish to delete this poid? \\n\\n This change is irreversible! To confirm please type YES in the box below.\");\n                if(a == \"YES\"){\n\n\n                    //console.log(\"WE DELETE IT\");\n\n\n                    // PoidService.Delete(vm.user_id, id)\n                    //     .then(function (data) {\n                    //         //console.log(data);\n                    //         if(data.success){\n                    //             //console.log(\"HUZZAH\", data);\n                    //             //then we need to remove this from the list of files...\n                    //             vm.user_poids = $.grep(vm.user_poids, function(e){ \n                    //                 return e.id != id; \n                    //             });\n                                \n                    //             //refresh?\n                    //             $state.reload();\n                    //             $state.go('dashboard.my_account.poid');\n\n                    //         } else {\n\n                    //             alert(\"Something went terribly wrong... \\n\\n \"+data.message);\n\n                    //         }\n\n                    //     });\n\n\n\n                } else {\n                    //console.log(\"ignore123\");\n                }\n\n\n            }\n\n\n\n\n            $scope.save_plane_documents = function(){\n\n               \n              \n\n                // //console.log(\"plane_documents: \", vm.plane_documents);\n\n\n                //compile the required elements YAY\n\n                // //console.log(\"plane_document \", vm.plane_document);\n\n\n                 //clean shizzle before sending\n                 //why keep sending back heavy data?\n\n                    // for(var i=0;i<vm.plane_document.images.length;i++){\n                    //     delete vm.plane_document.images[i].data_uri;\n                    // }\n\n                    // // vm.plane_document.images = vm.plane_documents;\n                    // vm.plane_document.images = vm.plane_document.images.concat(vm.plane_documents);\n                    // vm.plane_document.user_id = vm.user_id;\n\n\n\n\n            //     if(vm.plane_document.id){\n            //         //then its an udpate\n\n            //         //merge the images left?\n            //         PoidService.Update(vm.plane_document)\n            //             .then(function (data) {\n            //                 //console.log(data);\n            //                 if(data.success){\n            //                     //console.log(\"HUZZAH\", vm.plane_document);\n            //                     //console.log(\"HUZZAH\", data);\n            //                     //then we need to remove this from the list of files...\n                                \n                                \n            //                     //move somewhere?\n            //                     $state.go('dashboard.my_account.poid', {}, { reload: true });\n\n\n\n\n\n            //                 } else {\n\n            //                     alert(\"Something went terribly wrong... \\n\\n \"+data.message);\n\n            //                 }\n\n            //             });\n\n            //     } else {\n\n\n                   \n\n\n            //         //then its a create\n            //         //console.log(vm.plane_document);\n\n            //         PoidService.Create(vm.plane_document)\n            //             .then(function (data) {\n            //                 //console.log(data);\n            //                 if(data.success){\n            //                     //console.log(\"HUZZAH\", vm.plane_document);\n            //                     //console.log(\"HUZZAH\", data);\n            //                     //then we need to remove this from the list of files...\n                                \n                                \n            //                     //move somewhere?\n            //                    // $state.reload();\n            //                    // $state.go('dashboard.my_account.poid', {}, { reload: true });\n\n\n            //                 } else {\n\n            //                     alert(\"Something went terribly wrong... \\n\\n \"+data.message);\n\n            //                 }\n\n            //             });\n\n\n            //     }\n\n\n\n             };\n\n\n\n\n             $scope.change_file_name = function(file){\n                \n                //this is terribly ineficient... unfortunately... can't \n                //work out how else to do it! (lol)\n\n                // //console.log(\"TO BE CHANGED\", file);\n\n                // //console.log(\"BEFORE BEFORE\", vm.plane_documents);\n\n                vm.plane_documents = $.grep(vm.plane_documents, function(e){ \n                    return e.temp_path != file.temp_path; \n                });\n\n                // //console.log(\"BEFORE\", vm.plane_documents);\n\n                vm.plane_documents.push(file);\n\n                // //console.log(\"AFTER\", vm.plane_documents);\n\n             }\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n        initController();\n\n        function initController() {\n           //console.log(\"check if access is okay\");\n        }\n\n\n          //var warning_msg = \"By deleting this plane, you will also cancel all reservations that this plane currently has.\"\n\n          // $scope.open = function (plane_id) {\n          //   var modalInstance = $uibModal.open({\n          //     animation: true,\n          //     templateUrl: 'views/modals/deleteModal.html',\n          //     controller: 'ModalInstanceCtrl',\n          //     //params: {},\n          //     size: \"lg\",\n          //     resolve: {\n          //       id: function () {\n          //         return plane_id;\n          //       },\n          //       warning: function(){\n          //           return warning_msg;\n          //       }\n          //     }\n          //   });\n          //   modalInstance.result.then(function (plane_id) {\n          //     $log.info('PRESSED GO: '+plane_id);\n          //     PlaneService.Delete(plane_id)\n          //     .then(function(){\n          //       //console.log(\"HELLO DELETE\");\n          //       //update view?\n          //        vm.club.planes = $.grep(vm.club.planes, function(e){ \n          //           return e.plane_id != plane_id; \n          //       });\n          //     })\n          //   }, function () {\n          //     $log.info('Modal dismissed at: ' + new Date());\n          //   });\n          // };\n\n            $scope.open = function (club_plane_id) {\n            var modalInstance = $uibModal.open({\n              animation: true,\n              templateUrl: 'views/modals/deleteModal.html',\n              controller: 'ModalInstanceCtrl',\n              size: \"lg\",\n              resolve: {\n                id: function () {\n                  return club_plane_id;\n                },\n                params: function() {\n                  return {id: club_plane_id};\n                },\n                warning: function(){\n                    return warning_msg;\n                }\n              }\n            });\n            modalInstance.result.then(function (plane) {\n                var id = plane.id;\n              $log.info('PRESSED GO: ', id);\n              \n              PlaneService.Delete(id)\n              .then(function(){\n                // //console.log(\"HELLO DELETE\");\n                //update view?\n                 vm.club.planes = $.grep(vm.club.planes, function(e){ \n                    return e.id != id; \n                });\n             });\n\n            }, function () {\n              $log.info('Modal dismissed at: ' + new Date());\n            });\n\n\n          };\n         \n          \n\n\n        //   $scope.downloadCertificate = function(doc) {\n        //     var data = $.param({\n        //         id: doc\n        //     });\n\n        //     var ddd = doc.replace(/^.*[\\\\\\/]/, '');\n\n        //     $http.get('api/v1/plane_certificate/show_file/'+ddd, {\n        //             responseType: 'arraybuffer'\n        //         })\n        //         .success(function(data, status, headers) {\n        //             var zipName = processArrayBufferToBlob(data, headers);\n\n        //             //Delete file from temp folder in server - file needs to remain open until blob is created\n        //             //deleteFileFromServerTemp(zipName);\n        //         }).error(function(data, status) {\n        //             alert(\"There was an error downloading the selected document(s).\");\n        //         })\n        // };\n\n\n        // $scope.downloadInsurance = function(doc) {\n        //     var data = $.param({\n        //         id: doc\n        //     });\n\n        //     var ddd = doc.replace(/^.*[\\\\\\/]/, '');\n\n        //     $http.get('api/v1/plane_insurance/show_file/'+ddd, {\n        //             responseType: 'arraybuffer'\n        //         })\n        //         .success(function(data, status, headers) {\n        //             var zipName = processArrayBufferToBlob(data, headers);\n\n        //             //Delete file from temp folder in server - file needs to remain open until blob is created\n        //             //deleteFileFromServerTemp(zipName);\n        //         }).error(function(data, status) {\n        //             alert(\"There was an error downloading the selected document(s).\");\n        //         })\n        // };\n\n\n\n\n        $scope.downloadDocument = function(doc, type = 'docs') {\n            var data = $.param({\n                id: doc\n            });\n\n            var controller = \"plane_documents\";\n\n            switch(type){\n                 case \"radio\": \n                    controller = \"plane_radio_licence\";\n                break;\n                 case \"insurance\": \n                    controller = \"plane_insurance\";\n                break;\n                 case \"certificate\": \n                    controller = \"plane_certificate\";\n                break;\n                case \"noise\": \n                    controller = \"plane_noise_certificate\";\n                break;\n                case \"docs\": \n                    controller = \"plane_documents\";\n                break;\n                default:\n                    controller = \"plane_documents\";\n                break;\n\n            }\n\n\n\n            var ddd = doc.replace(/^.*[\\\\\\/]/, '');\n\n            $http.get('api/v1/'+controller+'/show_file/'+ddd, {\n                    responseType: 'arraybuffer'\n                })\n                .success(function(data, status, headers) {\n                    var zipName = processArrayBufferToBlob(data, headers);\n\n                    //Delete file from temp folder in server - file needs to remain open until blob is created\n                    //deleteFileFromServerTemp(zipName);\n                }).error(function(data, status) {\n                    alert(\"There was an error downloading the selected document(s).\");\n                })\n        };\n\n        $scope.downloadClubDocument = function(doc) {\n            var data = $.param({\n                id: doc\n            });\n\n            var ddd = doc.replace(/^.*[\\\\\\/]/, '');\n\n            $http.get('api/v1/club_documents/show_file/'+ddd, {\n                    responseType: 'arraybuffer'\n                })\n                .success(function(data, status, headers) {\n                    var zipName = processArrayBufferToBlob(data, headers);\n\n                    //Delete file from temp folder in server - file needs to remain open until blob is created\n                    //deleteFileFromServerTemp(zipName);\n                }).error(function(data, status) {\n                    alert(\"There was an error downloading the selected document(s).\");\n                })\n        };\n\n        function processArrayBufferToBlob(data, headers) {\n            var octetStreamMime = 'application/octet-stream';\n            var success = false;\n\n            // Get the headers\n            headers = headers();\n            //var ttt = title.toLowerCase().replace(/\\W/g, '_');\n            // Get the filename from the x-filename header or default to \"download.bin\"\n            var filename = headers['x-filename'] || 'download.zip';\n\n            // Determine the content type from the header or default to \"application/octet-stream\"\n            var contentType = headers['content-type'] || octetStreamMime;\n\n            try {\n                // Try using msSaveBlob if supported\n                var blob = new Blob([data], {\n                    type: contentType\n                });\n                if (navigator.msSaveBlob)\n                    navigator.msSaveBlob(blob, filename);\n                else {\n                    // Try using other saveBlob implementations, if available\n                    var saveBlob = navigator.webkitSaveBlob || navigator.mozSaveBlob || navigator.saveBlob;\n                    if (saveBlob === undefined) throw \"Not supported\";\n                    saveBlob(blob, filename);\n                }\n                success = true;\n            } catch (ex) {\n                $log.info(\"saveBlob method failed with the following exception:\");\n                $log.info(ex);\n            }\n\n            if (!success) {\n                // Get the blob url creator\n                var urlCreator = window.URL || window.webkitURL || window.mozURL || window.msURL;\n                if (urlCreator) {\n                    // Try to use a download link\n                    var link = document.createElement('a');\n                    if ('download' in link) {\n                        // Try to simulate a click\n                        try {\n                            // Prepare a blob URL\n                            var blob = new Blob([data], {\n                                type: contentType\n                            });\n                            var url = urlCreator.createObjectURL(blob);\n                            link.setAttribute('href', url);\n\n                            // Set the download attribute (Supported in Chrome 14+ / Firefox 20+)\n                            link.setAttribute(\"download\", filename);\n\n                            // Simulate clicking the download link\n                            var event = document.createEvent('MouseEvents');\n                            event.initMouseEvent('click', true, true, window, 1, 0, 0, 0, 0, false, false, false, false, 0, null);\n                            link.dispatchEvent(event);\n                            success = true;\n\n                        } catch (ex) {\n                            $log.info(\"Download link method with simulated click failed with the following exception:\");\n                            $log.info(ex);\n                        }\n                    }\n\n                    if (!success) {\n                        // Fallback to window.location method\n                        try {\n                            // Prepare a blob URL\n                            // Use application/octet-stream when using window.location to force download\n                            var blob = new Blob([data], {\n                                type: octetStreamMime\n                            });\n                            var url = urlCreator.createObjectURL(blob);\n                            window.location = url;\n                            success = true;\n                        } catch (ex) {\n                            $log.info(\"Download link method with window.location failed with the following exception:\");\n                            $log.info(ex);\n                        }\n                    }\n                }\n            }\n\n            if (!success) {\n                // Fallback to window.open method\n                $log.info(\"No methods worked for saving the arraybuffer, using last resort window.open\");\n                window.open(httpPath, '_blank', '');\n            }\n            return filename;\n        };\n\n\n\n        $scope.search2 = function(row){\n            //(angular.lowercase(row.first_name).indexOf(angular.lowercase($scope.my_search2) || '') !== -1)  || (angular.lowercase(row.last_name).indexOf(angular.lowercase($scope.my_search2) || '') !== -1)\n            ////console.log(\"answer\", (angular.lowercase(row.flight_date).indexOf(angular.lowercase($scope.my_search2) || '') !== -1));\n            // return ((angular.lowercase(row.flight_date).indexOf(angular.lowercase($scope.my_search2) || (angular.lowercase(row.flight_time).indexOf(angular.lowercase($scope.my_search2)) || '') !== -1)));\n            //(angular.lowercase(row.flight_date).indexOf(angular.lowercase($scope.my_search2) || '') !== -1)\n           \n            // if( (test_date($scope.my_search2, row.flight_date)) || (angular.lowercase(row.destination_airport).indexOf(angular.lowercase($scope.my_search2) || '') !== -1) || (angular.lowercase(row.departure_airport).indexOf(angular.lowercase($scope.my_search2) || '') !== -1) || (angular.lowercase(row.destination_airport_code).indexOf(angular.lowercase($scope.my_search2) || '') !== -1) || (angular.lowercase(row.departure_airport_code).indexOf(angular.lowercase($scope.my_search2) || '') !== -1)){\n            //     return true;\n            // } else {\n            //     return false;\n            // }test_aircraft\n\n            //console.log(\"TEST \" , test_date($scope.my_search2));\n\n            ////console.log($scope.my_search2);\n            if(!$scope.my_search2 || ($scope.my_search2 == \"\")){\n                return true;\n            } else if(test_date($scope.my_search2, row.entry_date)){\n                return true;\n            } else {\n                return false;\n            }\n\n            // we are testing for the date, the pilot, the departure and destination.\n\n            // return (angular.lowercase(row.flight_date).indexOf(angular.lowercase($scope.my_search2) || '') !== -1); // ? (angular.lowercase(row.flight_date).indexOf(angular.lowercase($scope.my_search2) || '') !== -1) : (angular.lowercase(row.flight_time).indexOf(angular.lowercase($scope.my_search2) || '') !== -1);\n\n        };\n\n        function test_date(search, date){\n\n\n            if(search.length < 2){\n                return false;\n            }\n\n            if(search && search.length <= 3){\n                if(date.indexOf(search) > -1){\n                    return true;\n                }\n            } else {\n                var parsed_date = \"\";\n                var b = moment(search);\n                if(b.isValid() && b.format(\"YYYY\") != \"2001\"){\n                    parsed_date = b.format(\"YYYY-MM-DD\");\n                } else if(b.isValid()){\n                    parsed_date = b.format(\"MM-DD\");\n                }\n\n\n                var search_type = 0;\n\n                if(parsed_date !== \"\" && date.indexOf(parsed_date) > -1){\n                    // //console.log(\"found\");\n                    return true;\n                } else {\n\n                    //backup in case of wrong parsing data::;\n                    //european method\n\n                    if(search.length <= 5 && search.length >= 4){\n\n                        var c = moment(search, \"DDMM\");\n                        // //console.log(\"C is : \", c);\n                        if(c.isValid()){\n                            var c2 = c.format(\"MM-DD\");\n                            if(date.indexOf(c2) > -1){\n                                return true;\n                            }\n                        }\n\n                    } else if(search.length == 8 || search.length == 10){\n                        \n                        var c = moment(search, \"DDMMYYYY\");\n                        // //console.log(\"C is : \", c);\n                        if(c.isValid()){\n                            var c2 = c.format(\"YYYY-MM-DD\");\n                            if(date.indexOf(c2) > -1){\n                                return true;\n                            }\n                        }\n\n                    }\n\n                    // //console.log(\"not found\");\n                    return false;\n                }\n            }\n\n        }\n\n        $scope.getMySearchCount = function(str){\n            var docs = str.documents;\n            var total = 0;\n            for(var i=0;i<docs.length;i++){\n                if($scope.search(docs[i])){\n                    total++;\n                }\n            }\n            return total;\n        }\n\n        $scope.getMySearchCount2 = function(str){\n            var charges = str.charges;\n            var total = 0;\n            for(var i=0;i<charges.length;i++){\n                if($scope.search(charges[i])){\n                    total++;\n                }\n            }\n            return total;\n        }\n\n\n    }\n app.controller('DashboardClubExperienceDiscountsController', DashboardClubExperienceDiscountsController);\n\n    DashboardClubExperienceDiscountsController.$inject = ['UserService', 'PlaneService', '$rootScope', '$location', '$scope', '$state', '$stateParams', '$uibModal', '$log', '$window', 'LicenceService', 'MedicalService', 'DifferencesService', 'ExperiencesService'];\n    function DashboardClubExperienceDiscountsController(UserService, PlaneService, $rootScope, $location, $scope, $state, $stateParams, $uibModal, $log, $window, LicenceService, MedicalService, DifferencesService, ExperiencesService ) {\n        var vm = this;\n\n        vm.user = null;\n        vm.allUsers = [];\n        vm.club = {\n            item: {\n            }\n        };\n        vm.page_title = \"\";\n        \n        vm.plane_document = {};\n        vm.plane_documents = [];\n\n        var update_this_file = [];\n        \n\n        vm.action = $state.current.data.action;\n        vm.club_id = $rootScope.globals.currentUser.current_club_admin.id;\n        vm.user = $rootScope.globals.currentUser;\n        vm.user_id = vm.user.id;\n\n        vm.charge_type = [\"brakes\", \"session\", \"plane\"];\n\n\n        vm.planes = [];\n   \n\n        ExperiencesService.GetByClubId(vm.club_id)\n                    .then(function(data){\n                        //console.log(\"planes\", data);\n                        vm.experiences = data.items;\n                    });\n\n        ////console.log(\"club_id : \"+vm.club_id);\n\n        // //console.log(vm.action);\n         //console.log($stateParams);\n        // //console.log($stateParams.id);\n        switch(vm.action){\n            case \"add\":\n                //console.log(\"adding a new plane please\");\n                vm.page_title = \"Add an Experience\";\n            break;\n            case \"edit\":\n                //console.log(\"edit an existing plane\");\n                 //console.log($stateParams);\n                ExperiencesService.GetById($stateParams.id)\n                    .then(function(data){\n                        vm.club.item = data.item; \n                        //console.log(vm.club);\n                        // vm.page_title = \"Edit an Experience - \"+vm.club.item.title;\n                    });\n\n\n            break;\n            case \"list\":\n                //need to update this to be part of the authentication\n                //to find out club id\n                ExperiencesService.GetDiscountsByClubId(vm.club_id)\n                    .then(function(data){\n                        vm.club.items = data.items;   \n                        //console.log(vm.club.items);\n                    });\n            break;\n            default:\n                //console.log(\"none of the above... redirect somewhere?\");\n            break;\n        }  \n\n        //'9' needs to refer the the user's account set to manage\n       \n\n        $scope.check_code = function(){\n            //console.log(\"CHECKING NOW\");\n        }\n\n        $scope.back = function(){\n            $window.history.back();\n        }\n\n        $scope.save = function(){\n            if(vm.action == \"add\"){\n                //console.log(\"CREATE click\");\n                $scope.create();\n            } else {\n                //console.log(\"EDIT click\");\n                //console.log(vm.club.plane);\n                $scope.update();\n            }\n        }\n\n\n        $scope.create = function(){\n            //console.log(\"CREATE ME NOW\");\n            vm.club.item.experience_id = vm.club.item.experience.id;\n            delete vm.club.item.experience;\n            vm.club.item.club_id = vm.club_id;\n            ExperiencesService.CreateDiscount(vm.club.item)\n                .then(function(data){\n                    //console.log(data);\n                    //$state.reload();\n                    $state.go('dashboard.manage_club.experience_discounts', {}, {reload: true});\n\n                });\n        }\n\n        $scope.delete = function(){\n            //console.log(\"CLICK\");\n            alert(\"Are you sure you would like to delete this plane?\");\n            ExperiencesService.DeleteDiscount(vm.user.id, vm.club.item)\n                .then(function(data){\n                    //console.log(data);\n                });\n        }\n\n        function get_update_docs(){\n            var documents = [];\n\n            for(var i=0;i<update_this_file.length;i++){\n                var id = update_this_file[i];\n                //console.log(\"looking for : \", id);\n                //console.log(\"in: \", vm.plane_documents);\n\n                for(var k=0;k<vm.club.plane.plane_documents.length;k++){\n                    //console.log(\"comparing to : \", vm.club.plane.plane_documents[k].id);\n                    if(vm.club.plane.plane_documents[k].id == id){\n                        documents.push(vm.club.plane.plane_documents[k]);\n                    }\n                }\n\n            }\n\n            // //console.log(\"DOCS TO UPDATE : \", documents);\n\n            return documents;\n        }\n\n        $scope.update = function(){\n            //console.log(\"CLICK\");\n            vm.club.item.club_id = vm.club_id;\n            ExperiencesService.UpdateDiscount(vm.club.item, vm.user.id)\n                .then(function(data){\n                    //console.log(data);\n                    //console.log(\"saved\");\n                    //$state.reload();\n                    $state.go('dashboard.manage_club.experience_discounts', {}, {reload: true});\n                });\n        }\n\n\n        function containsObject(obj, list, params) {\n\n            // //console.log(\"obj\", obj);\n            // //console.log(\"list\", list);\n            // //console.log(\"params\", params);\n\n            for(var i=0; i<list.length; i++) {\n                // //console.log(\"list i : \", list[i]);\n                // //console.log(\"obj is: \", obj);\n\n                var count_success = 0;\n                for(var j=0;j<params.length;j++){\n                    if(list[i][params[j]] && obj[params[j]] && list[i][params[j]] == obj[params[j]]){\n                        count_success++;\n                    }\n                }\n\n                if(count_success === params.length) {                    \n                    return true;\n                }\n            }\n\n            return false;\n        }\n\n\n\n\n        function check_all(){\n\n            //maybe a nice to have one day... not yet though.\n\n\n            //licences\n            vm.club.plane.requirements.licence.forEach(function(obj){\n\n            });\n\n        }\n\n      \n\n\n\n        $scope.add_item = function(type){\n            //console.log(\"ADD\");\n            switch(type){\n                case \"plane\":\n                    //console.log(\"plane\");\n                    if(vm.temporary.plane && vm.temporary.plane !== \"\"){\n                        //then we can add it\n                        //console.log(\"here we go\");\n                        // var add_plane = {\n                        //     id: vm.temporary.plane.id\n                        // };\n\n                        //check if it doesnt exist first...\n                        //if(vm.club.item.planes && vm.club.item.planes.indexOf(vm.temporary.plane.plane_id) == -1){\n\n\n                        if(!vm.club.item.planes){\n                            vm.club.item.planes = [];\n                        }\n\n                        if(containsObject(vm.temporary.plane, vm.club.item.planes, new Array(\"plane_id\") ) == false){\n                            vm.club.item.planes.push(vm.temporary.plane);\n\n                            // vm.club.item.planes.indexOf(vm.temporary.plane)\n                            // vm.planes.filter(function(el) { return el.plane_id !== vm.temporary.plane.plane_id; });\n                        } \n\n                        delete vm.temporary.plane;\n\n                    } else {\n                        alert(\"Please select a plane that this activity be done on!\");\n                    }\n\n                break;\n\n            }\n\n\n\n        }\n\n\n        $scope.remove_item = function(type, index){\n            //console.log(\"REMOVE\");\n\n            vm.club.item.planes.splice(index, 1);\n\n\n            // switch(type){\n            //     case \"plane\":\n            //             //console.log(\"plane\");\n                   \n            //             //check if it doesnt exist first...\n            //             // if(containsObject(add_licence, vm.club.plane.requirements.licence, new Array(\"licence_id\", \"rating_id\")) == false){\n            //             //     vm.club.plane.requirements.licence.push(add_licence);\n            //             // }\n\n            //             vm.club.item.planes.splice(index, 1);\n                      \n            //     break;\n            // }\n\n\n            //     case \"medical\":\n            //         //console.log(\"medical\");\n            //         if(vm.temporary.medical_authority && vm.temporary.medical_authority !== \"\" && vm.temporary.medical_component && vm.temporary.medical_component !== \"\"){\n            //             //then we can add it\n            //             //console.log(\"here we go\");\n            //             var add_medical = {\n            //                 authority_id: vm.temporary.medical_authority.id,\n            //                 authority_title: vm.temporary.medical_authority.abbreviation,\n            //                 medical_component_id: vm.temporary.medical_component.id,\n            //                 medical_component_title: vm.temporary.medical_component.title\n            //             };\n\n            //             //check if it doesnt exist first...\n            //             if(containsObject(add_medical, vm.club.plane.requirements.medical, new Array(\"authority_id\", \"medical_component_id\")) == false){\n            //                 vm.club.plane.requirements.medical.push(add_medical);\n            //             }\n\n            //             delete vm.temporary.medical_authority;\n            //             delete vm.temporary.medical_component;\n\n            //         } else {\n            //             alert(\"Please select a medical that is required to book the plane solo!\");\n            //         }\n\n            //     break;\n\n\n            //     case \"differences\":\n            //         //console.log(\"difference\");\n            //         if(vm.temporary.difference && vm.temporary.difference !== \"\"){\n            //             //then we can add it\n            //             //console.log(\"here we go\");\n            //             var add_difference = {\n            //                 difference_id: vm.temporary.difference.id,\n            //                 difference_title: vm.temporary.difference.title\n            //             };\n\n            //             //check if it doesnt exist first...\n            //             if(containsObject(add_difference, vm.club.plane.requirements.differences, new Array(\"difference_id\", \"difference_title\")) == false){\n            //                 vm.club.plane.requirements.differences.push(add_difference);\n            //             }\n\n            //             delete vm.temporary.difference;\n\n            //         } else {\n            //             alert(\"Please select a difference that is required to book the plane solo!\");\n            //         }\n\n            //     break;\n\n\n            // }\n\n\n\n        }\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n        $scope.update_this_file = function(file){\n            //console.log(\"==== update is : \", file.id);\n            if(update_this_file.indexOf(file.id) === -1){\n                update_this_file.push(file.id)\n            } else {\n               ////console.log(\"This item already exists\"); \n            } \n        }\n\n\n         $scope.remove_real_file = function(file){\n\n                //remove_file\n\n                vm.club.plane.plane_documents = $.grep(vm.club.plane.plane_documents, function(e){ \n                        return e.id != file.id; \n                    });\n\n                //no need to actually remove the file as it will be archived accordingly on the backend whilst it is missing! :)\n                PlaneDocumentService.Delete(vm.user.id, file.id)\n                .then(function (data) {\n                    //console.log(data);\n                    if(data.success){\n                        //console.log(\"HUZZAH\", current_files);\n                        //then we need to remove this from the list of files...\n                        //clear files\n                        vm.plane_documents = [];\n                        //and re-process available files\n                        $scope.processFiles(current_files);\n\n                    } else {\n                        //console.log(\"WOOOPSIES...\");\n                        //this should be very very rare...\n                    }\n\n                });\n\n          }\n\n\n          \n          $scope.remove_file = function(file, current_files){\n\n            //remove_file\n            var j = JSON.parse(file.file_return);\n            //console.log(\"REMOVE: \", j);\n            //console.log(\"REMOVE: \", j.saved_url);\n\n            //to delete the temp file created: j.saved_url\n            //tmp_rm.php POST tmp = filename\n            \n            PoidService.DeleteTmp(j.saved_url)\n                .then(function (data) {\n                    //console.log(data);\n                    if(data.success){\n                        //console.log(\"HUZZAH\", current_files);\n                        //then we need to remove this from the list of files...\n                        //clear files\n                        vm.plane_documents = [];\n                        //and re-process available files\n                        $scope.processFiles(current_files);\n\n                    } else {\n                        //console.log(\"WOOOPSIES...\");\n                        //this should be very very rare...\n                    }\n\n                });\n\n          }\n          \n\n          // $scope.$on('flow::fileAdded', function (event, $flow, flowFile) {\n          //     event.preventDefault();//prevent file from uploading\n          //     //console.log(\"FILE ADDED\");\n          //     //console.log($flow);\n          //   });\n\n            $scope.processFiles = function(files){\n                // //console.log(\"files\", files);\n\n                for(var i=0; i<files.length; i++){\n                    // //console.log(\"JSON\", files[i].file_return);\n                    var j = JSON.parse(files[i].file_return);\n                    // //console.log(\"PARSED\", j);\n                    //console.log(\"J is : \",j);\n                    //console.log(\"name is : \", j.files.file.name);\n\n                    files[i].file.temp_path = j.saved_url;\n                    files[i].file.save_name = j.files.file.name;\n                    var ft = j.files.file.name;\n                    ft = ft.split('.').pop();\n                    files[i].file.extension = ft;\n\n                    // //console.log(\"file\", files[i].file);\n                    vm.plane_documents.push(files[i].file);\n                }\n\n\n            }\n\n            $scope.set_title = function(file){\n                //console.log(\"return\", file);\n                return file.save_name;\n            }\n\n            $scope.get_icon = function(file){\n\n                var ft = file.name;\n                ft = ft.split('.').pop();\n                var icon_name = \"\";\n\n                // //console.log(\"FILE:\", ft);\n                // //console.log(\"index : \", ft.indexOf(\"pdf\"));\n                switch(true){\n                    case (ft.indexOf(\"pdf\") > -1):\n                        icon_name = \"pdf.png\";\n                    break;\n                    case (ft.indexOf(\"doc\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"docx\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"xls\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"xlsx\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"ppt\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"pptx\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"jpg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"jpeg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"png\") > -1):\n                        icon_name = \"png.png\";\n                    break;\n                    case (ft.indexOf(\"gif\") > -1):\n                        icon_name = \"gif.png\";\n                    break;\n                    case (ft.indexOf(\"zip\") > -1):\n                        icon_name = \"zip.png\";\n                    break;\n                    case (ft.indexOf(\"avi\") > -1):\n                        icon_name = \"avi.png\";\n                    break;\n                    case (ft.indexOf(\"mp4\") > -1):\n                        icon_name = \"mp4.png\";\n                    break;\n                    default:\n                        icon_name = \"file.png\";\n                    break;\n                }\n\n                // //console.log(\"FILE:\", icon_name);\n\n                return \"images/file_icons/\"+icon_name;\n            }\n\n\n            $scope.get_icon2 = function(file){\n\n                var ft = file.split('.').pop();\n                // //console.log(\"ICON 2 : \", ft);\n                var icon_name = \"\";\n\n                // //console.log(\"FILE:\", ft);\n                // //console.log(\"index : \", ft.indexOf(\"pdf\"));\n                switch(true){\n                    case (ft.indexOf(\"pdf\") > -1):\n                        icon_name = \"pdf.png\";\n                    break;\n                    case (ft.indexOf(\"doc\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"docx\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"xls\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"xlsx\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"ppt\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"pptx\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"jpg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"jpeg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"png\") > -1):\n                        icon_name = \"png.png\";\n                    break;\n                    case (ft.indexOf(\"gif\") > -1):\n                        icon_name = \"gif.png\";\n                    break;\n                    case (ft.indexOf(\"zip\") > -1):\n                        icon_name = \"zip.png\";\n                    break;\n                    case (ft.indexOf(\"avi\") > -1):\n                        icon_name = \"avi.png\";\n                    break;\n                    case (ft.indexOf(\"mp4\") > -1):\n                        icon_name = \"mp4.png\";\n                    break;\n                    default:\n                        icon_name = \"file.png\";\n                    break;\n                }\n\n                // //console.log(\"FILE:\", icon_name);\n\n                return \"images/file_icons/\"+icon_name;\n            }\n\n\n\n            $scope.delete_poid = function(id){\n\n              \n                var a = prompt(\"Are you sure you wish to delete this poid? \\n\\n This change is irreversible! To confirm please type YES in the box below.\");\n                if(a == \"YES\"){\n\n\n                    //console.log(\"WE DELETE IT\");\n\n\n                    // PoidService.Delete(vm.user_id, id)\n                    //     .then(function (data) {\n                    //         //console.log(data);\n                    //         if(data.success){\n                    //             //console.log(\"HUZZAH\", data);\n                    //             //then we need to remove this from the list of files...\n                    //             vm.user_poids = $.grep(vm.user_poids, function(e){ \n                    //                 return e.id != id; \n                    //             });\n                                \n                    //             //refresh?\n                    //             $state.reload();\n                    //             $state.go('dashboard.my_account.poid');\n\n                    //         } else {\n\n                    //             alert(\"Something went terribly wrong... \\n\\n \"+data.message);\n\n                    //         }\n\n                    //     });\n\n\n\n                } else {\n                    //console.log(\"ignore123\");\n                }\n\n\n            }\n\n\n\n\n            $scope.save_plane_documents = function(){\n\n               \n              \n\n                //console.log(\"plane_documents: \", vm.plane_documents);\n\n\n                //compile the required elements YAY\n\n                //console.log(\"plane_document \", vm.plane_document);\n\n\n                 //clean shizzle before sending\n                 //why keep sending back heavy data?\n\n                    // for(var i=0;i<vm.plane_document.images.length;i++){\n                    //     delete vm.plane_document.images[i].data_uri;\n                    // }\n\n                    // // vm.plane_document.images = vm.plane_documents;\n                    // vm.plane_document.images = vm.plane_document.images.concat(vm.plane_documents);\n                    // vm.plane_document.user_id = vm.user_id;\n\n\n\n\n            //     if(vm.plane_document.id){\n            //         //then its an udpate\n\n            //         //merge the images left?\n            //         PoidService.Update(vm.plane_document)\n            //             .then(function (data) {\n            //                 //console.log(data);\n            //                 if(data.success){\n            //                     //console.log(\"HUZZAH\", vm.plane_document);\n            //                     //console.log(\"HUZZAH\", data);\n            //                     //then we need to remove this from the list of files...\n                                \n                                \n            //                     //move somewhere?\n            //                     $state.go('dashboard.my_account.poid', {}, { reload: true });\n\n\n\n\n\n            //                 } else {\n\n            //                     alert(\"Something went terribly wrong... \\n\\n \"+data.message);\n\n            //                 }\n\n            //             });\n\n            //     } else {\n\n\n                   \n\n\n            //         //then its a create\n            //         //console.log(vm.plane_document);\n\n            //         PoidService.Create(vm.plane_document)\n            //             .then(function (data) {\n            //                 //console.log(data);\n            //                 if(data.success){\n            //                     //console.log(\"HUZZAH\", vm.plane_document);\n            //                     //console.log(\"HUZZAH\", data);\n            //                     //then we need to remove this from the list of files...\n                                \n                                \n            //                     //move somewhere?\n            //                    // $state.reload();\n            //                    // $state.go('dashboard.my_account.poid', {}, { reload: true });\n\n\n            //                 } else {\n\n            //                     alert(\"Something went terribly wrong... \\n\\n \"+data.message);\n\n            //                 }\n\n            //             });\n\n\n            //     }\n\n\n\n             };\n\n\n\n\n             $scope.change_file_name = function(file){\n                \n                //this is terribly ineficient... unfortunately... can't \n                //work out how else to do it! (lol)\n\n                // //console.log(\"TO BE CHANGED\", file);\n\n                // //console.log(\"BEFORE BEFORE\", vm.plane_documents);\n\n                vm.plane_documents = $.grep(vm.plane_documents, function(e){ \n                    return e.temp_path != file.temp_path; \n                });\n\n                // //console.log(\"BEFORE\", vm.plane_documents);\n\n                vm.plane_documents.push(file);\n\n                // //console.log(\"AFTER\", vm.plane_documents);\n\n             }\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n        initController();\n\n        function initController() {\n           //console.log(\"check if access is okay\");\n        }\n\n\n            var warning_msg = \"By deleting this plane, you will also cancel all reservations that this plane currently has.\"\n\n          $scope.open = function (plane_id) {\n            var modalInstance = $uibModal.open({\n              animation: true,\n              templateUrl: 'views/modals/deleteModal.html',\n              controller: 'ModalInstanceCtrl',\n              size: \"lg\",\n              resolve: {\n                id: function () {\n                  return plane_id;\n                },\n                params: function() {\n                  return {id: plane_id};\n                },\n                warning: function(){\n                    return warning_msg;\n                }\n              }\n            });\n            modalInstance.result.then(function (plane_id) {\n              $log.info('PRESSED GO: '+plane_id.id);\n              ExperiencesService.Delete(vm.user.id, plane_id.id)\n              .then(function(){\n                //console.log(\"HELLO DELETE\");\n                //update view?\n                 vm.club.items = $.grep(vm.club.items, function(e){ \n                    return e.id != plane_id.id; \n                });\n              })\n            }, function () {\n              $log.info('Modal dismissed at: ' + new Date());\n            });\n          };\n\n         \n\n\n    }\n app.controller('DashboardClubExperiencesController', DashboardClubExperiencesController);\n\n    DashboardClubExperiencesController.$inject = ['UserService', 'PlaneService', '$rootScope', '$location', '$scope', '$state', '$stateParams', '$uibModal', '$log', '$window', 'LicenceService', 'MedicalService', 'DifferencesService', 'ExperiencesService'];\n    function DashboardClubExperiencesController(UserService, PlaneService, $rootScope, $location, $scope, $state, $stateParams, $uibModal, $log, $window, LicenceService, MedicalService, DifferencesService, ExperiencesService ) {\n        var vm = this;\n\n        vm.user = null;\n        vm.allUsers = [];\n        vm.club = {\n            item: {\n                planes: []\n            }\n        };\n        vm.page_title = \"\";\n        \n        vm.plane_document = {};\n        vm.plane_documents = [];\n\n        var update_this_file = [];\n        \n\n        vm.action = $state.current.data.action;\n        vm.club_id = $rootScope.globals.currentUser.current_club_admin.id;\n        vm.user = $rootScope.globals.currentUser;\n        vm.user_id = vm.user.id;\n\n        vm.charge_type = [\"brakes\", \"session\", \"plane\"];\n\n\n        vm.planes = [];\n        vm.club.item.planes = [];\n        vm.temporary = {};\n        vm.temporary.plane = {};\n\n        PlaneService.GetAllByClub(vm.club_id)\n                    .then(function(data){\n                        //console.log(\"planes\", data);\n                        vm.planes = data;\n                    });\n\n        ////console.log(\"club_id : \"+vm.club_id);\n\n        // //console.log(vm.action);\n         //console.log($stateParams);\n        // //console.log($stateParams.id);\n        switch(vm.action){\n            case \"add\":\n                //console.log(\"adding a new plane please\");\n                vm.page_title = \"Add an Experience\";\n            break;\n            case \"edit\":\n                //console.log(\"edit an existing plane\");\n                 //console.log($stateParams);\n                ExperiencesService.GetById($stateParams.id)\n                    .then(function(data){\n                        vm.club.item = data.item; \n                        //console.log(vm.club);\n                        // vm.page_title = \"Edit an Experience - \"+vm.club.item.title;\n                    });\n\n\n            break;\n            case \"list\":\n                //need to update this to be part of the authentication\n                //to find out club id\n                ExperiencesService.GetByClubId(vm.club_id)\n                    .then(function(data){\n                        vm.club.items = data.items;   \n                        //console.log(vm.club.items);\n                    });\n            break;\n            default:\n                //console.log(\"none of the above... redirect somewhere?\");\n            break;\n        }  \n\n        //'9' needs to refer the the user's account set to manage\n       \n        $scope.back = function(){\n            $window.history.back();\n        }\n\n        $scope.save = function(){\n            if(vm.action == \"add\"){\n                //console.log(\"CREATE click\");\n                $scope.create();\n            } else {\n                //console.log(\"EDIT click\");\n                //console.log(vm.club.plane);\n                $scope.update();\n            }\n        }\n\n\n        $scope.create = function(){\n            //console.log(\"CREATE ME NOW\");\n            vm.club.item.club_id = vm.club_id;\n            ExperiencesService.Create(vm.club.item)\n                .then(function(data){\n                    //console.log(data);\n                    //$state.reload();\n                    $state.go('dashboard.manage_club.experiences', {}, {reload: true});\n\n                });\n        }\n\n        $scope.delete = function(){\n            //console.log(\"CLICK\");\n            alert(\"Are you sure you would like to delete this plane?\");\n            ExperiencesService.Delete(vm.user.id, vm.club.item)\n                .then(function(data){\n                    //console.log(data);\n                });\n        }\n\n        function get_update_docs(){\n            var documents = [];\n\n            for(var i=0;i<update_this_file.length;i++){\n                var id = update_this_file[i];\n                //console.log(\"looking for : \", id);\n                //console.log(\"in: \", vm.plane_documents);\n\n                for(var k=0;k<vm.club.plane.plane_documents.length;k++){\n                    //console.log(\"comparing to : \", vm.club.plane.plane_documents[k].id);\n                    if(vm.club.plane.plane_documents[k].id == id){\n                        documents.push(vm.club.plane.plane_documents[k]);\n                    }\n                }\n\n            }\n\n            // //console.log(\"DOCS TO UPDATE : \", documents);\n\n            return documents;\n        }\n\n        $scope.update = function(){\n            //console.log(\"CLICK\");\n            vm.club.item.club_id = vm.club_id;\n            ExperiencesService.Update(vm.club.item, vm.user.id)\n                .then(function(data){\n                    //console.log(data);\n                    //console.log(\"saved\");\n                    //$state.reload();\n                    $state.go('dashboard.manage_club.experiences', {}, {reload: true});\n                });\n        }\n\n\n        function containsObject(obj, list, params) {\n\n            // //console.log(\"obj\", obj);\n            // //console.log(\"list\", list);\n            // //console.log(\"params\", params);\n\n            for(var i=0; i<list.length; i++) {\n                // //console.log(\"list i : \", list[i]);\n                // //console.log(\"obj is: \", obj);\n\n                var count_success = 0;\n                for(var j=0;j<params.length;j++){\n                    if(list[i][params[j]] && obj[params[j]] && list[i][params[j]] == obj[params[j]]){\n                        count_success++;\n                    }\n                }\n\n                if(count_success === params.length) {                    \n                    return true;\n                }\n            }\n\n            return false;\n        }\n\n\n\n\n        function check_all(){\n\n            //maybe a nice to have one day... not yet though.\n\n\n            //licences\n            vm.club.plane.requirements.licence.forEach(function(obj){\n\n            });\n\n        }\n\n      \n\n\n\n        $scope.add_item = function(type){\n            //console.log(\"ADD\");\n            switch(type){\n                case \"plane\":\n                    //console.log(\"plane\");\n                    if(vm.temporary.plane && vm.temporary.plane !== \"\"){\n                        //then we can add it\n                        //console.log(\"here we go\");\n                        // var add_plane = {\n                        //     id: vm.temporary.plane.id\n                        // };\n\n                        //check if it doesnt exist first...\n                        //if(vm.club.item.planes && vm.club.item.planes.indexOf(vm.temporary.plane.plane_id) == -1){\n\n\n                        if(!vm.club.item.planes){\n                            vm.club.item.planes = [];\n                        }\n\n                        if(containsObject(vm.temporary.plane, vm.club.item.planes, new Array(\"plane_id\") ) == false){\n                            vm.club.item.planes.push(vm.temporary.plane);\n\n                            // vm.club.item.planes.indexOf(vm.temporary.plane)\n                            // vm.planes.filter(function(el) { return el.plane_id !== vm.temporary.plane.plane_id; });\n                        } \n\n                        delete vm.temporary.plane;\n\n                    } else {\n                        alert(\"Please select a plane that this activity be done on!\");\n                    }\n\n                break;\n\n            }\n\n\n\n        }\n\n\n        $scope.remove_item = function(type, index){\n            //console.log(\"REMOVE\");\n\n            vm.club.item.planes.splice(index, 1);\n\n\n            // switch(type){\n            //     case \"plane\":\n            //             //console.log(\"plane\");\n                   \n            //             //check if it doesnt exist first...\n            //             // if(containsObject(add_licence, vm.club.plane.requirements.licence, new Array(\"licence_id\", \"rating_id\")) == false){\n            //             //     vm.club.plane.requirements.licence.push(add_licence);\n            //             // }\n\n            //             vm.club.item.planes.splice(index, 1);\n                      \n            //     break;\n            // }\n\n\n            //     case \"medical\":\n            //         //console.log(\"medical\");\n            //         if(vm.temporary.medical_authority && vm.temporary.medical_authority !== \"\" && vm.temporary.medical_component && vm.temporary.medical_component !== \"\"){\n            //             //then we can add it\n            //             //console.log(\"here we go\");\n            //             var add_medical = {\n            //                 authority_id: vm.temporary.medical_authority.id,\n            //                 authority_title: vm.temporary.medical_authority.abbreviation,\n            //                 medical_component_id: vm.temporary.medical_component.id,\n            //                 medical_component_title: vm.temporary.medical_component.title\n            //             };\n\n            //             //check if it doesnt exist first...\n            //             if(containsObject(add_medical, vm.club.plane.requirements.medical, new Array(\"authority_id\", \"medical_component_id\")) == false){\n            //                 vm.club.plane.requirements.medical.push(add_medical);\n            //             }\n\n            //             delete vm.temporary.medical_authority;\n            //             delete vm.temporary.medical_component;\n\n            //         } else {\n            //             alert(\"Please select a medical that is required to book the plane solo!\");\n            //         }\n\n            //     break;\n\n\n            //     case \"differences\":\n            //         //console.log(\"difference\");\n            //         if(vm.temporary.difference && vm.temporary.difference !== \"\"){\n            //             //then we can add it\n            //             //console.log(\"here we go\");\n            //             var add_difference = {\n            //                 difference_id: vm.temporary.difference.id,\n            //                 difference_title: vm.temporary.difference.title\n            //             };\n\n            //             //check if it doesnt exist first...\n            //             if(containsObject(add_difference, vm.club.plane.requirements.differences, new Array(\"difference_id\", \"difference_title\")) == false){\n            //                 vm.club.plane.requirements.differences.push(add_difference);\n            //             }\n\n            //             delete vm.temporary.difference;\n\n            //         } else {\n            //             alert(\"Please select a difference that is required to book the plane solo!\");\n            //         }\n\n            //     break;\n\n\n            // }\n\n\n\n        }\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n        $scope.update_this_file = function(file){\n            //console.log(\"==== update is : \", file.id);\n            if(update_this_file.indexOf(file.id) === -1){\n                update_this_file.push(file.id)\n            } else {\n               ////console.log(\"This item already exists\"); \n            } \n        }\n\n\n         $scope.remove_real_file = function(file){\n\n                //remove_file\n\n                vm.club.plane.plane_documents = $.grep(vm.club.plane.plane_documents, function(e){ \n                        return e.id != file.id; \n                    });\n\n                //no need to actually remove the file as it will be archived accordingly on the backend whilst it is missing! :)\n                PlaneDocumentService.Delete(vm.user.id, file.id)\n                .then(function (data) {\n                    //console.log(data);\n                    if(data.success){\n                        //console.log(\"HUZZAH\", current_files);\n                        //then we need to remove this from the list of files...\n                        //clear files\n                        vm.plane_documents = [];\n                        //and re-process available files\n                        $scope.processFiles(current_files);\n\n                    } else {\n                        //console.log(\"WOOOPSIES...\");\n                        //this should be very very rare...\n                    }\n\n                });\n\n          }\n\n\n          \n          $scope.remove_file = function(file, current_files){\n\n            //remove_file\n            var j = JSON.parse(file.file_return);\n            //console.log(\"REMOVE: \", j);\n            //console.log(\"REMOVE: \", j.saved_url);\n\n            //to delete the temp file created: j.saved_url\n            //tmp_rm.php POST tmp = filename\n            \n            PoidService.DeleteTmp(j.saved_url)\n                .then(function (data) {\n                    //console.log(data);\n                    if(data.success){\n                        //console.log(\"HUZZAH\", current_files);\n                        //then we need to remove this from the list of files...\n                        //clear files\n                        vm.plane_documents = [];\n                        //and re-process available files\n                        $scope.processFiles(current_files);\n\n                    } else {\n                        //console.log(\"WOOOPSIES...\");\n                        //this should be very very rare...\n                    }\n\n                });\n\n          }\n          \n\n          // $scope.$on('flow::fileAdded', function (event, $flow, flowFile) {\n          //     event.preventDefault();//prevent file from uploading\n          //     //console.log(\"FILE ADDED\");\n          //     //console.log($flow);\n          //   });\n\n            $scope.processFiles = function(files){\n                // //console.log(\"files\", files);\n\n                for(var i=0; i<files.length; i++){\n                    // //console.log(\"JSON\", files[i].file_return);\n                    var j = JSON.parse(files[i].file_return);\n                    // //console.log(\"PARSED\", j);\n                    //console.log(\"J is : \",j);\n                    //console.log(\"name is : \", j.files.file.name);\n\n                    files[i].file.temp_path = j.saved_url;\n                    files[i].file.save_name = j.files.file.name;\n                    var ft = j.files.file.name;\n                    ft = ft.split('.').pop();\n                    files[i].file.extension = ft;\n\n                    // //console.log(\"file\", files[i].file);\n                    vm.plane_documents.push(files[i].file);\n                }\n\n\n            }\n\n            $scope.set_title = function(file){\n                //console.log(\"return\", file);\n                return file.save_name;\n            }\n\n            $scope.get_icon = function(file){\n\n                var ft = file.name;\n                ft = ft.split('.').pop();\n                var icon_name = \"\";\n\n                // //console.log(\"FILE:\", ft);\n                // //console.log(\"index : \", ft.indexOf(\"pdf\"));\n                switch(true){\n                    case (ft.indexOf(\"pdf\") > -1):\n                        icon_name = \"pdf.png\";\n                    break;\n                    case (ft.indexOf(\"doc\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"docx\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"xls\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"xlsx\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"ppt\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"pptx\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"jpg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"jpeg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"png\") > -1):\n                        icon_name = \"png.png\";\n                    break;\n                    case (ft.indexOf(\"gif\") > -1):\n                        icon_name = \"gif.png\";\n                    break;\n                    case (ft.indexOf(\"zip\") > -1):\n                        icon_name = \"zip.png\";\n                    break;\n                    case (ft.indexOf(\"avi\") > -1):\n                        icon_name = \"avi.png\";\n                    break;\n                    case (ft.indexOf(\"mp4\") > -1):\n                        icon_name = \"mp4.png\";\n                    break;\n                    default:\n                        icon_name = \"file.png\";\n                    break;\n                }\n\n                // //console.log(\"FILE:\", icon_name);\n\n                return \"images/file_icons/\"+icon_name;\n            }\n\n\n            $scope.get_icon2 = function(file){\n\n                var ft = file.split('.').pop();\n                // //console.log(\"ICON 2 : \", ft);\n                var icon_name = \"\";\n\n                // //console.log(\"FILE:\", ft);\n                // //console.log(\"index : \", ft.indexOf(\"pdf\"));\n                switch(true){\n                    case (ft.indexOf(\"pdf\") > -1):\n                        icon_name = \"pdf.png\";\n                    break;\n                    case (ft.indexOf(\"doc\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"docx\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"xls\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"xlsx\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"ppt\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"pptx\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"jpg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"jpeg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"png\") > -1):\n                        icon_name = \"png.png\";\n                    break;\n                    case (ft.indexOf(\"gif\") > -1):\n                        icon_name = \"gif.png\";\n                    break;\n                    case (ft.indexOf(\"zip\") > -1):\n                        icon_name = \"zip.png\";\n                    break;\n                    case (ft.indexOf(\"avi\") > -1):\n                        icon_name = \"avi.png\";\n                    break;\n                    case (ft.indexOf(\"mp4\") > -1):\n                        icon_name = \"mp4.png\";\n                    break;\n                    default:\n                        icon_name = \"file.png\";\n                    break;\n                }\n\n                // //console.log(\"FILE:\", icon_name);\n\n                return \"images/file_icons/\"+icon_name;\n            }\n\n\n\n            $scope.delete_poid = function(id){\n\n              \n                var a = prompt(\"Are you sure you wish to delete this poid? \\n\\n This change is irreversible! To confirm please type YES in the box below.\");\n                if(a == \"YES\"){\n\n\n                    //console.log(\"WE DELETE IT\");\n\n\n                    // PoidService.Delete(vm.user_id, id)\n                    //     .then(function (data) {\n                    //         //console.log(data);\n                    //         if(data.success){\n                    //             //console.log(\"HUZZAH\", data);\n                    //             //then we need to remove this from the list of files...\n                    //             vm.user_poids = $.grep(vm.user_poids, function(e){ \n                    //                 return e.id != id; \n                    //             });\n                                \n                    //             //refresh?\n                    //             $state.reload();\n                    //             $state.go('dashboard.my_account.poid');\n\n                    //         } else {\n\n                    //             alert(\"Something went terribly wrong... \\n\\n \"+data.message);\n\n                    //         }\n\n                    //     });\n\n\n\n                } else {\n                    //console.log(\"ignore123\");\n                }\n\n\n            }\n\n\n\n\n            $scope.save_plane_documents = function(){\n\n               \n              \n\n                //console.log(\"plane_documents: \", vm.plane_documents);\n\n\n                //compile the required elements YAY\n\n                //console.log(\"plane_document \", vm.plane_document);\n\n\n                 //clean shizzle before sending\n                 //why keep sending back heavy data?\n\n                    // for(var i=0;i<vm.plane_document.images.length;i++){\n                    //     delete vm.plane_document.images[i].data_uri;\n                    // }\n\n                    // // vm.plane_document.images = vm.plane_documents;\n                    // vm.plane_document.images = vm.plane_document.images.concat(vm.plane_documents);\n                    // vm.plane_document.user_id = vm.user_id;\n\n\n\n\n            //     if(vm.plane_document.id){\n            //         //then its an udpate\n\n            //         //merge the images left?\n            //         PoidService.Update(vm.plane_document)\n            //             .then(function (data) {\n            //                 //console.log(data);\n            //                 if(data.success){\n            //                     //console.log(\"HUZZAH\", vm.plane_document);\n            //                     //console.log(\"HUZZAH\", data);\n            //                     //then we need to remove this from the list of files...\n                                \n                                \n            //                     //move somewhere?\n            //                     $state.go('dashboard.my_account.poid', {}, { reload: true });\n\n\n\n\n\n            //                 } else {\n\n            //                     alert(\"Something went terribly wrong... \\n\\n \"+data.message);\n\n            //                 }\n\n            //             });\n\n            //     } else {\n\n\n                   \n\n\n            //         //then its a create\n            //         //console.log(vm.plane_document);\n\n            //         PoidService.Create(vm.plane_document)\n            //             .then(function (data) {\n            //                 //console.log(data);\n            //                 if(data.success){\n            //                     //console.log(\"HUZZAH\", vm.plane_document);\n            //                     //console.log(\"HUZZAH\", data);\n            //                     //then we need to remove this from the list of files...\n                                \n                                \n            //                     //move somewhere?\n            //                    // $state.reload();\n            //                    // $state.go('dashboard.my_account.poid', {}, { reload: true });\n\n\n            //                 } else {\n\n            //                     alert(\"Something went terribly wrong... \\n\\n \"+data.message);\n\n            //                 }\n\n            //             });\n\n\n            //     }\n\n\n\n             };\n\n\n\n\n             $scope.change_file_name = function(file){\n                \n                //this is terribly ineficient... unfortunately... can't \n                //work out how else to do it! (lol)\n\n                // //console.log(\"TO BE CHANGED\", file);\n\n                // //console.log(\"BEFORE BEFORE\", vm.plane_documents);\n\n                vm.plane_documents = $.grep(vm.plane_documents, function(e){ \n                    return e.temp_path != file.temp_path; \n                });\n\n                // //console.log(\"BEFORE\", vm.plane_documents);\n\n                vm.plane_documents.push(file);\n\n                // //console.log(\"AFTER\", vm.plane_documents);\n\n             }\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n        initController();\n\n        function initController() {\n           //console.log(\"check if access is okay\");\n        }\n\n\n            var warning_msg = \"By deleting this plane, you will also cancel all reservations that this plane currently has.\"\n\n          $scope.open = function (plane_id) {\n            var modalInstance = $uibModal.open({\n              animation: true,\n              templateUrl: 'views/modals/deleteModal.html',\n              controller: 'ModalInstanceCtrl',\n              size: \"lg\",\n              resolve: {\n                id: function () {\n                  return plane_id;\n                },\n                params: function() {\n                  return {id: plane_id};\n                },\n                warning: function(){\n                    return warning_msg;\n                }\n              }\n            });\n            modalInstance.result.then(function (plane_id) {\n              $log.info('PRESSED GO: '+plane_id.id);\n              ExperiencesService.Delete(vm.user.id, plane_id.id)\n              .then(function(){\n                //console.log(\"HELLO DELETE\");\n                //update view?\n                 vm.club.items = $.grep(vm.club.items, function(e){ \n                    return e.id != plane_id.id; \n                });\n              })\n            }, function () {\n              $log.info('Modal dismissed at: ' + new Date());\n            });\n          };\n\n         \n\n\n    }\n app.controller('DashboardClubFlightsController', DashboardClubFlightsController);\n\n    DashboardClubFlightsController.$inject = ['UserService', 'PlaneService', '$rootScope', '$location', '$scope', '$state', '$stateParams', '$uibModal', '$log', '$window', 'LicenceService', 'MedicalService', 'DifferencesService', 'PlaneDocumentService'];\n    function DashboardClubFlightsController(UserService, PlaneService, $rootScope, $location, $scope, $state, $stateParams, $uibModal, $log, $window, LicenceService, MedicalService, DifferencesService, PlaneDocumentService) {\n        var vm = this;\n\n           //    /* PLEASE DO NOT COPY AND PASTE THIS CODE. */(function(){var w=window,C='___grecaptcha_cfg',cfg=w[C]=w[C]||{},N='grecaptcha';var gr=w[N]=w[N]||{};gr.ready=gr.ready||function(f){(cfg['fns']=cfg['fns']||[]).push(f);};(cfg['render']=cfg['render']||[]).push('explicit');(cfg['onload']=cfg['onload']||[]).push('initRecaptcha');w['__google_recaptcha_client']=true;var d=document,po=d.createElement('script');po.type='text/javascript';po.async=true;po.src='https://www.gstatic.com/recaptcha/releases/JPZ52lNx97aD96bjM7KaA0bo/recaptcha__en.js';var e=d.querySelector('script[nonce]'),n=e&&(e['nonce']||e.getAttribute('nonce'));if(n){po.setAttribute('nonce',n);}var s=d.getElementsByTagName('script')[0];s.parentNode.insertBefore(po, s);})();\n\n           // var initRecaptcha = function () { \n           //     // document.getElementById(\"SearchModule\").scope().vm.parent.isGrecaptchaLoaded = !0, \n           //     // document.getElementById(\"SearchModule\").scope().vm.showRecaptcha();\n           //     vm.showRecaptcha();\n           // };           \n\n\n        vm.user = null;\n        vm.allUsers = [];\n        vm.club = {\n            plane: {\n                requirements: {\n                    licence: [],\n                    medical: [],\n                    differences: []\n                },\n                documents: []\n            }\n        };\n\n        vm.show_loading = false;\n\n        vm.page_title = \"\";\n        \n        vm.plane_document = {};\n        vm.plane_documents = [];\n\n        var update_this_file = [];\n        \n        \n        vm.currency_types = [\"class\", \"type\"];\n        vm.gear_types = [\"tricycle\", \"tailwheel\", \"monowheel\", \"floats\", \"amphibian\", \"skis\"];\n        // vm.certificates = [\"Certificate of Airworthiness\", \"National Certificate of Airworthiness\", \"Permit to Fly\"];\n        vm.certificates = [{id: 1, title: \"Certificate of Airworthiness\", value: \"cofa\"}, {id: 2, title: \"National Certificate of Airworthiness\", value: \"cofa\"}, {id: 2, title: \"LAA Permit to Fly\", value: \"ptf\"}];\n        vm.classes = [\"SEP (land)\", \"SEP (sea)\", \"SET (land)\", \"SET (sea)\", \"MEP (land)\", \"MEP (sea)\", \"ME\"];\n\n        vm.charge_type = [\"airborne\", \"brakes\", \"tacho\", \"hobbs\", \"flight\", \"brakes_rounded\"];\n        vm.surcharge_type = [\"none\", \"flight\", \"hour\"];\n\n        vm.action = $state.current.data.action;\n        vm.user = $rootScope.globals.currentUser;\n        //console.log(\"$rootScope.globals.currentUser : \", $rootScope.globals.currentUser);\n        vm.club_id = $rootScope.globals.currentUser.current_club_admin.id;\n        vm.user_id = vm.user.id;\n\n\n       \n        // //console.log(vm.action);\n        // //console.log($stateParams);\n        // //console.log($stateParams.id);\n       \n        vm.to_date = new Date();\n        vm.from_date = new Date();\n        vm.aircraft = \"\";\n\n        vm.from_date.setMonth(vm.from_date.getMonth() - 1);\n        vm.show_loading = true;\n        PlaneService.GetAllFlightsByClub(vm.club_id, vm.from_date, vm.to_date, vm.selected_aircraft)\n        .then(function(data){\n            vm.flights = data.flights;  \n            vm.totals = data.totals; \n            vm.aircraft = data.aircraft; \n            vm.show_loading = false;\n            //console.log(vm.club.planes);\n        });\n\n\n         vm.editing = false;\n        \n        switch(vm.action){\n            case \"add\":\n                //console.log(\"adding a new plane please\");\n                vm.page_title = \"Add a New Plane\";\n            break;\n            case \"edit\":\n                vm.editing = true;\n                //console.log(\"edit an existing plane\");\n                PlaneService.GetById($stateParams.plane_id, vm.club_id)\n                    .then(function(data){\n                        vm.club.plane = data;   \n                        // vm.club.plane.requirements = {\n                        //         licence: [],\n                        //         medical: [],\n                        //         differences: [],\n                        //         hours: []\n                        // };\n\n                        console.log(vm.club.plane);\n\n                        vm.club.plane.airframe_hours = parseFloat(vm.club.plane.airframe_hours);\n\n                        vm.club.plane.vp = (vm.club.plane.vp == 1)? true:false;\n                        vm.club.plane.rg = (vm.club.plane.rg == 1)? true:false; \n                        vm.club.plane.tb = (vm.club.plane.tb == 1)? true:false; \n\n                        vm.plane_engine_1 = vm.club.plane.engine_1;\n                        vm.plane_engine_2 = vm.club.plane.engine_2;\n\n                        vm.plane_propeller_1 = vm.club.plane.propeller_1;\n                        vm.plane_propeller_2 = vm.club.plane.propeller_2;\n\n                        //console.log(vm.club);\n                        vm.page_title = \"Edit a Plane - \"+vm.club.plane.registration;\n                    });\n\n               \n\n\n               \n\n\n            break;\n            case \"list\":\n                //need to update this to be part of the authentication\n                //to find out club id\n\n                PlaneService.GetAllByClub(vm.club_id)\n                    .then(function(data){\n                        vm.club.planes = data;   \n                        //console.log(vm.club.planes);\n                    });\n            break;\n            default:\n                //console.log(\"none of the above... redirect somewhere?\");\n            break;\n        }  \n\n        //'9' needs to refer the the user's account set to manage\n       \n        $scope.back = function(){\n            $window.history.back();\n        }\n\n        $scope.my_search = \"\";\n\n        $scope.search = function(row){\n            // console.log(\"hi\", (angular.lowercase(row.title).indexOf(angular.lowercase($scope.my_search) || '') !== -1));\n            //console.log(row);\n            if($scope.my_search == \"\"){\n                return true;\n            }\n            var my_return = false;\n            if(row && row.aircraft){\n                if(angular.lowercase(row.aircraft.registration).indexOf(angular.lowercase($scope.my_search) || '') !== -1){\n                    return true;\n                }\n            }\n            if(row && row.flight_date){\n                if(angular.lowercase(row.flight_date.toString()).indexOf(angular.lowercase($scope.my_search) || '') !== -1){\n                    return true;\n                }\n            }\n            if(row && row.from_airport && row.from_airport.code){\n                if(angular.lowercase(row.from_airport.code).indexOf(angular.lowercase($scope.my_search) || '') !== -1){\n                    return true;\n                }\n            }\n            if(row && row.from_airport && row.from_airport.title){\n                if(angular.lowercase(row.from_airport.title).indexOf(angular.lowercase($scope.my_search) || '') !== -1){\n                    return true;\n                }\n            }\n            if(row && row.to_airport && row.to_airport.code){\n                if(angular.lowercase(row.to_airport.code).indexOf(angular.lowercase($scope.my_search) || '') !== -1){\n                    return true;\n                }\n            }\n            if(row && row.to_airport && row.to_airport.title){\n                if(angular.lowercase(row.to_airport.title).indexOf(angular.lowercase($scope.my_search) || '') !== -1){\n                    return true;\n                }\n            }\n\n            return my_return;\n            // return ( (angular.lowercase(row.aircraft.registration).indexOf(angular.lowercase($scope.my_search) || '') !== -1) || \n            //         (angular.lowercase(row.flight_date.toString()).indexOf(angular.lowercase($scope.my_search) || '') !== -1) \n            //          );\n            /*\n    || (angular.lowercase(row.from_airport.title.toString()).indexOf(angular.lowercase($scope.my_search) || '') !== -1) ||\n                    (angular.lowercase(row.to_airport.title.toString()).indexOf(angular.lowercase($scope.my_search) || '') !== -1)\n            */\n        };\n\n        $scope.set_aircraft_details = function(){\n\n            // console.log(\"get deeeets\", vm.plane_search);\n\n            PlaneService.GetAddAircraft(vm.plane_search.registration)\n                .then(function (data) {\n                    ////console.log(data);\n\n                    // console.log(data);\n                                // return false;\n\n                    if(data){\n                        //use GB airfields first...\n                       \n                         if(data.length == 0){\n                            //console.log(\"SETTINGS HERE\");\n                                // vm.plane_search = \n                                //     {\n                                //         id: 0,\n                                //         registation: vm.plane_search.registration,\n                                //         icao_type: \"not known\"\n                                //     };\n\n                                // vm.club.plane.manufacturer = vm.plane_search.manufacturer;      \n\n                        } else {\n\n                                vm.plane_search = data;\n                                // console.log(\"SUCCESS FOUND\", data);\n                                processNewAircraft();\n                        }\n\n\n                        //console.log(\"PLANE SEARCHED\", vm.plane_search);\n\n                    } else {\n\n\n                        console.log(\"WOOOPSIES... this aircraft isn't in our database?\");\n                        //this should be very very rare...\n\n                         // vm.plane_search = \n                         //            {\n                         //                registation: vm.plane_search.registration,\n                         //                icao_type: \"not known\"\n                         //            };\n                                    // vm.club.plane.manufacturer = vm.plane_search.manufacturer;                        \n\n                    }\n\n                });\n\n\n        }\n\n        function processNewAircraft(){\n\n\n            //vm.club.plane \n\n            //TYPES -->>>\n\n              //aircraft_class --> FIXED-WING LANDPLANE\n                  //is_propeller = 1\n                  //number_of_engines  --> 1 = SEP\n                                    // --> >1 = MEP\n\n                  //is_propeller = 0\n                  //number_of_engines  --> 1 = SET\n                                    // --> >1 = ME\n\n\n            vm.club.plane.manufacturer = vm.plane_search.manufacturer;                        \n            vm.club.plane.serial_no = vm.plane_search.serial_number;                        \n            vm.club.plane.plane_type = vm.plane_search.icao_type;                        \n            vm.club.plane.type_name = vm.plane_search.type_name;                        \n            vm.club.plane.year_built = vm.plane_search.year_built;                        \n            vm.club.plane.aircraft_id = vm.plane_search.id;       \n            vm.club.plane.mtow = parseInt(vm.plane_search.mtow);\n            vm.club.plane.airframe_hours = vm.plane_search.airframe_hours;          \n\n\n            // alert(vm.plane_search.gear_type);\n\n            if(vm.plane_search.noise_level){\n\n                var regex = /[+-]?\\d+(\\.\\d+)?/g;\n\n                vm.plane_noise.noise_level = vm.plane_search.noise_level.match(regex).map(function(v) { return parseFloat(v); });\n                ////console.log(floats);\n\n            }\n            // vm.club.plane.noise_level = vm.plane_search.noise_level;//parseInt(vm.plane_search.noise_level);                 \n            \n\n\n            vm.plane_noise.noise_cert_issue = (vm.plane_search.noise_cert_issue)? new Date(vm.plane_search.noise_cert_issue) : \"\";                 \n\n            if(vm.plane_search.aircraft_class.indexOf(\"FIXED-WING\") > -1){\n\n                if(vm.plane_search.is_propeller > 0 && vm.plane_search.engine_name.indexOf(\"PT6A-\") == -1){\n\n                    vm.club.plane.plane_class = (vm.club.plane.number_of_engines > 1) ? \"MEP\" : \"SEP\";\n\n                } else {\n\n                    vm.club.plane.plane_class = (vm.club.plane.number_of_engines > 1) ? \"ME\" : \"SET\";\n\n                }\n\n                if(vm.plane_search.aircraft_class.indexOf(\"LANDPLANE\") > -1){\n                    vm.club.plane.plane_class = vm.club.plane.plane_class + \" (land)\";\n                    vm.club.plane.gear_type = \"\";\n                }\n\n                if(vm.plane_search.aircraft_class.indexOf(\"AMPHIBIAN\") > -1 || vm.plane_search.aircraft_class.indexOf(\"FLOAT\") > -1){\n                    vm.club.plane.plane_class = vm.club.plane.plane_class + \" (sea)\";\n                    vm.club.plane.gear_type = (vm.plane_search.aircraft_class.indexOf(\"AMPHIBIAN\") > -1)? \"amphibian\" : \"floats\";\n                }\n\n\n\n            }        \n\n\n\n            vm.club.plane.seats = (parseInt(vm.plane_search.seats) + 1);\n\n\n            //Certificate of Airworthiness ==> National CofA\n            //Permit to Fly ==> LAA permit\n            //EASA Certificate of Airworthiness ==> EASA CofA\n            vm.plane_maintenance.cofa_category =  (vm.plane_search.cofa_category.indexOf(\"cofa\") > -1)? \"Certificate of Airworthiness\" : \"Permit to Fly\";//(vm.plane_search.cofa_category.indexOf(\"EASA\") > -1)? \"EASA Certificate of Airworthiness\" : ((vm.plane_search.cofa_category.indexOf(\"Certificate of Airworthiness\") > -1)? \"National Certificate of Airworthiness\" : \"Permit to Fly\");\n            vm.plane_maintenance.certificate_expiry = new Date(vm.plane_search.cofa_expiry);\n            \n            vm.club.plane.cofa_category = vm.plane_maintenance.cofa_category;//(vm.plane_search.cofa_category.indexOf(\"EASA\") > -1)? \"easa_cofa\" : ((vm.plane_search.cofa_category.indexOf(\"Certificate of Airworthiness\") > -1)? \"n_cofa\" : \"permit\")\n\n            vm.club.plane.gear_type = vm.plane_search.gear_type;\n\n\n\n            //ENGINES AND PROPS!!!\n            vm.plane_engine_1.make = vm.plane_search.engine_name;                        \n            vm.plane_engine_1.model = vm.plane_search.engine_name;                     \n\n            vm.plane_propeller_1.make = vm.plane_search.propeller_manufacturer;                        \n            vm.plane_propeller_1.model = vm.plane_search.propeller_name;                        \n\n            if(vm.plane_search.number_of_engines > 1){\n                \n                vm.number_of_engine = vm.plane_search.number_of_engines;\n\n                vm.plane_engine_2.make = vm.plane_search.engine_name;                        \n                vm.plane_engine_2.model = vm.plane_search.engine_name;\n                \n                vm.plane_propeller_2.make = vm.plane_search.propeller_manufacturer;                        \n                vm.plane_propeller_2.model = vm.plane_search.propeller_name; \n            }   \n\n        }\n\n\n        $scope.save = function(){\n            if(vm.action == \"add\"){\n                //console.log(\"CREATE click\");\n                $scope.create();\n            } else {\n                //console.log(\"EDIT click\");\n                //console.log(vm.club.plane);\n                $scope.update();\n            }\n        }\n\n        vm.update_ac = function(){\n\n        }\n\n        vm.search_for_flights = function(){\n            vm.show_loading = true;\n            var plane_id = 0;\n            if(vm.selected_aircraft && vm.selected_aircraft.plane_id){\n                plane_id = vm.selected_aircraft.plane_id;\n            }\n             PlaneService.GetAllFlightsByClub(vm.club_id, vm.from_date, vm.to_date, plane_id)\n                .then(function(data){\n                    vm.flights = data.flights;  \n                    vm.totals = data.totals; \n                    vm.aircraft = data.aircraft;\n                    vm.show_loading = false; \n                    //console.log(vm.club.planes);\n                });\n        }\n\n        vm.round_brake_times_start = function(input, earlier_input=null){\n            \n                if(input){\n                  if(input.indexOf(\":\") > -1){\n                    var split = input.split(\":\");\n                    var x = split[1];\n\n\n\n                    var min_nearest_five = ((x % 5) >= 2.5 ? parseInt(x / 5) * 5 + 5 : parseInt(x / 5) * 5);\n                    \n\n\n                    if(min_nearest_five < 10){\n                      min_nearest_five = \"0\"+min_nearest_five;\n                    } else if(min_nearest_five == 60){\n                      split[0]++;\n                      min_nearest_five = \"00\";\n                    } else if(min_nearest_five > 60){\n                      split[0]++;\n                      min_nearest_five = (min_nearest_five - 60);\n                    }\n\n\n                    if(earlier_input && earlier_input.indexOf(\":\") > -1){\n                            // console.log(\"total calculated?\");\n                            // console.log(\"earlier_input: \", earlier_input);\n                            // console.log(\"input: \", input);\n                            var esplit = earlier_input.split(\":\");\n                            var ehour = esplit[0];\n                            var emin = esplit[1];\n                            var etot = (parseInt(ehour)*60) + parseInt(emin); \n                            // console.log(\"etot: \", etot);\n                            var hr = split[0];\n                            var mn = min_nearest_five;\n                            var tot = (parseInt(hr)*60) + parseInt(mn);\n                            // console.log(\"tot: \", tot);\n\n                            if(etot < tot){\n                                //the earlier time is after the end time\n                                // console.log(\"etot < tot\");\n                                min_nearest_five = parseInt(min_nearest_five) - 5;\n                                if(min_nearest_five == 60){\n                                    split[0]++; \n                                    min_nearest_five = \"00\";\n                                } else if(min_nearest_five > 60){\n                                    split[0]++;\n                                    min_nearest_five = (min_nearest_five - 60);\n                                    if(min_nearest_five < 10 ){\n                                      min_nearest_five = \"0\"+min_nearest_five;\n                                    }\n                                } else if(min_nearest_five < 0){\n                                    split[0]--;\n                                    min_nearest_five = (60 + parseInt(min_nearest_five));\n                                }\n                                // console.log(\"split: \", split[0]);\n                                // console.log(\"min_nearest_five: \", min_nearest_five);\n                            }\n\n                    }\n                    //essentially we add 5 in case something happens over the limit\n\n                    return split[0] + \":\" + min_nearest_five;\n                  } else {\n                    return input;\n                  }\n                } else {\n                  return '';\n                }\n          \n\n          }\n\n\n        $scope.create = function(){\n            ////console.log(\"CREATE ME NOW\");\n            vm.club.plane.club_id = vm.club_id;\n            vm.club.plane.add_documents = vm.plane_documents;\n            vm.club.plane.registration = vm.plane_search.registration;\n\n            vm.club.maintenance_type = vm.plane_maintenance.cofa_category.value;\n\n            console.log(\"vm.plane_maintenance.cofa_category \", vm.club.maintenance_type );\n            return false;\n            vm.plane_maintenance.file = vm.files.cert[0];\n            vm.plane_radio.file = vm.files.radio[0];\n            vm.plane_noise.file = vm.files.noise[0];\n            vm.plane_insurance.file = vm.files.insurance[0];\n\n            vm.club.plane.maintenance = vm.plane_maintenance;\n            vm.club.plane.insurance = vm.plane_insurance;\n            vm.club.plane.noise_cert = vm.plane_noise;\n            vm.club.plane.radio_licence= vm.plane_radio;\n\n            vm.club.plane.vp = (vm.club.plane.vp)? 1:0;\n            vm.club.plane.rg = (vm.club.plane.rg)? 1:0; \n            vm.club.plane.tb = (vm.club.plane.tb)? 1:0; \n\n            vm.club.plane.engine_1 = vm.plane_engine_1;\n            vm.club.plane.engine_2 = vm.plane_engine_2;\n            vm.club.plane.propeller_1 = vm.plane_propeller_1;\n            vm.club.plane.propeller_2 = vm.plane_propeller_2;\n\n\n            //return false;\n            //console.log(\"PLANE TO ADD, \", vm.club.plane);\n            //return false;\n            PlaneService.Create(vm.club.plane)\n                .then(function(data){\n                    ////console.log(data);\n                    $state.go('dashboard.manage_club.planes', {reload: true});\n\n                });\n        }\n\n        $scope.delete = function(){\n            //console.log(\"CLICK\");\n            alert(\"Are you sure you would like to delete this plane?\");\n            PlaneService.Update(vm.club.plane)\n                .then(function(data){\n                    //console.log(data);\n                });\n        }\n\n        function get_update_docs(){\n            var documents = [];\n\n            for(var i=0;i<update_this_file.length;i++){\n                var id = update_this_file[i];\n                //console.log(\"looking for : \", id);\n                //console.log(\"in: \", vm.plane_documents);\n\n                for(var k=0;k<vm.club.plane.plane_documents.length;k++){\n                    //console.log(\"comparing to : \", vm.club.plane.plane_documents[k].id);\n                    if(vm.club.plane.plane_documents[k].id == id){\n                        documents.push(vm.club.plane.plane_documents[k]);\n                    }\n                }\n\n            }\n\n            // //console.log(\"DOCS TO UPDATE : \", documents);\n\n            return documents;\n        }\n\n        $scope.update = function(){\n            //console.log(\"CLICK\");\n            vm.club.plane.club_id = vm.club_id;\n            vm.club.plane.add_documents = vm.plane_documents;\n\n            vm.club.plane.update_documents = get_update_docs();\n            //get_update_docs();\n\n            PlaneService.Update(vm.club.plane)\n                .then(function(data){\n                    //console.log(data);\n                    //console.log(\"saved\");\n                    $state.go('dashboard.manage_club.planes');\n                });\n        }\n\n        vm.save_new_aircraft_bit = function(item, num){\n            \n            // console.log(item);\n            // console.log(num);\n\n            //this assumes there was an engine and prop already saved\n\n\n            var comb = \"plane_\"+item+\"_\"+num;\n            var comb2 = \"plane_\"+item+\"_\"+num+\"_replace\";\n\n            var item_update = {};\n            \n            if(vm[comb] && vm[comb] !== \"\"){\n                //only if there is one set --> FIRST!!!\n                vm[comb].removed_date = vm[comb2].removed_date;\n                delete(vm[comb2].removed_date);\n\n                item_update = {\n                    old_item: vm[comb],\n                    new_item: vm[comb2],\n                    plane_id: vm.club.plane.id,\n                    item: item,\n                    no: num\n                };\n            } else {\n                item_update = {\n                    old_item: {},\n                    new_item: vm[comb2],\n                    plane_id: vm.club.plane.id,\n                    item: item,\n                    no: num\n                };\n            }\n\n            \n\n            // if(item == \"engine\"){\n            //     if(num == 1){\n                    \n            //         console.log( \"engine\", vm );\n            //         console.log( \"engine\", vm.plane_engine_1 );\n            //         console.log( \"engine\", vm.plane_engine_1.removed_date );\n            //         console.log( \"engine\", vm.plane_engine_1_replace );\n            //         console.log( \"engine\", vm.plane_engine_1_replace.removed_date );\n\n            //         vm.plane_engine_1.removed_date = vm.plane_engine_1_replace.removed_date;\n            //         delete(vm.plane_engine_1_replace.removed_date);\n            //         item_update.old_item = vm.plane_engine_1;\n            //         item_update.new_item = vm.plane_engine_1_replace;\n\n            //     } else if(num == 2){\n            //         vm.plane_engine_2.removed_date = vm.plane_engine_2_replace.removed_date;\n            //         delete(vm.plane_engine_2_replace.removed_date);\n            //         item_update.old_item = vm.plane_engine_2;\n            //         item_update.new_item = vm.plane_engine_2_replace;\n            //     }\n            // } else if(item == \"propeller\"){\n            //     if(num == 1){\n            //         vm.plane_propeller_1.removed_date = vm.plane_engine_1_replace.removed_date;\n            //         delete(vm.plane_engine_1_replace.removed_date);\n            //         item_update.old_item = vm.plane_propeller_1;\n            //         item_update.new_item = vm.plane_engine_1_replace;\n            //     } else if(num == 2){\n            //         vm.plane_propeller_2.removed_date = vm.plane_engine_2_replace.removed_date;\n            //         delete(vm.plane_engine_2_replace.removed_date);\n            //         item_update.old_item = vm.plane_propeller_2;\n            //         item_update.new_item = vm.plane_engine_2_replace;\n            //     }\n            // }\n\n           \n            console.log(\"LETS SEE WHAT WOULD BE SENT\", item_update);\n\n\n            PlaneService.UpdateAircraftBit(item_update)\n                .then(function(data){\n                    console.log(data);\n                    //console.log(\"saved\");\n                    $state.go('dashboard.manage_club.planes');\n                });\n\n        }\n\n\n        function containsObject(obj, list, params) {\n\n            // //console.log(\"obj\", obj);\n            // //console.log(\"list\", list);\n            // //console.log(\"params\", params);\n\n            for(var i=0; i<list.length; i++) {\n                // //console.log(\"list i : \", list[i]);\n                // //console.log(\"obj is: \", obj);\n\n                var count_success = 0;\n                for(var j=0;j<params.length;j++){\n                    if(list[i][params[j]] && obj[params[j]] && list[i][params[j]] == obj[params[j]]){\n                        count_success++;\n                    }\n                }\n\n                if(count_success === params.length) {                    \n                    return true;\n                }\n            }\n\n            return false;\n        }\n\n\n        function check_all(){\n\n            //maybe a nice to have one day... not yet though.\n\n\n            //licences\n            vm.club.plane.requirements.licence.forEach(function(obj){\n\n            });\n\n        }\n\n      \n\n\n        $scope.add_item = function(type){\n            //console.log(\"ADD\");\n            switch(type){\n                case \"licence\":\n                    //console.log(\"licence\");\n                    if(vm.temporary.licence && vm.temporary.licence !== \"\" && vm.temporary.rating && vm.temporary.rating !== \"\"){\n                        //then we can add it\n                        //console.log(\"here we go\");\n                        var add_licence = {\n                            licence_id: vm.temporary.licence.id,\n                            licence_title: vm.temporary.licence.abbreviation,\n                            rating_title: vm.temporary.rating.abbreviation,\n                            rating_id: vm.temporary.rating.id\n                        };\n\n                        //check if it doesnt exist first...\n                        if(containsObject(add_licence, vm.club.plane.requirements.licence, new Array(\"licence_id\", \"rating_id\")) == false){\n                            vm.club.plane.requirements.licence.push(add_licence);\n                        }\n\n                        delete vm.temporary.licence;\n                        delete vm.temporary.rating;\n\n                    } else {\n                        alert(\"Please select a licence and rating that is required to book the plane solo!\");\n                    }\n\n                break;\n\n\n                case \"medical\":\n                    //console.log(\"medical\");\n                    if(vm.temporary.medical_authority && vm.temporary.medical_authority !== \"\" && vm.temporary.medical_component && vm.temporary.medical_component !== \"\"){\n                        //then we can add it\n                        //console.log(\"here we go\");\n                        var add_medical = {\n                            authority_id: vm.temporary.medical_authority.id,\n                            authority_title: vm.temporary.medical_authority.abbreviation,\n                            medical_component_id: vm.temporary.medical_component.id,\n                            medical_component_title: vm.temporary.medical_component.title\n                        };\n\n                        //check if it doesnt exist first...\n                        if(containsObject(add_medical, vm.club.plane.requirements.medical, new Array(\"authority_id\", \"medical_component_id\")) == false){\n                            vm.club.plane.requirements.medical.push(add_medical);\n                        }\n\n                        delete vm.temporary.medical_authority;\n                        delete vm.temporary.medical_component;\n\n                    } else {\n                        alert(\"Please select a medical that is required to book the plane solo!\");\n                    }\n\n                break;\n\n\n                case \"differences\":\n                    //console.log(\"difference\");\n                    if(vm.temporary.difference && vm.temporary.difference !== \"\"){\n                        //then we can add it\n                        //console.log(\"here we go\");\n                        var add_difference = {\n                            difference_id: vm.temporary.difference.id,\n                            difference_title: vm.temporary.difference.title\n                        };\n\n                        //check if it doesnt exist first...\n                        if(containsObject(add_difference, vm.club.plane.requirements.differences, new Array(\"difference_id\", \"difference_title\")) == false){\n                            vm.club.plane.requirements.differences.push(add_difference);\n                        }\n\n                        delete vm.temporary.difference;\n\n                    } else {\n                        alert(\"Please select a difference that is required to book the plane solo!\");\n                    }\n\n                break;\n\n\n            }\n\n\n\n        }\n\n\n        $scope.remove_item = function(type, index){\n            //console.log(\"REMOVE\");\n\n            vm.club.plane.requirements[type].splice(index, 1);\n\n\n            // switch(type){\n            //     case \"licence\":\n            //             //console.log(\"licence\");\n                   \n            //             //check if it doesnt exist first...\n            //             // if(containsObject(add_licence, vm.club.plane.requirements.licence, new Array(\"licence_id\", \"rating_id\")) == false){\n            //             //     vm.club.plane.requirements.licence.push(add_licence);\n            //             // }\n\n            //             vm.club.plane.requirements.licence.splice(index, 1);\n                      \n                   \n\n            //     break;\n\n\n            //     case \"medical\":\n            //         //console.log(\"medical\");\n            //         if(vm.temporary.medical_authority && vm.temporary.medical_authority !== \"\" && vm.temporary.medical_component && vm.temporary.medical_component !== \"\"){\n            //             //then we can add it\n            //             //console.log(\"here we go\");\n            //             var add_medical = {\n            //                 authority_id: vm.temporary.medical_authority.id,\n            //                 authority_title: vm.temporary.medical_authority.abbreviation,\n            //                 medical_component_id: vm.temporary.medical_component.id,\n            //                 medical_component_title: vm.temporary.medical_component.title\n            //             };\n\n            //             //check if it doesnt exist first...\n            //             if(containsObject(add_medical, vm.club.plane.requirements.medical, new Array(\"authority_id\", \"medical_component_id\")) == false){\n            //                 vm.club.plane.requirements.medical.push(add_medical);\n            //             }\n\n            //             delete vm.temporary.medical_authority;\n            //             delete vm.temporary.medical_component;\n\n            //         } else {\n            //             alert(\"Please select a medical that is required to book the plane solo!\");\n            //         }\n\n            //     break;\n\n\n            //     case \"differences\":\n            //         //console.log(\"difference\");\n            //         if(vm.temporary.difference && vm.temporary.difference !== \"\"){\n            //             //then we can add it\n            //             //console.log(\"here we go\");\n            //             var add_difference = {\n            //                 difference_id: vm.temporary.difference.id,\n            //                 difference_title: vm.temporary.difference.title\n            //             };\n\n            //             //check if it doesnt exist first...\n            //             if(containsObject(add_difference, vm.club.plane.requirements.differences, new Array(\"difference_id\", \"difference_title\")) == false){\n            //                 vm.club.plane.requirements.differences.push(add_difference);\n            //             }\n\n            //             delete vm.temporary.difference;\n\n            //         } else {\n            //             alert(\"Please select a difference that is required to book the plane solo!\");\n            //         }\n\n            //     break;\n\n\n            // }\n\n\n\n        }\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n        $scope.update_this_file = function(file){\n            //console.log(\"==== update is : \", file.id);\n            if(update_this_file.indexOf(file.id) === -1){\n                update_this_file.push(file.id)\n            } else {\n               ////console.log(\"This item already exists\"); \n            } \n        }\n\n\n         $scope.remove_real_file = function(file){\n\n                //remove_file\n\n                vm.club.plane.plane_documents = $.grep(vm.club.plane.plane_documents, function(e){ \n                        return e.id != file.id; \n                    });\n\n                //no need to actually remove the file as it will be archived accordingly on the backend whilst it is missing! :)\n                PlaneDocumentService.Delete(vm.user_id, file.id)\n                .then(function (data) {\n                    //console.log(data);\n                    if(data.success){\n                        //console.log(\"HUZZAH\", current_files);\n                        //then we need to remove this from the list of files...\n                        //clear files\n                        vm.plane_documents = [];\n                        //and re-process available files\n                        $scope.processFiles(current_files);\n\n                    } else {\n                        //console.log(\"WOOOPSIES...\");\n                        //this should be very very rare...\n                    }\n\n                });\n\n          }\n\n\n        vm.files = {\n            radio: [],\n            cert: [],\n            insurance: [],\n            noise: []\n        }\n\n\n           $scope.processFile = function(files, location){\n                 //console.log(\"files\", files[0].file_return);\n\n                     // //console.log(\"JSON\", files[i].file_return);\n                    var j = JSON.parse(files[0].file_return);\n                     ////console.log(\"PARSED\", j);\n                    // //console.log(\"J is : \",j);\n                    // //console.log(\"name is : \", j.files.file.name);\n\n                    files[0].file.temp_path = j.saved_url;\n                    files[0].file.save_name = j.files.file.name;\n\n                    var ft = j.files.file.name;\n                    //console.log(\"ft\", ft);\n                    var fft = ft.split('.').pop();\n                    files[0].file.extension = fft;\n                    //console.log(\"FILE is : \", files[0]);\n\n                    // //console.log(\"file\", files[i].file);\n                    vm.files[location].push(files[0].file);\n\n\n            }\n\n            $scope.set_title = function(file){\n                //console.log(\"return\", file);\n                return file.save_name;\n            }\n\n\n          \n          $scope.remove_file = function(file, current_files){\n\n            //remove_file\n            var j = JSON.parse(file.file_return);\n            //console.log(\"REMOVE: \", j);\n            //console.log(\"REMOVE: \", j.saved_url);\n\n            //to delete the temp file created: j.saved_url\n            //tmp_rm.php POST tmp = filename\n            \n            PoidService.DeleteTmp(j.saved_url)\n                .then(function (data) {\n                    //console.log(data);\n                    if(data.success){\n                        //console.log(\"HUZZAH\", current_files);\n                        //then we need to remove this from the list of files...\n                        //clear files\n                        vm.plane_documents = [];\n                        //and re-process available files\n                        $scope.processFiles(current_files);\n\n                    } else {\n                        //console.log(\"WOOOPSIES...\");\n                        //this should be very very rare...\n                    }\n\n                });\n\n          }\n          \n\n          // $scope.$on('flow::fileAdded', function (event, $flow, flowFile) {\n          //     event.preventDefault();//prevent file from uploading\n          //     //console.log(\"FILE ADDED\");\n          //     //console.log($flow);\n          //   });\n\n            $scope.processFiles = function(files){\n                // //console.log(\"files\", files);\n\n                for(var i=0; i<files.length; i++){\n                    // //console.log(\"JSON\", files[i].file_return);\n                    var j = JSON.parse(files[i].file_return);\n                    // //console.log(\"PARSED\", j);\n                    //console.log(\"J is : \",j);\n                    //console.log(\"name is : \", j.files.file.name);\n\n                    files[i].file.temp_path = j.saved_url;\n                    files[i].file.save_name = j.files.file.name;\n                    var ft = j.files.file.name;\n                    ft = ft.split('.').pop();\n                    files[i].file.extension = ft;\n\n                    // //console.log(\"file\", files[i].file);\n                    vm.plane_documents.push(files[i].file);\n                }\n\n\n            }\n\n            $scope.set_title = function(file){\n                //console.log(\"return\", file);\n                return file.save_name;\n            }\n\n            $scope.get_icon = function(file){\n\n                var ft = file.name;\n                ft = ft.split('.').pop();\n                var icon_name = \"\";\n\n                // //console.log(\"FILE:\", ft);\n                // //console.log(\"index : \", ft.indexOf(\"pdf\"));\n                switch(true){\n                    case (ft.indexOf(\"pdf\") > -1):\n                        icon_name = \"pdf.png\";\n                    break;\n                    case (ft.indexOf(\"doc\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"docx\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"xls\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"xlsx\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"ppt\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"pptx\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"jpg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"jpeg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"png\") > -1):\n                        icon_name = \"png.png\";\n                    break;\n                    case (ft.indexOf(\"gif\") > -1):\n                        icon_name = \"gif.png\";\n                    break;\n                    case (ft.indexOf(\"zip\") > -1):\n                        icon_name = \"zip.png\";\n                    break;\n                    case (ft.indexOf(\"avi\") > -1):\n                        icon_name = \"avi.png\";\n                    break;\n                    case (ft.indexOf(\"mp4\") > -1):\n                        icon_name = \"mp4.png\";\n                    break;\n                    default:\n                        icon_name = \"file.png\";\n                    break;\n                }\n\n                // //console.log(\"FILE:\", icon_name);\n\n                return \"images/file_icons/\"+icon_name;\n            }\n\n\n            $scope.get_icon2 = function(file){\n\n                var ft = file.split('.').pop();\n                // //console.log(\"ICON 2 : \", ft);\n                var icon_name = \"\";\n\n                // //console.log(\"FILE:\", ft);\n                // //console.log(\"index : \", ft.indexOf(\"pdf\"));\n                switch(true){\n                    case (ft.indexOf(\"pdf\") > -1):\n                        icon_name = \"pdf.png\";\n                    break;\n                    case (ft.indexOf(\"doc\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"docx\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"xls\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"xlsx\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"ppt\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"pptx\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"jpg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"jpeg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"png\") > -1):\n                        icon_name = \"png.png\";\n                    break;\n                    case (ft.indexOf(\"gif\") > -1):\n                        icon_name = \"gif.png\";\n                    break;\n                    case (ft.indexOf(\"zip\") > -1):\n                        icon_name = \"zip.png\";\n                    break;\n                    case (ft.indexOf(\"avi\") > -1):\n                        icon_name = \"avi.png\";\n                    break;\n                    case (ft.indexOf(\"mp4\") > -1):\n                        icon_name = \"mp4.png\";\n                    break;\n                    default:\n                        icon_name = \"file.png\";\n                    break;\n                }\n\n                // //console.log(\"FILE:\", icon_name);\n\n                return \"images/file_icons/\"+icon_name;\n            }\n\n\n\n            $scope.delete_poid = function(id){\n\n              \n                var a = prompt(\"Are you sure you wish to delete this poid? \\n\\n This change is irreversible! To confirm please type YES in the box below.\");\n                if(a == \"YES\"){\n\n\n                    //console.log(\"WE DELETE IT\");\n\n\n                    // PoidService.Delete(vm.user_id, id)\n                    //     .then(function (data) {\n                    //         //console.log(data);\n                    //         if(data.success){\n                    //             //console.log(\"HUZZAH\", data);\n                    //             //then we need to remove this from the list of files...\n                    //             vm.user_poids = $.grep(vm.user_poids, function(e){ \n                    //                 return e.id != id; \n                    //             });\n                                \n                    //             //refresh?\n                    //             $state.reload();\n                    //             $state.go('dashboard.my_account.poid');\n\n                    //         } else {\n\n                    //             alert(\"Something went terribly wrong... \\n\\n \"+data.message);\n\n                    //         }\n\n                    //     });\n\n\n\n                } else {\n                    //console.log(\"ignore123\");\n                }\n\n\n            }\n\n\n\n\n            $scope.save_plane_documents = function(){\n\n               \n              \n\n                //console.log(\"plane_documents: \", vm.plane_documents);\n\n\n                //compile the required elements YAY\n\n                //console.log(\"plane_document \", vm.plane_document);\n\n\n                 //clean shizzle before sending\n                 //why keep sending back heavy data?\n\n                    // for(var i=0;i<vm.plane_document.images.length;i++){\n                    //     delete vm.plane_document.images[i].data_uri;\n                    // }\n\n                    // // vm.plane_document.images = vm.plane_documents;\n                    // vm.plane_document.images = vm.plane_document.images.concat(vm.plane_documents);\n                    // vm.plane_document.user_id = vm.user_id;\n\n\n\n\n            //     if(vm.plane_document.id){\n            //         //then its an udpate\n\n            //         //merge the images left?\n            //         PoidService.Update(vm.plane_document)\n            //             .then(function (data) {\n            //                 //console.log(data);\n            //                 if(data.success){\n            //                     //console.log(\"HUZZAH\", vm.plane_document);\n            //                     //console.log(\"HUZZAH\", data);\n            //                     //then we need to remove this from the list of files...\n                                \n                                \n            //                     //move somewhere?\n            //                     $state.go('dashboard.my_account.poid', {}, { reload: true });\n\n\n\n\n\n            //                 } else {\n\n            //                     alert(\"Something went terribly wrong... \\n\\n \"+data.message);\n\n            //                 }\n\n            //             });\n\n            //     } else {\n\n\n                   \n\n\n            //         //then its a create\n            //         //console.log(vm.plane_document);\n\n            //         PoidService.Create(vm.plane_document)\n            //             .then(function (data) {\n            //                 //console.log(data);\n            //                 if(data.success){\n            //                     //console.log(\"HUZZAH\", vm.plane_document);\n            //                     //console.log(\"HUZZAH\", data);\n            //                     //then we need to remove this from the list of files...\n                                \n                                \n            //                     //move somewhere?\n            //                    // $state.reload();\n            //                    // $state.go('dashboard.my_account.poid', {}, { reload: true });\n\n\n            //                 } else {\n\n            //                     alert(\"Something went terribly wrong... \\n\\n \"+data.message);\n\n            //                 }\n\n            //             });\n\n\n            //     }\n\n\n\n             };\n\n\n\n\n             $scope.change_file_name = function(file){\n                \n                //this is terribly ineficient... unfortunately... can't \n                //work out how else to do it! (lol)\n\n                // //console.log(\"TO BE CHANGED\", file);\n\n                // //console.log(\"BEFORE BEFORE\", vm.plane_documents);\n\n                vm.plane_documents = $.grep(vm.plane_documents, function(e){ \n                    return e.temp_path != file.temp_path; \n                });\n\n                // //console.log(\"BEFORE\", vm.plane_documents);\n\n                vm.plane_documents.push(file);\n\n                // //console.log(\"AFTER\", vm.plane_documents);\n\n             }\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n        initController();\n\n        function initController() {\n           //console.log(\"check if access is okay\");\n        }\n\n\n          var warning_msg = \"By deleting this plane, you will also cancel all reservations that this plane currently has.\"\n\n          // $scope.open = function (plane_id) {\n          //   var modalInstance = $uibModal.open({\n          //     animation: true,\n          //     templateUrl: 'views/modals/deleteModal.html',\n          //     controller: 'ModalInstanceCtrl',\n          //     //params: {},\n          //     size: \"lg\",\n          //     resolve: {\n          //       id: function () {\n          //         return plane_id;\n          //       },\n          //       warning: function(){\n          //           return warning_msg;\n          //       }\n          //     }\n          //   });\n          //   modalInstance.result.then(function (plane_id) {\n          //     $log.info('PRESSED GO: '+plane_id);\n          //     PlaneService.Delete(plane_id)\n          //     .then(function(){\n          //       //console.log(\"HELLO DELETE\");\n          //       //update view?\n          //        vm.club.planes = $.grep(vm.club.planes, function(e){ \n          //           return e.plane_id != plane_id; \n          //       });\n          //     })\n          //   }, function () {\n          //     $log.info('Modal dismissed at: ' + new Date());\n          //   });\n          // };\n\n            $scope.open = function (club_plane_id) {\n            var modalInstance = $uibModal.open({\n              animation: true,\n              templateUrl: 'views/modals/deleteModal.html',\n              controller: 'ModalInstanceCtrl',\n              size: \"lg\",\n              resolve: {\n                id: function () {\n                  return club_plane_id;\n                },\n                params: function() {\n                  return {id: club_plane_id};\n                },\n                warning: function(){\n                    return warning_msg;\n                }\n              }\n            });\n            modalInstance.result.then(function (plane) {\n                var id = plane.id;\n              $log.info('PRESSED GO: ', id);\n              \n              PlaneService.Delete(id)\n              .then(function(){\n                //console.log(\"HELLO DELETE\");\n                //update view?\n                 vm.club.planes = $.grep(vm.club.planes, function(e){ \n                    return e.id != id; \n                });\n             });\n\n            }, function () {\n              $log.info('Modal dismissed at: ' + new Date());\n            });\n\n\n          };\n         \n\n         vm.aircraft;\n         vm.plane_search;\n         vm.plane_to_add;\n\n         $scope.get_aircraft = function(registration){\n\n            if(registration.length > 3){\n\n                 PlaneService.GetAddAircraft(registration)\n                .then(function (data) {\n                    ////console.log(data);\n                    if(data){\n                        //use GB airfields first...\n                         \n                        // vm.aircraft = data;\n                        // console.log(\"one is : \", data[0]);\n                       \n                         if(data.length == 0){\n                            // console.log(\"SETTINGS HERE\");\n                              vm.aircraft = [\n                                    {\n                                        icao_type: \"not known\",\n                                        registration: registration.toUpperCase()\n                                    }];\n                        } else {\n                            vm.aircraft = data;\n                        }\n\n                    } else {\n\n                          vm.aircraft = [\n                                    {\n                                        icao_type: \"not known\",\n                                        registration: registration.toUpperCase()\n                                    }];\n\n                                    //console.log(vm.aircraft);\n                        // console.log(\"WOOOPSIES...\");\n                        //this should be very very rare...\n                    }\n\n                });\n\n\n            }\n\n            \n        }\n\n\n    }\n app.controller('DashboardClubFlyingController', DashboardClubFlyingController);\n\n    DashboardClubFlyingController.$inject = ['UserService', 'MemberService', 'MembershipService', 'PlaneService', '$rootScope', '$location', '$scope', '$state', '$stateParams', '$uibModal', '$log', '$window', 'PoidService',  'LicenceService', 'MedicalService', 'DifferencesService', 'AuthenticationService', '$http', 'PaymentService', 'PackageService', 'BookoutService'];\n    function DashboardClubFlyingController(UserService, MemberService, MembershipService, PlaneService, $rootScope, $location, $scope, $state, $stateParams, $uibModal, $log, $window, PoidService,  LicenceService, MedicalService, DifferencesService, AuthenticationService, $http, PaymentService, PackageService, BookoutService) {\n        var vm = this;\n\n        vm.user = null;\n        vm.allUsers = [];\n        vm.club = {};\n        vm.page_title = \"\";\n        vm.club.member = {};\n                                vm.club.member.payment_now = true;\n\n        vm.imported_new_headers = [];\n\n        // vm.club.member.membership_id = {};\n\n        vm.test = \"Package valid until 12/03/2022<br /> To be used on:<br /> G-BOOF <br /> G-OARU\";\n        \n        vm.action = $state.current.data.action;\n\n        vm.club_id = $rootScope.globals.currentUser.current_club_admin.id;\n        vm.user = $rootScope.globals.currentUser;\n        vm.user_id = vm.user.id;\n\n        vm.no_show_cols = [\"membership_start\", \"membership_id\", \"selected\"];\n\n\n        $scope.sortType     = 'Email'; // set the default sort type\n        $scope.sortReverse  = false;  // set the default sort order\n        $scope.searchTool   = '';     // set the default search/filter term\n\n        ////console.log(\"club_id : \"+vm.club_id);\n\n        // //console.log(vm.action);\n        // //console.log($stateParams);\n        // //console.log($stateParams.id);\n\n\n        $scope.get_human_status = function(status){\n\n            var returned;\n            switch(status){\n                case 'issued':\n            \n                  returned = \"Created\";\n\n              break;\n\n              case 'pending_submission':\n                  \n                    returned = \"Requesting\";\n\n              break;\n\n              case 'submitted':\n                    \n                    returned = \"Requested\";\n\n              break;\n\n              case 'confirmed':\n                    \n                    returned = \"Paid\";\n\n              break;\n\n              case 'paid_out':\n                    returned = \"Paid\";\n\n              break;\n\n              case 'failed':\n                    returned = \"Failed\";\n\n              break;\n\n              case 'charged_back':\n                    returned = \"Charged Back\";\n\n              break;\n              default:\n                  returned = status;\n              break\n            }\n\n            return returned;\n\n        }\n\n        switch(vm.action){\n            case \"add\":\n                //console.log(\"adding a new member please\");\n                vm.page_title = \"Add a New member\";\n\n                 MembershipService.GetAllByClub(vm.club_id)\n                    .then(function(data){\n                        vm.club.memberships = data;\n                        // vm.club.member.membership_id.selected = vm.club.member.membership_id;\n                        // vm.membership = vm.club.member.membership_name;\n                        // vm.club.membership = vm.club.member.membership_name;\n                        // //console.log(vm.club.memberships);\n                    });\n\n            break;\n            case \"edit\":\n                //console.log(\"edit an existing membership\");\n\n                \n\n                       \n\n\n                        // vm.calculate_difference = function(package, difference){\n\n                        //     var price = package.price;\n                        //     var hours_dual = package.hours_dual;\n                        //     var hours_solo = package.hours_solo;\n\n                        //     var base = price / (hours_dual + hours_solo);\n\n                        //     var initial_dual_price = base + difference;\n                        //     var initial_solo_price = (price - (initial_dual_price * hours_dual)) / hours_solo;\n\n                        //     var price_ratio = initial_dual_price / initial_solo_price;\n\n                        //     var hour_ratio = hours_dual / hours_solo;\n                        //     var remaining_ratio = hours_dual_remaining / hours_solo_remaining;\n                        //     var remaining_hours = hours_dual_remaining / hours_solo_remaining;\n\n                        //     //hello world\n\n                        //     vm.package_split = {ratio: hour_ratio, remaining_ratio: remaining_ratio, dual_price: initial_dual_price, solo_price: initial_solo_price, price_ratio: price_ratio, remaining_hours: remaining_hours};\n\n                        // }\n\n\n                        // vm.calculate_change = function(slider_value){\n\n                        //     //100 ==> everything in solo\n                        //     //0 ==> everything in dual flights\n\n                        //     var dual_percent = slide_value/100;\n                        //     var dual_hours = dual_percent * remaining_hours;\n\n                        //     var solo_percent = 100 - (slide_value/100);\n\n\n\n                        //     var changme = slider_value - (vm.package_split.remaining_ratio * 100);\n                        //     if(changeme > 0){\n                        //         //then we are decreasing solo and increasing dual\n\n\n                        //     } else {\n                        //         //then we are increasing solo and decreasing dual\n                        //     }\n\n\n                        // }\n\n                       \n            break;\n            case \"list\":\n                //need to update this to be part of the authentication\n                //to find out club id\n\n                //incomplete_club\n\n                PlaneService.GetIncompleteClub(vm.club_id)\n                    .then(function(data){\n                        vm.club.flights = data.bookouts;\n                        // vm.club.member.membership_id.selected = vm.club.member.membership_id;\n                        // vm.membership = vm.club.member.membership_name;\n                        // vm.club.membership = vm.club.member.membership_name;\n                        // //console.log(vm.club.memberships);\n                    });\n\n\n                \n\n                vm.get_pax_html = function(flight_obj){\n                            var pax = \"\";\n                             for(var i=0;i<flight_obj.passengers.length;i++){\n                                 //\"+flight_obj.passengers[i].nok[0].first_name+\" \"+flight_obj.passengers[i].nok[0].last_name+\"\n                                 var nok = \"\";\n                                 if(flight_obj.passengers[i].nok.length > 0){\n                                     for(var j=0;j<flight_obj.passengers[i].nok.length;j++){\n                                         nok = nok + \"<br /><br />Emergency Contact (\"+(j+1)+\"): <br />\"+flight_obj.passengers[i].nok[j].first_name+ \" \" +flight_obj.passengers[i].nok[j].last_name + \" <br />relationship: \"+flight_obj.passengers[i].nok[j].relationship+\"<br />t: \"+flight_obj.passengers[i].nok[j].phone_number+ \" <br /> e: \"+flight_obj.passengers[i].nok[j].email_address+\"<br />\";\n                                     }\n                                 } \n                                pax = pax + \"<span class='bolder'><b>\" + flight_obj.passengers[i].first_name +\" \"+ flight_obj.passengers[i].last_name +\"</b></span><br />e: \"+flight_obj.passengers[i].email+\"<br />t: \"+((flight_obj.passengers[i].telephone_number) ? flight_obj.passengers[i].telephone_number : \"unknown\")+nok+\"  <br /> <br />\";\n                            }\n                            if(flight_obj.passengers.length == 0){\n\n                            }\n                            if(flight_obj.instructor_id > 0){\n\n                                 var nok2 = \"\";\n                                     if(flight_obj.booking.instructor_nok.noks.length > 0){\n                                         for(var j=0;j<flight_obj.booking.instructor_nok.noks.length;j++){\n                                             nok2 = nok2 + \"<br />Emergency Contact (\"+(j+1)+\"): <br />\"+flight_obj.booking.instructor_nok.noks[j].first_name+ \" \" +flight_obj.booking.instructor_nok.noks[j].last_name + \" <br />relationship: \"+flight_obj.booking.instructor_nok.noks[j].relationship+\"<br />t: \"+flight_obj.booking.instructor_nok.noks[j].phone_number+ \" <br /> e: \"+flight_obj.booking.instructor_nok.noks[j].email_address+\"<br />\";\n                                         }\n                                     } \n\n                                    pax = pax + \"<br /><span class='bolder'>Instructor Present</span> <br /> \"+flight_obj.booking.instructor.first_name+\" \"+flight_obj.booking.instructor.last_name+\" <br /> \"+nok2;\n                                }\n                            if(flight_obj.user_id > 0){\n                                    \n                                    var nok1 = \"\";\n                                     if(flight_obj.booking.user_nok.noks.length > 0){\n                                         for(var j=0;j<flight_obj.booking.user_nok.noks.length;j++){\n                                             nok1 = nok1 + \"<br />Emergency Contact (\"+(j+1)+\"): <br />\"+flight_obj.booking.user_nok.noks[j].first_name+ \" \" +flight_obj.booking.user_nok.noks[j].last_name + \" <br />relationship: \"+flight_obj.booking.user_nok.noks[j].relationship+\"<br />t: \"+flight_obj.booking.user_nok.noks[j].phone_number+ \" <br /> e: \"+flight_obj.booking.user_nok.noks[j].email_address+\"<br />\";\n                                         }\n                                     } \n\n                                    // var nok1 = \"<br /><br />Emergency Contact (\"+(j+1)+\"): <br />\"+flight_obj.passengers[i].nok[j].first_name+ \" \" +flight_obj.passengers[i].nok[j].last_name + \" <br />relationship: \"+flight_obj.passengers[i].nok[j].relationship+\"<br />t: \"+flight_obj.passengers[i].nok[j].phone_number+ \" <br /> e: \"+flight_obj.passengers[i].nok[j].email_address+\"<br />\";\n                                    pax = pax + \"<br /><span class='bolder'>Member Present</span><br />\"+flight_obj.booking.user.first_name+ \" \" +flight_obj.booking.user.last_name + \" <br />\"+nok1;\n                            }\n                            return pax;\n\n                            // var b = '<accordion close-others=\"oneAtATime\"> <accordion-group heading=\"Static Header, initially expanded\" is-open=\"true\"> This content is straight in the template. </accordion-group> <accordion-group heading=\"TITLE\" ng-repeat=\"group in groups\"> Some content here </accordion-group> <accordion-group heading=\"Dynamic Body Content\"> <p>The body of the accordion group grows to fit the contents</p> <button class=\"btn btn-default btn-sm\" ng-click=\"addItem()\">Add Item</button> <div ng-repeat=\"item in items\">{{item}}</div> </accordion-group> <accordion-group is-open=\"isopen\"> <accordion-heading> I can have markup, too! <i class=\"pull-right glyphicon\" ng-class=\"{\\'glyphicon-chevron-down\\': isopen, \\'glyphicon-chevron-right\\': !isopen}\"></i> </accordion-heading> This is just some content to illustrate fancy headings. </accordion-group> </accordion>';\n                            // return b;\n                        }\n\n\n\n\n\n\n            break;\n            default:\n                //console.log(\"none of the above... redirect somewhere?\");\n            break;\n        }  \n\n        //'9' needs to refer the the user's account set to manage\n       \n        $scope.back = function(){\n            $window.history.back();\n        }\n\n        vm.load_adsb = function(icao_hex){\n            var httpPath = \"https://globe.adsbexchange.com/?icao=\"+icao_hex;\n            window.open(httpPath, '_blank', '');\n        }\n\n\n        vm.cancel_bookout = function(id){\n\n            var a = confirm(\"Please confirm you wish to cancel the bookout.\");\n            if(a){\n                BookoutService.CancelBookout(id)\n                 .then(function(data){\n\n                     if(data.success){\n\n                       //load_bookings();\n                        PlaneService.GetIncompleteClub(vm.club_id)\n                            .then(function(data){\n                                vm.club.flights = data.bookouts;\n                            });\n\n                     } else {\n                         alert(data.message);\n                     }\n                                                \n                    });\n            }\n\n        }\n\n         \n\n\n    }\n app.controller('DashboardClubInstructorBookings', DashboardClubInstructorBookings);\n\n    DashboardClubInstructorBookings.$inject = ['UserService', 'PlaneService', '$rootScope', '$location', '$scope', '$state', '$stateParams', '$uibModal', '$log', '$window', 'LicenceService', 'MedicalService', 'DifferencesService', 'InstructorService'];\n    function DashboardClubInstructorBookings(UserService, PlaneService, $rootScope, $location, $scope, $state, $stateParams, $uibModal, $log, $window, LicenceService, MedicalService, DifferencesService, InstructorService) {\n        var vm = this;\n\n           //    /* PLEASE DO NOT COPY AND PASTE THIS CODE. */(function(){var w=window,C='___grecaptcha_cfg',cfg=w[C]=w[C]||{},N='grecaptcha';var gr=w[N]=w[N]||{};gr.ready=gr.ready||function(f){(cfg['fns']=cfg['fns']||[]).push(f);};(cfg['render']=cfg['render']||[]).push('explicit');(cfg['onload']=cfg['onload']||[]).push('initRecaptcha');w['__google_recaptcha_client']=true;var d=document,po=d.createElement('script');po.type='text/javascript';po.async=true;po.src='https://www.gstatic.com/recaptcha/releases/JPZ52lNx97aD96bjM7KaA0bo/recaptcha__en.js';var e=d.querySelector('script[nonce]'),n=e&&(e['nonce']||e.getAttribute('nonce'));if(n){po.setAttribute('nonce',n);}var s=d.getElementsByTagName('script')[0];s.parentNode.insertBefore(po, s);})();\n\n           // var initRecaptcha = function () { \n           //     // document.getElementById(\"SearchModule\").scope().vm.parent.isGrecaptchaLoaded = !0, \n           //     // document.getElementById(\"SearchModule\").scope().vm.showRecaptcha();\n           //     vm.showRecaptcha();\n           // };\n              \n\n\n\n\n        vm.user = null;\n        vm.allUsers = [];\n        vm.club = {\n            plane: {\n                requirements: {\n                    licence: [],\n                    medical: [],\n                    differences: []\n                },\n                documents: []\n            }\n        };\n\n        vm.page_title = \"\";\n        \n        vm.plane_document = {};\n        vm.plane_documents = [];\n\n        var update_this_file = [];\n        \n        \n        vm.currency_types = [\"class\", \"type\"];\n        vm.gear_types = [\"tricycle\", \"tailwheel\", \"monowheel\", \"floats\", \"amphibian\", \"skis\"];\n        // vm.certificates = [\"Certificate of Airworthiness\", \"National Certificate of Airworthiness\", \"Permit to Fly\"];\n        vm.certificates = [{id: 1, title: \"Certificate of Airworthiness\", value: \"cofa\"}, {id: 2, title: \"National Certificate of Airworthiness\", value: \"cofa\"}, {id: 2, title: \"LAA Permit to Fly\", value: \"ptf\"}];\n        vm.classes = [\"SEP (land)\", \"SEP (sea)\", \"SET (land)\", \"SET (sea)\", \"MEP (land)\", \"MEP (sea)\", \"ME\"];\n\n        vm.charge_type = [\"airborne\", \"brakes\", \"tacho\", \"hobbs\", \"flight\", \"brakes_rounded\"];\n        vm.surcharge_type = [\"none\", \"flight\", \"hour\"];\n\n        vm.action = $state.current.data.action;\n        vm.user = $rootScope.globals.currentUser;\n\n        //console.log(\"$rootScope.globals.currentUser : \", $rootScope.globals.currentUser);\n        \n        vm.club_id = $rootScope.globals.currentUser.current_club_admin.id;\n        vm.user_id = vm.user.id;\n\n\n\n\n         vm.editing = false;\n        \n        switch(vm.action){\n           \n\n\n            // break;\n            case \"list\":\n                //need to update this to be part of the authentication\n                //to find out club id\n                //console.log(\"hey\");\n                InstructorService.GetAllByClub(vm.club_id, vm.user_id)\n                    .then(function(data){\n                        vm.club.instructors = data.instructors;   \n                        //console.log(data);\n                        vm.edit_instructor();\n                    });\n            break;\n            default:\n                //console.log(\"none of the above... redirect somewhere?\");\n            break;\n        }  \n\n        //'9' needs to refer the the user's account set to manage\n       \n        $scope.back = function(){\n            $window.history.back();\n        }\n\n        function rgbaToHex (rgba) {\n          var inParts = rgba.substring(rgba.indexOf(\"(\")).split(\",\"),\n              r = parseInt(trim(inParts[0].substring(1)), 10),\n              g = parseInt(trim(inParts[1]), 10),\n              b = parseInt(trim(inParts[2]), 10);\n             // a = parseFloat(trim(inParts[3].substring(0, inParts[3].length - 1))).toFixed(2);\n          var outParts = [\n            r.toString(16),\n            g.toString(16),\n            b.toString(16)\n            //,Math.round(a * 255).toString(16).substring(0, 2)\n          ];\n\n          // Pad single-digit output values\n          outParts.forEach(function (part, i) {\n            if (part.length === 1) {\n              outParts[i] = '0' + part;\n            }\n          })\n\n          return ('#' + outParts.join(''));\n        }\n\n        function trim (str) {\n          return str.replace(/^\\s+|\\s+$/gm,'');\n        }\n        function hexToRGBA(hex, opacity=1) {  \n            let r = parseInt(hex.substring(1,3), 16);  \n            let g = parseInt(hex.substring(3,5), 16);  \n            let b = parseInt(hex.substring(5), 16);  \n            var rtn = \"rgba(\"+r+\", \"+g+\", \"+b+\", \"+opacity+\")\";\n            return rtn;\n        }\n\n        vm.save_instructor = function(instructor){\n\n            console.log(instructor.new_colour);\n\n            if(instructor.new_colour && instructor.new_colour !== \"\"){\n                instructor.instructor_colour = hexToRGBA(instructor.new_colour, 1);\n                delete(instructor.new_colour);\n            }\n            console.log(instructor.new_booking_colour);\n\n            if(instructor.new_booking_colour && instructor.new_booking_colour !== \"\"){\n                instructor.booking_colour = hexToRGBA(instructor.new_booking_colour, 1);\n                delete(instructor.new_booking_colour);\n            }\n\n            console.log(\"SAVE THIS : \", instructor);\n\n            instructor.edit = false;\n\n            delete(instructor.edit);\n\n            InstructorService.UpdateInstructor(instructor, vm.club_id)\n                .then(function(data){\n                    //console.log(data);\n\n                    // vm.items = data.items;\n                    //$state.go('dashboard.manage_club.edit_lesson', {course_id: vm.club.lesson.course_id, lesson_id: data.id, reload: true});\n\n                });\n\n\n        }\n\n        vm.edit_instructor = function(){\n            \n            for(var i=0; i < vm.club.instructors.length;i++){\n                if(vm.club.instructors[i].instructor_colour && vm.club.instructors[i].instructor_colour !== \"\"){\n                    vm.club.instructors[i].new_colour = rgbaToHex(vm.club.instructors[i].instructor_colour);\n                }\n\n                if(vm.club.instructors[i].booking_colour && vm.club.instructors[i].booking_colour !== \"\"){\n                    vm.club.instructors[i].new_booking_colour = rgbaToHex(vm.club.instructors[i].booking_colour);\n                }\n            }\n        }\n\n        $scope.save_instructor_order = function(){\n            // //console.log(\"hiya\");\n            var update_order = [];\n            for(var i=0; i < vm.club.instructors.length;i++){\n                var me = {\n                    id: vm.club.instructors[i].id,\n                    display_order: i\n                }\n                update_order.push(me);\n            }\n            // //console.log(\"organised: \", update_order);\n\n\n\n            InstructorService.UpdateOrder({\"order\": update_order}, vm.club_id)\n                .then(function(data){\n                    console.log(data);\n\n                    // vm.items = data.items;\n                    //$state.go('dashboard.manage_club.edit_lesson', {course_id: vm.club.lesson.course_id, lesson_id: data.id, reload: true});\n\n                });\n\n        }\n\n\n        $scope.set_aircraft_details = function(){\n\n            // console.log(\"get deeeets\", vm.plane_search);\n\n            PlaneService.GetAddAircraft(vm.plane_search.registration)\n                .then(function (data) {\n                    ////console.log(data);\n\n                    // console.log(data);\n                                // return false;\n\n                    if(data){\n                        //use GB airfields first...\n                       \n                         if(data.length == 0){\n                            //console.log(\"SETTINGS HERE\");\n                                // vm.plane_search = \n                                //     {\n                                //         id: 0,\n                                //         registation: vm.plane_search.registration,\n                                //         icao_type: \"not known\"\n                                //     };\n\n                                // vm.club.plane.manufacturer = vm.plane_search.manufacturer;      \n\n                        } else {\n\n                                vm.plane_search = data;\n                                // console.log(\"SUCCESS FOUND\", data);\n                                processNewAircraft();\n                        }\n\n\n                        //console.log(\"PLANE SEARCHED\", vm.plane_search);\n\n                    } else {\n\n\n                        console.log(\"WOOOPSIES... this aircraft isn't in our database?\");\n                        //this should be very very rare...\n\n                         // vm.plane_search = \n                         //            {\n                         //                registation: vm.plane_search.registration,\n                         //                icao_type: \"not known\"\n                         //            };\n                                    // vm.club.plane.manufacturer = vm.plane_search.manufacturer;                        \n\n                    }\n\n                });\n\n\n        }\n\n        function processNewAircraft(){\n\n\n            //vm.club.plane \n\n            //TYPES -->>>\n\n              //aircraft_class --> FIXED-WING LANDPLANE\n                  //is_propeller = 1\n                  //number_of_engines  --> 1 = SEP\n                                    // --> >1 = MEP\n\n                  //is_propeller = 0\n                  //number_of_engines  --> 1 = SET\n                                    // --> >1 = ME\n\n\n            vm.club.plane.manufacturer = vm.plane_search.manufacturer;                        \n            vm.club.plane.serial_no = vm.plane_search.serial_number;                        \n            vm.club.plane.plane_type = vm.plane_search.icao_type;                        \n            vm.club.plane.type_name = vm.plane_search.type_name;                        \n            vm.club.plane.year_built = vm.plane_search.year_built;                        \n            vm.club.plane.aircraft_id = vm.plane_search.id;       \n            vm.club.plane.mtow = parseInt(vm.plane_search.mtow);\n            vm.club.plane.airframe_hours = vm.plane_search.airframe_hours;          \n\n\n            // alert(vm.plane_search.gear_type);\n\n            if(vm.plane_search.noise_level){\n\n                var regex = /[+-]?\\d+(\\.\\d+)?/g;\n\n                vm.plane_noise.noise_level = vm.plane_search.noise_level.match(regex).map(function(v) { return parseFloat(v); });\n                ////console.log(floats);\n\n            }\n            // vm.club.plane.noise_level = vm.plane_search.noise_level;//parseInt(vm.plane_search.noise_level);                 \n            \n\n\n            vm.plane_noise.noise_cert_issue = (vm.plane_search.noise_cert_issue)? new Date(vm.plane_search.noise_cert_issue) : \"\";                 \n\n            if(vm.plane_search.aircraft_class.indexOf(\"FIXED-WING\") > -1){\n\n                if(vm.plane_search.is_propeller > 0 && vm.plane_search.engine_name.indexOf(\"PT6A-\") == -1){\n\n                    vm.club.plane.plane_class = (vm.club.plane.number_of_engines > 1) ? \"MEP\" : \"SEP\";\n\n                } else {\n\n                    vm.club.plane.plane_class = (vm.club.plane.number_of_engines > 1) ? \"ME\" : \"SET\";\n\n                }\n\n                if(vm.plane_search.aircraft_class.indexOf(\"LANDPLANE\") > -1){\n                    vm.club.plane.plane_class = vm.club.plane.plane_class + \" (land)\";\n                    vm.club.plane.gear_type = \"\";\n                }\n\n                if(vm.plane_search.aircraft_class.indexOf(\"AMPHIBIAN\") > -1 || vm.plane_search.aircraft_class.indexOf(\"FLOAT\") > -1){\n                    vm.club.plane.plane_class = vm.club.plane.plane_class + \" (sea)\";\n                    vm.club.plane.gear_type = (vm.plane_search.aircraft_class.indexOf(\"AMPHIBIAN\") > -1)? \"amphibian\" : \"floats\";\n                }\n\n\n\n            }        \n\n\n\n            vm.club.plane.seats = (parseInt(vm.plane_search.seats) + 1);\n\n\n            //Certificate of Airworthiness ==> National CofA\n            //Permit to Fly ==> LAA permit\n            //EASA Certificate of Airworthiness ==> EASA CofA\n            vm.plane_maintenance.cofa_category =  (vm.plane_search.cofa_category.indexOf(\"cofa\") > -1)? \"Certificate of Airworthiness\" : \"Permit to Fly\";//(vm.plane_search.cofa_category.indexOf(\"EASA\") > -1)? \"EASA Certificate of Airworthiness\" : ((vm.plane_search.cofa_category.indexOf(\"Certificate of Airworthiness\") > -1)? \"National Certificate of Airworthiness\" : \"Permit to Fly\");\n            vm.plane_maintenance.certificate_expiry = new Date(vm.plane_search.cofa_expiry);\n            \n            vm.club.plane.cofa_category = vm.plane_maintenance.cofa_category;//(vm.plane_search.cofa_category.indexOf(\"EASA\") > -1)? \"easa_cofa\" : ((vm.plane_search.cofa_category.indexOf(\"Certificate of Airworthiness\") > -1)? \"n_cofa\" : \"permit\")\n\n            vm.club.plane.gear_type = vm.plane_search.gear_type;\n\n\n\n            //ENGINES AND PROPS!!!\n            vm.plane_engine_1.make = vm.plane_search.engine_name;                        \n            vm.plane_engine_1.model = vm.plane_search.engine_name;                     \n\n            vm.plane_propeller_1.make = vm.plane_search.propeller_manufacturer;                        \n            vm.plane_propeller_1.model = vm.plane_search.propeller_name;                        \n\n            if(vm.plane_search.number_of_engines > 1){\n                \n                vm.number_of_engine = vm.plane_search.number_of_engines;\n\n                vm.plane_engine_2.make = vm.plane_search.engine_name;                        \n                vm.plane_engine_2.model = vm.plane_search.engine_name;\n                \n                vm.plane_propeller_2.make = vm.plane_search.propeller_manufacturer;                        \n                vm.plane_propeller_2.model = vm.plane_search.propeller_name; \n            }   \n\n        }\n\n\n        $scope.save = function(){\n            if(vm.action == \"add\"){\n                //console.log(\"CREATE click\");\n                $scope.create();\n            } else {\n                //console.log(\"EDIT click\");\n                //console.log(vm.club.plane);\n                $scope.update();\n            }\n        }\n\n\n\n        vm.round_brake_times_start = function(input, earlier_input=null){\n            \n                if(input){\n                  if(input.indexOf(\":\") > -1){\n                    var split = input.split(\":\");\n                    var x = split[1];\n\n\n\n                    var min_nearest_five = ((x % 5) >= 2.5 ? parseInt(x / 5) * 5 + 5 : parseInt(x / 5) * 5);\n                    \n\n\n                    if(min_nearest_five < 10){\n                      min_nearest_five = \"0\"+min_nearest_five;\n                    } else if(min_nearest_five == 60){\n                      split[0]++;\n                      min_nearest_five = \"00\";\n                    } else if(min_nearest_five > 60){\n                      split[0]++;\n                      min_nearest_five = (min_nearest_five - 60);\n                    }\n\n\n                    if(earlier_input && earlier_input.indexOf(\":\") > -1){\n                            // console.log(\"total calculated?\");\n                            // console.log(\"earlier_input: \", earlier_input);\n                            // console.log(\"input: \", input);\n                            var esplit = earlier_input.split(\":\");\n                            var ehour = esplit[0];\n                            var emin = esplit[1];\n                            var etot = (parseInt(ehour)*60) + parseInt(emin); \n                            // console.log(\"etot: \", etot);\n                            var hr = split[0];\n                            var mn = min_nearest_five;\n                            var tot = (parseInt(hr)*60) + parseInt(mn);\n                            // console.log(\"tot: \", tot);\n\n                            if(etot < tot){\n                                //the earlier time is after the end time\n                                // console.log(\"etot < tot\");\n                                min_nearest_five = parseInt(min_nearest_five) - 5;\n                                if(min_nearest_five == 60){\n                                    split[0]++; \n                                    min_nearest_five = \"00\";\n                                } else if(min_nearest_five > 60){\n                                    split[0]++;\n                                    min_nearest_five = (min_nearest_five - 60);\n                                    if(min_nearest_five < 10 ){\n                                      min_nearest_five = \"0\"+min_nearest_five;\n                                    }\n                                } else if(min_nearest_five < 0){\n                                    split[0]--;\n                                    min_nearest_five = (60 + parseInt(min_nearest_five));\n                                }\n                                // console.log(\"split: \", split[0]);\n                                // console.log(\"min_nearest_five: \", min_nearest_five);\n                            }\n\n                    }\n                    //essentially we add 5 in case something happens over the limit\n\n                    return split[0] + \":\" + min_nearest_five;\n                  } else {\n                    return input;\n                  }\n                } else {\n                  return '';\n                }\n          \n\n          }\n\n\n        $scope.create = function(){\n            ////console.log(\"CREATE ME NOW\");\n            vm.club.plane.club_id = vm.club_id;\n            vm.club.plane.add_documents = vm.plane_documents;\n            vm.club.plane.registration = vm.plane_search.registration;\n\n            vm.club.maintenance_type = vm.plane_maintenance.cofa_category.value;\n\n            console.log(\"vm.plane_maintenance.cofa_category \", vm.club.maintenance_type );\n            return false;\n            vm.plane_maintenance.file = vm.files.cert[0];\n            vm.plane_radio.file = vm.files.radio[0];\n            vm.plane_noise.file = vm.files.noise[0];\n            vm.plane_insurance.file = vm.files.insurance[0];\n\n            vm.club.plane.maintenance = vm.plane_maintenance;\n            vm.club.plane.insurance = vm.plane_insurance;\n            vm.club.plane.noise_cert = vm.plane_noise;\n            vm.club.plane.radio_licence= vm.plane_radio;\n\n            vm.club.plane.vp = (vm.club.plane.vp)? 1:0;\n            vm.club.plane.rg = (vm.club.plane.rg)? 1:0; \n            vm.club.plane.tb = (vm.club.plane.tb)? 1:0; \n\n            vm.club.plane.engine_1 = vm.plane_engine_1;\n            vm.club.plane.engine_2 = vm.plane_engine_2;\n            vm.club.plane.propeller_1 = vm.plane_propeller_1;\n            vm.club.plane.propeller_2 = vm.plane_propeller_2;\n\n\n            if(vm.club.plane.colour && vm.club.plane.colour !== \"\" && vm.club.plane.colour.indexOf(\"rgba\") == -1){\n                vm.club.plane.colour = hexToRGBA(vm.club.plane.colour, 0.75);\n            } \n\n            if(vm.club.plane.bg_colour && vm.club.plane.bg_colour !== \"\" && vm.club.plane.bg_colour.indexOf(\"rgba\") == -1){\n                vm.club.plane.bg_colour = hexToRGBA(vm.club.plane.bg_colour, 0.25);\n            } \n\n\n            //return false;\n            //console.log(\"PLANE TO ADD, \", vm.club.plane);\n            //return false;\n            PlaneService.Create(vm.club.plane)\n                .then(function(data){\n                    ////console.log(data);\n                    $state.go('dashboard.manage_club.planes', {reload: true});\n\n                });\n        }\n\n        $scope.delete = function(){\n            //console.log(\"CLICK\");\n            alert(\"Are you sure you would like to delete this plane?\");\n            PlaneService.Update(vm.club.plane)\n                .then(function(data){\n                    //console.log(data);\n                });\n        }\n\n        function get_update_docs(){\n            var documents = [];\n\n            for(var i=0;i<update_this_file.length;i++){\n                var id = update_this_file[i];\n                //console.log(\"looking for : \", id);\n                //console.log(\"in: \", vm.plane_documents);\n\n                for(var k=0;k<vm.club.plane.plane_documents.length;k++){\n                    //console.log(\"comparing to : \", vm.club.plane.plane_documents[k].id);\n                    if(vm.club.plane.plane_documents[k].id == id){\n                        documents.push(vm.club.plane.plane_documents[k]);\n                    }\n                }\n\n            }\n\n            // //console.log(\"DOCS TO UPDATE : \", documents);\n\n            return documents;\n        }\n\n        $scope.update = function(){\n            //console.log(\"CLICK\");\n            vm.club.plane.club_id = vm.club_id;\n            vm.club.plane.add_documents = vm.plane_documents;\n\n            vm.club.plane.update_documents = get_update_docs();\n            //get_update_docs();\n\n            if(vm.club.plane.colour && vm.club.plane.colour !== \"\" && vm.club.plane.colour.indexOf(\"rgba\") == -1){\n                vm.club.plane.colour = hexToRGBA(vm.club.plane.colour, 0.75);\n            } \n\n            if(vm.club.plane.bg_colour && vm.club.plane.bg_colour !== \"\" && vm.club.plane.bg_colour.indexOf(\"rgba\") == -1){\n                vm.club.plane.bg_colour = hexToRGBA(vm.club.plane.bg_colour, 0.25);\n            } \n\n            PlaneService.Update(vm.club.plane)\n                .then(function(data){\n                    //console.log(data);\n                    //console.log(\"saved\");\n                    $state.go('dashboard.manage_club.planes');\n                });\n        }\n\n        vm.save_new_aircraft_bit = function(item, num){\n            \n            // console.log(item);\n            // console.log(num);\n\n            //this assumes there was an engine and prop already saved\n\n\n            var comb = \"plane_\"+item+\"_\"+num;\n            var comb2 = \"plane_\"+item+\"_\"+num+\"_replace\";\n\n            var item_update = {};\n            \n            if(vm[comb] && vm[comb] !== \"\"){\n                //only if there is one set --> FIRST!!!\n                vm[comb].removed_date = vm[comb2].removed_date;\n                delete(vm[comb2].removed_date);\n\n                item_update = {\n                    old_item: vm[comb],\n                    new_item: vm[comb2],\n                    plane_id: vm.club.plane.id,\n                    item: item,\n                    no: num\n                };\n            } else {\n                item_update = {\n                    old_item: {},\n                    new_item: vm[comb2],\n                    plane_id: vm.club.plane.id,\n                    item: item,\n                    no: num\n                };\n            }\n\n            \n\n            // if(item == \"engine\"){\n            //     if(num == 1){\n                    \n            //         console.log( \"engine\", vm );\n            //         console.log( \"engine\", vm.plane_engine_1 );\n            //         console.log( \"engine\", vm.plane_engine_1.removed_date );\n            //         console.log( \"engine\", vm.plane_engine_1_replace );\n            //         console.log( \"engine\", vm.plane_engine_1_replace.removed_date );\n\n            //         vm.plane_engine_1.removed_date = vm.plane_engine_1_replace.removed_date;\n            //         delete(vm.plane_engine_1_replace.removed_date);\n            //         item_update.old_item = vm.plane_engine_1;\n            //         item_update.new_item = vm.plane_engine_1_replace;\n\n            //     } else if(num == 2){\n            //         vm.plane_engine_2.removed_date = vm.plane_engine_2_replace.removed_date;\n            //         delete(vm.plane_engine_2_replace.removed_date);\n            //         item_update.old_item = vm.plane_engine_2;\n            //         item_update.new_item = vm.plane_engine_2_replace;\n            //     }\n            // } else if(item == \"propeller\"){\n            //     if(num == 1){\n            //         vm.plane_propeller_1.removed_date = vm.plane_engine_1_replace.removed_date;\n            //         delete(vm.plane_engine_1_replace.removed_date);\n            //         item_update.old_item = vm.plane_propeller_1;\n            //         item_update.new_item = vm.plane_engine_1_replace;\n            //     } else if(num == 2){\n            //         vm.plane_propeller_2.removed_date = vm.plane_engine_2_replace.removed_date;\n            //         delete(vm.plane_engine_2_replace.removed_date);\n            //         item_update.old_item = vm.plane_propeller_2;\n            //         item_update.new_item = vm.plane_engine_2_replace;\n            //     }\n            // }\n\n           \n            console.log(\"LETS SEE WHAT WOULD BE SENT\", item_update);\n\n\n            PlaneService.UpdateAircraftBit(item_update)\n                .then(function(data){\n                    console.log(data);\n                    //console.log(\"saved\");\n                    $state.go('dashboard.manage_club.planes');\n                });\n\n        }\n\n\n        function containsObject(obj, list, params) {\n\n            // //console.log(\"obj\", obj);\n            // //console.log(\"list\", list);\n            // //console.log(\"params\", params);\n\n            for(var i=0; i<list.length; i++) {\n                // //console.log(\"list i : \", list[i]);\n                // //console.log(\"obj is: \", obj);\n\n                var count_success = 0;\n                for(var j=0;j<params.length;j++){\n                    if(list[i][params[j]] && obj[params[j]] && list[i][params[j]] == obj[params[j]]){\n                        count_success++;\n                    }\n                }\n\n                if(count_success === params.length) {                    \n                    return true;\n                }\n            }\n\n            return false;\n        }\n\n\n        function check_all(){\n\n            //maybe a nice to have one day... not yet though.\n\n\n            //licences\n            vm.club.plane.requirements.licence.forEach(function(obj){\n\n            });\n\n        }\n\n      \n\n\n        $scope.add_item = function(type){\n            //console.log(\"ADD\");\n            switch(type){\n                case \"licence\":\n                    //console.log(\"licence\");\n                    if(vm.temporary.licence && vm.temporary.licence !== \"\" && vm.temporary.rating && vm.temporary.rating !== \"\"){\n                        //then we can add it\n                        //console.log(\"here we go\");\n                        var add_licence = {\n                            licence_id: vm.temporary.licence.id,\n                            licence_title: vm.temporary.licence.abbreviation,\n                            rating_title: vm.temporary.rating.abbreviation,\n                            rating_id: vm.temporary.rating.id\n                        };\n\n                        //check if it doesnt exist first...\n                        if(containsObject(add_licence, vm.club.plane.requirements.licence, new Array(\"licence_id\", \"rating_id\")) == false){\n                            vm.club.plane.requirements.licence.push(add_licence);\n                        }\n\n                        delete vm.temporary.licence;\n                        delete vm.temporary.rating;\n\n                    } else {\n                        alert(\"Please select a licence and rating that is required to book the plane solo!\");\n                    }\n\n                break;\n\n\n                case \"medical\":\n                    //console.log(\"medical\");\n                    if(vm.temporary.medical_authority && vm.temporary.medical_authority !== \"\" && vm.temporary.medical_component && vm.temporary.medical_component !== \"\"){\n                        //then we can add it\n                        //console.log(\"here we go\");\n                        var add_medical = {\n                            authority_id: vm.temporary.medical_authority.id,\n                            authority_title: vm.temporary.medical_authority.abbreviation,\n                            medical_component_id: vm.temporary.medical_component.id,\n                            medical_component_title: vm.temporary.medical_component.title\n                        };\n\n                        //check if it doesnt exist first...\n                        if(containsObject(add_medical, vm.club.plane.requirements.medical, new Array(\"authority_id\", \"medical_component_id\")) == false){\n                            vm.club.plane.requirements.medical.push(add_medical);\n                        }\n\n                        delete vm.temporary.medical_authority;\n                        delete vm.temporary.medical_component;\n\n                    } else {\n                        alert(\"Please select a medical that is required to book the plane solo!\");\n                    }\n\n                break;\n\n\n                case \"differences\":\n                    //console.log(\"difference\");\n                    if(vm.temporary.difference && vm.temporary.difference !== \"\"){\n                        //then we can add it\n                        //console.log(\"here we go\");\n                        var add_difference = {\n                            difference_id: vm.temporary.difference.id,\n                            difference_title: vm.temporary.difference.title\n                        };\n\n                        //check if it doesnt exist first...\n                        if(containsObject(add_difference, vm.club.plane.requirements.differences, new Array(\"difference_id\", \"difference_title\")) == false){\n                            vm.club.plane.requirements.differences.push(add_difference);\n                        }\n\n                        delete vm.temporary.difference;\n\n                    } else {\n                        alert(\"Please select a difference that is required to book the plane solo!\");\n                    }\n\n                break;\n\n\n            }\n\n\n\n        }\n\n\n        $scope.remove_item = function(type, index){\n            //console.log(\"REMOVE\");\n\n            vm.club.plane.requirements[type].splice(index, 1);\n\n\n            // switch(type){\n            //     case \"licence\":\n            //             //console.log(\"licence\");\n                   \n            //             //check if it doesnt exist first...\n            //             // if(containsObject(add_licence, vm.club.plane.requirements.licence, new Array(\"licence_id\", \"rating_id\")) == false){\n            //             //     vm.club.plane.requirements.licence.push(add_licence);\n            //             // }\n\n            //             vm.club.plane.requirements.licence.splice(index, 1);\n                      \n                   \n\n            //     break;\n\n\n            //     case \"medical\":\n            //         //console.log(\"medical\");\n            //         if(vm.temporary.medical_authority && vm.temporary.medical_authority !== \"\" && vm.temporary.medical_component && vm.temporary.medical_component !== \"\"){\n            //             //then we can add it\n            //             //console.log(\"here we go\");\n            //             var add_medical = {\n            //                 authority_id: vm.temporary.medical_authority.id,\n            //                 authority_title: vm.temporary.medical_authority.abbreviation,\n            //                 medical_component_id: vm.temporary.medical_component.id,\n            //                 medical_component_title: vm.temporary.medical_component.title\n            //             };\n\n            //             //check if it doesnt exist first...\n            //             if(containsObject(add_medical, vm.club.plane.requirements.medical, new Array(\"authority_id\", \"medical_component_id\")) == false){\n            //                 vm.club.plane.requirements.medical.push(add_medical);\n            //             }\n\n            //             delete vm.temporary.medical_authority;\n            //             delete vm.temporary.medical_component;\n\n            //         } else {\n            //             alert(\"Please select a medical that is required to book the plane solo!\");\n            //         }\n\n            //     break;\n\n\n            //     case \"differences\":\n            //         //console.log(\"difference\");\n            //         if(vm.temporary.difference && vm.temporary.difference !== \"\"){\n            //             //then we can add it\n            //             //console.log(\"here we go\");\n            //             var add_difference = {\n            //                 difference_id: vm.temporary.difference.id,\n            //                 difference_title: vm.temporary.difference.title\n            //             };\n\n            //             //check if it doesnt exist first...\n            //             if(containsObject(add_difference, vm.club.plane.requirements.differences, new Array(\"difference_id\", \"difference_title\")) == false){\n            //                 vm.club.plane.requirements.differences.push(add_difference);\n            //             }\n\n            //             delete vm.temporary.difference;\n\n            //         } else {\n            //             alert(\"Please select a difference that is required to book the plane solo!\");\n            //         }\n\n            //     break;\n\n\n            // }\n\n\n\n        }\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n        $scope.update_this_file = function(file){\n            //console.log(\"==== update is : \", file.id);\n            if(update_this_file.indexOf(file.id) === -1){\n                update_this_file.push(file.id)\n            } else {\n               ////console.log(\"This item already exists\"); \n            } \n        }\n\n\n         $scope.remove_real_file = function(file){\n\n                //remove_file\n\n                vm.club.plane.plane_documents = $.grep(vm.club.plane.plane_documents, function(e){ \n                        return e.id != file.id; \n                    });\n\n                //no need to actually remove the file as it will be archived accordingly on the backend whilst it is missing! :)\n                PlaneDocumentService.Delete(vm.user_id, file.id)\n                .then(function (data) {\n                    //console.log(data);\n                    if(data.success){\n                        //console.log(\"HUZZAH\", current_files);\n                        //then we need to remove this from the list of files...\n                        //clear files\n                        vm.plane_documents = [];\n                        //and re-process available files\n                        $scope.processFiles(current_files);\n\n                    } else {\n                        //console.log(\"WOOOPSIES...\");\n                        //this should be very very rare...\n                    }\n\n                });\n\n          }\n\n\n        vm.files = {\n            radio: [],\n            cert: [],\n            insurance: [],\n            noise: []\n        }\n\n\n           $scope.processFile = function(files, location){\n                 //console.log(\"files\", files[0].file_return);\n\n                     // //console.log(\"JSON\", files[i].file_return);\n                    var j = JSON.parse(files[0].file_return);\n                     ////console.log(\"PARSED\", j);\n                    // //console.log(\"J is : \",j);\n                    // //console.log(\"name is : \", j.files.file.name);\n\n                    files[0].file.temp_path = j.saved_url;\n                    files[0].file.save_name = j.files.file.name;\n\n                    var ft = j.files.file.name;\n                    //console.log(\"ft\", ft);\n                    var fft = ft.split('.').pop();\n                    files[0].file.extension = fft;\n                    //console.log(\"FILE is : \", files[0]);\n\n                    // //console.log(\"file\", files[i].file);\n                    vm.files[location].push(files[0].file);\n\n\n            }\n\n            $scope.set_title = function(file){\n                //console.log(\"return\", file);\n                return file.save_name;\n            }\n\n\n          \n          $scope.remove_file = function(file, current_files){\n\n            //remove_file\n            var j = JSON.parse(file.file_return);\n            //console.log(\"REMOVE: \", j);\n            //console.log(\"REMOVE: \", j.saved_url);\n\n            //to delete the temp file created: j.saved_url\n            //tmp_rm.php POST tmp = filename\n            \n            PoidService.DeleteTmp(j.saved_url)\n                .then(function (data) {\n                    //console.log(data);\n                    if(data.success){\n                        //console.log(\"HUZZAH\", current_files);\n                        //then we need to remove this from the list of files...\n                        //clear files\n                        vm.plane_documents = [];\n                        //and re-process available files\n                        $scope.processFiles(current_files);\n\n                    } else {\n                        //console.log(\"WOOOPSIES...\");\n                        //this should be very very rare...\n                    }\n\n                });\n\n          }\n          \n\n          // $scope.$on('flow::fileAdded', function (event, $flow, flowFile) {\n          //     event.preventDefault();//prevent file from uploading\n          //     //console.log(\"FILE ADDED\");\n          //     //console.log($flow);\n          //   });\n\n            $scope.processFiles = function(files){\n                // //console.log(\"files\", files);\n\n                for(var i=0; i<files.length; i++){\n                    // //console.log(\"JSON\", files[i].file_return);\n                    var j = JSON.parse(files[i].file_return);\n                    // //console.log(\"PARSED\", j);\n                    //console.log(\"J is : \",j);\n                    //console.log(\"name is : \", j.files.file.name);\n\n                    files[i].file.temp_path = j.saved_url;\n                    files[i].file.save_name = j.files.file.name;\n                    var ft = j.files.file.name;\n                    ft = ft.split('.').pop();\n                    files[i].file.extension = ft;\n\n                    // //console.log(\"file\", files[i].file);\n                    vm.plane_documents.push(files[i].file);\n                }\n\n\n            }\n\n            $scope.set_title = function(file){\n                //console.log(\"return\", file);\n                return file.save_name;\n            }\n\n            $scope.get_icon = function(file){\n\n                var ft = file.name;\n                ft = ft.split('.').pop();\n                var icon_name = \"\";\n\n                // //console.log(\"FILE:\", ft);\n                // //console.log(\"index : \", ft.indexOf(\"pdf\"));\n                switch(true){\n                    case (ft.indexOf(\"pdf\") > -1):\n                        icon_name = \"pdf.png\";\n                    break;\n                    case (ft.indexOf(\"doc\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"docx\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"xls\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"xlsx\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"ppt\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"pptx\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"jpg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"jpeg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"png\") > -1):\n                        icon_name = \"png.png\";\n                    break;\n                    case (ft.indexOf(\"gif\") > -1):\n                        icon_name = \"gif.png\";\n                    break;\n                    case (ft.indexOf(\"zip\") > -1):\n                        icon_name = \"zip.png\";\n                    break;\n                    case (ft.indexOf(\"avi\") > -1):\n                        icon_name = \"avi.png\";\n                    break;\n                    case (ft.indexOf(\"mp4\") > -1):\n                        icon_name = \"mp4.png\";\n                    break;\n                    default:\n                        icon_name = \"file.png\";\n                    break;\n                }\n\n                // //console.log(\"FILE:\", icon_name);\n\n                return \"images/file_icons/\"+icon_name;\n            }\n\n\n            $scope.get_icon2 = function(file){\n\n                var ft = file.split('.').pop();\n                // //console.log(\"ICON 2 : \", ft);\n                var icon_name = \"\";\n\n                // //console.log(\"FILE:\", ft);\n                // //console.log(\"index : \", ft.indexOf(\"pdf\"));\n                switch(true){\n                    case (ft.indexOf(\"pdf\") > -1):\n                        icon_name = \"pdf.png\";\n                    break;\n                    case (ft.indexOf(\"doc\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"docx\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"xls\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"xlsx\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"ppt\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"pptx\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"jpg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"jpeg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"png\") > -1):\n                        icon_name = \"png.png\";\n                    break;\n                    case (ft.indexOf(\"gif\") > -1):\n                        icon_name = \"gif.png\";\n                    break;\n                    case (ft.indexOf(\"zip\") > -1):\n                        icon_name = \"zip.png\";\n                    break;\n                    case (ft.indexOf(\"avi\") > -1):\n                        icon_name = \"avi.png\";\n                    break;\n                    case (ft.indexOf(\"mp4\") > -1):\n                        icon_name = \"mp4.png\";\n                    break;\n                    default:\n                        icon_name = \"file.png\";\n                    break;\n                }\n\n                // //console.log(\"FILE:\", icon_name);\n\n                return \"images/file_icons/\"+icon_name;\n            }\n\n\n\n            $scope.delete_poid = function(id){\n\n              \n                var a = prompt(\"Are you sure you wish to delete this poid? \\n\\n This change is irreversible! To confirm please type YES in the box below.\");\n                if(a == \"YES\"){\n\n\n                    //console.log(\"WE DELETE IT\");\n\n\n                    // PoidService.Delete(vm.user_id, id)\n                    //     .then(function (data) {\n                    //         //console.log(data);\n                    //         if(data.success){\n                    //             //console.log(\"HUZZAH\", data);\n                    //             //then we need to remove this from the list of files...\n                    //             vm.user_poids = $.grep(vm.user_poids, function(e){ \n                    //                 return e.id != id; \n                    //             });\n                                \n                    //             //refresh?\n                    //             $state.reload();\n                    //             $state.go('dashboard.my_account.poid');\n\n                    //         } else {\n\n                    //             alert(\"Something went terribly wrong... \\n\\n \"+data.message);\n\n                    //         }\n\n                    //     });\n\n\n\n                } else {\n                    //console.log(\"ignore123\");\n                }\n\n\n            }\n\n\n\n\n            $scope.save_plane_documents = function(){\n\n               \n              \n\n                //console.log(\"plane_documents: \", vm.plane_documents);\n\n\n                //compile the required elements YAY\n\n                //console.log(\"plane_document \", vm.plane_document);\n\n\n                 //clean shizzle before sending\n                 //why keep sending back heavy data?\n\n                    // for(var i=0;i<vm.plane_document.images.length;i++){\n                    //     delete vm.plane_document.images[i].data_uri;\n                    // }\n\n                    // // vm.plane_document.images = vm.plane_documents;\n                    // vm.plane_document.images = vm.plane_document.images.concat(vm.plane_documents);\n                    // vm.plane_document.user_id = vm.user_id;\n\n\n\n\n            //     if(vm.plane_document.id){\n            //         //then its an udpate\n\n            //         //merge the images left?\n            //         PoidService.Update(vm.plane_document)\n            //             .then(function (data) {\n            //                 //console.log(data);\n            //                 if(data.success){\n            //                     //console.log(\"HUZZAH\", vm.plane_document);\n            //                     //console.log(\"HUZZAH\", data);\n            //                     //then we need to remove this from the list of files...\n                                \n                                \n            //                     //move somewhere?\n            //                     $state.go('dashboard.my_account.poid', {}, { reload: true });\n\n\n\n\n\n            //                 } else {\n\n            //                     alert(\"Something went terribly wrong... \\n\\n \"+data.message);\n\n            //                 }\n\n            //             });\n\n            //     } else {\n\n\n                   \n\n\n            //         //then its a create\n            //         //console.log(vm.plane_document);\n\n            //         PoidService.Create(vm.plane_document)\n            //             .then(function (data) {\n            //                 //console.log(data);\n            //                 if(data.success){\n            //                     //console.log(\"HUZZAH\", vm.plane_document);\n            //                     //console.log(\"HUZZAH\", data);\n            //                     //then we need to remove this from the list of files...\n                                \n                                \n            //                     //move somewhere?\n            //                    // $state.reload();\n            //                    // $state.go('dashboard.my_account.poid', {}, { reload: true });\n\n\n            //                 } else {\n\n            //                     alert(\"Something went terribly wrong... \\n\\n \"+data.message);\n\n            //                 }\n\n            //             });\n\n\n            //     }\n\n\n\n             };\n\n\n\n\n             $scope.change_file_name = function(file){\n                \n                //this is terribly ineficient... unfortunately... can't \n                //work out how else to do it! (lol)\n\n                // //console.log(\"TO BE CHANGED\", file);\n\n                // //console.log(\"BEFORE BEFORE\", vm.plane_documents);\n\n                vm.plane_documents = $.grep(vm.plane_documents, function(e){ \n                    return e.temp_path != file.temp_path; \n                });\n\n                // //console.log(\"BEFORE\", vm.plane_documents);\n\n                vm.plane_documents.push(file);\n\n                // //console.log(\"AFTER\", vm.plane_documents);\n\n             }\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n        initController();\n\n        function initController() {\n           //console.log(\"check if access is okay\");\n        }\n\n\n          var warning_msg = \"By deleting this plane, you will also cancel all reservations that this plane currently has.\"\n\n          // $scope.open = function (plane_id) {\n          //   var modalInstance = $uibModal.open({\n          //     animation: true,\n          //     templateUrl: 'views/modals/deleteModal.html',\n          //     controller: 'ModalInstanceCtrl',\n          //     //params: {},\n          //     size: \"lg\",\n          //     resolve: {\n          //       id: function () {\n          //         return plane_id;\n          //       },\n          //       warning: function(){\n          //           return warning_msg;\n          //       }\n          //     }\n          //   });\n          //   modalInstance.result.then(function (plane_id) {\n          //     $log.info('PRESSED GO: '+plane_id);\n          //     PlaneService.Delete(plane_id)\n          //     .then(function(){\n          //       //console.log(\"HELLO DELETE\");\n          //       //update view?\n          //        vm.club.planes = $.grep(vm.club.planes, function(e){ \n          //           return e.plane_id != plane_id; \n          //       });\n          //     })\n          //   }, function () {\n          //     $log.info('Modal dismissed at: ' + new Date());\n          //   });\n          // };\n\n            $scope.open = function (club_plane_id) {\n            var modalInstance = $uibModal.open({\n              animation: true,\n              templateUrl: 'views/modals/deleteModal.html',\n              controller: 'ModalInstanceCtrl',\n              size: \"lg\",\n              resolve: {\n                id: function () {\n                  return club_plane_id;\n                },\n                params: function() {\n                  return {id: club_plane_id};\n                },\n                warning: function(){\n                    return warning_msg;\n                }\n              }\n            });\n            modalInstance.result.then(function (plane) {\n                var id = plane.id;\n              $log.info('PRESSED GO: ', id);\n              \n              PlaneService.Delete(id)\n              .then(function(){\n                //console.log(\"HELLO DELETE\");\n                //update view?\n                 vm.club.planes = $.grep(vm.club.planes, function(e){ \n                    return e.id != id; \n                });\n             });\n\n            }, function () {\n              $log.info('Modal dismissed at: ' + new Date());\n            });\n\n\n          };\n         \n\n         vm.aircraft;\n         vm.plane_search;\n         vm.plane_to_add;\n\n         $scope.get_aircraft = function(registration){\n\n            if(registration.length > 3){\n\n                 PlaneService.GetAddAircraft(registration)\n                .then(function (data) {\n                    ////console.log(data);\n                    if(data){\n                        //use GB airfields first...\n                         \n                        // vm.aircraft = data;\n                        // console.log(\"one is : \", data[0]);\n                       \n                         if(data.length == 0){\n                            // console.log(\"SETTINGS HERE\");\n                              vm.aircraft = [\n                                    {\n                                        icao_type: \"not known\",\n                                        registration: registration.toUpperCase()\n                                    }];\n                        } else {\n                            vm.aircraft = data;\n                        }\n\n                    } else {\n\n                          vm.aircraft = [\n                                    {\n                                        icao_type: \"not known\",\n                                        registration: registration.toUpperCase()\n                                    }];\n\n                                    //console.log(vm.aircraft);\n                        // console.log(\"WOOOPSIES...\");\n                        //this should be very very rare...\n                    }\n\n                });\n\n\n            }\n\n            \n        }\n\n\n    }\n app.controller('DashboardClubInstructorChargesController', DashboardClubInstructorChargesController);\n\n    DashboardClubInstructorChargesController.$inject = ['UserService', 'PlaneService', '$rootScope', '$location', '$scope', '$state', '$stateParams', '$uibModal', '$log', '$window', 'LicenceService', 'MedicalService', 'DifferencesService', 'InstructorCharges'];\n    function DashboardClubInstructorChargesController(UserService, PlaneService, $rootScope, $location, $scope, $state, $stateParams, $uibModal, $log, $window, LicenceService, MedicalService, DifferencesService, InstructorCharges) {\n        var vm = this;\n\n        vm.user = null;\n        vm.allUsers = [];\n        vm.club = {};\n        vm.page_title = \"\";\n        \n        vm.plane_document = {};\n        vm.plane_documents = [];\n\n        var update_this_file = [];\n        \n\n        vm.action = $state.current.data.action;\n        vm.club_id = $rootScope.globals.currentUser.current_club_admin.id;\n        vm.user = $rootScope.globals.currentUser;\n        vm.user_id = vm.user.id;\n\n        vm.charge_type = [\"brakes\", \"session\", \"plane\"];\n\n        ////console.log(\"club_id : \"+vm.club_id);\n\n        // //console.log(vm.action);\n         //console.log($stateParams);\n        // //console.log($stateParams.id);\n        switch(vm.action){\n            case \"add\":\n                //console.log(\"adding a new plane please\");\n                vm.page_title = \"Add a Instructor Charge\";\n            break;\n            case \"edit\":\n                //console.log(\"edit an existing plane\");\n                 //console.log($stateParams);\n                InstructorCharges.GetById($stateParams.id)\n                    .then(function(data){\n                        vm.club.item = data.item;   \n                        //console.log(vm.club);\n                        vm.page_title = \"Edit an instructor charge - \"+vm.club.item.title;\n                    });\n\n\n            break;\n            case \"list\":\n                //need to update this to be part of the authentication\n                //to find out club id\n                InstructorCharges.GetByClubId(vm.club_id)\n                    .then(function(data){\n                        vm.club.items = data.items;   \n                        //console.log(vm.club.items);\n                    });\n            break;\n            default:\n                //console.log(\"none of the above... redirect somewhere?\");\n            break;\n        }  \n\n        //'9' needs to refer the the user's account set to manage\n       \n        $scope.back = function(){\n            $window.history.back();\n        }\n\n        $scope.save = function(){\n            if(vm.action == \"add\"){\n                //console.log(\"CREATE click\");\n                $scope.create();\n            } else {\n                //console.log(\"EDIT click\");\n                //console.log(vm.club.plane);\n                $scope.update();\n            }\n        }\n\n\n        $scope.create = function(){\n            //console.log(\"CREATE ME NOW\");\n            vm.club.item.club_id = vm.club_id;\n            InstructorCharges.Create(vm.club.item)\n                .then(function(data){\n                    //console.log(data);\n                    //$state.reload();\n                    $state.go('dashboard.manage_club.instructor_charges', {}, {reload: true});\n\n                });\n        }\n\n        $scope.delete = function(){\n            //console.log(\"CLICK\");\n            alert(\"Are you sure you would like to delete this plane?\");\n            InstructorCharges.Delete(vm.user.id, vm.club.item)\n                .then(function(data){\n                    //console.log(data);\n                });\n        }\n\n        function get_update_docs(){\n            var documents = [];\n\n            for(var i=0;i<update_this_file.length;i++){\n                var id = update_this_file[i];\n                //console.log(\"looking for : \", id);\n                //console.log(\"in: \", vm.plane_documents);\n\n                for(var k=0;k<vm.club.plane.plane_documents.length;k++){\n                    //console.log(\"comparing to : \", vm.club.plane.plane_documents[k].id);\n                    if(vm.club.plane.plane_documents[k].id == id){\n                        documents.push(vm.club.plane.plane_documents[k]);\n                    }\n                }\n\n            }\n\n            // //console.log(\"DOCS TO UPDATE : \", documents);\n\n            return documents;\n        }\n\n        $scope.update = function(){\n            //console.log(\"CLICK\");\n            vm.club.item.club_id = vm.club_id;\n            InstructorCharges.Update(vm.club.item, vm.user.id)\n                .then(function(data){\n                    //console.log(data);\n                    //console.log(\"saved\");\n                    //$state.reload();\n                    $state.go('dashboard.manage_club.instructor_charges', {}, {reload: true});\n                });\n        }\n\n\n        function containsObject(obj, list, params) {\n\n            // //console.log(\"obj\", obj);\n            // //console.log(\"list\", list);\n            // //console.log(\"params\", params);\n\n            for(var i=0; i<list.length; i++) {\n                // //console.log(\"list i : \", list[i]);\n                // //console.log(\"obj is: \", obj);\n\n                var count_success = 0;\n                for(var j=0;j<params.length;j++){\n                    if(list[i][params[j]] && obj[params[j]] && list[i][params[j]] == obj[params[j]]){\n                        count_success++;\n                    }\n                }\n\n                if(count_success === params.length) {                    \n                    return true;\n                }\n            }\n\n            return false;\n        }\n\n\n        function check_all(){\n\n            //maybe a nice to have one day... not yet though.\n\n\n            //licences\n            vm.club.plane.requirements.licence.forEach(function(obj){\n\n            });\n\n        }\n\n      \n\n\n        $scope.add_item = function(type){\n            //console.log(\"ADD\");\n            switch(type){\n                case \"licence\":\n                    //console.log(\"licence\");\n                    if(vm.temporary.licence && vm.temporary.licence !== \"\" && vm.temporary.rating && vm.temporary.rating !== \"\"){\n                        //then we can add it\n                        //console.log(\"here we go\");\n                        var add_licence = {\n                            licence_id: vm.temporary.licence.id,\n                            licence_title: vm.temporary.licence.abbreviation,\n                            rating_title: vm.temporary.rating.abbreviation,\n                            rating_id: vm.temporary.rating.id\n                        };\n\n                        //check if it doesnt exist first...\n                        if(containsObject(add_licence, vm.club.plane.requirements.licence, new Array(\"licence_id\", \"rating_id\")) == false){\n                            vm.club.plane.requirements.licence.push(add_licence);\n                        }\n\n                        delete vm.temporary.licence;\n                        delete vm.temporary.rating;\n\n                    } else {\n                        alert(\"Please select a licence and rating that is required to book the plane solo!\");\n                    }\n\n                break;\n\n\n                case \"medical\":\n                    //console.log(\"medical\");\n                    if(vm.temporary.medical_authority && vm.temporary.medical_authority !== \"\" && vm.temporary.medical_component && vm.temporary.medical_component !== \"\"){\n                        //then we can add it\n                        //console.log(\"here we go\");\n                        var add_medical = {\n                            authority_id: vm.temporary.medical_authority.id,\n                            authority_title: vm.temporary.medical_authority.abbreviation,\n                            medical_component_id: vm.temporary.medical_component.id,\n                            medical_component_title: vm.temporary.medical_component.title\n                        };\n\n                        //check if it doesnt exist first...\n                        if(containsObject(add_medical, vm.club.plane.requirements.medical, new Array(\"authority_id\", \"medical_component_id\")) == false){\n                            vm.club.plane.requirements.medical.push(add_medical);\n                        }\n\n                        delete vm.temporary.medical_authority;\n                        delete vm.temporary.medical_component;\n\n                    } else {\n                        alert(\"Please select a medical that is required to book the plane solo!\");\n                    }\n\n                break;\n\n\n                case \"differences\":\n                    //console.log(\"difference\");\n                    if(vm.temporary.difference && vm.temporary.difference !== \"\"){\n                        //then we can add it\n                        //console.log(\"here we go\");\n                        var add_difference = {\n                            difference_id: vm.temporary.difference.id,\n                            difference_title: vm.temporary.difference.title\n                        };\n\n                        //check if it doesnt exist first...\n                        if(containsObject(add_difference, vm.club.plane.requirements.differences, new Array(\"difference_id\", \"difference_title\")) == false){\n                            vm.club.plane.requirements.differences.push(add_difference);\n                        }\n\n                        delete vm.temporary.difference;\n\n                    } else {\n                        alert(\"Please select a difference that is required to book the plane solo!\");\n                    }\n\n                break;\n\n\n            }\n\n\n\n        }\n\n\n        $scope.remove_item = function(type, index){\n            //console.log(\"REMOVE\");\n\n            vm.club.plane.requirements[type].splice(index, 1);\n\n\n            // switch(type){\n            //     case \"licence\":\n            //             //console.log(\"licence\");\n                   \n            //             //check if it doesnt exist first...\n            //             // if(containsObject(add_licence, vm.club.plane.requirements.licence, new Array(\"licence_id\", \"rating_id\")) == false){\n            //             //     vm.club.plane.requirements.licence.push(add_licence);\n            //             // }\n\n            //             vm.club.plane.requirements.licence.splice(index, 1);\n                      \n                   \n\n            //     break;\n\n\n            //     case \"medical\":\n            //         //console.log(\"medical\");\n            //         if(vm.temporary.medical_authority && vm.temporary.medical_authority !== \"\" && vm.temporary.medical_component && vm.temporary.medical_component !== \"\"){\n            //             //then we can add it\n            //             //console.log(\"here we go\");\n            //             var add_medical = {\n            //                 authority_id: vm.temporary.medical_authority.id,\n            //                 authority_title: vm.temporary.medical_authority.abbreviation,\n            //                 medical_component_id: vm.temporary.medical_component.id,\n            //                 medical_component_title: vm.temporary.medical_component.title\n            //             };\n\n            //             //check if it doesnt exist first...\n            //             if(containsObject(add_medical, vm.club.plane.requirements.medical, new Array(\"authority_id\", \"medical_component_id\")) == false){\n            //                 vm.club.plane.requirements.medical.push(add_medical);\n            //             }\n\n            //             delete vm.temporary.medical_authority;\n            //             delete vm.temporary.medical_component;\n\n            //         } else {\n            //             alert(\"Please select a medical that is required to book the plane solo!\");\n            //         }\n\n            //     break;\n\n\n            //     case \"differences\":\n            //         //console.log(\"difference\");\n            //         if(vm.temporary.difference && vm.temporary.difference !== \"\"){\n            //             //then we can add it\n            //             //console.log(\"here we go\");\n            //             var add_difference = {\n            //                 difference_id: vm.temporary.difference.id,\n            //                 difference_title: vm.temporary.difference.title\n            //             };\n\n            //             //check if it doesnt exist first...\n            //             if(containsObject(add_difference, vm.club.plane.requirements.differences, new Array(\"difference_id\", \"difference_title\")) == false){\n            //                 vm.club.plane.requirements.differences.push(add_difference);\n            //             }\n\n            //             delete vm.temporary.difference;\n\n            //         } else {\n            //             alert(\"Please select a difference that is required to book the plane solo!\");\n            //         }\n\n            //     break;\n\n\n            // }\n\n\n\n        }\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n        $scope.update_this_file = function(file){\n            //console.log(\"==== update is : \", file.id);\n            if(update_this_file.indexOf(file.id) === -1){\n                update_this_file.push(file.id)\n            } else {\n               ////console.log(\"This item already exists\"); \n            } \n        }\n\n\n         $scope.remove_real_file = function(file){\n\n                //remove_file\n\n                vm.club.plane.plane_documents = $.grep(vm.club.plane.plane_documents, function(e){ \n                        return e.id != file.id; \n                    });\n\n                //no need to actually remove the file as it will be archived accordingly on the backend whilst it is missing! :)\n                PlaneDocumentService.Delete(vm.user.id, file.id)\n                .then(function (data) {\n                    //console.log(data);\n                    if(data.success){\n                        //console.log(\"HUZZAH\", current_files);\n                        //then we need to remove this from the list of files...\n                        //clear files\n                        vm.plane_documents = [];\n                        //and re-process available files\n                        $scope.processFiles(current_files);\n\n                    } else {\n                        //console.log(\"WOOOPSIES...\");\n                        //this should be very very rare...\n                    }\n\n                });\n\n          }\n\n\n          \n          $scope.remove_file = function(file, current_files){\n\n            //remove_file\n            var j = JSON.parse(file.file_return);\n            //console.log(\"REMOVE: \", j);\n            //console.log(\"REMOVE: \", j.saved_url);\n\n            //to delete the temp file created: j.saved_url\n            //tmp_rm.php POST tmp = filename\n            \n            PoidService.DeleteTmp(j.saved_url)\n                .then(function (data) {\n                    //console.log(data);\n                    if(data.success){\n                        //console.log(\"HUZZAH\", current_files);\n                        //then we need to remove this from the list of files...\n                        //clear files\n                        vm.plane_documents = [];\n                        //and re-process available files\n                        $scope.processFiles(current_files);\n\n                    } else {\n                        //console.log(\"WOOOPSIES...\");\n                        //this should be very very rare...\n                    }\n\n                });\n\n          }\n          \n\n          // $scope.$on('flow::fileAdded', function (event, $flow, flowFile) {\n          //     event.preventDefault();//prevent file from uploading\n          //     //console.log(\"FILE ADDED\");\n          //     //console.log($flow);\n          //   });\n\n            $scope.processFiles = function(files){\n                // //console.log(\"files\", files);\n\n                for(var i=0; i<files.length; i++){\n                    // //console.log(\"JSON\", files[i].file_return);\n                    var j = JSON.parse(files[i].file_return);\n                    // //console.log(\"PARSED\", j);\n                    //console.log(\"J is : \",j);\n                    //console.log(\"name is : \", j.files.file.name);\n\n                    files[i].file.temp_path = j.saved_url;\n                    files[i].file.save_name = j.files.file.name;\n                    var ft = j.files.file.name;\n                    ft = ft.split('.').pop();\n                    files[i].file.extension = ft;\n\n                    // //console.log(\"file\", files[i].file);\n                    vm.plane_documents.push(files[i].file);\n                }\n\n\n            }\n\n            $scope.set_title = function(file){\n                //console.log(\"return\", file);\n                return file.save_name;\n            }\n\n            $scope.get_icon = function(file){\n\n                var ft = file.name;\n                ft = ft.split('.').pop();\n                var icon_name = \"\";\n\n                // //console.log(\"FILE:\", ft);\n                // //console.log(\"index : \", ft.indexOf(\"pdf\"));\n                switch(true){\n                    case (ft.indexOf(\"pdf\") > -1):\n                        icon_name = \"pdf.png\";\n                    break;\n                    case (ft.indexOf(\"doc\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"docx\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"xls\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"xlsx\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"ppt\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"pptx\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"jpg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"jpeg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"png\") > -1):\n                        icon_name = \"png.png\";\n                    break;\n                    case (ft.indexOf(\"gif\") > -1):\n                        icon_name = \"gif.png\";\n                    break;\n                    case (ft.indexOf(\"zip\") > -1):\n                        icon_name = \"zip.png\";\n                    break;\n                    case (ft.indexOf(\"avi\") > -1):\n                        icon_name = \"avi.png\";\n                    break;\n                    case (ft.indexOf(\"mp4\") > -1):\n                        icon_name = \"mp4.png\";\n                    break;\n                    default:\n                        icon_name = \"file.png\";\n                    break;\n                }\n\n                // //console.log(\"FILE:\", icon_name);\n\n                return \"images/file_icons/\"+icon_name;\n            }\n\n\n            $scope.get_icon2 = function(file){\n\n                var ft = file.split('.').pop();\n                // //console.log(\"ICON 2 : \", ft);\n                var icon_name = \"\";\n\n                // //console.log(\"FILE:\", ft);\n                // //console.log(\"index : \", ft.indexOf(\"pdf\"));\n                switch(true){\n                    case (ft.indexOf(\"pdf\") > -1):\n                        icon_name = \"pdf.png\";\n                    break;\n                    case (ft.indexOf(\"doc\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"docx\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"xls\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"xlsx\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"ppt\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"pptx\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"jpg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"jpeg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"png\") > -1):\n                        icon_name = \"png.png\";\n                    break;\n                    case (ft.indexOf(\"gif\") > -1):\n                        icon_name = \"gif.png\";\n                    break;\n                    case (ft.indexOf(\"zip\") > -1):\n                        icon_name = \"zip.png\";\n                    break;\n                    case (ft.indexOf(\"avi\") > -1):\n                        icon_name = \"avi.png\";\n                    break;\n                    case (ft.indexOf(\"mp4\") > -1):\n                        icon_name = \"mp4.png\";\n                    break;\n                    default:\n                        icon_name = \"file.png\";\n                    break;\n                }\n\n                // //console.log(\"FILE:\", icon_name);\n\n                return \"images/file_icons/\"+icon_name;\n            }\n\n\n\n            $scope.delete_poid = function(id){\n\n              \n                var a = prompt(\"Are you sure you wish to delete this poid? \\n\\n This change is irreversible! To confirm please type YES in the box below.\");\n                if(a == \"YES\"){\n\n\n                    //console.log(\"WE DELETE IT\");\n\n\n                    // PoidService.Delete(vm.user_id, id)\n                    //     .then(function (data) {\n                    //         //console.log(data);\n                    //         if(data.success){\n                    //             //console.log(\"HUZZAH\", data);\n                    //             //then we need to remove this from the list of files...\n                    //             vm.user_poids = $.grep(vm.user_poids, function(e){ \n                    //                 return e.id != id; \n                    //             });\n                                \n                    //             //refresh?\n                    //             $state.reload();\n                    //             $state.go('dashboard.my_account.poid');\n\n                    //         } else {\n\n                    //             alert(\"Something went terribly wrong... \\n\\n \"+data.message);\n\n                    //         }\n\n                    //     });\n\n\n\n                } else {\n                    //console.log(\"ignore123\");\n                }\n\n\n            }\n\n\n\n\n            $scope.save_plane_documents = function(){\n\n               \n              \n\n                //console.log(\"plane_documents: \", vm.plane_documents);\n\n\n                //compile the required elements YAY\n\n                //console.log(\"plane_document \", vm.plane_document);\n\n\n                 //clean shizzle before sending\n                 //why keep sending back heavy data?\n\n                    // for(var i=0;i<vm.plane_document.images.length;i++){\n                    //     delete vm.plane_document.images[i].data_uri;\n                    // }\n\n                    // // vm.plane_document.images = vm.plane_documents;\n                    // vm.plane_document.images = vm.plane_document.images.concat(vm.plane_documents);\n                    // vm.plane_document.user_id = vm.user_id;\n\n\n\n\n            //     if(vm.plane_document.id){\n            //         //then its an udpate\n\n            //         //merge the images left?\n            //         PoidService.Update(vm.plane_document)\n            //             .then(function (data) {\n            //                 //console.log(data);\n            //                 if(data.success){\n            //                     //console.log(\"HUZZAH\", vm.plane_document);\n            //                     //console.log(\"HUZZAH\", data);\n            //                     //then we need to remove this from the list of files...\n                                \n                                \n            //                     //move somewhere?\n            //                     $state.go('dashboard.my_account.poid', {}, { reload: true });\n\n\n\n\n\n            //                 } else {\n\n            //                     alert(\"Something went terribly wrong... \\n\\n \"+data.message);\n\n            //                 }\n\n            //             });\n\n            //     } else {\n\n\n                   \n\n\n            //         //then its a create\n            //         //console.log(vm.plane_document);\n\n            //         PoidService.Create(vm.plane_document)\n            //             .then(function (data) {\n            //                 //console.log(data);\n            //                 if(data.success){\n            //                     //console.log(\"HUZZAH\", vm.plane_document);\n            //                     //console.log(\"HUZZAH\", data);\n            //                     //then we need to remove this from the list of files...\n                                \n                                \n            //                     //move somewhere?\n            //                    // $state.reload();\n            //                    // $state.go('dashboard.my_account.poid', {}, { reload: true });\n\n\n            //                 } else {\n\n            //                     alert(\"Something went terribly wrong... \\n\\n \"+data.message);\n\n            //                 }\n\n            //             });\n\n\n            //     }\n\n\n\n             };\n\n\n\n\n             $scope.change_file_name = function(file){\n                \n                //this is terribly ineficient... unfortunately... can't \n                //work out how else to do it! (lol)\n\n                // //console.log(\"TO BE CHANGED\", file);\n\n                // //console.log(\"BEFORE BEFORE\", vm.plane_documents);\n\n                vm.plane_documents = $.grep(vm.plane_documents, function(e){ \n                    return e.temp_path != file.temp_path; \n                });\n\n                // //console.log(\"BEFORE\", vm.plane_documents);\n\n                vm.plane_documents.push(file);\n\n                // //console.log(\"AFTER\", vm.plane_documents);\n\n             }\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n        initController();\n\n        function initController() {\n           //console.log(\"check if access is okay\");\n        }\n\n\n            var warning_msg = \"By deleting this plane, you will also cancel all reservations that this plane currently has.\"\n\n          $scope.open = function (plane_id) {\n            var modalInstance = $uibModal.open({\n              animation: true,\n              templateUrl: 'views/modals/deleteModal.html',\n              controller: 'ModalInstanceCtrl',\n              size: \"lg\",\n              resolve: {\n                id: function () {\n                  return plane_id;\n                },\n                params: function() {\n                  return {id: plane_id};\n                },\n                warning: function(){\n                    return warning_msg;\n                }\n              }\n            });\n            modalInstance.result.then(function (plane_id) {\n              $log.info('PRESSED GO: '+plane_id.id);\n              InstructorCharges.Delete(vm.user.id, plane_id.id)\n              .then(function(){\n                //console.log(\"HELLO DELETE\");\n                //update view?\n                 vm.club.items = $.grep(vm.club.items, function(e){ \n                    return e.id != plane_id.id; \n                });\n              })\n            }, function () {\n              $log.info('Modal dismissed at: ' + new Date());\n            });\n          };\n\n         \n\n\n    }\n app.controller('DashboardClubInvoicesController', DashboardClubInvoicesController);\n\n    DashboardClubInvoicesController.$inject = ['$sce', 'PaymentService', 'UserService', 'ClubService', 'MemberService', 'InstructorService', 'MembershipService', 'HolidayService', '$rootScope', '$location', '$scope', '$state', '$stateParams', '$uibModal', '$log', '$window', '$compile', '$timeout', 'uiCalendarConfig', 'BookingService', 'LicenceService', 'ClubDocumentService', 'PlaneDocumentService', '$http'];\n    function DashboardClubInvoicesController($sce, PaymentService, UserService, ClubService, MemberService, InstructorService, MembershipService, HolidayService, $rootScope, $location, $scope, $state, $stateParams, $uibModal, $log, $window, $compile, $timeout, uiCalendarConfig, BookingService, LicenceService, ClubDocumentService, PlaneDocumentService, $http) {\n        \n        var vm = this;\n\n        vm.clubs = [];\n        vm.user = $rootScope.globals.currentUser;\n        vm.user_id = vm.user.id;\n        \n        vm.club_id = vm.user.current_club_admin.id;\n\n        vm.to_date = new Date();\n        vm.from_date = new Date();\n\n        vm.from_date.setMonth(vm.from_date.getMonth() - 1);\n\n\n        vm.show_pay_now = false;\n        vm.show_loading = false;\n\n        vm.last_invoice_opened = {};\n\n\n        var iconBank = '<svg viewBox=\"0 0 24 24\"><path d=\"M3 10h18M4 10V8l8-5 8 5v2M5 10v8M9 10v8M15 10v8M19 10v8M3 18h18M2 20h20\" fill=\"none\" stroke=\"#4f46e5\" stroke-width=\"1.6\"/></svg>';\n        var iconCard = '<svg viewBox=\"0 0 24 24\"><rect x=\"2\" y=\"4\" width=\"20\" height=\"16\" rx=\"2\" ry=\"2\" fill=\"none\" stroke=\"#4f46e5\" stroke-width=\"1.6\"/><path d=\"M2 9h20M6 14h6\" stroke=\"#4f46e5\" stroke-width=\"1.6\"/></svg>';\n        var iconNew  = '<svg viewBox=\"0 0 24 24\"><circle cx=\"12\" cy=\"12\" r=\"9\" fill=\"none\" stroke=\"#4f46e5\" stroke-width=\"1.6\"/><path d=\"M12 8v8M8 12h8\" stroke=\"#4f46e5\" stroke-width=\"1.6\"/></svg>';\n        var iconTerm = '<svg viewBox=\"0 0 24 24\"><rect x=\"6\" y=\"2\" width=\"12\" height=\"14\" rx=\"2\" fill=\"none\" stroke=\"#4f46e5\" stroke-width=\"1.6\"/><rect x=\"8\" y=\"5\" width=\"8\" height=\"3\" fill=\"none\" stroke=\"#4f46e5\" stroke-width=\"1.6\"/><rect x=\"9\" y=\"10\" width=\"6\" height=\"3\" fill=\"none\" stroke=\"#4f46e5\" stroke-width=\"1.6\"/></svg>';\n        \n          vm.donConfirm = function(methodLabel, paymentIntent){\n            // console.log(\"confirmation is called\", methodLabel);\n            // console.log(\"paymentIntent\", paymentIntent);\n          //alert('Parent received D confirmation: ' + methodLabel);\n            vm.complete_invoice(methodLabel, paymentIntent);\n          };\n\n          vm.default_payment = 'direct-debit';\n\n          vm.methods = [\n            { id: 'direct-debit', title: 'Direct Debit', subtitle: 'Use your BACS mandate', type: 'direct-debit', iconSvg: $sce.trustAsHtml(iconBank), visible: true },\n            { id: 'saved-card',   title: 'Saved card',   subtitle: 'Use a card on file',    type: 'saved-card',  iconSvg: $sce.trustAsHtml(iconCard), visible: true },\n            { id: 'new-card',     title: 'New card',     subtitle: 'Add a new debit/credit card', type: 'new-card', iconSvg: $sce.trustAsHtml(iconNew), visible: false },\n            { id: 'card-machine', title: 'Card Machine', subtitle: 'Pay in person',          type: 'card-machine', iconSvg: $sce.trustAsHtml(iconTerm), visible: true }\n          ];\n\n           vm.savedCards = [];\n\n           vm.complete_invoice = function(method, paymentIntent){\n\n               //we now have a payment to complete\n               //process_payment\n\n               var obj = {\n                   user_id: vm.last_invoice_opened.user_id,\n                   club_id: vm.last_invoice_opened.club_id,\n                   paymentIntent: paymentIntent,\n                   invoice_id: vm.last_invoice_opened.id,\n                   method: method\n               }\n\n               PaymentService.ProcessPayment(obj)\n                   .then(function (data) {\n\n                       if(data.success){\n\n                           //finish with:\n                           //RELOAD THE INVOICES!!!\n                           ClubService.GetClubInvoices(vm.club_id, vm.from_date, vm.to_date)\n                            .then(function (data) {\n                                   console.log(\"data is : \", data);\n                                   vm.invoices = data.invoices;\n                                   vm.totals = data.totals;\n\n                                   vm.show_pay_now = false;\n                                   vm.show_loading = false;\n                                   //alert(\"SUCCESS!\");\n\n\n                                });\n\n                           \n\n                       } else {\n                          // alert(\"Something happened which was not supposed to happen... Please try again\");\n                           console.log(\"===== ERROR =====\");\n                           console.log(data);\n                           console.log(\"===== ERROR =====\");\n                       }\n\n\n                   });\n\n           }\n\n           vm.close_pay_now = function(){\n               vm.show_pay_now = false;\n               vm.show_loading = false;\n           }\n\n           vm.show_payment_option = function(invoice){\n            var status = invoice.status;\n            if(status == \"pending_submission\"){\n                return true;\n            } else if(status == \"issued\"){\n                return true;\n            } else {\n                return false;\n            }\n\n        }\n\n        vm.info;\n\n        vm.show_payment = function(invoice){\n            console.log(\"invoice details: \", invoice);\n            vm.last_invoice_opened = invoice;\n            vm.send = {\n                club_id: invoice.club_id,\n                user_id: invoice.user_id,\n                invoice_id: invoice.id\n            }\n\n            //get user cards\n            //get user info\n\n            MemberService.GetMandate(invoice.user_id, invoice.club_id)\n                    .then(function (data) {\n                            ////console.log(\"data is : \", data);\n                           \n                    if(data.success){\n                        vm.info = data.info;\n\n                        vm.savedCards = data.cards;\n\n                        if(vm.savedCards.length > 0){\n                            vm.methods[1].visible = true;\n                        } else {\n                            vm.methods[1].visible = false;\n                        }\n\n                        vm.machine = data.machine;\n                        if(vm.machine.success){\n                            vm.methods[3].visible = true;\n                        } else {\n                            vm.methods[3].visible = false;\n                        }\n\n                        vm.show_pay_now = true;\n                    }\n\n                });\n\n           \n\n        }\n\n\n\n\n        // console.log(\"GLOBALS\", $rootScope.globals);\n        // console.log(\"USER\", vm.user.current_club_admin.id);\n\n        vm.get_package_html = function(pack_obj){\n\n\n\n                            var used_on = \"\";\n                            for(var i=0;i<pack_obj.aircraft.length;i++){\n                                used_on = used_on + \" \" + pack_obj.aircraft[i].registration +\" (\"+ pack_obj.aircraft[i].plane_type +\") <br />\";\n                            }\n                            var text = \"\";\n                            if(pack_obj.validity == 0){\n                               text = \"Package purchased on: \"+moment(pack_obj.created_at).format(\"D MMM Y\")+\"<br /> Package does not expire <br /> To be used on:<br />\";\n                            } else {\n                               text = \"Package purchased on: \"+moment(pack_obj.created_at).format(\"D MMM Y\")+\"<br /> Package expires on: \"+ moment(pack_obj.created_at).add(pack_obj.validity, \"days\").format(\"D MMM Y\") +\" <br /> To be used on:<br />\";\n                            }\n                    \n                            var intro =  text+used_on;\n\n\n                            // bit = bit + '<h4 uib-tooltip=\"'+intro+'\"> '+package.title+' <i class=\"fa fa-question-circle\"></i></h4><div class=\"dual_solo\"><div class=\"dual\" uib-tooltip=\"Hours remaining on this package to fly dual (with an instructor)\"><span class=\"bigger_text\">'+vm.convert_decimal_to_hours( package.remaining_hours_dual )+'</span><span class=\"smaller_text\">DUAL</span></div><div class=\"solo\" uib-tooltip=\"Hours remaining on this package of solo rental\"><span class=\"bigger_text\">'+vm.convert_decimal_to_hours( package.remaining_hours_solo )+'</span><span class=\"smaller_text\">SOLO</span></div></div>';\n\n\n                            \n                            return intro;\n\n        }\n        vm.quick_select = {};\n        vm.base_date = new Date();\n        vm.yesterday = new Date();\n        vm.sevendaysago = new Date();\n        vm.thirtydaysago = new Date();\n        vm.yesterday.setDate(vm.yesterday.getDate() - 1);\n        vm.sevendaysago.setDate(vm.yesterday.getDate() - 7);\n        vm.thirtydaysago.setDate(vm.yesterday.getDate() - 30);\n\n        function getMonday(d) {\n          var date = new Date(d);\n          const day = date.getDay();\n          const diff = date.getDate() - day + (day === 0 ? -6 : 1);\n          return new Date(d.setDate(diff));\n        }\n        function getSunday(d){\n            const sunday = new Date(d)\n            sunday.setDate(sunday.getDate() + 6);\n            return sunday;\n        }\n\n        var date = new Date();\n        var firstDay = new Date(date.getFullYear(), date.getMonth(), 1);\n        var lastDay = new Date(date.getFullYear(), date.getMonth() + 1, 0);\n        \n        var lm_firstDay = new Date(date.getFullYear(), (date.getMonth() - 1), 1);\n        var lm_lastDay = new Date(date.getFullYear(), date.getMonth(), 0);\n        \n\n        vm.quick_selects = [\n           {\n               title: \"Today\",\n               from_date: vm.base_date,\n               to_date: vm.base_date\n           },\n           {\n               title: \"Yesterday\",\n               from_date: vm.yesterday,\n               to_date: vm.yesterday\n           },\n           {\n               title: \"Last 7 days\",\n               from_date: vm.sevendaysago,\n               to_date: vm.base_date\n           },\n           {\n               title: \"Last 30 days\",\n               from_date: vm.thirtydaysago,\n               to_date: vm.yesterday\n           },\n           {\n               title: \"This week\",\n               from_date: getMonday(new Date()),\n               to_date: getSunday(getMonday(new Date()))\n           },\n           {\n               title: \"This month\",\n               from_date: firstDay,\n               to_date: lastDay\n           },\n           {\n               title: \"Last month\",\n               from_date: lm_firstDay,\n               to_date: lm_lastDay\n           }\n\n\n        ];\n        vm.update_qs = function(){\n            console.log(\"QUICK SELECT : \");\n            console.log(vm.quick_select.from_date);\n            console.log(vm.quick_select.to_date);\n            vm.from_date = vm.quick_select.from_date;\n            vm.to_date = vm.quick_select.to_date;\n            vm.update_date_range();\n        }\n        vm.update_date_range = function(){\n            //update the invoices\n            ClubService.GetClubInvoices(vm.club_id, vm.from_date, vm.to_date)\n            .then(function (data) {\n                   console.log(\"data is : \", data);\n                   vm.invoices = data.invoices;\n                   vm.totals = data.totals;\n                });\n\n        }\n       \n\n        vm.convert_decimal_to_hours = function(number){\n            \n                            var sign = (number >= 0) ? 1 : -1;\n\n                            // Set positive value of number of sign negative\n                            number = number * sign;\n\n                            // Separate the int from the decimal part\n                            var hour = Math.floor(number);\n                            var decpart = number - hour;\n\n                            var min = 1 / 60;\n                            // Round to nearest minute\n                            decpart = min * Math.round(decpart / min);\n\n                            var minute = Math.floor(decpart * 60) + '';\n\n                            // Add padding if need\n                            if (minute.length < 2) {\n                            minute = '0' + minute; \n                            }\n\n                            if(minute == 60){\n                                hour = hour+1;\n                                minute = '00';\n                            }\n\n                            // Add Sign in final result\n                            sign = sign == 1 ? '' : '-';\n\n                            // Concate hours and minutes\n                            var time = sign + hour + ':' + minute;\n\n                            return time;\n\n                        }\n\n                        // var from_date = \"2024-01-01\";\n                        // var to_date = \"2024-07-01\";\n\n        ClubService.GetClubInvoices(vm.club_id, vm.from_date, vm.to_date)\n            .then(function (data) {\n                   console.log(\"data is : \", data);\n                   vm.invoices = data.invoices;\n                   vm.totals = data.totals;\n                });\n\n\n        // ClubService.GetClubTotals(vm.user.id, from_date, to_date)\n        //     .then(function (data) {\n        //             ////console.log(\"data is : \", data);\n        //            vm.upcoming = data.upcoming;\n        //         });\n       \n          \n        $scope.get_icon = function(file){\n\n                var ft = file.name;\n                ft = ft.split('.').pop();\n                var icon_name = \"\";\n\n                // //console.log(\"FILE:\", ft);\n                // //console.log(\"index : \", ft.indexOf(\"pdf\"));\n                switch(true){\n                    case (ft.indexOf(\"pdf\") > -1):\n                        icon_name = \"pdf.png\";\n                    break;\n                    case (ft.indexOf(\"doc\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"docx\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"xls\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"xlsx\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"ppt\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"pptx\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"jpg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"jpeg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"png\") > -1):\n                        icon_name = \"png.png\";\n                    break;\n                    case (ft.indexOf(\"gif\") > -1):\n                        icon_name = \"gif.png\";\n                    break;\n                    case (ft.indexOf(\"zip\") > -1):\n                        icon_name = \"zip.png\";\n                    break;\n                    case (ft.indexOf(\"avi\") > -1):\n                        icon_name = \"avi.png\";\n                    break;\n                    case (ft.indexOf(\"mp4\") > -1):\n                        icon_name = \"mp4.png\";\n                    break;\n                    default:\n                        icon_name = \"file.png\";\n                    break;\n                }\n\n                // //console.log(\"FILE:\", icon_name);\n\n                return \"images/file_icons/\"+icon_name;\n            }\n\n\n            vm.get_icon2 = function(file){\n\n                var ft = file.split('.').pop();\n                // //console.log(\"ICON 2 : \", ft);\n                var icon_name = \"\";\n\n                // //console.log(\"FILE:\", ft);\n                // //console.log(\"index : \", ft.indexOf(\"pdf\"));\n                switch(true){\n                    case (ft.indexOf(\"pdf\") > -1):\n                        icon_name = \"pdf.png\";\n                    break;\n                    case (ft.indexOf(\"doc\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"docx\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"xls\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"xlsx\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"ppt\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"pptx\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"jpg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"jpeg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"png\") > -1):\n                        icon_name = \"png.png\";\n                    break;\n                    case (ft.indexOf(\"gif\") > -1):\n                        icon_name = \"gif.png\";\n                    break;\n                    case (ft.indexOf(\"zip\") > -1):\n                        icon_name = \"zip.png\";\n                    break;\n                    case (ft.indexOf(\"avi\") > -1):\n                        icon_name = \"avi.png\";\n                    break;\n                    case (ft.indexOf(\"mp4\") > -1):\n                        icon_name = \"mp4.png\";\n                    break;\n                    default:\n                        icon_name = \"file.png\";\n                    break;\n                }\n\n                // //console.log(\"FILE:\", icon_name);\n\n                return \"images/file_icons/\"+icon_name;\n            }\n\n        \n        $scope.search = function(row){\n            //plane_registration\n            ////console.log(\"hi\", (angular.lowercase(row.title).indexOf(angular.lowercase($scope.my_search) || '') !== -1));\n            if(row.plane_registration){\n                if(angular.lowercase(row.plane_registration).indexOf(angular.lowercase($scope.my_search) || '') !== -1){\n                    return true;\n                }\n            }\n\n\n            return ( (angular.lowercase(row.invoice_number).indexOf(angular.lowercase($scope.my_search) || '') !== -1) || \n                    (angular.lowercase(row.user.last_name).indexOf(angular.lowercase($scope.my_search) || '') !== -1) ||\n                    (angular.lowercase(row.created_at.toString()).indexOf(angular.lowercase($scope.my_search) || '') !== -1) ||\n                    (angular.lowercase((parseFloat(row.total).toFixed(2)).toString()).indexOf(angular.lowercase($scope.my_search) || '') !== -1) ||\n                    (angular.lowercase(row.status).indexOf(angular.lowercase($scope.my_search) || '') !== -1) );\n        };\n\n        $scope.show_more = function(index){\n\n\n            vm.invoices[index].show_more = (vm.invoices[index].show_more)? false : true;\n\n\n        }\n\n\n\n\n        function process_payment_bits(payments){\n\n\n\n\n\n\n\n\n\n        }\n\n\n        $scope.get_human_status = function(status){\n\n            var returned;\n            switch(status){\n                case 'issued':\n            \n                  returned = \"Created\";\n\n              break;\n\n              case 'pending_submission':\n                  \n                    returned = \"Requesting\";\n\n              break;\n\n              case 'submitted':\n                    \n                    returned = \"Requested\";\n\n              break;\n\n              case 'confirmed':\n                    \n                    returned = \"Paid\";\n\n              break;\n\n              case 'paid_out':\n                    returned = \"Paid\";\n\n              break;\n\n              case 'failed':\n                    returned = \"Failed\";\n\n              break;\n\n              case 'charged_back':\n                    returned = \"Charged Back\";\n\n              break;\n              default:\n                  returned = status;\n              break\n            }\n\n            return returned;\n\n        }\n\n     \n        $scope.downloadDocument = function(doc) {\n            var data = $.param({\n                id: doc\n            });\n\n            var ddd = doc.replace(/^.*[\\\\\\/]/, '');\n\n            $http.get('http://local.arrow.com/api/v1/plane_documents/show_file/'+ddd, {\n                    responseType: 'arraybuffer'\n                })\n                .success(function(data, status, headers) {\n                    var zipName = processArrayBufferToBlob(data, headers);\n\n                    //Delete file from temp folder in server - file needs to remain open until blob is created\n                    //deleteFileFromServerTemp(zipName);\n                }).error(function(data, status) {\n                    alert(\"There was an error downloading the selected document(s).\");\n                })\n        };\n\n        $scope.downloadInvoice = function(id) {\n            // var data = $.param({\n            //     id: doc\n            // });\n\n            //var ddd = doc.replace(/^.*[\\\\\\/]/, '');\n\n            $http.get('api/v1/invoice_pdf/get_ad_hoc_invoice/'+id, {\n                    responseType: 'arraybuffer'\n                })\n                .success(function(data, status, headers) {\n                    var zipName = processArrayBufferToBlob(data, headers);\n\n                    //Delete file from temp folder in server - file needs to remain open until blob is created\n                    //deleteFileFromServerTemp(zipName);\n                }).error(function(data, status) {\n                    alert(\"There was an error downloading the selected document(s).\");\n                })\n        };\n\n        function processArrayBufferToBlob(data, headers) {\n            var octetStreamMime = 'application/octet-stream';\n            var success = false;\n\n            // Get the headers\n            headers = headers();\n            //var ttt = title.toLowerCase().replace(/\\W/g, '_');\n            // Get the filename from the x-filename header or default to \"download.bin\"\n            var filename = headers['x-filename'] || 'download.zip';\n\n            // Determine the content type from the header or default to \"application/octet-stream\"\n            var contentType = headers['content-type'] || octetStreamMime;\n\n            try {\n                // Try using msSaveBlob if supported\n                var blob = new Blob([data], {\n                    type: contentType\n                });\n                if (navigator.msSaveBlob)\n                    navigator.msSaveBlob(blob, filename);\n                else {\n                    // Try using other saveBlob implementations, if available\n                    var saveBlob = navigator.webkitSaveBlob || navigator.mozSaveBlob || navigator.saveBlob;\n                    if (saveBlob === undefined) throw \"Not supported\";\n                    saveBlob(blob, filename);\n                }\n                success = true;\n            } catch (ex) {\n                $log.info(\"!!saveBlob method failed with the following exception:\");\n                $log.info(ex);\n            }\n\n            if (!success) {\n                // Get the blob url creator\n                var urlCreator = window.URL || window.webkitURL || window.mozURL || window.msURL;\n                if (urlCreator) {\n                    // Try to use a download link\n                    var link = document.createElement('a');\n                    if ('download' in link) {\n                        // Try to simulate a click\n                        try {\n                            // Prepare a blob URL\n                            var blob = new Blob([data], {\n                                type: contentType\n                            });\n                            var url = urlCreator.createObjectURL(blob);\n                            link.setAttribute('href', url);\n\n                            // Set the download attribute (Supported in Chrome 14+ / Firefox 20+)\n                            link.setAttribute(\"download\", filename);\n\n                            // Simulate clicking the download link\n                            var event = document.createEvent('MouseEvents');\n                            event.initMouseEvent('click', true, true, window, 1, 0, 0, 0, 0, false, false, false, false, 0, null);\n                            link.dispatchEvent(event);\n                            success = true;\n\n                        } catch (ex) {\n                            $log.info(\"Download link method with simulated click failed with the following exception:\");\n                            $log.info(ex);\n                        }\n                    }\n\n                    if (!success) {\n                        // Fallback to window.location method\n                        try {\n                            // Prepare a blob URL\n                            // Use application/octet-stream when using window.location to force download\n                            var blob = new Blob([data], {\n                                type: octetStreamMime\n                            });\n                            var url = urlCreator.createObjectURL(blob);\n                            window.location = url;\n                            success = true;\n                        } catch (ex) {\n                            $log.info(\"Download link method with window.location failed with the following exception:\");\n                            $log.info(ex);\n                        }\n                    }\n                }\n            }\n\n            if (!success) {\n                // Fallback to window.open method\n                $log.info(\"No methods worked for saving the arraybuffer, using last resort window.open\");\n                window.open(httpPath, '_blank', '');\n            }\n            return filename;\n        };\n\n      \n\n\n\n    }\n\n\n\n\n\n app.controller('DashboardClubItemsController', DashboardClubItemsController);\n\n    DashboardClubItemsController.$inject = ['UserService', 'PlaneService', '$rootScope', '$location', '$scope', '$state', '$stateParams', '$uibModal', '$log', '$window', 'LicenceService', 'MedicalService', 'DifferencesService', 'ItemService'];\n    function DashboardClubItemsController(UserService, PlaneService, $rootScope, $location, $scope, $state, $stateParams, $uibModal, $log, $window, LicenceService, MedicalService, DifferencesService, ItemService) {\n        var vm = this;\n\n        vm.user = null;\n        vm.allUsers = [];\n        vm.club = {};\n        vm.page_title = \"\";\n        \n        vm.plane_document = {};\n        vm.plane_documents = [];\n\n        var update_this_file = [];\n        \n\n        vm.action = $state.current.data.action;\n        vm.club_id = $rootScope.globals.currentUser.current_club_admin.id;\n        vm.user = $rootScope.globals.currentUser;\n        vm.user_id = vm.user.id;\n        ////console.log(\"club_id : \"+vm.club_id);\n\n        // //console.log(vm.action);\n         //console.log($stateParams);\n        // //console.log($stateParams.id);\n        switch(vm.action){\n            case \"add\":\n                //console.log(\"adding a new plane please\");\n                vm.page_title = \"Add a New Plane\";\n            break;\n            case \"edit\":\n                //console.log(\"edit an existing plane\");\n                 //console.log($stateParams);\n                ItemService.GetById($stateParams.item_id)\n                    .then(function(data){\n                        vm.club.item = data.item;   \n                        //console.log(vm.club);\n                        vm.page_title = \"Edit an Item - \"+vm.club.item.title;\n                    });\n\n\n            break;\n            case \"list\":\n                //need to update this to be part of the authentication\n                //to find out club id\n                ItemService.GetByClubId(vm.club_id)\n                    .then(function(data){\n                        vm.club.items = data.items;   \n                        //console.log(vm.club.items);\n                    });\n            break;\n            default:\n                //console.log(\"none of the above... redirect somewhere?\");\n            break;\n        }  \n\n        //'9' needs to refer the the user's account set to manage\n       \n        $scope.back = function(){\n            $window.history.back();\n        }\n\n        $scope.save = function(){\n            if(vm.action == \"add\"){\n                //console.log(\"CREATE click\");\n                $scope.create();\n            } else {\n                //console.log(\"EDIT click\");\n                //console.log(vm.club.plane);\n                $scope.update();\n            }\n        }\n\n\n        $scope.create = function(){\n            //console.log(\"CREATE ME NOW\");\n            vm.club.item.club_id = vm.club_id;\n            ItemService.Create(vm.club.item)\n                .then(function(data){\n                    //console.log(data);\n                    $state.go('dashboard.manage_club.items');\n\n                });\n        }\n\n        // $scope.delete = function(){\n        //     //console.log(\"CLICK\");\n        //     alert(\"Are you sure you would like to delete this plane?\");\n        //     ItemService.Delete(vm.user.id, vm.club.item)\n        //         .then(function(data){\n        //             //console.log(data);\n        //         });\n        // }\n\n        $scope.delete = function(item){\n            var a = confirm(\"Are you sure you would like to delete this item?\");\n            if(a){\n                ItemService.Delete(vm.user.id, item.id)\n                .then(function(data){\n                    \n                    if(data.success){\n\n                         ItemService.GetByClubId(vm.club_id)\n                        .then(function(data){\n                            vm.club.items = data.items;   \n                            // //console.log(vm.club.items);\n                        });\n\n                    } else {\n                        alert(\"An error occured when trying to delete this item.\");\n                    }\n\n                });\n            }\n            \n        }\n\n        function get_update_docs(){\n            var documents = [];\n\n            for(var i=0;i<update_this_file.length;i++){\n                var id = update_this_file[i];\n                //console.log(\"looking for : \", id);\n                //console.log(\"in: \", vm.plane_documents);\n\n                for(var k=0;k<vm.club.plane.plane_documents.length;k++){\n                    //console.log(\"comparing to : \", vm.club.plane.plane_documents[k].id);\n                    if(vm.club.plane.plane_documents[k].id == id){\n                        documents.push(vm.club.plane.plane_documents[k]);\n                    }\n                }\n\n            }\n\n            // //console.log(\"DOCS TO UPDATE : \", documents);\n\n            return documents;\n        }\n\n        $scope.update = function(){\n            //console.log(\"CLICK\");\n            vm.club.item.club_id = vm.club_id;\n            ItemService.Update(vm.club.item, vm.user.id)\n                .then(function(data){\n                    //console.log(data);\n                    //console.log(\"saved\");\n                    $state.go('dashboard.manage_club.items');\n                });\n        }\n\n\n        function containsObject(obj, list, params) {\n\n            // //console.log(\"obj\", obj);\n            // //console.log(\"list\", list);\n            // //console.log(\"params\", params);\n\n            for(var i=0; i<list.length; i++) {\n                // //console.log(\"list i : \", list[i]);\n                // //console.log(\"obj is: \", obj);\n\n                var count_success = 0;\n                for(var j=0;j<params.length;j++){\n                    if(list[i][params[j]] && obj[params[j]] && list[i][params[j]] == obj[params[j]]){\n                        count_success++;\n                    }\n                }\n\n                if(count_success === params.length) {                    \n                    return true;\n                }\n            }\n\n            return false;\n        }\n\n\n\n      \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n        initController();\n\n        function initController() {\n           //console.log(\"check if access is okay\");\n        }\n\n\n            var warning_msg = \"By deleting this plane, you will also cancel all reservations that this plane currently has.\"\n\n          $scope.open = function (plane_id) {\n            var modalInstance = $uibModal.open({\n              animation: true,\n              templateUrl: 'views/modals/deleteModal.html',\n              controller: 'ModalInstanceCtrl',\n              size: \"lg\",\n              resolve: {\n                id: function () {\n                  return plane_id;\n                },\n                params: function() {\n                  return {id: plane_id};\n                },\n                warning: function(){\n                    return warning_msg;\n                }\n              }\n            });\n            modalInstance.result.then(function (plane_id) {\n              $log.info('PRESSED GO: '+plane_id.id);\n              ItemService.Delete(vm.user.id, plane_id.id)\n              .then(function(){\n                //console.log(\"HELLO DELETE\");\n                //update view?\n                 vm.club.items = $.grep(vm.club.items, function(e){ \n                    return e.id != plane_id.id; \n                });\n              })\n            }, function () {\n              $log.info('Modal dismissed at: ' + new Date());\n            });\n          };\n\n         \n\n\n    }\n app.controller('DashboardClubLessonController', DashboardClubLessonController);\n\n    DashboardClubLessonController.$inject = ['UserService', '$rootScope', '$location', '$scope', '$state', '$stateParams', '$uibModal', '$log', '$window', 'CourseService'];\n    function DashboardClubLessonController(UserService, $rootScope, $location, $scope, $state, $stateParams, $uibModal, $log, $window, CourseService) {\n        var vm = this;\n\n           //    /* PLEASE DO NOT COPY AND PASTE THIS CODE. */(function(){var w=window,C='___grecaptcha_cfg',cfg=w[C]=w[C]||{},N='grecaptcha';var gr=w[N]=w[N]||{};gr.ready=gr.ready||function(f){(cfg['fns']=cfg['fns']||[]).push(f);};(cfg['render']=cfg['render']||[]).push('explicit');(cfg['onload']=cfg['onload']||[]).push('initRecaptcha');w['__google_recaptcha_client']=true;var d=document,po=d.createElement('script');po.type='text/javascript';po.async=true;po.src='https://www.gstatic.com/recaptcha/releases/JPZ52lNx97aD96bjM7KaA0bo/recaptcha__en.js';var e=d.querySelector('script[nonce]'),n=e&&(e['nonce']||e.getAttribute('nonce'));if(n){po.setAttribute('nonce',n);}var s=d.getElementsByTagName('script')[0];s.parentNode.insertBefore(po, s);})();\n\n           // var initRecaptcha = function () { \n           //     // document.getElementById(\"SearchModule\").scope().vm.parent.isGrecaptchaLoaded = !0, \n           //     // document.getElementById(\"SearchModule\").scope().vm.showRecaptcha();\n           //     vm.showRecaptcha();\n           // };\n              \n\n\n\n\n        vm.user = null;\n        vm.allUsers = [];\n        vm.club = {\n            lesson: {\n                \n            }\n        };\n\n        vm.page_title = \"\";\n        \n        vm.lesson_document = {};\n        vm.lesson_documents = [];\n\n        var update_this_file = [];\n        \n       \n\n        vm.action = $state.current.data.action;\n        vm.user = $rootScope.globals.currentUser;\n        // //console.log(\"$rootScope.globals.currentUser : \", $rootScope.globals.currentUser);\n        vm.club_id = $rootScope.globals.currentUser.current_club_admin.id;\n        vm.user_id = vm.user.id;\n\n\n        vm.lesson_certificate = {};\n        vm.lesson_noise = {};\n        vm.lesson_radio = {};\n        vm.lesson_maintenance = {};\n        vm.lesson_insurance = {};\n\n        vm.club.lessons = [];\n        vm.club.lesson = {};\n\n\n        vm.new_tem = {\n            threat: \"\",\n            consequence: \"\",\n            mitigation: \"\"\n        }\n\n        vm.new = {\n            preflight: {\n                title: \"\",\n                bullet_format: \"0\"\n            },\n            airex: {\n                title: \"\",\n                bullet_format: \"0\"\n            },\n            debrief: {\n                title: \"\",\n                bullet_format: \"0\"\n            }\n        }\n\n\n        // //console.log(vm.action);\n        // //console.log($stateParams);\n        // //console.log($stateParams.id);\n\n\n        vm.editing = false;\n        \n        switch(vm.action){\n            case \"add\":\n                //console.log(\"adding a new lesson please\");\n                vm.page_title = \"Add a New Course\";\n            break;\n            case \"edit\":\n                vm.editing = true;\n                //console.log(\"edit an existing lesson\");\n\n\n                CourseService.GetLessonById($stateParams.lesson_id)\n                    .then(function(data){\n                        vm.club.lesson = data.item;   \n            \n                    });\n\n                \n                refresh_tem();\n\n                refresh_bullets();\n\n                refresh_items();\n\n               \n                    // CourseService.GetLessonsByCourseId($stateParams.lesson_id)\n                    // .then(function(data){\n                    //     vm.club.lessons = data.items;   \n           \n                    // });\n\n\n\n            break;\n            case \"list\":\n                //need to update this to be part of the authentication\n                //to find out club id\n                // CourseService.GetLessonsByCourseId(vm.club_id)\n                //     .then(function(data){\n                //         vm.club.lessons = data.items;   \n                //         //console.log(vm.club.lessons);\n                //     });\n            break;\n            default:\n                //console.log(\"none of the above... redirect somewhere?\");\n            break;\n        }  \n\n        //'9' needs to refer the the user's account set to manage\n       \n\n        function refresh_bullets(){\n             CourseService.GetBulletsByLessonId($stateParams.lesson_id)\n                    .then(function(data){\n\n                        vm.bullets = data.bullets;\n            \n                    });\n        }\n\n        function refresh_tem(){\n            CourseService.GetTemByLessonId($stateParams.lesson_id)\n                .then(function(data){\n                    //console.log(data);\n\n                    vm.tem = data.items;\n\n                    //$state.go('dashboard.manage_club.edit_lesson', {course_id: vm.club.lesson.course_id, lesson_id: data.id, reload: true});\n\n                });\n        }\n\n        vm.add_tem = function(){\n\n            vm.new_tem.lesson_id = $stateParams.lesson_id; \n            vm.new_tem.organise = (vm.tem && vm.tem.length > 0) ? vm.tem.length : 0;\n\n            CourseService.CreateTem(vm.new_tem)\n                .then(function(data){\n                    //console.log(data);\n                    if(data.success){\n\n                        vm.tem.push(data.item);\n\n                        vm.new_tem = {\n                            threat: \"\",\n                            consequence: \"\",\n                            mitigation: \"\"\n                        }\n                    } else {\n                        alert(\"An error occurred...\");\n                    }\n\n                    //$state.go('dashboard.manage_club.edit_lesson', {course_id: vm.club.lesson.course_id, lesson_id: data.id, reload: true});\n\n                });\n        }\n\n        vm.update_tem = function(tem, index){\n\n            delete(tem.edit_me);\n\n            CourseService.UpdateTem(tem)\n                .then(function(data){\n                    //console.log(data);\n                    if(data.success){\n\n                        vm.tem[index].edit_me = false;\n\n                    } else {\n                        alert(\"An error occurred...\");\n                    }\n                    //refresh_tem();\n                    //$state.go('dashboard.manage_club.edit_lesson', {course_id: vm.club.lesson.course_id, lesson_id: data.id, reload: true});\n                });\n        }\n\n        vm.update_cancel = function(index){\n            refresh_tem();\n        }\n\n        vm.edit_tem = function(index){\n\n            vm.tem[index].edit_me = true;\n\n        }\n\n        vm.delete_tem = function(tem, index){\n\n            CourseService.DeleteTem(tem.id)\n                .then(function(data){\n                    //console.log(data);\n                    if(data.success){\n                        vm.tem.splice(index, 1);\n                    } else {\n                        alert(\"An error occurred...\");\n                    }\n                    //$state.go('dashboard.manage_club.edit_lesson', {course_id: vm.club.lesson.course_id, lesson_id: data.id, reload: true});\n                });\n        }\n\n\n\n\n\n\n\n        vm.add_bullet = function(type){\n\n            var no = (vm.bullets[type] && vm.bullets[type].length > 0) ? vm.bullets[type].length : 0;\n\n            var send_me = {\n                title: vm.new[type].title,\n                bullet_format: vm.new[type].bullet_format,\n                lesson_id: $stateParams.lesson_id,\n                bullet_type: type,\n                organise: no\n            }\n\n            //vm.new_tem.lesson_id = $stateParams.lesson_id; \n\n            CourseService.CreateBullet(send_me)\n                .then(function(data){\n                    //console.log(data);\n                    if(data.success){\n                        if(vm.bullets[type]){\n                            vm.bullets[type].push(data.item);\n                        } else {\n                            vm.bullets[type] = Array(data.item);\n                        }\n\n                        vm.new[type].title = \"\";\n                        vm.new[type].bullet_format = \"0\";\n                        \n                    } else {\n                        alert(\"An error occurred...\");\n                    }\n\n                    //$state.go('dashboard.manage_club.edit_lesson', {course_id: vm.club.lesson.course_id, lesson_id: data.id, reload: true});\n\n                });\n        }\n\n        vm.update_bullet = function(type, bullet, index){\n\n            delete(bullet.edit_me);\n\n            CourseService.UpdateBullet(bullet)\n                .then(function(data){\n                    //console.log(data);\n                    if(data.success){\n\n                        vm.bullets[type][index].edit_me = false;\n\n                    } else {\n                        alert(\"An error occurred...\");\n                    }\n                    //refresh_tem();\n                    //$state.go('dashboard.manage_club.edit_lesson', {course_id: vm.club.lesson.course_id, lesson_id: data.id, reload: true});\n                });\n        }\n\n        vm.update_cancel_bullet = function(index){\n            refresh_bullets();\n        }\n\n        vm.edit_bullet = function(type, index){\n\n            vm.bullets[type][index].edit_me = true;\n\n        }\n\n        vm.delete_bullet = function(type, bullet, index){\n\n            CourseService.DeleteBullet(bullet.id)\n                .then(function(data){\n                    //console.log(data);\n                    if(data.success){\n                        vm.bullets[type].splice(index, 1);\n                    } else {\n                        alert(\"An error occurred...\");\n                    }\n                    //$state.go('dashboard.manage_club.edit_lesson', {course_id: vm.club.lesson.course_id, lesson_id: data.id, reload: true});\n                });\n        }\n\n\n\n\n\n  \n\n        $scope.save_bullet_order = function(type){\n            ////console.log(\"hiya\");\n            var update_order = [];\n            for(var i=0; i < vm.bullets[type].length;i++){\n                var me = {\n                    id: vm.bullets[type][i].id,\n                    organise: i\n                }\n                update_order.push(me);\n            }\n            // //console.log(\"organised: \", update_order);\n\n            CourseService.UpdateBulletOrder({\"order\": update_order})\n                .then(function(data){\n                   // //console.log(data);\n\n                    // vm.items = data.items;\n                    //$state.go('dashboard.manage_club.edit_lesson', {course_id: vm.club.lesson.course_id, lesson_id: data.id, reload: true});\n\n                });\n\n        }\n\n\n        $scope.save_items_order = function(){\n            // //console.log(\"hiya\");\n            var update_order = [];\n            for(var i=0; i < vm.items.length;i++){\n                var me = {\n                    id: vm.items[i].id,\n                    organise: i\n                }\n                update_order.push(me);\n            }\n            // //console.log(\"organised: \", update_order);\n\n            CourseService.UpdateItemsOrder({\"order\": update_order})\n                .then(function(data){\n                    //console.log(data);\n\n                    // vm.items = data.items;\n                    //$state.go('dashboard.manage_club.edit_lesson', {course_id: vm.club.lesson.course_id, lesson_id: data.id, reload: true});\n\n                });\n\n        }\n\n        $scope.save_tem_order = function(){\n            // //console.log(\"hiya\");\n            var update_order = [];\n            for(var i=0; i < vm.tem.length;i++){\n                var me = {\n                    id: vm.tem[i].id,\n                    organise: i\n                }\n                update_order.push(me);\n            }\n            // //console.log(\"organised: \", update_order);\n\n            CourseService.UpdateTemOrder({\"order\": update_order})\n                .then(function(data){\n                    //console.log(data);\n\n                    // vm.items = data.items;\n                    //$state.go('dashboard.manage_club.edit_lesson', {course_id: vm.club.lesson.course_id, lesson_id: data.id, reload: true});\n\n                });\n\n        }\n\n\n\n\n        function refresh_items(){\n            CourseService.GetItemsByLessonId($stateParams.lesson_id)\n                .then(function(data){\n                    //console.log(data);\n\n                    vm.items = data.items;\n\n                    //$state.go('dashboard.manage_club.edit_lesson', {course_id: vm.club.lesson.course_id, lesson_id: data.id, reload: true});\n\n                });\n        }\n\n        vm.add_item = function(){\n\n            vm.new_item.lesson_id = $stateParams.lesson_id; \n\n            vm.new_item.organise = (vm.items && vm.items.length > 0) ? vm.items.length : 0;\n\n            CourseService.CreateItem(vm.new_item)\n                .then(function(data){\n                    //console.log(data);\n                    if(data.success){\n\n                        vm.items.push(data.item);\n\n                        vm.new_item = {\n                            title: \"\"\n                        }\n                    } else {\n                        alert(\"An error occurred...\");\n                    }\n\n                    //$state.go('dashboard.manage_club.edit_lesson', {course_id: vm.club.lesson.course_id, lesson_id: data.id, reload: true});\n\n                });\n        }\n\n        vm.update_item = function(item, index){\n\n            delete(item.edit_me);\n\n            CourseService.UpdateItem(item)\n                .then(function(data){\n                    //console.log(data);\n                    if(data.success){\n\n                        vm.items[index].edit_me = false;\n\n                    } else {\n                        alert(\"An error occurred...\");\n                    }\n                    //refresh_tem();\n                    //$state.go('dashboard.manage_club.edit_lesson', {course_id: vm.club.lesson.course_id, lesson_id: data.id, reload: true});\n                });\n        }\n\n        vm.update_cancel_item = function(index){\n            refresh_items();\n        }\n\n        vm.edit_item = function(index){\n\n            vm.items[index].edit_me = true;\n\n        }\n\n        vm.delete_item = function(item, index){\n\n            CourseService.DeleteItem(item.id)\n                .then(function(data){\n                    //console.log(data);\n                    if(data.success){\n                        vm.items.splice(index, 1);\n                    } else {\n                        alert(\"An error occurred...\");\n                    }\n                    //$state.go('dashboard.manage_club.edit_lesson', {course_id: vm.club.lesson.course_id, lesson_id: data.id, reload: true});\n                });\n        }\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n        $scope.back = function(){\n            $window.history.back();\n        }\n\n\n\n        $scope.save = function(){\n          \n                //console.log(\"EDIT click\");\n                //console.log(vm.club.lesson);\n                $scope.update();\n            \n        }\n\n\n        $scope.create = function(){\n            ////console.log(\"CREATE ME NOW\");\n         \n            //return false;\n            //return false;\n            vm.club.lesson.course_id = $stateParams.course_id;\n\n            CourseService.CreateLesson(vm.club.lesson)\n                .then(function(data){\n                    ////console.log(data);\n                    $state.go('dashboard.manage_club.edit_lesson', {course_id: vm.club.lesson.course_id, lesson_id: data.id, reload: true});\n\n                });\n\n\n        }\n\n        $scope.delete = function(){\n            //console.log(\"CLICK\");\n            alert(\"Are you sure you would like to delete this lesson?\");\n            CourseService.DeleteLesson(vm.club.lesson.id)\n                .then(function(data){\n                    //console.log(data);\n                });\n        }\n\n        function get_update_docs(){\n            var documents = [];\n\n            for(var i=0;i<update_this_file.length;i++){\n                var id = update_this_file[i];\n                //console.log(\"looking for : \", id);\n                //console.log(\"in: \", vm.lesson_documents);\n\n                for(var k=0;k<vm.club.lesson.lesson_documents.length;k++){\n                    //console.log(\"comparing to : \", vm.club.lesson.lesson_documents[k].id);\n                    if(vm.club.lesson.lesson_documents[k].id == id){\n                        documents.push(vm.club.lesson.lesson_documents[k]);\n                    }\n                }\n\n            }\n\n            // //console.log(\"DOCS TO UPDATE : \", documents);\n\n            return documents;\n        }\n\n        $scope.update = function(){\n            //console.log(\"CLICK\");\n         \n\n            CourseService.UpdateLesson(vm.club.lesson)\n                .then(function(data){\n                    //console.log(data);\n                    //console.log(\"saved\");\n                    $state.go('dashboard.manage_club.edit_course', {course_id: vm.club.lesson.course_id, reload: true});\n                });\n        }\n\n\n        function containsObject(obj, list, params) {\n\n            // //console.log(\"obj\", obj);\n            // //console.log(\"list\", list);\n            // //console.log(\"params\", params);\n\n            for(var i=0; i<list.length; i++) {\n                // //console.log(\"list i : \", list[i]);\n                // //console.log(\"obj is: \", obj);\n\n                var count_success = 0;\n                for(var j=0;j<params.length;j++){\n                    if(list[i][params[j]] && obj[params[j]] && list[i][params[j]] == obj[params[j]]){\n                        count_success++;\n                    }\n                }\n\n                if(count_success === params.length) {                    \n                    return true;\n                }\n            }\n\n            return false;\n        }\n\n\n       \n\n        $scope.add_item = function(type){\n            //console.log(\"ADD\");\n            switch(type){\n                case \"licence\":\n                    //console.log(\"licence\");\n                    if(vm.temporary.licence && vm.temporary.licence !== \"\" && vm.temporary.rating && vm.temporary.rating !== \"\"){\n                        //then we can add it\n                        //console.log(\"here we go\");\n                        var add_licence = {\n                            licence_id: vm.temporary.licence.id,\n                            licence_title: vm.temporary.licence.abbreviation,\n                            rating_title: vm.temporary.rating.abbreviation,\n                            rating_id: vm.temporary.rating.id\n                        };\n\n                        //check if it doesnt exist first...\n                        if(containsObject(add_licence, vm.club.lesson.requirements.licence, new Array(\"licence_id\", \"rating_id\")) == false){\n                            vm.club.lesson.requirements.licence.push(add_licence);\n                        }\n\n                        delete vm.temporary.licence;\n                        delete vm.temporary.rating;\n\n                    } else {\n                        alert(\"Please select a licence and rating that is required to book the lesson solo!\");\n                    }\n\n                break;\n\n\n                case \"medical\":\n                    //console.log(\"medical\");\n                    if(vm.temporary.medical_authority && vm.temporary.medical_authority !== \"\" && vm.temporary.medical_component && vm.temporary.medical_component !== \"\"){\n                        //then we can add it\n                        //console.log(\"here we go\");\n                        var add_medical = {\n                            authority_id: vm.temporary.medical_authority.id,\n                            authority_title: vm.temporary.medical_authority.abbreviation,\n                            medical_component_id: vm.temporary.medical_component.id,\n                            medical_component_title: vm.temporary.medical_component.title\n                        };\n\n                        //check if it doesnt exist first...\n                        if(containsObject(add_medical, vm.club.lesson.requirements.medical, new Array(\"authority_id\", \"medical_component_id\")) == false){\n                            vm.club.lesson.requirements.medical.push(add_medical);\n                        }\n\n                        delete vm.temporary.medical_authority;\n                        delete vm.temporary.medical_component;\n\n                    } else {\n                        alert(\"Please select a medical that is required to book the lesson solo!\");\n                    }\n\n                break;\n\n\n                case \"differences\":\n                    //console.log(\"difference\");\n                    if(vm.temporary.difference && vm.temporary.difference !== \"\"){\n                        //then we can add it\n                        //console.log(\"here we go\");\n                        var add_difference = {\n                            difference_id: vm.temporary.difference.id,\n                            difference_title: vm.temporary.difference.title\n                        };\n\n                        //check if it doesnt exist first...\n                        if(containsObject(add_difference, vm.club.lesson.requirements.differences, new Array(\"difference_id\", \"difference_title\")) == false){\n                            vm.club.lesson.requirements.differences.push(add_difference);\n                        }\n\n                        delete vm.temporary.difference;\n\n                    } else {\n                        alert(\"Please select a difference that is required to book the lesson solo!\");\n                    }\n\n                break;\n\n\n            }\n\n\n\n        }\n\n\n\n\n\n\n\n\n\n\n\n\n\n        $scope.update_this_file = function(file){\n            //console.log(\"==== update is : \", file.id);\n            if(update_this_file.indexOf(file.id) === -1){\n                update_this_file.push(file.id)\n            } else {\n               ////console.log(\"This item already exists\"); \n            } \n        }\n\n\n         $scope.remove_real_file = function(file){\n\n                //remove_file\n\n                vm.club.lesson.lesson_documents = $.grep(vm.club.lesson.lesson_documents, function(e){ \n                        return e.id != file.id; \n                    });\n\n                //no need to actually remove the file as it will be archived accordingly on the backend whilst it is missing! :)\n                PlaneDocumentService.Delete(vm.user_id, file.id)\n                .then(function (data) {\n                    //console.log(data);\n                    if(data.success){\n                        //console.log(\"HUZZAH\", current_files);\n                        //then we need to remove this from the list of files...\n                        //clear files\n                        vm.lesson_documents = [];\n                        //and re-process available files\n                        $scope.processFiles(current_files);\n\n                    } else {\n                        //console.log(\"WOOOPSIES...\");\n                        //this should be very very rare...\n                    }\n\n                });\n\n          }\n\n\n        vm.files = {\n            radio: [],\n            cert: [],\n            insurance: [],\n            noise: []\n        }\n\n\n           $scope.processFile = function(files, location){\n                 //console.log(\"files\", files[0].file_return);\n\n                     // //console.log(\"JSON\", files[i].file_return);\n                    var j = JSON.parse(files[0].file_return);\n                     ////console.log(\"PARSED\", j);\n                    // //console.log(\"J is : \",j);\n                    // //console.log(\"name is : \", j.files.file.name);\n\n                    files[0].file.temp_path = j.saved_url;\n                    files[0].file.save_name = j.files.file.name;\n\n                    var ft = j.files.file.name;\n                    //console.log(\"ft\", ft);\n                    var fft = ft.split('.').pop();\n                    files[0].file.extension = fft;\n                    //console.log(\"FILE is : \", files[0]);\n\n                    // //console.log(\"file\", files[i].file);\n                    vm.files[location].push(files[0].file);\n\n\n            }\n\n            $scope.set_title = function(file){\n                //console.log(\"return\", file);\n                return file.save_name;\n            }\n\n\n          \n          $scope.remove_file = function(file, current_files){\n\n            //remove_file\n            var j = JSON.parse(file.file_return);\n            //console.log(\"REMOVE: \", j);\n            //console.log(\"REMOVE: \", j.saved_url);\n\n            //to delete the temp file created: j.saved_url\n            //tmp_rm.php POST tmp = filename\n            \n            PoidService.DeleteTmp(j.saved_url)\n                .then(function (data) {\n                    //console.log(data);\n                    if(data.success){\n                        //console.log(\"HUZZAH\", current_files);\n                        //then we need to remove this from the list of files...\n                        //clear files\n                        vm.lesson_documents = [];\n                        //and re-process available files\n                        $scope.processFiles(current_files);\n\n                    } else {\n                        //console.log(\"WOOOPSIES...\");\n                        //this should be very very rare...\n                    }\n\n                });\n\n          }\n          \n\n          // $scope.$on('flow::fileAdded', function (event, $flow, flowFile) {\n          //     event.preventDefault();//prevent file from uploading\n          //     //console.log(\"FILE ADDED\");\n          //     //console.log($flow);\n          //   });\n\n            $scope.processFiles = function(files){\n                // //console.log(\"files\", files);\n\n                for(var i=0; i<files.length; i++){\n                    // //console.log(\"JSON\", files[i].file_return);\n                    var j = JSON.parse(files[i].file_return);\n                    // //console.log(\"PARSED\", j);\n                    //console.log(\"J is : \",j);\n                    //console.log(\"name is : \", j.files.file.name);\n\n                    files[i].file.temp_path = j.saved_url;\n                    files[i].file.save_name = j.files.file.name;\n                    var ft = j.files.file.name;\n                    ft = ft.split('.').pop();\n                    files[i].file.extension = ft;\n\n                    // //console.log(\"file\", files[i].file);\n                    vm.lesson_documents.push(files[i].file);\n                }\n\n\n            }\n\n            $scope.set_title = function(file){\n                //console.log(\"return\", file);\n                return file.save_name;\n            }\n\n            $scope.get_icon = function(file){\n\n                var ft = file.name;\n                ft = ft.split('.').pop();\n                var icon_name = \"\";\n\n                // //console.log(\"FILE:\", ft);\n                // //console.log(\"index : \", ft.indexOf(\"pdf\"));\n                switch(true){\n                    case (ft.indexOf(\"pdf\") > -1):\n                        icon_name = \"pdf.png\";\n                    break;\n                    case (ft.indexOf(\"doc\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"docx\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"xls\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"xlsx\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"ppt\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"pptx\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"jpg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"jpeg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"png\") > -1):\n                        icon_name = \"png.png\";\n                    break;\n                    case (ft.indexOf(\"gif\") > -1):\n                        icon_name = \"gif.png\";\n                    break;\n                    case (ft.indexOf(\"zip\") > -1):\n                        icon_name = \"zip.png\";\n                    break;\n                    case (ft.indexOf(\"avi\") > -1):\n                        icon_name = \"avi.png\";\n                    break;\n                    case (ft.indexOf(\"mp4\") > -1):\n                        icon_name = \"mp4.png\";\n                    break;\n                    default:\n                        icon_name = \"file.png\";\n                    break;\n                }\n\n                // //console.log(\"FILE:\", icon_name);\n\n                return \"images/file_icons/\"+icon_name;\n            }\n\n\n            $scope.get_icon2 = function(file){\n\n                var ft = file.split('.').pop();\n                // //console.log(\"ICON 2 : \", ft);\n                var icon_name = \"\";\n\n                // //console.log(\"FILE:\", ft);\n                // //console.log(\"index : \", ft.indexOf(\"pdf\"));\n                switch(true){\n                    case (ft.indexOf(\"pdf\") > -1):\n                        icon_name = \"pdf.png\";\n                    break;\n                    case (ft.indexOf(\"doc\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"docx\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"xls\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"xlsx\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"ppt\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"pptx\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"jpg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"jpeg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"png\") > -1):\n                        icon_name = \"png.png\";\n                    break;\n                    case (ft.indexOf(\"gif\") > -1):\n                        icon_name = \"gif.png\";\n                    break;\n                    case (ft.indexOf(\"zip\") > -1):\n                        icon_name = \"zip.png\";\n                    break;\n                    case (ft.indexOf(\"avi\") > -1):\n                        icon_name = \"avi.png\";\n                    break;\n                    case (ft.indexOf(\"mp4\") > -1):\n                        icon_name = \"mp4.png\";\n                    break;\n                    default:\n                        icon_name = \"file.png\";\n                    break;\n                }\n\n                // //console.log(\"FILE:\", icon_name);\n\n                return \"images/file_icons/\"+icon_name;\n            }\n\n\n\n\n\n        initController();\n\n        function initController() {\n           //console.log(\"check if access is okay\");\n        }\n\n\n       \n\n\n    }\n app.controller('DashboardClubMaintenanceController', DashboardClubMaintenanceController);\n\n    DashboardClubMaintenanceController.$inject = ['UserService', 'PlaneService', '$rootScope', '$location', '$scope', '$state', '$stateParams', '$uibModal', '$log', '$window', 'LicenceService', 'MedicalService', 'DifferencesService', 'PlaneDocumentService', 'FoxService', '$http'];\n    function DashboardClubMaintenanceController(UserService, PlaneService, $rootScope, $location, $scope, $state, $stateParams, $uibModal, $log, $window, LicenceService, MedicalService, DifferencesService, PlaneDocumentService, FoxService, $http) {\n        var vm = this;\n\n        vm.user = null;\n        vm.allUsers = [];\n        vm.club = {\n            plane: {\n                requirements: {\n                    licence: [],\n                    medical: [],\n                    differences: []\n                },\n                documents: []\n            }\n        };\n\n        vm.page_title = \"\";\n        \n        vm.plane_document = {};\n        vm.plane_documents = [];\n\n        var update_this_file = [];\n        \n        \n        vm.currency_types = [\"class\", \"type\"];\n        vm.gear_types = [\"tricycle\", \"tailwheel\", \"monowheel\", \"floats\", \"skis\"];\n\n        vm.charge_type = [\"brakes\", \"tacho\", \"hobbs\"];\n        vm.surcharge_type = [\"none\", \"flight\", \"hour\"];\n\n        vm.action = $state.current.data.action;\n        vm.user = $rootScope.globals.currentUser;\n        // //console.log(\"$rootScope.globals.currentUser : \", $rootScope.globals.currentUser);\n        vm.club_id = $rootScope.globals.currentUser.current_club_admin.id;\n        vm.user_id = vm.user.id;\n\n        vm.show_overlay = false;\n        vm.show_cert = false;\n        vm.show_maintenance = false;\n        vm.show_radio = false;\n        vm.show_noise = false;\n        vm.show_insurance = false;\n        vm.show_offline = false;\n\n        vm.obj = {\n            issues: [],\n            issue_confirmation: false\n        };\n\n       vm.reported_defects = [];\n\n       vm.maintenance_types = [\n        \"annual\", \"25hours\", \"50hours\", \"100hours\", \"interim\", \"6months\", \"extension\"\n       ];\n\n      \n        \n        switch(vm.action){\n            case \"add\":\n                // //console.log(\"adding a new plane please\");\n                vm.page_title = \"Add a New Plane\";\n            break;\n            case \"edit\":\n                // //console.log(\"edit an existing plane\");\n                \n                PlaneService.GetByIdMaintenance2($stateParams.plane_id, vm.club_id)\n                    .then(function(data){\n                        vm.club.plane = data;  \n                        vm.this_plane_id = $stateParams.plane_id; \n\n                        if(vm.club.plane && vm.club.plane.maintenance){\n                            //console.log(\"vm.club.plane == > \", vm.club.plane);\n                            vm.obj.hours_remaining = vm.club.plane.maintenance.hours_remaining;\n                            vm.obj.next_check = new Date(vm.club.plane.maintenance.next_maintenance);\n                            vm.obj.check_date = new Date();\n                            vm.obj.extension_granted = new Date();\n                        }\n                       \n\n                        // vm.club.plane.requirements = {\n                        //         licence: [],\n                        //         medical: [],\n                        //         differences: [],\n                        //         hours: []\n                        // };\n                        // //console.log(\"BOOOO - get all planes....\");\n                        vm.page_title = \"Edit a Plane Maintenance - \"+vm.club.plane.registration;\n                    });\n\n                PlaneService.GetOpenIssues($stateParams.plane_id)\n                    .then(function (data) {\n                            ////console.log(\"data is : \", data);\n                           vm.reported_defects = data;\n                        });\n\n\n               \n\n\n            break;\n            case \"list\":\n                //need to update this to be part of the authentication\n                //to find out club id\n                PlaneService.GetAllByClubMaintenance(vm.club_id)\n                    .then(function(data){\n                        vm.club.planes = data;   \n                        // //console.log(vm.club.planes);\n                    });\n            break;\n            default:\n                //console.log(\"none of the above... redirect somewhere?\");\n            break;\n        }  \n\n        vm.reset_aeroplane = function(){\n            if(vm.this_plane_id && vm.this_plane_id > 0){\n                var a = confirm(\"Are you sure you wish to override the logs?\");\n                if(a){\n                    FoxService.ResetOneClubPlane(vm.this_plane_id)\n                    .then(function(data){\n                        console.log(data);\n                        if(data.success){\n                            alert(\"Should be sorted!\");\n                        }  \n                        // //console.log(vm.club.planes);\n                    });\n                } else {\n                    //ignore for now\n                }\n            } else {\n                alert(\"NO IDEA\");\n            }\n        }\n\n        //'9' needs to refer the the user's account set to manage\n        vm.selected_type = \"\";\n        vm.send_obj = {};\n        $scope.show_overlay = function(type){\n        \n            vm.show_overlay = true;\n            \n            vm.selected_type = type;\n\n            if(type == \"maintenance\"){\n                vm.show_cert = true;\n                vm.show_insurance = true;\n                vm.show_radio = true;\n                vm.show_maintenance = true;\n                vm.show_noise = true;\n                vm.show_offline = false;\n            } else if(type == \"cert\"){\n                vm.show_cert = true;\n                vm.show_insurance = false;\n                vm.show_radio = false;\n                vm.show_maintenance = false;\n                vm.show_noise = false;\n                vm.show_offline = false;\n            } else if(type == \"insurance\"){\n                vm.show_cert = false;\n                vm.show_insurance = true;\n                vm.show_radio = false;\n                vm.show_maintenance = false;\n                vm.show_noise = false;\n                vm.show_offline = false;\n            } else if(type == \"radio\"){\n                vm.show_cert = false;\n                vm.show_insurance = false;\n                vm.show_radio = true;\n                vm.show_maintenance = false;\n                vm.show_noise = false;\n                vm.show_offline = false;\n            } else if(type == \"noise\"){\n                vm.show_cert = false;\n                vm.show_insurance = false;\n                vm.show_radio = false;\n                vm.show_maintenance = false;\n                vm.show_noise = true;\n                vm.show_offline = false;\n            } else if(type == \"offline\"){\n                vm.show_cert = false;\n                vm.show_insurance = false;\n                vm.show_offline = true;\n                vm.show_radio = false;\n                vm.show_noise = false;\n                vm.show_maintenance = false;\n            } \n\n            \n\n       }\n\n       $scope.close_overlay = function(){\n            vm.show_overlay = false;\n\n       }\n\n\n        $scope.get_hours_from_decimal = function(time){\n\n            if(time){\n                 var sign = time < 0 ? \"-\" : \"\";\n                 var hour = Math.floor(Math.abs(time));\n                 var min = Math.round((Math.abs(time) * 60) % 60);\n                 if(min == 60){\n                     hour++;\n                     min = 0;\n                 }\n                 return sign + (hour < 10 ? \"0\" : \"\") + hour + \":\" + (min < 10 ? \"0\" : \"\") + min;\n             } else {\n                 return \"N/A\";\n             }\n            \n\n        }\n\n\n\n        $scope.filter_detail = function(show_all = 0){\n                return (show_all == 0) ? {status: \"open\"} : {};\n            }\n\n            $scope.count_defects = function(defects, show_all = 0){\n\n               var counter = 0;\n\n               for(var i=0;i<defects.length;i++){\n                   if(show_all == 1){\n                       counter++;\n                   } else {\n                       if(defects[i].status == \"open\"){\n                           counter++;\n                       }\n                   }\n               }\n\n               return counter;\n\n           }\n\n\n\n\n        $scope.save_overlay = function(){\n\n            //first we save stuff   \n\n           \n            \n\n            var save = vm.obj;\n            \n            // //console.log(\"FILES ARE \", vm.files);\n\n            save.files = {\n                radio: (vm.files.radio[0]) ? vm.files.radio[0].file : {},\n                cert: (vm.files.cert[0]) ? vm.files.cert[0].file : {},\n                noise_cert: (vm.files.noise_cert[0]) ? vm.files.noise_cert[0].file : {},\n                insurance: (vm.files.insurance[0]) ? vm.files.insurance[0].file : {}\n            }\n\n            var send_update = false;\n\n\n            save.selected_type = vm.selected_type;\n\n            var send_obj = {};\n\n            if(vm.one_ticked){\n               for(var i=0;i<vm.reported_defects.length;i++){\n                if(vm.reported_defects[i].resolved){\n                    vm.obj.issues.push(vm.reported_defects[i]);\n                }\n               } \n               send_obj.issues = vm.obj.issues;\n               if(send_obj.issues.length > 0){\n                   send_update = true;\n               }\n            }\n\n            if((vm.files.radio[0] && vm.obj.radio_expiry == null) || (!vm.files.radio[0] && vm.obj.radio_expiry)){\n                alert(\"The radio is not complete - please ensure to add both expiry date and the new certificate.\");\n                return false;\n            } else if(vm.files.radio[0] && vm.obj.radio_expiry){\n                send_obj.radio = {\n                    file: (vm.files.radio[0]) ? vm.files.radio[0].file : {},\n                    expiry: vm.obj.radio_expiry\n                };\n                send_update = true;\n            }\n\n            // //console.log(\"radio file \", vm.files.radio[0]);\n\n\n            if((vm.files.cert[0] && vm.obj.certificate_expiry == null) || (vm.files.cert[0] == null && vm.obj.certificate_expiry)){\n                alert(\"The certificate is not complete - please ensure to add both expiry date and the new certificate.\");\n                return false;\n            } else if(vm.files.cert[0] && vm.obj.certificate_expiry) {\n                send_obj.cert = {\n                    file: (vm.files.cert[0]) ? vm.files.cert[0].file : {},\n                    expiry: vm.obj.certificate_expiry,\n                    date_issued: vm.obj.certificate_issue\n                }\n                send_update = true;\n            }\n\n            // //console.log(\"insurance file \", vm.files.insurance[0]);\n\n            if((vm.files.insurance[0] && !vm.obj.insurance_expiry) || (vm.files.insurance[0] == null && vm.obj.insurance_expiry)){\n                alert(\"The insurance is not complete - please ensure to add both expiry date and the new certificate.\");\n                return false;\n            } else if(vm.files.insurance[0] && vm.obj.insurance_expiry) {\n                send_obj.insurance = {\n                    file: (vm.files.insurance[0]) ? vm.files.insurance[0].file : {},\n                    expiry: vm.obj.insurance_expiry\n                }\n                send_update = true;\n            }\n\n\n\n            if((vm.files.noise_cert[0] && !vm.obj.noise_date) || (vm.files.noise_cert[0] == null && vm.obj.noise_date)){\n                alert(\"The noise certificate is not complete - please ensure to add both date and the certificate - or keep them both empty.\");\n                return false;\n            } else if(vm.files.noise_cert[0] && vm.obj.noise_date) {\n                send_obj.noise_cert = {\n                    file: (vm.files.noise_cert[0]) ? vm.files.noise_cert[0].file : {},\n                    noise_level: vm.obj.noise_level,\n                    date_issued: vm.obj.noise_date\n                }\n                send_update = true;\n            }\n\n\n\n            // //console.log(\"type:\", vm.obj.maintenance_type);\n            // //console.log(\"remaining:\", vm.obj.hours_remaining);\n            // //console.log(\"next_check:\", vm.obj.next_check);\n           \n\n\n            // //console.log(\"firs: \", (vm.obj.maintenance_type !== undefined \n            //  || vm.obj.hours_remaining !== undefined \n            //  || vm.obj.next_check !== undefined));\n\n            // //console.log(\"secon: \",((vm.obj.maintenance_type !== \"\" || vm.obj.maintenance_type !== undefined) && (vm.obj.hours_remaining !== undefined || vm.obj.hours_remaining !== \"\") \n            //     && (vm.obj.next_check !== undefined && vm.obj.next_check !== \"\")) );\n          \n            if(((vm.obj.maintenance_type !== undefined && vm.obj.maintenance_type !==\"extension\") \n             || vm.obj.hours_remaining !== undefined \n             || vm.obj.next_check !== undefined)){\n                    if((vm.obj.maintenance_type !== \"\" || vm.obj.maintenance_type !== undefined) && (vm.obj.hours_remaining !== undefined || vm.obj.hours_remaining !== \"\") \n                && (vm.obj.next_check !== undefined && vm.obj.next_check !== \"\")){\n\n                    var check_date =  moment( moment(vm.obj.check_date).format(\"YYYY-MM-DD\")+ \" \"+moment(vm.obj.check_time).format(\"HH:mm:ss\") ).format(\"YYYY-MM-DD HH:mm:ss\");\n                // //console.log(\"NEW DATETIME\", check_date);\n                // return false;\n\n                    send_obj.maintenance = {\n                        maintenance_type: vm.obj.maintenance_type,\n                        hours_remaining: vm.obj.hours_remaining,\n                        check_date: check_date,\n                        expiry_date: vm.obj.next_check,\n                        description: vm.obj.description\n                    } \n\n                    send_update = true;\n                } else {\n                    // //console.log(\"type:\", vm.obj.maintenance_type);\n                    // //console.log(\"remaining:\", vm.obj.hours_remaining);\n                    // //console.log(\"next_check:\", vm.obj.next_check);\n                    alert(\"The maintenance is not complete - please ensure to add both check date, next check, and hours remaining\");\n                    return false; \n                }\n              }\n\n              if(vm.obj.maintenance_type == \"extension\"){\n                    if((vm.obj.extension_hours !== \"\" || vm.obj.extension_days !== \"\")){\n\n                    var extension_granted =  moment( moment(vm.obj.extension_granted).format(\"YYYY-MM-DD\")+ \" \"+moment(vm.obj.check_time).format(\"HH:mm:ss\") ).format(\"YYYY-MM-DD HH:mm:ss\");\n\n\n                    send_obj.extension = {\n                        maintenance_type: vm.obj.maintenance_type,\n                        extension_hours: vm.obj.extension_hours,\n                        extension_days: vm.obj.extension_days,\n                        extension_granted: extension_granted,\n                        description: vm.obj.description\n                    } \n                    send_update = true;\n                } else {\n                    // //console.log(\"type:\", vm.obj.maintenance_type);\n                    // //console.log(\"remaining:\", vm.obj.hours_remaining);\n                    // //console.log(\"next_check:\", vm.obj.next_check);\n                    alert(\"The maintenance is not complete - please ensure to add both check date, next check, and hours remaining\");\n                    return false; \n                }\n              }\n\n\n\n\n              if((vm.obj.offline_until !== \"\" || vm.obj.offline_notes !== \"\")){\n                    send_obj.offline = {\n                        offline_until: vm.obj.offline_until,\n                        offline_notes: vm.obj.offline_notes,\n                        club_id: vm.club_id\n                    } \n                    send_update = true;\n                } else {\n                    alert(\"Please ensure that offline date is set in the future!\");\n                    return false; \n              }\n\n            // var send_obj = {\n            //     radio: {\n            //         file: (vm.files.radio[0]) ? vm.files.radio[0].file : {},\n            //         expiry: vm.obj.radio_expiry\n            //     },\n            //     cert: {\n            //         file: (vm.files.cert[0]) ? vm.files.cert[0].file : {},\n            //         expiry: vm.obj.certificate_expiry\n            //     },\n            //     insurance: {\n            //         file: (vm.files.insurance[0]) ? vm.files.insurance[0].file : {},\n            //         expiry: vm.obj.insurance_expiry\n            //     },\n            //     maintenance: {\n            //         maintenance_type: vm.obj.maintenance_type,\n            //         hours_remaining: vm.obj.hours_remaining,\n            //         next_check: vm.obj.next_check\n            //     },\n            //     issues: vm.obj.issues\n            // };\n            // //console.log(\"TIME NOW : \", vm.obj.check_date);\n            // //console.log(\"TIME NOW : \", moment(vm.obj.check_date) );\n            // //console.log(\"TIME NOW : \", vm.obj.check_time);\n            // //console.log(\"TIME NOW : \", moment(vm.obj.check_time));\n\n            // //console.log(\"TIME NOW : \", moment( moment(vm.obj.check_date).format(\"YYYY-MM-DD\")+ \" \"+vm.obj.check_time ) );\n\n\n            // return false;\n\n            if(!send_update){\n                alert(\"You haven't filled anything - this box will now close without saving any changes.\");\n\n            } else {\n                // //console.log(\"TOSAVE: \", send_obj);\n                \n                vm.send_obj = send_obj;\n                PlaneService.AddMaintenance(vm.this_plane_id, send_obj)\n                .then(function(data){\n                    // //console.log(data);\n                    $state.go('dashboard.manage_club.maintenance', {action: \"list\", reload: true});\n\n                });\n\n\n\n\n            }\n\n\n            //EASYPEASY LEMON SQUEEEEEZY\n\n            ////console.log(\"SAVE CERT\");\n            vm.show_overlay = false;\n        }\n\n\n\n        $scope.check_ticked = function(){\n            var count = 0;\n            for(var i=0;i<vm.reported_defects.length;i++){\n                if(vm.reported_defects[i].resolved){\n                    count++;\n                }\n            }\n\n            ////console.log(\"total = \", count);\n\n            vm.one_ticked = (count > 0)? true : false;\n\n            // if(count > 0){\n            //     vm.one_ticked = true;\n            // } else {\n            //     vm.one_ticked = false;\n            // }\n        }\n\n\n\n\n        $scope.show_cert = function(){\n            //console.log(\"SHOW CERT HERE\");\n            vm.show_cert = true;\n\n        }\n\n        $scope.close_cert = function(){\n            //console.log(\"CLOSE CERT\");\n            vm.show_cert = false;\n        }\n\n        $scope.save_cert = function(){\n\n            //first we save stuff   \n\n\n\n\n\n            //console.log(\"SAVE CERT\");\n            vm.show_cert = false;\n        }\n\n\n        $scope.show_insurance = function(){\n            //console.log(\"SHOW INSURANCE HERE\");\n            vm.show_insurance = true;\n\n        }\n\n        $scope.close_insurance = function(){\n            //console.log(\"CLOSE INSURANCE\");\n            vm.show_insurance = false;\n        }\n\n        $scope.save_insurance = function(){\n\n            //first we save stuff   \n            \n\n\n            \n\n            //console.log(\"SAVE INSURANCE\");\n            vm.show_insurance = false;\n        }\n\n\n\n        $scope.show_radio = function(){\n            //console.log(\"SHOW radio HERE\");\n            vm.show_radio = true;\n\n        }\n\n        $scope.close_radio = function(){\n            //console.log(\"CLOSE radio\");\n            vm.show_radio = false;\n        }\n\n        $scope.save_radio = function(){\n\n            //first we save stuff   \n            \n\n\n            \n\n            //console.log(\"SAVE radio\");\n            vm.show_radio = false;\n        }\n\n        $scope.show_noise = function(){\n            //console.log(\"SHOW radio HERE\");\n            vm.show_noise = true;\n\n        }\n\n        $scope.close_noise = function(){\n            //console.log(\"CLOSE radio\");\n            vm.show_noise = false;\n        }\n\n        $scope.save_noise = function(){\n\n            //first we save stuff              \n            //console.log(\"SAVE radio\");\n            vm.show_noise = false;\n        }\n\n\n        $scope.show_maintenance = function(){\n            //console.log(\"SHOW maintenance HERE\");\n            vm.show_maintenance = true;\n\n        }\n\n        $scope.close_maintenance = function(){\n            //console.log(\"CLOSE maintenance\");\n            vm.show_maintenance = false;\n        }\n\n        $scope.save_maintenance = function(){\n\n            //first we save stuff   \n\n            //console.log(\"SAVE maintenance\");\n            vm.show_maintenance = false;\n        }\n\n\n        vm.add_defect = function(){\n\n\n                var obj = {\n                    club_id: vm.club_id,\n                    user_id: vm.user_id,\n                    plane_id: vm.this_plane_id,\n                    defect: vm.defect,\n                    severity: vm.defect_severity.title,\n                    status: \"open\"\n                }\n\n\n\n                PlaneService.AddDefect(obj)\n                 .then(function (data) {\n                        ////console.log(\"data is : \", data);\n                        data.item.can_delete = true;\n\n                        //HELLO\n                        vm.club.plane.defects.push(data.item);\n                        //vm.reported_defects.push(data.item);\n\n                        vm.defect = \"\";\n                        vm.defect_severity = \"\";\n\n\n\n                    });\n\n            }\n\n            vm.delete_defect = function(id){\n               // //console.log(\"UNDO DEFECT ID \", id);\n\n                PlaneService.DeleteDefect(id)\n                .then(function (data) {\n                        ////console.log(\"data is : \", data);\n                       \n                        PlaneService.GetOpenIssues(vm.bookout.plane_id)\n                        .then(function (data) {\n                                ////console.log(\"data is : \", data);\n                               vm.reported_defects = data;\n                            });\n\n\n                    });\n\n            }\n\n\n\n        $scope.back = function(){\n            $window.history.back();\n        }\n\n        $scope.save = function(){\n            if(vm.action == \"add\"){\n                // //console.log(\"CREATE click\");\n                $scope.create();\n            } else {\n                // //console.log(\"EDIT click\");\n                // //console.log(vm.club.plane);\n                $scope.update();\n            }\n        }\n\n\n        $scope.create = function(){\n            // //console.log(\"CREATE ME NOW\");\n            vm.club.plane.club_id = vm.club_id;\n            vm.club.plane.add_documents = vm.plane_documents;\n            // //console.log(\"PLANE TO ADD, \", vm.club.plane);\n            //return false;\n            PlaneService.Create(vm.club.plane)\n                .then(function(data){\n                    // //console.log(data);\n                    $state.go('dashboard.manage_club.planes', {reload: true});\n\n                });\n        }\n\n        $scope.delete = function(){\n            // //console.log(\"CLICK\");\n            alert(\"Are you sure you would like to delete this plane?\");\n            PlaneService.Update(vm.club.plane)\n                .then(function(data){\n                    // //console.log(data);\n                });\n        }\n\n        $scope.getColours = function(value){\n            if(value < 1){\n                return \"red\";\n            }\n            if(value < 5){\n                return \"warning\"\n            }\n            if(value < 10){\n                return \"amber\";\n            }\n        }\n\n        function get_update_docs(){\n            var documents = [];\n\n            for(var i=0;i<update_this_file.length;i++){\n                var id = update_this_file[i];\n                // //console.log(\"looking for : \", id);\n                // //console.log(\"in: \", vm.plane_documents);\n\n                for(var k=0;k<vm.club.plane.plane_documents.length;k++){\n                    // //console.log(\"comparing to : \", vm.club.plane.plane_documents[k].id);\n                    if(vm.club.plane.plane_documents[k].id == id){\n                        documents.push(vm.club.plane.plane_documents[k]);\n                    }\n                }\n\n            }\n\n            // //console.log(\"DOCS TO UPDATE : \", documents);\n\n            return documents;\n        }\n\n        $scope.update = function(){\n            // //console.log(\"CLICK\");\n            vm.club.plane.club_id = vm.club_id;\n            vm.club.plane.add_documents = vm.plane_documents;\n\n            vm.club.plane.update_documents = get_update_docs();\n            //get_update_docs();\n\n            PlaneService.Update(vm.club.plane)\n                .then(function(data){\n                    // //console.log(data);\n                    // //console.log(\"saved\");\n                    $state.go('dashboard.manage_club.planes');\n                });\n        }\n\n\n        function containsObject(obj, list, params) {\n\n            // //console.log(\"obj\", obj);\n            // //console.log(\"list\", list);\n            // //console.log(\"params\", params);\n\n            for(var i=0; i<list.length; i++) {\n                // //console.log(\"list i : \", list[i]);\n                // //console.log(\"obj is: \", obj);\n\n                var count_success = 0;\n                for(var j=0;j<params.length;j++){\n                    if(list[i][params[j]] && obj[params[j]] && list[i][params[j]] == obj[params[j]]){\n                        count_success++;\n                    }\n                }\n\n                if(count_success === params.length) {                    \n                    return true;\n                }\n            }\n\n            return false;\n        }\n\n\n        function check_all(){\n\n            //maybe a nice to have one day... not yet though.\n\n\n            //licences\n            vm.club.plane.requirements.licence.forEach(function(obj){\n\n            });\n\n        }\n\n      \n\n\n        $scope.add_item = function(type){\n            // //console.log(\"ADD\");\n            switch(type){\n                case \"licence\":\n                    // //console.log(\"licence\");\n                    if(vm.temporary.licence && vm.temporary.licence !== \"\" && vm.temporary.rating && vm.temporary.rating !== \"\"){\n                        //then we can add it\n                        // //console.log(\"here we go\");\n                        var add_licence = {\n                            licence_id: vm.temporary.licence.id,\n                            licence_title: vm.temporary.licence.abbreviation,\n                            rating_title: vm.temporary.rating.abbreviation,\n                            rating_id: vm.temporary.rating.id\n                        };\n\n                        //check if it doesnt exist first...\n                        if(containsObject(add_licence, vm.club.plane.requirements.licence, new Array(\"licence_id\", \"rating_id\")) == false){\n                            vm.club.plane.requirements.licence.push(add_licence);\n                        }\n\n                        delete vm.temporary.licence;\n                        delete vm.temporary.rating;\n\n                    } else {\n                        alert(\"Please select a licence and rating that is required to book the plane solo!\");\n                    }\n\n                break;\n\n\n                case \"medical\":\n                    //console.log(\"medical\");\n                    if(vm.temporary.medical_authority && vm.temporary.medical_authority !== \"\" && vm.temporary.medical_component && vm.temporary.medical_component !== \"\"){\n                        //then we can add it\n                        //console.log(\"here we go\");\n                        var add_medical = {\n                            authority_id: vm.temporary.medical_authority.id,\n                            authority_title: vm.temporary.medical_authority.abbreviation,\n                            medical_component_id: vm.temporary.medical_component.id,\n                            medical_component_title: vm.temporary.medical_component.title\n                        };\n\n                        //check if it doesnt exist first...\n                        if(containsObject(add_medical, vm.club.plane.requirements.medical, new Array(\"authority_id\", \"medical_component_id\")) == false){\n                            vm.club.plane.requirements.medical.push(add_medical);\n                        }\n\n                        delete vm.temporary.medical_authority;\n                        delete vm.temporary.medical_component;\n\n                    } else {\n                        alert(\"Please select a medical that is required to book the plane solo!\");\n                    }\n\n                break;\n\n\n                case \"differences\":\n                    //console.log(\"difference\");\n                    if(vm.temporary.difference && vm.temporary.difference !== \"\"){\n                        //then we can add it\n                        //console.log(\"here we go\");\n                        var add_difference = {\n                            difference_id: vm.temporary.difference.id,\n                            difference_title: vm.temporary.difference.title\n                        };\n\n                        //check if it doesnt exist first...\n                        if(containsObject(add_difference, vm.club.plane.requirements.differences, new Array(\"difference_id\", \"difference_title\")) == false){\n                            vm.club.plane.requirements.differences.push(add_difference);\n                        }\n\n                        delete vm.temporary.difference;\n\n                    } else {\n                        alert(\"Please select a difference that is required to book the plane solo!\");\n                    }\n\n                break;\n\n\n            }\n\n\n\n        }\n\n\n        $scope.remove_item = function(type, index){\n            //console.log(\"REMOVE\");\n\n            vm.club.plane.requirements[type].splice(index, 1);\n\n\n            // switch(type){\n            //     case \"licence\":\n            //             //console.log(\"licence\");\n                   \n            //             //check if it doesnt exist first...\n            //             // if(containsObject(add_licence, vm.club.plane.requirements.licence, new Array(\"licence_id\", \"rating_id\")) == false){\n            //             //     vm.club.plane.requirements.licence.push(add_licence);\n            //             // }\n\n            //             vm.club.plane.requirements.licence.splice(index, 1);\n                      \n                   \n\n            //     break;\n\n\n            //     case \"medical\":\n            //         //console.log(\"medical\");\n            //         if(vm.temporary.medical_authority && vm.temporary.medical_authority !== \"\" && vm.temporary.medical_component && vm.temporary.medical_component !== \"\"){\n            //             //then we can add it\n            //             //console.log(\"here we go\");\n            //             var add_medical = {\n            //                 authority_id: vm.temporary.medical_authority.id,\n            //                 authority_title: vm.temporary.medical_authority.abbreviation,\n            //                 medical_component_id: vm.temporary.medical_component.id,\n            //                 medical_component_title: vm.temporary.medical_component.title\n            //             };\n\n            //             //check if it doesnt exist first...\n            //             if(containsObject(add_medical, vm.club.plane.requirements.medical, new Array(\"authority_id\", \"medical_component_id\")) == false){\n            //                 vm.club.plane.requirements.medical.push(add_medical);\n            //             }\n\n            //             delete vm.temporary.medical_authority;\n            //             delete vm.temporary.medical_component;\n\n            //         } else {\n            //             alert(\"Please select a medical that is required to book the plane solo!\");\n            //         }\n\n            //     break;\n\n\n            //     case \"differences\":\n            //         //console.log(\"difference\");\n            //         if(vm.temporary.difference && vm.temporary.difference !== \"\"){\n            //             //then we can add it\n            //             //console.log(\"here we go\");\n            //             var add_difference = {\n            //                 difference_id: vm.temporary.difference.id,\n            //                 difference_title: vm.temporary.difference.title\n            //             };\n\n            //             //check if it doesnt exist first...\n            //             if(containsObject(add_difference, vm.club.plane.requirements.differences, new Array(\"difference_id\", \"difference_title\")) == false){\n            //                 vm.club.plane.requirements.differences.push(add_difference);\n            //             }\n\n            //             delete vm.temporary.difference;\n\n            //         } else {\n            //             alert(\"Please select a difference that is required to book the plane solo!\");\n            //         }\n\n            //     break;\n\n\n            // }\n\n\n\n        }\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n        $scope.update_this_file = function(file){\n            //console.log(\"==== update is : \", file.id);\n            if(update_this_file.indexOf(file.id) === -1){\n                update_this_file.push(file.id)\n            } else {\n               ////console.log(\"This item already exists\"); \n            } \n        }\n\n\n         $scope.remove_real_file = function(file){\n\n                //remove_file\n\n                vm.club.plane.plane_documents = $.grep(vm.club.plane.plane_documents, function(e){ \n                        return e.id != file.id; \n                    });\n\n                //no need to actually remove the file as it will be archived accordingly on the backend whilst it is missing! :)\n                PlaneDocumentService.Delete(vm.user_id, file.id)\n                .then(function (data) {\n                    // //console.log(data);\n                    if(data.success){\n                        // //console.log(\"HUZZAH\", current_files);\n                        //then we need to remove this from the list of files...\n                        //clear files\n                        vm.plane_documents = [];\n                        //and re-process available files\n                        $scope.processFiles(current_files);\n\n                    } else {\n                        //console.log(\"WOOOPSIES...\");\n                        //this should be very very rare...\n                    }\n\n                });\n\n          }\n\n\n          \n          $scope.remove_file = function(file, current_files){\n\n            //remove_file\n            var j = JSON.parse(file.file_return);\n            // //console.log(\"REMOVE: \", j);\n            // //console.log(\"REMOVE: \", j.saved_url);\n\n            //to delete the temp file created: j.saved_url\n            //tmp_rm.php POST tmp = filename\n            \n\n            //this SHOULD BE TO THE CURRENT POSITION\n\n            // PoidService.DeleteTmp(j.saved_url)\n            //     .then(function (data) {\n            //         //console.log(data);\n            //         if(data.success){\n            //             //console.log(\"HUZZAH\", current_files);\n            //             //then we need to remove this from the list of files...\n            //             //clear files\n            //             vm.plane_documents = [];\n            //             //and re-process available files\n            //             $scope.processFiles(current_files);\n\n            //         } else {\n            //             //console.log(\"WOOOPSIES...\");\n            //             //this should be very very rare...\n            //         }\n\n            //     });\n\n          }\n          \n\n          // $scope.$on('flow::fileAdded', function (event, $flow, flowFile) {\n          //     event.preventDefault();//prevent file from uploading\n          //     //console.log(\"FILE ADDED\");\n          //     //console.log($flow);\n          //   });\n\n            vm.files = {\n                radio: [],\n                cert: [],\n                noise_cert: [],\n                insurance: []\n            }\n\n\n            $scope.processFiles = function(files, location){\n                // //console.log(\"files\", files);\n\n                for(var i=0; i<files.length; i++){\n                    // //console.log(\"JSON\", files[i].file_return);\n                    var j = JSON.parse(files[i].file_return);\n                    // //console.log(\"PARSED\", j);\n                    // //console.log(\"J is : \",j);\n                    // //console.log(\"name is : \", j.files.file.name);\n\n                    files[i].file.temp_path = j.saved_url;\n                    files[i].file.save_name = j.files.file.name;\n                    var ft = j.files.file.name;\n                    ft = ft.split('.').pop();\n                    files[i].file.extension = ft;\n\n                    // //console.log(\"file\", files[i].file);\n                    vm.files[location].push(files[i].file);\n                }\n\n\n            }\n\n\n             $scope.processFile = function(files, location){\n                 //console.log(\"files\", files[0].file_return);\n\n                    // //console.log(\"JSON\", files[i].file_return);\n                    var j = JSON.parse(files[0].file_return);\n                    // //console.log(\"PARSED\", j);\n                    // //console.log(\"J is : \",j);\n                    // //console.log(\"name is : \", j.files.file.name);\n\n                    files[0].file.temp_path = j.saved_url;\n                    files[0].file.save_name = j.files.file.name;\n\n                    var ft = j.files.file.name;\n                    // //console.log(\"ft\", ft);\n                    var fft = ft.split('.').pop();\n                    files[0].file.extension = fft;\n                    // //console.log(\"FILE is : \", files[0]);\n\n                    // //console.log(\"file\", files[i].file);\n                    vm.files[location].push(files[0]);\n\n\n            }\n\n            $scope.set_title = function(file){\n                // //console.log(\"return\", file);\n                return file.save_name;\n            }\n\n            $scope.get_icon = function(file){\n\n                var ft = file.name;\n                ft = ft.split('.').pop();\n                var icon_name = \"\";\n\n                // //console.log(\"FILE:\", ft);\n                // //console.log(\"index : \", ft.indexOf(\"pdf\"));\n                switch(true){\n                    case (ft.indexOf(\"pdf\") > -1):\n                        icon_name = \"pdf.png\";\n                    break;\n                    case (ft.indexOf(\"doc\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"docx\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"xls\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"xlsx\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"ppt\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"pptx\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"jpg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"jpeg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"png\") > -1):\n                        icon_name = \"png.png\";\n                    break;\n                    case (ft.indexOf(\"gif\") > -1):\n                        icon_name = \"gif.png\";\n                    break;\n                    case (ft.indexOf(\"zip\") > -1):\n                        icon_name = \"zip.png\";\n                    break;\n                    case (ft.indexOf(\"avi\") > -1):\n                        icon_name = \"avi.png\";\n                    break;\n                    case (ft.indexOf(\"mp4\") > -1):\n                        icon_name = \"mp4.png\";\n                    break;\n                    default:\n                        icon_name = \"file.png\";\n                    break;\n                }\n\n                // //console.log(\"FILE:\", icon_name);\n\n                return \"images/file_icons/\"+icon_name;\n            }\n\n\n            $scope.get_icon2 = function(file){\n                ////console.log(\"FILE\", file);\n                if(!file || file == \"\"){\n                    return \"\";\n                }\n                var ft = file.split('.').pop();\n                // //console.log(\"ICON 2 : \", ft);\n                var icon_name = \"\";\n\n                // //console.log(\"FILE:\", ft);\n                // //console.log(\"index : \", ft.indexOf(\"pdf\"));\n                switch(true){\n                    case (ft.indexOf(\"pdf\") > -1):\n                        icon_name = \"pdf.png\";\n                    break;\n                    case (ft.indexOf(\"doc\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"docx\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"xls\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"xlsx\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"ppt\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"pptx\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"jpg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"jpeg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"png\") > -1):\n                        icon_name = \"png.png\";\n                    break;\n                    case (ft.indexOf(\"gif\") > -1):\n                        icon_name = \"gif.png\";\n                    break;\n                    case (ft.indexOf(\"zip\") > -1):\n                        icon_name = \"zip.png\";\n                    break;\n                    case (ft.indexOf(\"avi\") > -1):\n                        icon_name = \"avi.png\";\n                    break;\n                    case (ft.indexOf(\"mp4\") > -1):\n                        icon_name = \"mp4.png\";\n                    break;\n                    default:\n                        icon_name = \"file.png\";\n                    break;\n                }\n\n                // //console.log(\"FILE:\", icon_name);\n\n                return \"images/file_icons/\"+icon_name;\n            }\n\n\n            vm.defect_severity;\n                vm.defect_severities = [\n                    { title: \"No Fly Item - Ground the plane\"},\n                    { title: \"Flyable - needs to be checked at next maintenance\"},\n                    { title: \"Not urgent - but needs noting\"},\n                    { title: \"Unsure of severity\"}\n                ]; \n\n\n            $scope.delete_poid = function(id){\n\n              \n                var a = prompt(\"Are you sure you wish to delete this poid? \\n\\n This change is irreversible! To confirm please type YES in the box below.\");\n                if(a == \"YES\"){\n\n\n                    //console.log(\"WE DELETE IT\");\n\n\n                    // PoidService.Delete(vm.user_id, id)\n                    //     .then(function (data) {\n                    //         //console.log(data);\n                    //         if(data.success){\n                    //             //console.log(\"HUZZAH\", data);\n                    //             //then we need to remove this from the list of files...\n                    //             vm.user_poids = $.grep(vm.user_poids, function(e){ \n                    //                 return e.id != id; \n                    //             });\n                                \n                    //             //refresh?\n                    //             $state.reload();\n                    //             $state.go('dashboard.my_account.poid');\n\n                    //         } else {\n\n                    //             alert(\"Something went terribly wrong... \\n\\n \"+data.message);\n\n                    //         }\n\n                    //     });\n\n\n\n                } else {\n                    //console.log(\"ignore123\");\n                }\n\n\n            }\n\n\n\n\n            $scope.save_plane_documents = function(){\n\n               \n              \n\n                // //console.log(\"plane_documents: \", vm.plane_documents);\n\n\n                //compile the required elements YAY\n\n                // //console.log(\"plane_document \", vm.plane_document);\n\n\n                 //clean shizzle before sending\n                 //why keep sending back heavy data?\n\n                    // for(var i=0;i<vm.plane_document.images.length;i++){\n                    //     delete vm.plane_document.images[i].data_uri;\n                    // }\n\n                    // // vm.plane_document.images = vm.plane_documents;\n                    // vm.plane_document.images = vm.plane_document.images.concat(vm.plane_documents);\n                    // vm.plane_document.user_id = vm.user_id;\n\n\n\n\n            //     if(vm.plane_document.id){\n            //         //then its an udpate\n\n            //         //merge the images left?\n            //         PoidService.Update(vm.plane_document)\n            //             .then(function (data) {\n            //                 //console.log(data);\n            //                 if(data.success){\n            //                     //console.log(\"HUZZAH\", vm.plane_document);\n            //                     //console.log(\"HUZZAH\", data);\n            //                     //then we need to remove this from the list of files...\n                                \n                                \n            //                     //move somewhere?\n            //                     $state.go('dashboard.my_account.poid', {}, { reload: true });\n\n\n\n\n\n            //                 } else {\n\n            //                     alert(\"Something went terribly wrong... \\n\\n \"+data.message);\n\n            //                 }\n\n            //             });\n\n            //     } else {\n\n\n                   \n\n\n            //         //then its a create\n            //         //console.log(vm.plane_document);\n\n            //         PoidService.Create(vm.plane_document)\n            //             .then(function (data) {\n            //                 //console.log(data);\n            //                 if(data.success){\n            //                     //console.log(\"HUZZAH\", vm.plane_document);\n            //                     //console.log(\"HUZZAH\", data);\n            //                     //then we need to remove this from the list of files...\n                                \n                                \n            //                     //move somewhere?\n            //                    // $state.reload();\n            //                    // $state.go('dashboard.my_account.poid', {}, { reload: true });\n\n\n            //                 } else {\n\n            //                     alert(\"Something went terribly wrong... \\n\\n \"+data.message);\n\n            //                 }\n\n            //             });\n\n\n            //     }\n\n\n\n             };\n\n\n\n\n             $scope.change_file_name = function(file){\n                \n                //this is terribly ineficient... unfortunately... can't \n                //work out how else to do it! (lol)\n\n                // //console.log(\"TO BE CHANGED\", file);\n\n                // //console.log(\"BEFORE BEFORE\", vm.plane_documents);\n\n                vm.plane_documents = $.grep(vm.plane_documents, function(e){ \n                    return e.temp_path != file.temp_path; \n                });\n\n                // //console.log(\"BEFORE\", vm.plane_documents);\n\n                vm.plane_documents.push(file);\n\n                // //console.log(\"AFTER\", vm.plane_documents);\n\n             }\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n        initController();\n\n        function initController() {\n           //console.log(\"check if access is okay\");\n        }\n\n\n          var warning_msg = \"By deleting this plane, you will also cancel all reservations that this plane currently has.\"\n\n          // $scope.open = function (plane_id) {\n          //   var modalInstance = $uibModal.open({\n          //     animation: true,\n          //     templateUrl: 'views/modals/deleteModal.html',\n          //     controller: 'ModalInstanceCtrl',\n          //     //params: {},\n          //     size: \"lg\",\n          //     resolve: {\n          //       id: function () {\n          //         return plane_id;\n          //       },\n          //       warning: function(){\n          //           return warning_msg;\n          //       }\n          //     }\n          //   });\n          //   modalInstance.result.then(function (plane_id) {\n          //     $log.info('PRESSED GO: '+plane_id);\n          //     PlaneService.Delete(plane_id)\n          //     .then(function(){\n          //       //console.log(\"HELLO DELETE\");\n          //       //update view?\n          //        vm.club.planes = $.grep(vm.club.planes, function(e){ \n          //           return e.plane_id != plane_id; \n          //       });\n          //     })\n          //   }, function () {\n          //     $log.info('Modal dismissed at: ' + new Date());\n          //   });\n          // };\n\n            $scope.open = function (club_plane_id) {\n            var modalInstance = $uibModal.open({\n              animation: true,\n              templateUrl: 'views/modals/deleteModal.html',\n              controller: 'ModalInstanceCtrl',\n              size: \"lg\",\n              resolve: {\n                id: function () {\n                  return club_plane_id;\n                },\n                params: function() {\n                  return {id: club_plane_id};\n                },\n                warning: function(){\n                    return warning_msg;\n                }\n              }\n            });\n            modalInstance.result.then(function (plane) {\n                var id = plane.id;\n              $log.info('PRESSED GO: ', id);\n              \n              PlaneService.Delete(id)\n              .then(function(){\n                // //console.log(\"HELLO DELETE\");\n                //update view?\n                 vm.club.planes = $.grep(vm.club.planes, function(e){ \n                    return e.id != id; \n                });\n             });\n\n            }, function () {\n              $log.info('Modal dismissed at: ' + new Date());\n            });\n\n\n          };\n         \n          \n\n\n        //   $scope.downloadCertificate = function(doc) {\n        //     var data = $.param({\n        //         id: doc\n        //     });\n\n        //     var ddd = doc.replace(/^.*[\\\\\\/]/, '');\n\n        //     $http.get('api/v1/plane_certificate/show_file/'+ddd, {\n        //             responseType: 'arraybuffer'\n        //         })\n        //         .success(function(data, status, headers) {\n        //             var zipName = processArrayBufferToBlob(data, headers);\n\n        //             //Delete file from temp folder in server - file needs to remain open until blob is created\n        //             //deleteFileFromServerTemp(zipName);\n        //         }).error(function(data, status) {\n        //             alert(\"There was an error downloading the selected document(s).\");\n        //         })\n        // };\n\n\n        // $scope.downloadInsurance = function(doc) {\n        //     var data = $.param({\n        //         id: doc\n        //     });\n\n        //     var ddd = doc.replace(/^.*[\\\\\\/]/, '');\n\n        //     $http.get('api/v1/plane_insurance/show_file/'+ddd, {\n        //             responseType: 'arraybuffer'\n        //         })\n        //         .success(function(data, status, headers) {\n        //             var zipName = processArrayBufferToBlob(data, headers);\n\n        //             //Delete file from temp folder in server - file needs to remain open until blob is created\n        //             //deleteFileFromServerTemp(zipName);\n        //         }).error(function(data, status) {\n        //             alert(\"There was an error downloading the selected document(s).\");\n        //         })\n        // };\n\n\n\n\n        $scope.downloadDocument = function(doc, type = 'docs') {\n            var data = $.param({\n                id: doc\n            });\n\n            var controller = \"plane_documents\";\n\n            switch(type){\n                 case \"radio\": \n                    controller = \"plane_radio_licence\";\n                break;\n                 case \"insurance\": \n                    controller = \"plane_insurance\";\n                break;\n                 case \"certificate\": \n                    controller = \"plane_certificate\";\n                break;\n                case \"noise\": \n                    controller = \"plane_noise_certificate\";\n                break;\n                case \"docs\": \n                    controller = \"plane_documents\";\n                break;\n                default:\n                    controller = \"plane_documents\";\n                break;\n\n            }\n\n\n\n            var ddd = doc.replace(/^.*[\\\\\\/]/, '');\n\n            $http.get('api/v1/'+controller+'/show_file/'+ddd, {\n                    responseType: 'arraybuffer'\n                })\n                .success(function(data, status, headers) {\n                    var zipName = processArrayBufferToBlob(data, headers);\n\n                    //Delete file from temp folder in server - file needs to remain open until blob is created\n                    //deleteFileFromServerTemp(zipName);\n                }).error(function(data, status) {\n                    alert(\"There was an error downloading the selected document(s).\");\n                })\n        };\n\n        $scope.downloadClubDocument = function(doc) {\n            var data = $.param({\n                id: doc\n            });\n\n            var ddd = doc.replace(/^.*[\\\\\\/]/, '');\n\n            $http.get('api/v1/club_documents/show_file/'+ddd, {\n                    responseType: 'arraybuffer'\n                })\n                .success(function(data, status, headers) {\n                    var zipName = processArrayBufferToBlob(data, headers);\n\n                    //Delete file from temp folder in server - file needs to remain open until blob is created\n                    //deleteFileFromServerTemp(zipName);\n                }).error(function(data, status) {\n                    alert(\"There was an error downloading the selected document(s).\");\n                })\n        };\n\n        // function processArrayBufferToBlob(data, headers) {\n        //     var octetStreamMime = 'application/octet-stream';\n        //     var success = false;\n\n        //     // Get the headers\n        //     headers = headers();\n        //     //var ttt = title.toLowerCase().replace(/\\W/g, '_');\n        //     // Get the filename from the x-filename header or default to \"download.bin\"\n        //     var filename = headers['x-filename'] || 'download.zip';\n\n        //     // Determine the content type from the header or default to \"application/octet-stream\"\n        //     var contentType = headers['content-type'] || octetStreamMime;\n\n        //     try {\n        //         // Try using msSaveBlob if supported\n        //         var blob = new Blob([data], {\n        //             type: contentType\n        //         });\n        //         if (navigator.msSaveBlob)\n        //             navigator.msSaveBlob(blob, filename);\n        //         else {\n        //             // Try using other saveBlob implementations, if available\n        //             var saveBlob = navigator.webkitSaveBlob || navigator.mozSaveBlob || navigator.saveBlob;\n        //             if (saveBlob === undefined) throw \"Not supported\";\n        //             saveBlob(blob, filename);\n        //         }\n        //         success = true;\n        //     } catch (ex) {\n        //         $log.info(\"saveBlob method failed with the following exception:\");\n        //         $log.info(ex);\n        //     }\n\n        //     if (!success) {\n        //         // Get the blob url creator\n        //         var urlCreator = window.URL || window.webkitURL || window.mozURL || window.msURL;\n        //         if (urlCreator) {\n        //             // Try to use a download link\n        //             var link = document.createElement('a');\n        //             if ('download' in link) {\n        //                 // Try to simulate a click\n        //                 try {\n        //                     // Prepare a blob URL\n        //                     var blob = new Blob([data], {\n        //                         type: contentType\n        //                     });\n        //                     var url = urlCreator.createObjectURL(blob);\n        //                     link.setAttribute('href', url);\n\n        //                     // Set the download attribute (Supported in Chrome 14+ / Firefox 20+)\n        //                     link.setAttribute(\"download\", filename);\n\n        //                     // Simulate clicking the download link\n        //                     var event = document.createEvent('MouseEvents');\n        //                     event.initMouseEvent('click', true, true, window, 1, 0, 0, 0, 0, false, false, false, false, 0, null);\n        //                     link.dispatchEvent(event);\n        //                     success = true;\n\n        //                 } catch (ex) {\n        //                     $log.info(\"Download link method with simulated click failed with the following exception:\");\n        //                     $log.info(ex);\n        //                 }\n        //             }\n\n        //             if (!success) {\n        //                 // Fallback to window.location method\n        //                 try {\n        //                     // Prepare a blob URL\n        //                     // Use application/octet-stream when using window.location to force download\n        //                     var blob = new Blob([data], {\n        //                         type: octetStreamMime\n        //                     });\n        //                     var url = urlCreator.createObjectURL(blob);\n        //                     window.location = url;\n        //                     success = true;\n        //                 } catch (ex) {\n        //                     $log.info(\"Download link method with window.location failed with the following exception:\");\n        //                     $log.info(ex);\n        //                 }\n        //             }\n        //         }\n        //     }\n\n        //     if (!success) {\n        //         // Fallback to window.open method\n        //         $log.info(\"No methods worked for saving the arraybuffer, using last resort window.open\");\n        //         window.open(httpPath, '_blank', '');\n        //     }\n        //     return filename;\n        // };\n\n        function titlepath(path,name){\n\n        //In this path defined as your pdf url and name (your pdf name)\n            var prntWin = window.open();\n            prntWin.document.write(\"<html><head><title>\"+name+\"</title></head><body>\"\n                + '<embed width=\"100%\" height=\"100%\" name=\"plugin\" src=\"'+ path+ '\" '\n                + 'type=\"application/pdf\" internalinstanceid=\"21\"></body></html>');\n            prntWin.document.close();\n        }\n        \n        function processArrayBufferToBlob(data, headers) {\n            var octetStreamMime = 'application/octet-stream';\n            var success = false;\n\n            // Get the headers\n            headers = headers();\n            //var ttt = title.toLowerCase().replace(/\\W/g, '_');\n            // Get the filename from the x-filename header or default to \"download.bin\"\n            var filename = headers['x-filename'] || 'download.zip';\n\n            // Determine the content type from the header or default to \"application/octet-stream\"\n            var contentType = headers['content-type'] || octetStreamMime;\n\n            try {\n\n                $log.info(\"first try\");\n                // Try using msSaveBlob if supported\n                var blob = new Blob([data], {\n                    //type: contentType\n                    type: 'application/pdf'\n                });\n\n                var fileURL = URL.createObjectURL(blob);\n                titlepath(fileURL, \"Secure Documents\");\n\n                // if (navigator.msSaveBlob)\n                //     navigator.msSaveBlob(blob, filename);\n                // else {\n                //     // Try using other saveBlob implementations, if available\n                //     var saveBlob = navigator.webkitSaveBlob || navigator.mozSaveBlob || navigator.saveBlob;\n                //     if (saveBlob === undefined) throw \"Not supported\";\n                //     saveBlob(blob, filename);\n                // }\n                success = true;\n            } catch (ex) {\n                $log.info(\"saveBlob method failed with the following exception:\");\n                $log.info(ex);\n            }\n\n            if (!success) {\n                // Get the blob url creator\n                var urlCreator = window.URL || window.webkitURL || window.mozURL || window.msURL;\n                if (urlCreator) {\n                    // Try to use a download link\n                    var link = document.createElement('a');\n                    if ('download' in link) {\n                        // Try to simulate a click\n                        try {\n                            $log.info(\"second try\");\n                            // Prepare a blob URL\n                            var blob = new Blob([data], {\n                                type: contentType\n                            });\n                            var url = urlCreator.createObjectURL(blob);\n                            link.setAttribute('href', url);\n\n                            // Set the download attribute (Supported in Chrome 14+ / Firefox 20+)\n                            link.setAttribute(\"download\", filename);\n\n                            // Simulate clicking the download link\n                            var event = document.createEvent('MouseEvents');\n                            event.initMouseEvent('click', true, true, window, 1, 0, 0, 0, 0, false, false, false, false, 0, null);\n                            link.dispatchEvent(event);\n                            success = true;\n\n                        } catch (ex) {\n                            $log.info(\"Download link method with simulated click failed with the following exception:\");\n                            $log.info(ex);\n                        }\n                    }\n\n                    if (!success) {\n                        // Fallback to window.location method\n                        try {\n\n                            $log.info(\"third try\");\n\n                            // Prepare a blob URL\n                            // Use application/octet-stream when using window.location to force download\n                            var blob = new Blob([data], {\n                                type: octetStreamMime\n                            });\n                            var url = urlCreator.createObjectURL(blob);\n                            window.location = url;\n                            success = true;\n                        } catch (ex) {\n                            $log.info(\"Download link method with window.location failed with the following exception:\");\n                            $log.info(ex);\n                        }\n                    }\n                }\n            }\n\n            if (!success) {\n                // Fallback to window.open method\n                $log.info(\"No methods worked for saving the arraybuffer, using last resort window.open\");\n                window.open(httpPath, '_blank', '');\n            }\n            return filename;\n        };\n\n\n\n\n\n\n    }\n app.controller('DashboardClubMemberRequestsController', DashboardClubMemberRequestsController);\n\n    DashboardClubMemberRequestsController.$inject = ['UserService', 'MemberService', 'MembershipService', 'PaymentService', 'InstructorService', 'HolidayService', 'ClubService', '$rootScope', '$location', '$scope', '$state', '$stateParams', '$uibModal', '$log', '$window', '$compile', '$timeout', 'uiCalendarConfig', 'LicenceService', 'NokService', '$cookies'];\n    function DashboardClubMemberRequestsController(UserService, MemberService, MembershipService, PaymentService, InstructorService, HolidayService, ClubService, $rootScope, $location, $scope, $state, $stateParams, $uibModal, $log, $window, $compile, $timeout, uiCalendarConfig, LicenceService, NokService, $cookies) {\n        \n        var vm = this;        \n\n        vm.user = $rootScope.globals.currentUser;\n        vm.user_id = vm.user.id;  \n\n        vm.club_id = $rootScope.globals.currentUser.current_club_admin.id;\n        vm.user = $rootScope.globals.currentUser;\n        vm.user_id = vm.user.id;\n\n\n        vm.noks = [];\n        vm.requests = [];\n        vm.auto_renew = false;\n\n        \n    \n\n\n\n\n        function update_requests(){\n            MembershipService.GetRequestsByClub(vm.club_id)\n                .then(function (data) {\n                    if(data.success){\n                        vm.requests = data.requests;\n                        //console.log(\"memberships\", vm.memberships);\n\n                    } else {\n                        //console.log(\"WOOOPSIES...\");\n                        //this should be very very rare...\n                    }\n\n                });\n        }\n\n        update_requests();\n\n            $scope.popup = [];\n\n            $scope.open = function(id, $event) {\n                //console.log(\"THIS\", id);\n                //this comment would allow the event not to be affect by clicking it again... not sure this is a good idea\n                if($scope.popup[id] && $scope.popup[id].opened == true){\n                    $event.preventDefault();\n                    $event.stopPropagation();\n                } else {\n                    $scope.popup[id] = {opened: true};\n                }\n            };\n\n            $scope.formats = ['dd/MM/yyyy', 'yyyy/MM/dd', 'dd.MM.yyyy', 'shortDate'];\n            $scope.format = $scope.formats[0];\n\n            $scope.datePickerOptions = {\n                                        format: 'dd/MM/yyyy',\n                                        showWeeks: false\n                                    };\n\n           \n\n            vm.show_memberships = false;\n\n        \n\n\n\n\n\n            $scope.accept_request = function(id){\n\n                //basic checks...\n                var obj = {\n                    status: \"Accepted\"\n                };\n\n                MembershipService.ClubAcceptRequest(id, obj)\n                .then(function (data) {\n                    // //console.log(\"ACCEPT HERE\", data);\n                    //vm.memberships = data;\n\n                    update_requests();\n\n                    // $state.go('dashboard.my_account.memberships', {}, {reload: true});\n\n                }); \n\n            }\n\n\n            $scope.decline_request = function(){\n\n\n                MembershipService.ClubDeclineRequest(vm.this_req.id)\n                .then(function (data) {\n                    //console.log(\"DECLINE HERE\", data);\n                    //vm.memberships = data;\n\n                    update_requests();\n\n                    // $state.go('dashboard.my_account.memberships', {}, {reload: true});\n\n                }); \n\n            }\n\n\n          \n\n            // $scope.delete_request = function(){\n\n\n            //     MembershipService.ClubDeclineRequest(vm.this_req.id)\n            //     .then(function (data) {\n            //         //console.log(\"DECLINE HERE\", data);\n            //         //vm.memberships = data;\n\n            //         update_requests();\n\n            //         // $state.go('dashboard.my_account.memberships', {}, {reload: true});\n\n            //     }); \n\n            // }\n\n\n\n\n\n\n\n            $scope.delete_request = function(id){\n                MembershipService.DeleteRequest(id)\n                .then(function (data) {\n                    //console.log(\"DELETE HERE\", data);\n\n\n                    update_requests();\n                }); \n            }\n\n             $scope.resend_request = function(id){\n                MembershipService.ResendRequest({request_id: id})\n                .then(function (data) {\n                    //vm.memberships = data;\n\n                    if(data.success){\n                        alert(\"Request re-sent. Please ask them to check their junk / spam folders if they do not see it within the next 5 minutes.\")\n                    }\n\n                    update_requests();\n                }); \n            }\n\n\n        \n        \n\n\n    }\napp.controller('DashboardClubMembersController', DashboardClubMembersController);\n\n    DashboardClubMembersController.$inject = ['$sce', 'PaymentService', 'UserService', 'MemberService', 'MembershipService', 'PlaneService', '$rootScope', '$location', '$scope', '$state', '$stateParams', '$uibModal', '$log', '$window', 'PoidService',  'LicenceService', 'MedicalService', 'DifferencesService', 'AuthenticationService', '$http', 'PackageService'];\n    function DashboardClubMembersController($sce, PaymentService, UserService, MemberService, MembershipService, PlaneService, $rootScope, $location, $scope, $state, $stateParams, $uibModal, $log, $window, PoidService,  LicenceService, MedicalService, DifferencesService, AuthenticationService, $http, PackageService) {\n        var vm = this;\n\n        vm.user = null;\n        vm.allUsers = [];\n        vm.club = {};\n        vm.page_title = \"\";\n        vm.club.member = {};\n                                vm.club.member.payment_now = true;\n\n        vm.imported_new_headers = [];\n\n        // vm.club.member.membership_id = {};\n\n        vm.test = \"Package valid until 12/03/2022<br /> To be used on:<br /> G-BOOF <br /> G-OARU\";\n        \n        vm.action = $state.current.data.action;\n\n        vm.club_id = $rootScope.globals.currentUser.current_club_admin.id;\n        vm.user = $rootScope.globals.currentUser;\n        vm.user_id = vm.user.id;\n\n        vm.no_show_cols = [\"membership_start\", \"membership_id\", \"selected\"];\n\n        vm.show_loading = true;\n\n        $scope.sortType     = 'Email'; // set the default sort type\n        $scope.sortReverse  = false;  // set the default sort order\n        $scope.searchTool   = '';     // set the default search/filter term\n\n        ////console.log(\"club_id : \"+vm.club_id);\n\n        // //console.log(vm.action);\n        // //console.log($stateParams);\n        // //console.log($stateParams.id);\n\n\n\n        vm.show_pay_now = false;\n        vm.show_loading = false;\n\n        vm.last_invoice_opened = {};\n\n\n        var iconBank = '<svg viewBox=\"0 0 24 24\"><path d=\"M3 10h18M4 10V8l8-5 8 5v2M5 10v8M9 10v8M15 10v8M19 10v8M3 18h18M2 20h20\" fill=\"none\" stroke=\"#4f46e5\" stroke-width=\"1.6\"/></svg>';\n        var iconCard = '<svg viewBox=\"0 0 24 24\"><rect x=\"2\" y=\"4\" width=\"20\" height=\"16\" rx=\"2\" ry=\"2\" fill=\"none\" stroke=\"#4f46e5\" stroke-width=\"1.6\"/><path d=\"M2 9h20M6 14h6\" stroke=\"#4f46e5\" stroke-width=\"1.6\"/></svg>';\n        var iconNew  = '<svg viewBox=\"0 0 24 24\"><circle cx=\"12\" cy=\"12\" r=\"9\" fill=\"none\" stroke=\"#4f46e5\" stroke-width=\"1.6\"/><path d=\"M12 8v8M8 12h8\" stroke=\"#4f46e5\" stroke-width=\"1.6\"/></svg>';\n        var iconTerm = '<svg viewBox=\"0 0 24 24\"><rect x=\"6\" y=\"2\" width=\"12\" height=\"14\" rx=\"2\" fill=\"none\" stroke=\"#4f46e5\" stroke-width=\"1.6\"/><rect x=\"8\" y=\"5\" width=\"8\" height=\"3\" fill=\"none\" stroke=\"#4f46e5\" stroke-width=\"1.6\"/><rect x=\"9\" y=\"10\" width=\"6\" height=\"3\" fill=\"none\" stroke=\"#4f46e5\" stroke-width=\"1.6\"/></svg>';\n        \n          vm.donConfirm = function(methodLabel, paymentIntent){\n            // console.log(\"confirmation is called\", methodLabel);\n            // console.log(\"paymentIntent\", paymentIntent);\n          //alert('Parent received D confirmation: ' + methodLabel);\n            vm.complete_invoice(methodLabel, paymentIntent);\n          };\n\n          vm.default_payment = 'direct-debit';\n\n          vm.methods = [\n            { id: 'direct-debit', title: 'Direct Debit', subtitle: 'Use your BACS mandate', type: 'direct-debit', iconSvg: $sce.trustAsHtml(iconBank), visible: true },\n            { id: 'saved-card',   title: 'Saved card',   subtitle: 'Use a card on file',    type: 'saved-card',  iconSvg: $sce.trustAsHtml(iconCard), visible: true },\n            { id: 'new-card',     title: 'New card',     subtitle: 'Add a new debit/credit card', type: 'new-card', iconSvg: $sce.trustAsHtml(iconNew), visible: false },\n            { id: 'card-machine', title: 'Card Machine', subtitle: 'Pay in person',          type: 'card-machine', iconSvg: $sce.trustAsHtml(iconTerm), visible: true }\n          ];\n\n           vm.savedCards = [];\n\n           vm.complete_invoice = function(method, paymentIntent){\n\n               //we now have a payment to complete\n               //process_payment\n\n               var obj = {\n                   user_id: vm.last_invoice_opened.user_id,\n                   club_id: vm.last_invoice_opened.club_id,\n                   paymentIntent: paymentIntent,\n                   invoice_id: vm.last_invoice_opened.id,\n                   method: method\n               }\n\n               PaymentService.ProcessPayment(obj)\n                   .then(function (data) {\n\n                       if(data.success){\n\n                           //finish with:\n                           //RELOAD THE INVOICES!!!\n\n                            UserService.GetInvoicesUserClub(vm.club.member.user_id, vm.club_id, vm.current_invoice_offset, vm.loaded_per_batch, 0)\n                            .then(function (data) {\n                                   vm.invoices = data.invoices;\n                                   vm.upcoming = data.upcoming;\n\n\n                                    vm.add_credit_amount = 0;\n                                    vm.add_credit_note = \"\";\n                                    vm.show_add_credit = false;    \n                                    vm.show_loading = false;\n                                       \n                                    vm.show_pay_now = false;\n\n                                    alert(\"SUCCESS!\");\n\n\n                                });\n\n\n\n                           // ClubService.GetClubInvoices(vm.club_id, vm.from_date, vm.to_date)\n                           //  .then(function (data) {\n                           //         console.log(\"data is : \", data);\n                           //         vm.invoices = data.invoices;\n                           //         vm.totals = data.totals;\n\n                           //         vm.show_pay_now = false;\n                           //         vm.show_loading = false;\n                           //         alert(\"SUCCESS!\");\n\n\n                           //      });\n\n                           \n\n                       } else {\n                           alert(\"Something happened which was not supposed to happen... Please try again\");\n                           console.log(\"===== ERROR =====\");\n                           console.log(data);\n                           console.log(\"===== ERROR =====\");\n                       }\n\n\n                   });\n\n           }\n\n           vm.close_pay_now = function(){\n               vm.show_pay_now = false;\n               vm.show_loading = false;\n           }\n\n           vm.show_payment_option = function(invoice){\n            var status = invoice.status;\n            if(status == \"pending_submission\"){\n                return true;\n            } else if(status == \"issued\"){\n                return true;\n            } else {\n                return false;\n            }\n\n        }\n\n        vm.info;\n\n        vm.show_payment = function(invoice){\n            console.log(\"invoice details: \", invoice);\n            vm.last_invoice_opened = invoice;\n            vm.send = {\n                club_id: invoice.club_id,\n                user_id: invoice.user_id,\n                invoice_id: invoice.id\n            }\n\n            //get user cards\n            //get user info\n\n            MemberService.GetMandate(invoice.user_id, invoice.club_id)\n                    .then(function (data) {\n                            ////console.log(\"data is : \", data);\n                           \n                    if(data.success){\n                        vm.info = data.info;\n\n                        vm.savedCards = data.cards;\n\n                        if(vm.savedCards.length > 0){\n                            vm.methods[1].visible = true;\n                        } else {\n                            vm.methods[1].visible = false;\n                        }\n\n                        vm.machine = data.machine;\n                        if(vm.machine.success){\n                            vm.methods[3].visible = true;\n                        } else {\n                            vm.methods[3].visible = false;\n                        }\n\n                        vm.show_pay_now = true;\n                    }\n\n                });\n\n           \n\n        }\n\n\n\n\n\n\n\n        $scope.get_human_status = function(status){\n\n            var returned;\n            switch(status){\n                case 'issued':\n            \n                  returned = \"Created\";\n\n              break;\n\n              case 'pending_submission':\n                  \n                    returned = \"Requesting\";\n\n              break;\n\n              case 'submitted':\n                    \n                    returned = \"Requested\";\n\n              break;\n\n              case 'confirmed':\n                    \n                    returned = \"Paid\";\n\n              break;\n\n              case 'paid_out':\n                    returned = \"Paid\";\n\n              break;\n\n              case 'failed':\n                    returned = \"Failed\";\n\n              break;\n\n              case 'charged_back':\n                    returned = \"Charged Back\";\n\n              break;\n              default:\n                  returned = status;\n              break\n            }\n\n            return returned;\n\n        }\n\n        switch(vm.action){\n            case \"add\":\n                //console.log(\"adding a new member please\");\n                vm.page_title = \"Add a New member\";\n\n                 MembershipService.GetAllByClub(vm.club_id)\n                    .then(function(data){\n                        vm.club.memberships = data;\n                        // vm.club.member.membership_id.selected = vm.club.member.membership_id;\n                        // vm.membership = vm.club.member.membership_name;\n                        // vm.club.membership = vm.club.member.membership_name;\n                        // //console.log(vm.club.memberships);\n                    });\n\n            break;\n            case \"edit\":\n                //console.log(\"edit an existing membership\");\n\n                \n\n                 MemberService.GetById($stateParams.member_id, vm.club_id)\n                    .then(function(data){\n                        vm.club.member = data.member;   \n                        // //console.log(vm.club);\n                        vm.club.member.is_manager = (vm.club.member.is_manager == 1) ? true : false;\n                        vm.club.member.approved = (vm.club.member.approved == 1) ? true : false;\n\n                        \n\n                        PoidService.GetByUserIdClub(vm.club.member.user_id, vm.club_id)\n                        .then(function (data) {\n                            //console.log(data);\n                            if(data.success){\n                                vm.poids = data.poids;\n                                //console.log(\"POIDS\", data.poids);\n                            } else {\n                                //console.log(\"WOOOPSIES...\");\n                                //this should be very very rare...\n                            }\n\n                        });\n\n\n                        MedicalService.GetByUserIdClub(vm.club.member.user_id, vm.club_id)\n                        .then(function (data) {\n                            //console.log(data);\n                            if(data.success){\n                                vm.medicals = data.medicals;\n                                //console.log(\"medicals\", vm.medicals);\n                            } else {\n                                //console.log(\"WOOOPSIES...\");\n                                //this should be very very rare...\n                            }\n\n                        });\n\n                        LicenceService.GetByUserIdClub(vm.club.member.user_id, vm.club_id)\n                        .then(function (data) {\n                            //console.log(data);\n                            if(data.success){\n                                vm.licences = data.licences;\n                                //console.log(\"LICENCES\", vm.licences);\n\n                            } else {\n                                //console.log(\"WOOOPSIES...\");\n                                //this should be very very rare...\n                            }\n\n                        });\n\n                        DifferencesService.GetByUserIdClub(vm.club.member.user_id, vm.club_id)\n                        .then(function (data) {\n                                var diff = data.differences.differences;\n                                for(var i=0;i<diff.length;i++){\n                                    if(diff[i].sign_off_date == \"0000-00-00\"){\n                                       delete diff[i].sign_off_date;\n                                    }\n                                    diff[i].sign_off_date = new Date(diff[i].sign_off_date);\n                                    diff[i].day = (diff[i].day == 1)? true : false;\n                                    diff[i].night = (diff[i].night == 1)? true : false;\n                                    diff[i].vfr = (diff[i].vfr == 1)? true : false;\n                                    diff[i].ifr = (diff[i].ifr == 1)? true : false;\n                                }\n                                data.differences.differences = diff;\n                                vm.differences = data.differences.differences;\n                                vm.differences_images = data.differences.images;\n                                //console.log(\"GET DIFFS\", vm.differences);\n\n                        });\n\n\n                        PackageService.GetPackagesByUserIdAndClubId(vm.club.member.user_id, vm.club_id)\n                            .then(function (data) {\n                                //console.log(data);\n                                vm.packages = data.items;\n                            });\n\n\n                        vm.get_package_html = function(pack_obj){\n                            var used_on = \"\";\n                            for(var i=0;i<pack_obj.aircraft.length;i++){\n                                used_on = used_on + \" \" + pack_obj.aircraft[i].registration +\" (\"+ pack_obj.aircraft[i].plane_type +\") <br />\";\n                            }\n                            var text = \"\";\n                            if(pack_obj.validity == 0){\n                               text = \"Package purchased on: \"+moment(pack_obj.created_at).format(\"D MMM Y\")+\"<br /> Package does not expire <br /> To be used on:<br />\";\n                            } else {\n                               text = \"Package purchased on: \"+moment(pack_obj.created_at).format(\"D MMM Y\")+\"<br /> Package expires on: \"+ moment(pack_obj.created_at).add(pack_obj.validity, \"days\").format(\"D MMM Y\") +\" <br /> To be used on:<br />\";\n                            }\n                    \n                            return text+used_on;\n\n                        }\n\n                        vm.get_pax_html = function(flight_obj){\n                            var pax = \"\";\n                             for(var i=0;i<flight_obj.passengers.length;i++){\n                                 //\"+flight_obj.passengers[i].nok[0].first_name+\" \"+flight_obj.passengers[i].nok[0].last_name+\"\n                                 var nok = \"\";\n                                 if(flight_obj.passengers[i].nok.length > 0){\n                                     for(var j=0;j<flight_obj.passengers[i].nok.length;j++){\n                                         nok = nok + \"<br /><br />Emergency Contact (\"+(j+1)+\"): <br />\"+flight_obj.passengers[i].nok[j].first_name+ \" \" +flight_obj.passengers[i].nok[j].last_name + \" <br />relationship: \"+flight_obj.passengers[i].nok[j].relationship+\"<br />t: \"+flight_obj.passengers[i].nok[j].phone_number+ \" <br /> e: \"+flight_obj.passengers[i].nok[j].email_address+\"<br />\";\n                                     }\n                                 } \n                                pax = pax + \"<span class='bolder'><b>\" + flight_obj.passengers[i].first_name +\" \"+ flight_obj.passengers[i].last_name +\"</b></span><br />e: \"+flight_obj.passengers[i].email+\"<br />t: \"+((flight_obj.passengers[i].telephone_number) ? flight_obj.passengers[i].telephone_number : \"unknown\")+nok+\"  <br /> <br />\";\n                            }\n                            if(flight_obj.passengers.length == 0){\n\n                            }\n                            if(flight_obj.instructor_id > 0){\n\n                                 var nok2 = \"\";\n                                     if(vm.club.member.nok.noks.length > 0){\n                                         for(var j=0;j<vm.club.member.nok.noks.length;j++){\n                                             nok2 = nok2 + \"<br />Emergency Contact (\"+(j+1)+\"): <br />\"+vm.club.member.nok.noks[j].first_name+ \" \" +vm.club.member.nok.noks[j].last_name + \" <br />relationship: \"+vm.club.member.nok.noks[j].relationship+\"<br />t: \"+vm.club.member.nok.noks[j].phone_number+ \" <br /> e: \"+vm.club.member.nok.noks[j].email_address+\"<br />\";\n                                         }\n                                     } \n\n                                    pax = pax + \"<br /><span class='bolder'>Instructor Present</span> <br /> \"+flight_obj.booking.instructor.first_name+\" \"+flight_obj.booking.instructor.last_name+\" <br /> \"+nok2;\n                                }\n                            if(flight_obj.user_id > 0){\n                                    \n                                    var nok1 = \"\";\n                                     if(vm.club.member.nok.noks.length > 0){\n                                         for(var j=0;j<vm.club.member.nok.noks.length;j++){\n                                             nok1 = nok1 + \"<br />Emergency Contact (\"+(j+1)+\"): <br />\"+vm.club.member.nok.noks[j].first_name+ \" \" +vm.club.member.nok.noks[j].last_name + \" <br />relationship: \"+vm.club.member.nok.noks[j].relationship+\"<br />t: \"+vm.club.member.nok.noks[j].phone_number+ \" <br /> e: \"+vm.club.member.nok.noks[j].email_address+\"<br />\";\n                                         }\n                                     } \n\n                                    // var nok1 = \"<br /><br />Emergency Contact (\"+(j+1)+\"): <br />\"+flight_obj.passengers[i].nok[j].first_name+ \" \" +flight_obj.passengers[i].nok[j].last_name + \" <br />relationship: \"+flight_obj.passengers[i].nok[j].relationship+\"<br />t: \"+flight_obj.passengers[i].nok[j].phone_number+ \" <br /> e: \"+flight_obj.passengers[i].nok[j].email_address+\"<br />\";\n                                    pax = pax + \"<br /><span class='bolder'>Member Present</span> <br />\"+nok1;\n                            }\n                            return pax;\n\n                            // var b = '<accordion close-others=\"oneAtATime\"> <accordion-group heading=\"Static Header, initially expanded\" is-open=\"true\"> This content is straight in the template. </accordion-group> <accordion-group heading=\"TITLE\" ng-repeat=\"group in groups\"> Some content here </accordion-group> <accordion-group heading=\"Dynamic Body Content\"> <p>The body of the accordion group grows to fit the contents</p> <button class=\"btn btn-default btn-sm\" ng-click=\"addItem()\">Add Item</button> <div ng-repeat=\"item in items\">{{item}}</div> </accordion-group> <accordion-group is-open=\"isopen\"> <accordion-heading> I can have markup, too! <i class=\"pull-right glyphicon\" ng-class=\"{\\'glyphicon-chevron-down\\': isopen, \\'glyphicon-chevron-right\\': !isopen}\"></i> </accordion-heading> This is just some content to illustrate fancy headings. </accordion-group> </accordion>';\n                            // return b;\n                        }\n\n\n\n                        // vm.calculate_difference = function(package, difference){\n\n                        //     var price = package.price;\n                        //     var hours_dual = package.hours_dual;\n                        //     var hours_solo = package.hours_solo;\n\n                        //     var base = price / (hours_dual + hours_solo);\n\n                        //     var initial_dual_price = base + difference;\n                        //     var initial_solo_price = (price - (initial_dual_price * hours_dual)) / hours_solo;\n\n                        //     var price_ratio = initial_dual_price / initial_solo_price;\n\n                        //     var hour_ratio = hours_dual / hours_solo;\n                        //     var remaining_ratio = hours_dual_remaining / hours_solo_remaining;\n                        //     var remaining_hours = hours_dual_remaining / hours_solo_remaining;\n\n                        //     //hello world\n\n                        //     vm.package_split = {ratio: hour_ratio, remaining_ratio: remaining_ratio, dual_price: initial_dual_price, solo_price: initial_solo_price, price_ratio: price_ratio, remaining_hours: remaining_hours};\n\n                        // }\n\n\n                        // vm.calculate_change = function(slider_value){\n\n                        //     //100 ==> everything in solo\n                        //     //0 ==> everything in dual flights\n\n                        //     var dual_percent = slide_value/100;\n                        //     var dual_hours = dual_percent * remaining_hours;\n\n                        //     var solo_percent = 100 - (slide_value/100);\n\n\n\n                        //     var changme = slider_value - (vm.package_split.remaining_ratio * 100);\n                        //     if(changeme > 0){\n                        //         //then we are decreasing solo and increasing dual\n\n\n                        //     } else {\n                        //         //then we are increasing solo and decreasing dual\n                        //     }\n\n\n                        // }\n\n                        vm.change_package = {};\n\n                        vm.calculate_change = function(new_percent=0) {\n\n                            // output.innerHTML = \"slider percentage: \"+Number(slider.value).toFixed(2)+\"%\";\n\n                              ////console.log(\"CHANGE\");\n\n                            var slider_val = (new_percent > 0) ? new_percent : vm.change_package.slider_value;\n\n                            vm.change_package.dual_percent = slider_val/100;\n                            vm.change_package.dual_hours = ( vm.change_package.dual_percent * vm.change_package.remaining_price ) / vm.change_package.initial_dual_price;\n\n                            // var solo_percent = 100 - (slider_val/100);\n\n                            vm.change_package.dual_price = vm.change_package.dual_percent * vm.change_package.remaining_price;\n\n                            if(vm.change_package.dual_price >= vm.change_package.remaining_price){\n\n                               vm.change_package.dual_price = vm.change_package.remaining_price;\n                               vm.change_package.dual_hours = vm.change_package.dual_price / vm.change_package.initial_dual_price;\n\n                            }\n\n                            vm.change_package.remaining_solo_hours = (vm.change_package.remaining_price - vm.change_package.dual_price) / vm.change_package.initial_solo_price; \n                            \n                            console.log(\"CHANGE CALC??\", vm.change_package);\n                            vm.change_package.solo_number = vm.change_package.remaining_solo_hours;\n                            vm.change_package.dual_number = vm.change_package.dual_hours;\n\n                            // dual.innerHTML = \"DUAL: \"+Number(dual_hours).toFixed(2)+\" hours\"; // Display the default slider value\n                            // dual_price_div.innerHTML = \"DUAL: \"+Number(dual_price).toFixed(2);\n                            \n                            // vm.change_package.dual_number = dual_hours;\n\n                            vm.change_package.solo_price = (vm.change_package.remaining_solo_hours * vm.change_package.initial_solo_price);\n\n                            // solo.innerHTML = \"SOLO: \"+Number(remaining_solo_hours).toFixed(2)+\" hours\"; // Display the default slider value\n                            // solo_number.value = remaining_solo_hours;\n                            // solo_price_div.innerHTML = \"SOLO: \"+Number(solo_price).toFixed(2);\n\n\n                            // price_total.innerHTML = \"TOTAL: \"+Number(solo_price + dual_price).toFixed(2);\n\n                        }\n\n\n                        vm.show_package_change = function(pack_obj){\n                            console.log(pack_obj);\n\n                            vm.show_package_popup = true;\n\n                            var slider = document.getElementById(\"myRange\");\n\n                            vm.change_package.id = pack_obj.id;\n                            vm.change_package.price = pack_obj.price;\n                            // vm.change_package.hours_dual = pack_obj.hours_dual;\n                            // vm.change_package.hours_solo = pack_obj.hours_solo;\n                            // vm.change_package.dual_hours = pack_obj.hours_dual;\n                            // vm.change_package.solo_hours = pack_obj.hours_solo;\n\n                            vm.change_package.hours_dual = pack_obj.remaining_hours_dual;\n                            vm.change_package.hours_solo = pack_obj.remaining_hours_solo;\n                            vm.change_package.dual_hours = pack_obj.remaining_hours_dual;\n                            vm.change_package.solo_hours = pack_obj.remaining_hours_solo;\n\n\n                            // vm.change_package.dual_percent = pack_obj.hours_solo;\n                            vm.change_package.difference = pack_obj.difference;\n                            vm.change_package.hours_dual_remaining = pack_obj.remaining_hours_dual;\n                            vm.change_package.hours_solo_remaining = pack_obj.remaining_hours_solo;\n\n                            vm.change_package.solo_number = pack_obj.remaining_hours_solo;\n                            vm.change_package.dual_number = pack_obj.remaining_hours_dual;\n                            //console.log(\"vm.change_package.dual_number : \", vm.change_package.dual_number);\n\n                            vm.change_package.base = (vm.change_package.price - (vm.change_package.difference * vm.change_package.hours_dual) ) / (vm.change_package.hours_dual + vm.change_package.hours_solo);\n                            vm.change_package.initial_dual_price = vm.change_package.base + vm.change_package.difference;\n                            if(vm.change_package.hours_solo > 0){\n                                vm.change_package.initial_solo_price = ((vm.change_package.price - (vm.change_package.initial_dual_price * vm.change_package.hours_dual)) / vm.change_package.hours_solo);\n                            } else {\n                                vm.change_package.initial_solo_price = vm.change_package.base;\n                            }\n                            // var price_ratio = initial_dual_price / initial_solo_price;\n                            vm.change_package.remaining_price = (vm.change_package.hours_dual_remaining * vm.change_package.initial_dual_price) + (vm.change_package.hours_solo_remaining * vm.change_package.initial_solo_price);\n\n                            // var hour_ratio = hours_dual / hours_solo;\n                            vm.change_package.remaining_ratio = (vm.change_package.initial_dual_price * vm.change_package.hours_dual_remaining) / vm.change_package.remaining_price;//hours_dual_remaining / (hours_solo_remaining + hours_dual_remaining);\n\n                            vm.change_package.slider_value = (vm.change_package.remaining_ratio * 100);\n\n                            //hello visuals\n                            // var output = document.getElementById(\"demo\");\n                            // var solo = document.getElementById(\"solo\");\n                            // var dual = document.getElementById(\"dual\");\n                            // var solo_price_div = document.getElementById(\"solo_price\");\n                            // var dual_price_div = document.getElementById(\"dual_price\");\n                            // var price_total = document.getElementById(\"price_total\");\n                            // var dual_number = document.getElementById(\"dual_number\");\n                            // var solo_number = document.getElementById(\"solo_number\");\n\n                            // solo_number.value = hours_solo_remaining;\n                            // solo_number.max = remaining_price / initial_solo_price;\n                            // dual_number.value = hours_dual_remaining;\n                            // dual_number.max = remaining_price / initial_dual_price;\n\n\n                            // output.innerHTML = \"slider percentage: \"+slider.value+\"%\"; // Display the default slider value\n                            // dual.innerHTML = \"DUAL: \"+hours_dual_remaining; // Display the default slider value\n                            // solo.innerHTML = \"SOLO: \"+hours_solo_remaining; // Display the default slider value\n                            // price_total.innerHTML = \"REMAINING FUNDS: \"+remaining_price;\n\n                            var percent = 0;\n\n\n                            // Update the current slider value (each time you drag the slider handle)\n                            // slider.oninput = calculate_change();\n                            \n\n                            //uncomment the calc\n                            vm.calculate_change();\n\n                        }\n                        \n\n                        vm.hide_package_change = function(){\n                            vm.show_package_popup = false;\n                        }\n\n                        vm.refund_package_to_credit = function(){\n                            vm.show_loading = true;\n                            var check = confirm(\"Are you sure you wish to refund this package? This is irreversible!\");\n                            if(check){\n\n                                 PackageService.RefundPackageToAccount(vm.change_package.id)\n                                     .then(function (data) {\n                                        //console.log(data);\n                                        if(data.success) {\n                                            vm.packages = data.items;\n                                            vm.show_package_popup = false;\n                                            vm.show_loading = false;\n                                        } else {\n                                            alert(\"an error happened - please try again\");\n                                            vm.show_package_popup = false;\n                                            vm.show_loading = false;\n                                        }\n                                        \n\n                                    });\n\n                            } else {\n                                return false;\n                            }\n                           \n                        }\n\n                        vm.save_package_change = function(){\n                            vm.show_loading = true;\n\n                            var obj = {\n                                \"remaining_hours_dual\": vm.change_package.dual_number,\n                                \"remaining_hours_solo\": vm.change_package.solo_number\n                            };\n\n                            PackageService.SwapPackageHours(vm.change_package.id, obj)\n                             .then(function (data) {\n                                //console.log(data);\n                                if(data.success) {\n                                    vm.packages = data.items;\n                                    vm.show_package_popup = false;\n                                } else {\n                                    alert(\"an error happened - please try again\");\n                                    vm.show_package_popup = false;\n                                }\n                            vm.show_loading = false;\n\n                            });\n\n                        }\n\n                        vm.change_numbers = function(solo_dual){\n                            console.log(\"CHANGE NUMBER\");\n                            val = 0;\n                            if(solo_dual == 'solo'){\n\n                                if( vm.change_package.solo_number > (vm.change_package.remaining_price / vm.change_package.initial_solo_price) ){\n                                    vm.change_package.solo_number = (vm.change_package.remaining_price / vm.change_package.initial_solo_price);\n                                    val = 0;\n                                } else if(vm.change_package.solo_number >= 0) {\n                                    val = 1 - ((vm.change_package.solo_number * vm.change_package.initial_solo_price) / vm.change_package.remaining_price); // (remaining_hours - solo_number.value) / remaining_hours;\n                                    ////console.log(\"SOLO: \", val);\n                                } else {\n                                    val = 1;\n                                }\n\n                            } else {\n\n                                if( vm.change_package.dual_number > (vm.change_package.remaining_price / vm.change_package.initial_dual_price) ){\n                                    vm.change_package.dual_number = (vm.change_package.remaining_price / vm.change_package.initial_dual_price);\n                                    val = 1;\n                                } else if(vm.change_package.dual_number >= 0) {\n                                    val = (vm.change_package.dual_number * vm.change_package.initial_dual_price) / vm.change_package.remaining_price;\n                                } else {\n                                    val = 0;\n                                }\n\n\n                            }\n                            vm.change_package.percent = (val * 100);\n                            vm.change_package.slider_value = vm.change_package.percent;\n                            vm.calculate_change(vm.change_package.percent);\n                        }\n\n\n                        \n\n\n\n                        // vm.convert_decimal_to_hours = function(decimal_time){\n                        //     var temp = new Array();\n                        //     temp = decimal_time.toString().split('.');\n                            \n                        //     var hours = temp[0];\n                        //     if(hours < 10){\n                        //         hours = \"0\"+hours;\n                        //     }\n                        //     if(temp[1]){\n                        //        var minutes = 100 / temp[1];\n                        //         minutes = Math.round(60 / minutes); \n\n                        //         if(minutes < 10){\n                        //             minutes = \"0\"+minutes;\n                        //         }\n                        //     } else {\n                        //         minutes = \"00\"\n                        //     }\n\n                        //     return hours + ':' + minutes;\n                        // }\n\n                        vm.convert_decimal_to_hours = function(number){\n            \n                            var sign = (number >= 0) ? 1 : -1;\n\n                            // Set positive value of number of sign negative\n                            number = number * sign;\n\n                            // Separate the int from the decimal part\n                            var hour = Math.floor(number);\n                            var decpart = number - hour;\n\n                            var min = 1 / 60;\n                            // Round to nearest minute\n                            decpart = min * Math.round(decpart / min);\n\n                            var minute = Math.floor(decpart * 60) + '';\n\n                            // Add padding if need\n                            if (minute.length < 2) {\n                            minute = '0' + minute; \n                            }\n\n                            // Add Sign in final result\n                            sign = sign == 1 ? '' : '-';\n\n\n                            if(minute == 60){\n                                hour = hour+1;\n                                minute = '00';\n                            }\n\n\n                            // Concate hours and minutes\n                            var time = sign + hour + ':' + minute;\n\n                            return time;\n\n                        }\n                        \n\n                        vm.show_add_credit = false;    \n                        vm.add_credit = function(){\n                                \n                            //show the add credit for the user.\n                            vm.show_add_credit = true;\n\n                        }\n\n                        vm.close_credit = function(){\n                            vm.show_add_credit = false;\n                        }\n\n                        vm.apply_credit = function(){\n                            //create the negative invoice.\n                            vm.show_loading = true;\n\n                              \n \n                            var obj_to_send = {\n                                    items: [{ \n                                        quantity: 1,\n                                        price: -vm.add_credit_amount,\n                                        title: vm.add_credit_note,\n                                        vat: 0,\n                                        is_credit_from_admin: 1\n                                }\n                                ],\n                              user: {user_id: vm.club.member.user_id},\n                              club_id: vm.club_id,\n                              payment: {direct_debit: true},\n                              credit_only: 1\n                            };\n\n\n                            // SAMPLE OF WHERE WE NEED TO SEND THE SHIZZLE....\n                            PaymentService.CreateCustom(obj_to_send)\n                            .then(function (data) {\n                                if(data.success){\n\n                                    ////console.log(\"CARD: \"+data);\n                                    //fill the drop down menu\n                                    //$state.go('dashboard.my_account.payment_methods', {}, { reload: true });\n                                     UserService.GetInvoicesUserClub(vm.club.member.user_id, vm.club_id, vm.current_invoice_offset, vm.loaded_per_batch, 0)\n                                    .then(function (data) {\n                                           vm.invoices = data.invoices;\n                                           vm.upcoming = data.upcoming;\n\n\n                                            vm.add_credit_amount = 0;\n                                            vm.add_credit_note = \"\";\n                                            vm.show_add_credit = false;    \n                                            vm.show_loading = false;\n\n                                        });\n\n                                   \n\n                                } else {\n                                    //console.log(\"WOOOPSIES...\", data);\n                                    //this should be very very rare...\n                                    vm.show_loading = false;\n\n                                }\n                            });\n\n\n\n\n                            \n\n\n\n\n                        }\n\n\n                        //planes/get_user_journey_log/:user_id/:club_id\n                        \n                        vm.current_offset = 0;\n                        vm.current_invoice_offset = 0;\n                        vm.loaded_per_batch = 5;\n                        vm.all_loaded = false;\n                        vm.all_invoices_loaded = false;\n\n                        PlaneService.GetUserJourneyLogs(vm.club.member.user_id, vm.club_id, vm.current_offset, vm.loaded_per_batch)\n                        .then(function (data) {\n                            // //console.log(data);\n                            vm.logs = data.logs;\n                        });\n\n                         // invoices/get_all_upcoming_for_user_by_club/:user_id/:club_id\n                        \n                        UserService.GetInvoicesUserClub(vm.club.member.user_id, vm.club_id, vm.current_invoice_offset, vm.loaded_per_batch, 0)\n                        .then(function (data) {\n                               vm.invoices = data.invoices;\n                               vm.upcoming = data.upcoming;\n                            });\n\n\n\n\n\n                        vm.load_more = function(){\n                            vm.current_offset = vm.current_offset + vm.loaded_per_batch;\n                            PlaneService.GetUserJourneyLogs(vm.club.member.user_id, vm.club_id, vm.current_offset, vm.loaded_per_batch)\n                            .then(function (data) {\n                                    if(data.logs.length > 0){\n                                        data.logs.forEach(log => vm.logs.push(log));\n                                    } else {\n                                        vm.all_loaded = true;\n                                    }\n                                   //vm.logs = data.logs;\n\n\n                                });\n\n                        }\n\n\n                        vm.load_more_invoices = function(){\n                            vm.current_invoice_offset = vm.current_invoice_offset + vm.loaded_per_batch;\n                        UserService.GetInvoicesUserClub(vm.club.member.user_id, vm.club_id, vm.current_invoice_offset, vm.loaded_per_batch, 1)\n                            .then(function (data) {\n                                    if(data.invoices.length > 0){\n                                        data.invoices.forEach(invoice => vm.invoices.push(invoice));\n                                    } else {\n                                        vm.all_invoices_loaded = true;\n                                    }\n                                   //vm.logs = data.logs;\n\n\n                                });\n\n                        }\n\n                        vm.get_initial = function(text){\n                            return text.charAt(0);\n                        }\n\n                        vm.clean_times = function(time){\n                            if(time == \"00:00:00\"){\n                                return \" - \";\n                            }\n                            return time.substring(0,5);\n                        }\n\n                         $scope.get_hours_from_decimal = function(time){\n\n                            if(time){\n                                 var sign = time < 0 ? \"-\" : \"\";\n                                 var hour = Math.floor(Math.abs(time));\n                                 var min = Math.floor((Math.abs(time) * 60) % 60);\n                                 if(min == 60){\n                                     hour++;\n                                     min = 0;\n                                 }\n                                 return sign + (hour < 10 ? \"0\" : \"\") + hour + \":\" + (min < 10 ? \"0\" : \"\") + min;\n                             } else {\n                                 return \"N/A\";\n                             }\n                        }\n\n\n\n\n\n\n\n\n\n\n                        vm.club.member.instructor = (vm.club.member.instructor == 1) ? true : false;\n                        //vm.club.member.membership_start = Date.parse(vm.club.member.membership_start);\n                        vm.page_title = \"Edit a Member - \"+vm.club.member.first_name+\" \"+vm.club.member.last_name;\n\n                        vm.club.member.membership_start = new Date(vm.club.member.membership_start);\n\n                        MemberService.GetMemberPlanes(vm.club.member.user_id, vm.club_id)\n                        .then(function(data){\n                            vm.club.planes = data;   \n                            //console.log(vm.club.planes);\n                        });\n\n                        // $(\"#membership_start\").datepicker({\n                        //     format: 'dd-mm-yyyy',\n                        //     startDate: vm.club.member.membership_start,\n                        //     endDate: ''\n                        //   }).on(\"show\", function() {\n                        //     $(this).val(new Date()).datepicker('update');\n                        //   });\n\n                    });\n\n                 MembershipService.GetAllByClub(vm.club_id)\n                    .then(function(data){\n                        vm.club.memberships = data;   \n                        // vm.club.member.membership_id.selected = vm.club.member.membership_id;\n                        // vm.membership = vm.club.member.membership_name;\n                        // vm.club.membership = vm.club.member.membership_name;\n                        //console.log(vm.club.memberships);\n                    });\n            break;\n            case \"list\":\n                //need to update this to be part of the authentication\n                //to find out club id\n                MemberService.GetAllByClub(vm.club_id)\n                    .then(function(data){\n                        vm.club.members = data;   \n                        //console.log(vm.club.members);\n                    });\n\n                 MembershipService.GetAllByClub(vm.club_id)\n                    .then(function(data){\n                        vm.club.memberships = data;   \n                        // vm.club.member.membership_id.selected = vm.club.member.membership_id;\n                        // vm.membership = vm.club.member.membership_name;\n                        // vm.club.membership = vm.club.member.membership_name;\n                        //console.log(vm.club.memberships);\n                    });\n                $scope.checkAll = function () {\n                    //console.log(\"check all\");\n                    if ($scope.selectedAll) {\n                        $scope.selectedAll = true;\n                    } else {\n                        $scope.selectedAll = false;\n                    }\n                    angular.forEach(vm.club.members, function(member) {\n                        member.selected = $scope.selectedAll;\n                    });\n                };\n\n\n            break;\n            default:\n                //console.log(\"none of the above... redirect somewhere?\");\n            break;\n        }  \n\n        //'9' needs to refer the the user's account set to manage\n       \n        $scope.back = function(){\n            $window.history.back();\n        }\n\n        $scope.save = function(){\n            if(vm.action == \"add\"){\n                // //console.log(\"CREATE click\");\n                $scope.create();\n            } else {\n                // //console.log(\"EDIT click\");\n                // //console.log(vm.club.membership);\n                $scope.update();\n            }\n        }\n\n        $scope.search = function(row){\n            ////console.log(\"hi\", (angular.lowercase(row.invoice_number).indexOf(angular.lowercase($scope.my_search) || '') !== -1));\n            return ( (angular.lowercase(row.invoice_number).indexOf(angular.lowercase($scope.my_search) || '') !== -1) || \n                    (angular.lowercase(row.club_title).indexOf(angular.lowercase($scope.my_search) || '') !== -1) ||\n                    (angular.lowercase(row.created_at.toString()).indexOf(angular.lowercase($scope.my_search) || '') !== -1) ||\n                    (angular.lowercase(row.total.toString()).indexOf(angular.lowercase($scope.my_search) || '') !== -1) ||\n                    (angular.lowercase(row.status).indexOf(angular.lowercase($scope.my_search) || '') !== -1) );\n        };\n\n        $scope.show_more = function(index){\n\n\n            vm.invoices[index].show_more = (vm.invoices[index].show_more)? false : true;\n\n\n        }\n\n\n        // $scope.readCSV = function() {\n        //     // http get request to read CSV file content\n        //     $http.get('/angular/sample.csv').success($scope.processData);\n        // };\n\n\n        $scope.csvToJSON = function(content) {\n                var lines=content.csv.split(/\\r\\n|\\n/);\n                var result = [];\n                var start = 0;\n                lines[0] += \",membership_id,membership_start,selected\";\n                for (var j=1; j<lines.length; j++) {\n                    lines[j] += \",membership_id,membership_start,true\";\n                }\n                var columnCount = lines[0].split(content.separator).length;\n\n                var headers = [];\n                if (content.header) {\n                    headers=lines[0].split(content.separator);\n                    vm.imported_headers = headers;\n                    start = 1;\n                }\n\n                for (var i=start; i<lines.length; i++) {\n                    var obj = {};\n                        var currentline=lines[i].split(new RegExp(content.separator+'(?![^\"]*\"(?:(?:[^\"]*\"){2})*[^\"]*$)'));\n                        if ( currentline.length === columnCount ) {\n                            if (content.header) {\n                                for (var j=0; j<headers.length; j++) {\n                                    obj[headers[j]] = currentline[j];\n                                }\n                            } else {\n                                for (var k=0; k<currentline.length; k++) {\n                                    obj[k] = currentline[k];\n                                }\n                            }\n                            result.push(obj);\n                        }\n                   \n                }\n\n                //result = $scope.toPrettyJSON(result, 2);\n                //console.log(result);\n\n                return result;\n            };\n\n       \n        vm.apply_default_memberships = function(){\n\n\n             for(var b=0;b<vm.imported_users.length;b++){\n\n                if(!vm.imported_users[b].membership || vm.imported_users[b].membership == {} || vm.imported_users[b].membership == \"\"){\n                    vm.imported_users[b].membership_id = vm.default_membership.id;\n                    vm.imported_users[b].membership = vm.default_membership;\n                }\n               \n             }\n\n        }\n\n\n        function parseLooseDate(input, opts) {\n          opts = opts || {};\n          var prefer = opts.prefer || \"DMY\"; // default to UK style\n          var useUTC = !!opts.utc;\n\n          if (input == null) return null;\n\n          // Already a Date?\n          if (Object.prototype.toString.call(input) === \"[object Date]\") {\n            return isNaN(input.getTime()) ? null : new Date(input.getTime());\n          }\n\n          // Timestamp?\n          if (typeof input === \"number\" && isFinite(input)) {\n            var dNum = new Date(input);\n            return isNaN(dNum.getTime()) ? null : dNum;\n          }\n\n          var s = String(input).trim();\n          if (!s) return null;\n\n          // Try native ISO-ish first (safe formats like 2025-01-06, 2025-01-06T12:34:56Z)\n          // BUT avoid native parsing for ambiguous slash formats like 01/02/2025.\n          var looksAmbiguousSlash = /^\\d{1,2}[\\/. -]\\d{1,2}[\\/. -]\\d{2,4}(\\s+.*)?$/.test(s);\n          if (!looksAmbiguousSlash) {\n            var native = new Date(s);\n            if (!isNaN(native.getTime())) return native;\n          }\n\n          // Normalize separators to \"/\"\n          s = s.replace(/[.\\-]/g, \"/\").replace(/\\s+/g, \" \").trim();\n\n          // Split date and time\n          var parts = s.split(\" \");\n          var datePart = parts[0];\n          var timePart = parts.slice(1).join(\" \").trim(); // ignore timezone words here\n\n          var d = datePart.split(\"/\");\n          if (d.length !== 3) return null;\n\n          // Parse ints\n          var a = parseInt(d[0], 10);\n          var b = parseInt(d[1], 10);\n          var c = parseInt(d[2], 10);\n\n          if (![a, b, c].every(function (n) { return isFinite(n); })) return null;\n\n          // Expand 2-digit years (00-69 => 2000-2069, 70-99 => 1970-1999)\n          function normalizeYear(y) {\n            if (y >= 0 && y <= 99) return (y <= 69) ? (2000 + y) : (1900 + y);\n            return y;\n          }\n\n          var year, month, day;\n\n          // Detect yyyy/mm/dd (or yyyy/dd/mm if someone did that  we only accept yyyy first)\n          if (d[0].length === 4) {\n            year = a;\n            month = b;\n            day = c;\n          } else if (d[2].length === 4) {\n            year = c;\n            // decide between DMY and MDY for a/b\n            // If one is > 12, it's forced.\n            if (a > 12 && b <= 12) { day = a; month = b; }\n            else if (b > 12 && a <= 12) { month = a; day = b; }\n            else {\n              // ambiguous: both <= 12\n              if (prefer === \"MDY\") { month = a; day = b; }\n              else { day = a; month = b; } // DMY default\n            }\n          } else {\n            // No 4-digit year found; accept 2-digit year at end\n            year = normalizeYear(c);\n            if (a > 12 && b <= 12) { day = a; month = b; }\n            else if (b > 12 && a <= 12) { month = a; day = b; }\n            else {\n              if (prefer === \"MDY\") { month = a; day = b; }\n              else { day = a; month = b; }\n            }\n          }\n\n          // Basic range checks\n          if (!(year >= 1 && year <= 9999)) return null;\n          if (!(month >= 1 && month <= 12)) return null;\n          if (!(day >= 1 && day <= 31)) return null;\n\n          // Time (optional)\n          var hh = 0, mm = 0, ss = 0;\n          if (timePart) {\n            // accept HH:mm or HH:mm:ss (ignore trailing timezone text)\n            var mTime = timePart.match(/^(\\d{1,2}):(\\d{2})(?::(\\d{2}))?/);\n            if (mTime) {\n              hh = parseInt(mTime[1], 10);\n              mm = parseInt(mTime[2], 10);\n              ss = mTime[3] ? parseInt(mTime[3], 10) : 0;\n              if (hh > 23 || mm > 59 || ss > 59) return null;\n            }\n          }\n\n          // Construct date\n          var dt = useUTC\n            ? new Date(Date.UTC(year, month - 1, day, hh, mm, ss, 0))\n            : new Date(year, month - 1, day, hh, mm, ss, 0);\n\n          // Validate (catches invalid dates like 31/02/2025)\n          var y2 = useUTC ? dt.getUTCFullYear() : dt.getFullYear();\n          var m2 = (useUTC ? dt.getUTCMonth() : dt.getMonth()) + 1;\n          var d2 = useUTC ? dt.getUTCDate() : dt.getDate();\n\n          if (y2 !== year || m2 !== month || d2 !== day) return null;\n\n          return dt;\n        }\n\n        vm.change_header = function(index, h){\n           \n            if(vm.imported_new_headers[index] == \"membership_start\"){\n\n\n\n                for(var b=0;b<vm.imported_users.length;b++){\n\n                    try{\n                       var parse_me =  parseLooseDate(vm.imported_users[b][h]);\n                      // console.log(\"value: \", parse_me.toISOString());\n                       if(!vm.imported_users[b].membership_start || vm.imported_users[b].membership_start == {} || vm.imported_users[b].membership_start == \"\" || !vm.imported_users[b].membership_start.getTime()){\n                           //console.log(vm.imported_users[b].membership_start.getTime());\n                           vm.imported_users[b].membership_start = new Date(parse_me.toISOString());\n                       }\n\n                    } catch(e){\n                        console.log(\"didnt parse, \", e);\n                    }\n                    \n                \n                }\n            }\n\n        }\n\n        vm.apply_default_start = function(){\n\n\n\n\n             \n\n        }\n\n        function stripDoubleQuotes(str) {\n          if (typeof str !== 'string') return str;\n          return str.replace(/\"/g, '');\n        }\n\n        $scope.processData = function() {\n            //get the stuff\n            //allText = vm.import_users;\n            var tobesorter = {\n                csv: vm.import_users,\n                separator: \",\",\n                header: true\n            }\n            var test_mode = true;\n            var test_e = \"a\";\n            var test_mail = \"@toaviate.com\";\n\n            vm.imported_users = $scope.csvToJSON(tobesorter);\n\n             for(var b=0;b<vm.imported_users.length;b++){\n\n\n\n                if(test_mode){\n                   vm.imported_users[b].matching = vm.imported_users[b].email;\n                   vm.imported_users[b].email = test_e + b + test_mail;\n                }\n\n\n                if(vm.imported_users[b].membership_start){\n                    vm.imported_users[b].membership_start = new Date(vm.imported_users[b].membership_start);\n                } else {\n                    vm.imported_users[b].membership_start = new Date();\n                }\n\n\n                \n                //below set the default membership perhaps?\n\n\n\n\n\n                //vm.imported_users[b].membership = { membership_id: 4, membership_name: \"Annual Membership\" };\n            }\n\n            // split content based on new line\n            // var allTextLines = allText.split(/\\r\\n|\\n/);\n            // var headers = allTextLines[0].split(',');\n            // var lines = [];\n\n            // for ( var i = 0; i < allTextLines.length; i++) {\n            //     // split content based on comma\n            //     var data = allTextLines[i].split(',');\n            //     if (data.length == headers.length) {\n            //         var tarr = [];\n            //         for ( var j = 0; j < headers.length; j++) {\n            //             tarr.push(data[j]);\n            //         }\n            //         lines.push(tarr);\n            //     }\n            // }\n            // $scope.data = lines;\n        };\n       \n\n        vm.user_columns = {\n            first_name: \"First Name\", \n            last_name: \"Last Name\", \n            email: \"Email Address\",\n            dob: \"Date of Birth\",\n            membership_number: \"Membership Number\", \n            membership_start: \"Membership Start Date\",\n            membership_id: \"Membership Name\",\n            matching_email: \"Matching Email\"\n        };\n\n\n        $scope.import_column = function(name){\n            // //console.log(\"update the field\");\n            // for(var i = 0; i < vm.imported_users.length; i++){\n            //     var original_val = vm.imported_users[i][name];\n            //     delete vm.imported_users[i][name];\n            //     vm.imported_users[i][vm.change_col_to] = original_val;\n            //     //console.log(vm.imported_users[i]);\n            // }\n\n        }\n\n        vm.member_check = [];\n\n        function check_member_requirements(){\n\n            var poid = 0;\n            var medical = 0;\n            var licence = 0;\n            var differences = 0;\n            for(var i=0;i<vm.member_check.length;i++){\n\n\n                var a = vm.member_check[i].type;\n\n                switch(a){\n                    case 'poid':\n                        poid++;\n                    break;\n                    case 'medical':\n                        medical++;\n                    break;\n                    case 'licence':\n                        licence++;\n                    break;\n                    case 'difference':\n                        difference++;\n                    break;\n                }\n            }   \n\n            if(poid > 0 && medical > 0 && licence > 0){\n                //TODO\n                //then we now need to check if they're not expired?\n                //then we know that the user is actually 100% valid.\n\n                vm.club.member.approved = 1;\n\n            }\n\n        }\n\n\n        $scope.update_verification = function(type, obj, val){\n\n            //console.log(\"UPDATE VERIFICATION ON : \"+type+\" WITH obj: \", obj);\n            vm.member_check.push({\"type\": type, \"obj\": obj});\n\n            var verify = {\n                \"check_type\": type,\n                \"user_id\": vm.club.member.user_id,\n                \"club_id\": vm.club_id,\n                \"check_id\": obj.id,\n                \"verified\": val\n            };\n\n            MemberService.Verify(verify)\n                .then(function(data){\n                    // //console.log(data);\n            });\n\n            //call the put request here\n\n            check_member_requirements();\n\n        }\n\n\n        $scope.import_users = function(){\n            //console.log(\"import some users now\");\n\n\n            //first let's ignore the ones that weren't in the list\n            vm.imported_users = $.grep(vm.imported_users, function(e){ \n                    return e.selected != \"false\"; \n            });\n\n           \n            // //console.log(vm.imported_users);\n            // //console.log(vm.imported_headers);\n            // //console.log(vm.imported_new_headers);\n\n            //we need to verify that at least first name and last name in addition to email is present in the columns selected.\n            if(vm.imported_new_headers.indexOf(\"first_name\") > -1 && vm.imported_new_headers.indexOf(\"last_name\") > -1 && vm.imported_new_headers.indexOf(\"email\") > -1){\n                // //console.log(\"ALL HEADERS HERE ! YAY!\");\n                \n                for(var b=0;b<vm.imported_users.length;b++){\n                    if(vm.imported_users[b].membership){\n                        if(vm.imported_users[b].membership.membership_id){\n                            vm.imported_users[b][\"membership_id\"] = vm.imported_users[b].membership.id;\n                            delete vm.imported_users[b].membership;\n                        }\n                    }\n                }\n\n                // //console.log(\"===--->===\");\n                // //console.log(vm.imported_users);\n                // //console.log(\"===--->===\");\n\n                vm.imported_new_headers.push(\"membership_id\");\n                vm.imported_new_headers.push(\"membership_start\");\n\n                //now we generate the users with the correct headings for our tables\n                var to_import_users = [];\n                for(var d=0; d<vm.imported_users.length;d++){\n                    var obj = {\n                        user: {},\n                        club_id: vm.club_id\n                    };\n                    for(var c=0; c<vm.imported_new_headers.length;c++){\n                        if(vm.imported_new_headers[c]){\n                            // //console.log(vm.imported_new_headers[c]);\n                            if(vm.imported_new_headers[c] == \"first_name\" || vm.imported_new_headers[c] == \"last_name\" || vm.imported_new_headers[c] == \"dob\" || vm.imported_new_headers[c] == \"email\"){\n                                obj[\"user\"][vm.imported_new_headers[c]] = vm.imported_users[d][Object.keys(vm.imported_users[d])[c]];\n                            } else {\n                                if(vm.imported_new_headers[c] == \"membership_start\" || vm.imported_new_headers[c] == \"membership_id\"){\n                                    obj[vm.imported_new_headers[c]] = vm.imported_users[d][vm.imported_new_headers[c]];\n                                } else {\n                                    obj[vm.imported_new_headers[c]] = vm.imported_users[d][Object.keys(vm.imported_users[d])[c]];\n                                }\n                            }\n                            //we can push this into a new object with new key!\n                        } else {\n                            //we ignore this one...\n                            //console.log(\"blank\");\n                        }\n                    }\n                    to_import_users.push(obj);\n                }\n                // //console.log(\"--==--\");\n                // //console.log(to_import_users);\n                // //console.log(\"--==--\");\n\n                //now that we have what we want to add to our \n                MemberService.CreateMany(to_import_users)\n                .then(function(data){\n                    // //console.log(data);\n                    $state.go('dashboard.manage_club.members');\n                });\n\n            } else {\n                //console.log(\"missing key elements in headers!\");\n                alert(\"You must select the First Name, Last Name and Email Address to be able to add the user to the system!\");\n            }\n        \n\n\n        }\n\n        vm.sa_dual = false;\n        vm.sa_solo = false;\n        vm.sa_instruct = false;\n\n        vm.select_all = function(select_all_what){\n            if(select_all_what == \"dual\"){\n                for(var i = 0; i < vm.club.planes.length; i++){\n                    vm.club.planes[i].book_dual = 1;\n                    vm.sa_dual = true;\n                }\n            } else if(select_all_what == \"solo\"){\n                for(var i = 0; i < vm.club.planes.length; i++){\n                    vm.club.planes[i].book_solo = 1;\n                    vm.sa_solo = true;\n                }\n            } else if(select_all_what == \"instruct\"){\n                for(var i = 0; i < vm.club.planes.length; i++){\n                    vm.club.planes[i].instruct = 1;\n                    vm.sa_instruct = true;\n                }\n            }\n        }\n\n        vm.deselect_all = function(select_all_what){\n            if(select_all_what == \"dual\"){\n                for(var i = 0; i < vm.club.planes.length; i++){\n                    vm.club.planes[i].book_dual = 0;\n                    vm.sa_dual = false;\n                }\n            } else if(select_all_what == \"solo\"){\n                for(var i = 0; i < vm.club.planes.length; i++){\n                    vm.club.planes[i].book_solo = 0;\n                    vm.sa_solo = false;\n                }\n            } else if(select_all_what == \"instruct\"){\n                for(var i = 0; i < vm.club.planes.length; i++){\n                    vm.club.planes[i].instruct = 0;\n                    vm.sa_instruct = false;\n                }\n            }\n        }\n\n\n\n        $scope.create = function(){\n            //console.log(\"CREATE ME NOW\");\n            vm.club.member.club_id = vm.club_id;\n            MemberService.Create(vm.club.member)\n                .then(function(data){\n                    //console.log(data);\n                    $state.go('dashboard.manage_club.members');\n                });\n        }\n\n        //this should be admin / instructor only\n        $scope.invite_member = function(){\n\n                vm.club.member.club_id = vm.club_id;\n\n                MemberService.send_invite_by_club(vm.club.member)\n                    .then(function(data){\n                        ////console.log(data);\n                        $state.go('dashboard.manage_club.members');\n                    });\n\n        }\n\n        $scope.delete = function(){\n            //console.log(\"CLICK\");\n            alert(\"Are you sure you would like to delete this membership?\");\n            MemberService.Update(vm.club.membership)\n                .then(function(data){\n                   // //console.log(data);\n                });\n        }\n\n        $scope.update = function(){\n            //console.log(\"CLICK\");\n            vm.club.member.club_id = vm.club_id;\n\n            var process_member_start_dt = new Date(vm.club.member.membership_start);\n            if(!process_member_start_dt.isValid){\n                process_member_start_dt = new Date();\n            }\n\n\n            vm.club.member.membership_start = process_member_start_dt; //.toISOString().split('T')[0];\n           \n            // console.log(vm.club.member);\n            // return false;\n\n            MemberService.Update(vm.club.member)\n                        .then(function(data){\n                            // //console.log(data);\n                            // //console.log(\"saved\");\n                            $state.go('dashboard.manage_club.members');\n                        });\n                        \n            MemberService.SaveMemberPlanes(vm.club.member.user_id, vm.club.member.club_id, vm.club.planes)\n                .then(function(data){\n                    ////console.log(data);\n                    // //console.log(\"saved THE PLANES\");\n                     \n                });\n\n                //         function SaveMemberPlanes(user_id, club_id, planes){\n\n        }\n\n        function refresh_members(){\n\n             MemberService.GetAllByClub(vm.club_id)\n                    .then(function(data){\n                        vm.club.members = data;   \n                        \n                        MembershipService.GetAllByClub(vm.club_id)\n                        .then(function(data){\n                            vm.club.memberships = data;   \n                            return true;\n                        });\n\n                    });\n\n            \n        }\n\n\n        vm.select_member_approval = false;\n        $scope.selected_members = function(type){\n            //get the selected members\n            if(vm.select_member_approval){\n                return false;\n            }\n            vm.show_loading = true;\n            vm.select_member_approval = true;\n\n            //console.log(vm.club.members);\n            vm.selected_members = $.grep(vm.club.members, function(e){ \n                return e.selected == true; \n            });\n            console.log(vm.selected_members);\n\n            //type is the action required...\n            \n\n            for(var j=0;j < vm.selected_members.length; j++){\n\n                if(type == \"approve\"){\n                    vm.selected_members[j].approved = 1;\n                } else {\n                    vm.selected_members[j].approved = 0;\n                }\n                //console.log(\"here\");\n                MemberService.Update(vm.selected_members[j])\n                    .then(function(data){\n                        //console.log(data);\n                        //console.log(\"saved\");\n                    });\n            }\n            console.log(\"refresh members\");\n            //vm.club.members = [];\n            setTimeout(() => {  \n\n                MemberService.GetAllByClub(vm.club_id)\n                .then(function(data){\n                    vm.club.members = data;   \n                    console.log(vm.club.members);\n                    MembershipService.GetAllByClub(vm.club_id)\n                    .then(function(data){\n                        vm.club.memberships = data;   \n                        vm.select_member_approval = false;\n                        vm.show_loading = false;\n                        //$state.go('dashboard.manage_club.members');\n                    });\n\n                });\n\n            }, 1000);\n\n            \n\n\n            // if(refresh_members()){\n            //     vm.select_member_approval = false;\n            //     vm.show_loading = false;\n            // } else {\n            //     alert(\"We failed to update the approval state of the member - please refresh this page\");\n            // }\n\n            \n\n        }\n\n        $scope.update_membership = function(item, model){\n            vm.club.member.membership_id = item.membership_id;\n            vm.club.member.membership_name = item.membership_name;\n        }\n\n        initController();\n\n        function initController() {\n           //console.log(\"check if access is okay\");\n        }\n\n\n        var warning_msg = \"By deleting this membership, you will also cancel all reservations that this membership currently has.\"\n\n\n        function actually_open(id, params, document_type, document_id){\n\n\n\n             var modalInstance = $uibModal.open({\n              animation: true,\n              templateUrl: 'views/modals/check_documents.html',\n              controller: 'ModalInstanceCtrl',\n              size: \"lg\",\n              resolve: {\n                id: function() {\n                  return id;\n                },\n                params: function() {\n                  return params;\n                },\n                warning: function(){\n                    return warning_msg;\n                }\n              }\n            });\n\n\n            modalInstance.result.then(function (params) {\n              $log.info('PRESSED GO: ', params);\n              // alert(\"verified\");\n\n\n               for(var i=0; i<vm[document_type].length; i++){\n                        // //console.log(\"ID\", vm[document_type][i].id);\n                        // //console.log(\"VERI\", vm[document_type][i].verified);\n                        // //console.log(\"DOCU\", document_id);\n                        if(vm[document_type][i].id == document_id && vm[document_type][i].verified != 1){\n                            // //console.log(\"CHECK BELOW : \", vm[document_type][i][\"verified\"]);\n                            // if(vm.poids[i].verified == 0){\n                                vm[document_type][i].verified = 1;\n                                // //console.log(\"HERE\");\n                                var action_name = (document_type == \"differences\")? \"differences\" : document_type.slice(0, -1);\n                                $scope.update_verification(action_name, vm[document_type][i], 1);\n                            // }\n                        }\n                    }   \n\n              switch(document_type){\n                case 'poids':\n                    // vm.poids[0].verified = 0; \n                    // for(var i=0; i<vm.poids.length; i++){\n                    //     //console.log(\"ID\", vm.poids[i].id);\n                    //     //console.log(\"VERI\", vm.poids[i].verified);\n                    //     if(vm.poids[i].id == document_id && vm.poids[i].verified != 1){\n                    //         //console.log(\"CHECK BELOW : \", vm.poids[i][\"verified\"]);\n                    //         // if(vm.poids[i].verified == 0){\n                    //             vm.poids[i].verified = 1;\n                    //             $scope.update_verification('poid', vm.poids[i], 1);\n                    //         // }\n                    //     }\n                    // }   \n\n                break;\n                case 'medicals':\n\n\n                break;\n                case 'licences':\n\n                break;\n                case 'differences':\n\n                break;\n                default:\n                    alert(\"sorry - we didn't recognise the request...\");\n                break;\n            }\n\n\n            }, function () {\n              //alert(\"CLOSED\");\n              $log.info('Modal dismissed at: ' + new Date());\n            });\n\n\n\n        }\n\n\n            vm.show_temp_login = false;\n            vm.show_loading = false;\n\n\n        function create_sample(length) {\n                   var result           = '';\n                   var characters       = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n                   var charactersLength = characters.length;\n                   for ( var i = 0; i < length; i++ ) {\n                      result += characters.charAt(Math.floor(Math.random() * charactersLength));\n                   }\n                   return result;\n                }\n\n\n                $scope.re_login = function(){\n\n\n                      ////console.log(\"CLICKED\", vm.re_login_pass);\n\n                      //now we use the token that has been assigned already to verify the login password\n\n                        AuthenticationService.Login3(vm.re_login_pass, create_sample(120), function (response) {\n                            //console.log(\"resp\", response);\n                            if (response.success) {\n\n\n                                //we now need to call the query that was called before (decryption)\n\n                                //$scope.getDecrypted();\n                               $scope.openDocument(vm.maybe.doc_type, vm.maybe.doc_id);\n\n\n\n                                vm.show_temp_login = false;\n                            } else {\n                                alert(\"This is the wrong password - please try again...\");\n                            }\n                        });\n\n\n\n                      //vm.show_temp_login = true;\n\n                  }\n\n\n\n        $scope.openDocument = function(document_type, document_id) {\n\n            vm.show_loading = true;\n\n            var id = document_id;\n            //document type : poids, medicals, licences, differences\n            var images = [];\n            switch(document_type){\n                case 'poids':\n                    //console.log(\"PROOF OF ID CHECK FOR ID: \", document_id);\n\n                    PoidService.GetById(document_id, 0, 1)\n                        .then(function (data) {\n                            ////console.log(data);\n                            if(data.success){\n                                ////console.log(\"DATA RTN\", data);\n                                images = data.poid.images;\n\n                                var params = {\n                                    document_type: document_type,\n                                    document_id: document_id,\n                                    images: images\n                                };\n                                    vm.show_loading = false;\n\n                                actually_open(id, params, document_type, document_id);\n                            } else {\n                                //this should be very very rare...\n\n\n                                if(data.fail == \"templogin\"){\n                                    ////console.log(\"WOOOPSIES...\", data);\n                                    vm.show_temp_login = true;\n                                     vm.maybe = {\n                                         doc_type: \"poids\",\n                                         doc_id: document_id\n                                     }\n\n                                }\n                                    vm.show_loading = false;\n\n\n\n                            }\n                    });\n\n                break;\n                case 'medicals':\n                    ////console.log(\"MEDICAL CHECK FOR ID: \", document_id);\n\n                    // MedicalService.GetById(document_id, vm.club.member.user_id)\n                    MedicalService.GetById(document_id, 0, 1)\n                        .then(function (data) {\n                            //console.log(data);\n                            if(data.success){\n                                //console.log(\"DATA RTN\", data);\n                                images = data.medical.images;\n\n                                var params = {\n                                    document_type: document_type,\n                                    document_id: document_id,\n                                    images: images\n                                };\n                                    vm.show_loading = false;\n\n                                actually_open(id, params, document_type, document_id);\n                            } else {\n                                ////console.log(\"WOOOPSIES...\");\n                                //this should be very very rare...\n\n                                    vm.show_loading = false;\n\n                                 vm.maybe = {\n                                     doc_type: \"medicals\",\n                                     doc_id: document_id\n                                 }\n\n                                if(data.fail == \"templogin\"){\n                                    //console.log(\"WOOOPSIES...\", data);\n                                    vm.show_temp_login = true;\n                                     vm.maybe = {\n                                         doc_type: \"medicals\",\n                                         doc_id: document_id\n                                     }\n\n                                }\n\n\n                            }\n                    });\n\n                break;\n                case 'licences':\n                    //console.log(\"LICENCE CHECK FOR ID: \", document_id);\n                    LicenceService.GetById(document_id, 0, 1)\n                        .then(function (data) {\n                            //console.log(data);\n                            if(data.success){\n                                //console.log(\"DATA RTN\", data);\n                                images = data.licence.images;\n\n                                var params = {\n                                    document_type: document_type,\n                                    document_id: document_id,\n                                    images: images\n                                };\n                                    vm.show_loading = false;\n\n                                actually_open(id, params, document_type, document_id);\n                            } else {\n                                //console.log(\"WOOOPSIES...\");\n                                //this should be very very rare...\n                                    vm.show_loading = false;\n\n\n                                if(data.fail == \"templogin\"){\n                                    //console.log(\"WOOOPSIES...\", data);\n                                    vm.show_temp_login = true;\n\n                                     vm.maybe = {\n                                         doc_type: \"licences\",\n                                         doc_id: document_id\n                                     }\n\n                                }\n\n\n                            }\n                    });\n\n                break;\n                case 'differences':\n                    //console.log(\"DIFFERENCES CHECK FOR ID: \", document_id);\n\n                                var params = {\n                                    document_type: document_type,\n                                    document_id: document_id,\n                                    images: vm.differences_images\n                                };\n                                //console.log(\"DOCUMENT ID \", document_id);\n                                    vm.show_loading = false;\n                                actually_open(id, params, document_type, document_id);\n\n                break;\n                default:\n                                    vm.show_loading = false;\n                    alert(\"sorry - we didn't recognise the request...\");\n                break;\n            }\n\n\n\n\n           \n        };\n\n        $scope.downloadInvoice = function(id) {\n            // var data = $.param({\n            //     id: doc\n            // });\n\n            //var ddd = doc.replace(/^.*[\\\\\\/]/, '');\n\n            $http.get('api/v1/invoice_pdf/get_ad_hoc_invoice/'+id, {\n                    responseType: 'arraybuffer'\n                })\n                .success(function(data, status, headers) {\n                    var zipName = processArrayBufferToBlob(data, headers);\n\n                    //Delete file from temp folder in server - file needs to remain open until blob is created\n                    //deleteFileFromServerTemp(zipName);\n                }).error(function(data, status) {\n                    alert(\"There was an error downloading the selected document(s).\");\n                })\n        };\n\n        function processArrayBufferToBlob(data, headers) {\n            var octetStreamMime = 'application/octet-stream';\n            var success = false;\n\n            // Get the headers\n            headers = headers();\n            //var ttt = title.toLowerCase().replace(/\\W/g, '_');\n            // Get the filename from the x-filename header or default to \"download.bin\"\n            var filename = headers['x-filename'] || 'download.zip';\n\n            // Determine the content type from the header or default to \"application/octet-stream\"\n            var contentType = headers['content-type'] || octetStreamMime;\n\n            try {\n                // Try using msSaveBlob if supported\n                var blob = new Blob([data], {\n                    type: contentType\n                });\n                if (navigator.msSaveBlob)\n                    navigator.msSaveBlob(blob, filename);\n                else {\n                    // Try using other saveBlob implementations, if available\n                    var saveBlob = navigator.webkitSaveBlob || navigator.mozSaveBlob || navigator.saveBlob;\n                    if (saveBlob === undefined) throw \"Not supported\";\n                    saveBlob(blob, filename);\n                }\n                success = true;\n            } catch (ex) {\n                $log.info(\"saveBlob method failed with the following exception:\");\n                $log.info(ex);\n            }\n\n            if (!success) {\n                // Get the blob url creator\n                var urlCreator = window.URL || window.webkitURL || window.mozURL || window.msURL;\n                if (urlCreator) {\n                    // Try to use a download link\n                    var link = document.createElement('a');\n                    if ('download' in link) {\n                        // Try to simulate a click\n                        try {\n                            // Prepare a blob URL\n                            var blob = new Blob([data], {\n                                type: contentType\n                            });\n                            var url = urlCreator.createObjectURL(blob);\n                            link.setAttribute('href', url);\n\n                            // Set the download attribute (Supported in Chrome 14+ / Firefox 20+)\n                            link.setAttribute(\"download\", filename);\n\n                            // Simulate clicking the download link\n                            var event = document.createEvent('MouseEvents');\n                            event.initMouseEvent('click', true, true, window, 1, 0, 0, 0, 0, false, false, false, false, 0, null);\n                            link.dispatchEvent(event);\n                            success = true;\n\n                        } catch (ex) {\n                            $log.info(\"Download link method with simulated click failed with the following exception:\");\n                            $log.info(ex);\n                        }\n                    }\n\n                    if (!success) {\n                        // Fallback to window.location method\n                        try {\n                            // Prepare a blob URL\n                            // Use application/octet-stream when using window.location to force download\n                            var blob = new Blob([data], {\n                                type: octetStreamMime\n                            });\n                            var url = urlCreator.createObjectURL(blob);\n                            window.location = url;\n                            success = true;\n                        } catch (ex) {\n                            $log.info(\"Download link method with window.location failed with the following exception:\");\n                            $log.info(ex);\n                        }\n                    }\n                }\n            }\n\n            if (!success) {\n                // Fallback to window.open method\n                $log.info(\"No methods worked for saving the arraybuffer, using last resort window.open\");\n                window.open(httpPath, '_blank', '');\n            }\n            return filename;\n        };\n        \n\n        $scope.open = function (member_id) {\n            var modalInstance = $uibModal.open({\n              animation: true,\n              templateUrl: 'views/modals/deleteModal.html',\n              controller: 'ModalInstanceCtrl',\n              size: \"lg\",\n              resolve: {\n                id: function () {\n                  return member_id;\n                },\n                warning: function(){\n                    return warning_msg;\n                }\n              }\n            });\n\n\n            modalInstance.result.then(function (member_id) {\n              $log.info('PRESSED GO: '+member_id);\n              MemberService.Delete(member_id)\n              .then(function(){\n                //console.log(\"HELLO DELETE\");\n                //update view?\n                 vm.club.members = $.grep(vm.club.members, function(e){ \n                    return e.id != member_id; \n                });\n              })\n            }, function () {\n              $log.info('Modal dismissed at: ' + new Date());\n            });\n          };\n\n         \n\n\n    }\n app.controller('DashboardClubMembershipsController', DashboardClubMembershipsController);\n\n    DashboardClubMembershipsController.$inject = ['UserService', 'MembershipService', 'ClubService', '$rootScope', '$location', '$scope', '$state', '$stateParams', '$uibModal', '$log', '$window'];\n    function DashboardClubMembershipsController(UserService, MembershipService, ClubService, $rootScope, $location, $scope, $state, $stateParams, $uibModal, $log, $window) {\n        var vm = this;\n\n        vm.user = null;\n        vm.allUsers = [];\n        vm.club = {};\n        vm.page_title = \"\";\n        \n        \n\n        vm.action = $state.current.data.action;\n        vm.club_id = $rootScope.globals.currentUser.current_club_admin.id;\n        vm.user = $rootScope.globals.currentUser;\n        vm.user_id = vm.user.id;\n        ////console.log(\"club_id : \"+vm.club_id);\n\n        // //console.log(vm.action);\n        // //console.log($stateParams);\n        // //console.log($stateParams.id);\n\n\n        ClubService.GetById(vm.club_id)\n        .then(function(data){\n                console.log(\"DATA HERE\", data);\n                        vm.club = data;   \n                        vm.club.membership = {};\n\n        //default\n\n\n\n        switch(vm.action){\n            case \"add\":\n                //console.log(\"adding a new membership please\");\n                vm.page_title = \"Add a New membership\";\n\n                //setting some default values here\n                vm.club.membership.currency = vm.club.account_currency;\n                vm.club.membership.passenger_only = 0;\n                vm.club.membership.passenger_only_default = 0;\n\n                 MembershipService.GetAllMembershipPlanes(vm.club_id, 1)\n                    .then(function(data){\n                        vm.club_planes = data.membership_planes;   \n                    });\n\n            break;\n            case \"edit\":\n                //console.log(\"edit an existing membership\");\n                MembershipService.GetById($stateParams.membership_id, vm.club_id)\n                    .then(function(data){\n                        vm.club.membership = data;   \n                        //console.log(vm.club);\n                        vm.page_title = \"Edit a membership - \"+vm.club.membership.membership_name;\n                    });\n\n                MembershipService.GetAllMembershipPlanes(vm.club_id, $stateParams.membership_id)\n                    .then(function(data){\n                        vm.club_planes = data.membership_planes;   \n                    });\n\n\n            break;\n            case \"list\":\n                //need to update this to be part of the authentication\n                //to find out club id\n                MembershipService.GetAllByClub(vm.club_id)\n                    .then(function(data){\n                        vm.club.memberships = data;   \n                        console.log(\"one\", vm.club.memberships);\n                    });\n            break;\n            default:\n                //console.log(\"none of the above... redirect somewhere?\");\n            break;\n        }  \n\n\n         });\n        //'9' needs to refer the the user's account set to manage\n       \n        $scope.back = function(){\n            $window.history.back();\n        }\n\n        $scope.save = function(){\n            if(vm.action == \"add\"){\n                //console.log(\"CREATE click\");\n                $scope.create();\n            } else {\n                //console.log(\"EDIT click\");\n                //console.log(vm.club.membership);\n                $scope.update();\n\n\n\n            }\n\n\n\n\n        }\n\n\n        $scope.create = function(){\n            //console.log(\"CREATE ME NOW\");\n            vm.club.membership.club_id = vm.club_id;\n            MembershipService.Create(vm.club.membership)\n                .then(function(data){\n                    //console.log(data);\n                    $state.go('dashboard.manage_club.memberships');\n                });\n        }\n\n        $scope.delete = function(){\n            //console.log(\"CLICK\");\n            alert(\"Are you sure you would like to delete this membership?\");\n            MembershipService.Update(vm.club.membership)\n                .then(function(data){\n                    //console.log(data);\n                });\n        }\n\n        $scope.update = function(){\n            //console.log(\"CLICK\");\n            vm.club.membership.club_id = vm.club_id;\n            MembershipService.Update(vm.club.membership)\n                .then(function(data){\n                    //console.log(\"new membership is : \",data);\n                    //console.log(\"saved\");\n\n                    if(vm.club.membership.plane_access == 1){\n                        //sort out what we need from the club_planes\n                        var send_planes = [];\n                        for(var i=0;i<vm.club_planes.length;i++){\n                            var plane = {\n                                id: vm.club_planes[i].id,\n                                tacho_hour_fee: vm.club_planes[i].membership_tacho_hour_fee,\n                                landing_fee: vm.club_planes[i].membership_landing_fee,\n                                touch_and_go_fee: vm.club_planes[i].membership_touch_and_go_fee,\n                                access: vm.club_planes[i].access,\n                                membership_id: data,\n                                plane_id: vm.club_planes[i].plane_id\n                            };\n                            send_planes.push(plane);\n                        }\n\n\n                        //then we need to make an additional call to UPDATE all these...\n                         MembershipService.UpdateMembershipPlanes(data, send_planes)\n                            .then(function(data){\n                                //console.log(data);\n\n                            });\n\n                    }\n\n                    $state.go('dashboard.manage_club.memberships');\n                });\n        }\n\n        initController();\n\n        vm.previous_price = 0;\n\n        vm.update_price = function(){\n\n            ////console.log(\"previous price: \", vm.previous_price);\n\n            if(vm.club.membership.payment_term == \"free\"){\n                vm.previous_price = (vm.club.membership.price > 0)? vm.club.membership.price : 0;\n                vm.club.membership.price = 0;\n            } else {\n                vm.club.membership.price = (vm.club.membership.price > 0) ? vm.club.membership.price : ((vm.previous_price > 0) ? vm.previous_price : 0);\n            }\n\n        }\n\n        \n\n        function initController() {\n           //console.log(\"check if access is okay\");\n        }\n\n\n            var warning_msg = \"By deleting this membership, you will also cancel all reservations that this membership currently has.\"\n\n          // $scope.open = function(membership_id) {\n          //     alert(\"HI\");\n          //     //console.log(\"log =- \", membership_id);\n\n          //   var modalInstance = $uibModal.open({\n          //     animation: true,\n          //     templateUrl: 'views/modals/deleteModal.html',\n          //     controller: 'ModalInstanceCtrl',\n          //     size: \"lg\",\n          //     resolve: {\n          //       id: function () {\n          //         return membership_id;\n          //       },\n          //       warning: function(){\n          //           return warning_msg;\n          //       }\n          //     }\n          //   });\n          //   modalInstance.result.then(function (membership_id) {\n          //     $log.info('PRESSED GO: '+membership_id);\n          //     MembershipService.Delete(membership_id)\n          //     .then(function(){\n          //       //console.log(\"HELLO DELETE\");\n          //       //update view?\n          //        vm.club.memberships = $.grep(vm.club.memberships, function(e){ \n          //           return e.id != membership_id; \n          //       });\n          //     })\n          //   }, function () {\n          //     $log.info('Modal dismissed at: ' + new Date());\n          //   });\n          // };\n\n\n           $scope.open = function (memberships) {\n            var modalInstance = $uibModal.open({\n              animation: true,\n              templateUrl: 'views/modals/deleteModal.html',\n              controller: 'ModalInstanceCtrl',\n              size: \"lg\",\n              resolve: {\n                id: function () {\n                  return memberships;\n                },\n                params: function() {\n                  return {id: memberships};\n                },\n                warning: function(){\n                    return warning_msg;\n                }\n              }\n            });\n            modalInstance.result.then(function (memberships) {\n              $log.info('PRESSED GO: '+memberships.id);\n\n\n                MembershipService.Delete(memberships.id)\n              .then(function(){\n                //console.log(\"HELLO DELETE\");\n                //update view?\n                 vm.club.memberships = $.grep(vm.club.memberships, function(e){ \n                    return e.id != memberships.id; \n                });\n              })\n\n\n            }, function () {\n              $log.info('Modal dismissed at: ' + new Date());\n            });\n          };\n\n         \n\n\n    }\n app.controller('DashboardClubPackagesController', DashboardClubPackagesController);\n\n    DashboardClubPackagesController.$inject = ['UserService', '$rootScope', '$location', '$scope', '$state', '$stateParams', '$uibModal', '$log', '$window', 'PackageService', 'PlaneService'];\n    function DashboardClubPackagesController(UserService, $rootScope, $location, $scope, $state, $stateParams, $uibModal, $log, $window, PackageService, PlaneService) {\n        var vm = this;\n\n        vm.charge_type = [\"brakes\", \"session\", \"plane\"];\n\n\n        vm.page_title = \"\";\n\n        vm.action = $state.current.data.action;\n        vm.user = $rootScope.globals.currentUser;\n        // //console.log(\"$rootScope.globals.currentUser : \", $rootScope.globals.currentUser);\n        vm.club_id = $rootScope.globals.currentUser.current_club_admin.id;\n        vm.user_id = vm.user.id;\n\n        vm.packages = [];\n\n\n        // //console.log(vm.action);\n        // //console.log($stateParams);\n        // //console.log($stateParams.id);\n\n\n        vm.editing = false;\n        \n        switch(vm.action){\n            case \"add\":\n                //console.log(\"adding a new packages\");\n\n                  PlaneService.GetAllByClub(vm.club_id)\n                    .then(function(data){\n                        vm.planes_original = data; \n                        vm.planes = JSON.parse(JSON.stringify(vm.planes_original));\n\n\n                    });\n\n            break;\n            case \"edit\":\n                vm.editing = true;\n                //console.log(\"edit an existing packages\");\n\n                vm.package_id = $stateParams.package_id;\n\n                PackageService.GetPackageById($stateParams.package_id)\n                    .then(function(data){\n                        vm.package = data.item;   \n                        vm.package.available = (vm.package.available == 1) ? true : false;\n            \n                        vm.page_title = \"Edit a Package - \"+vm.package.title;\n                    });\n \n                    PackageService.GetPackagePlanesByPackageId($stateParams.package_id)\n                    .then(function(data){\n                        vm.aircraft = data.items;   \n            \n                        PlaneService.GetAllByClub(vm.club_id)\n                        .then(function(data){\n                            vm.planes_original = data; \n                            vm.planes = JSON.parse(JSON.stringify(vm.planes_original));\n\n                            vm.clean_aircraft_selection();\n\n                        });\n\n\n                    });\n\n\n\n\n            break;\n            case \"list\":\n                //need to update this to be part of the authentication\n                //to find out club id\n                PackageService.GetPackagesByClubId(vm.club_id)\n                    .then(function(data){\n                        vm.packages = data.items;   \n                        //console.log(vm.packages);\n                    });\n            break;\n            default:\n                //console.log(\"none of the above... redirect somewhere?\");\n            break;\n        }  \n\n       \n        \n        function refresh_aircraft(){\n\n                  PackageService.GetPackagePlanesByPackageId($stateParams.package_id)\n                    .then(function(data){\n                        vm.aircraft = data.items;   \n                    });\n\n        }\n\n        //'9' needs to refer the the user's account set to manage\n       \n        $scope.back = function(){\n            $window.history.back();\n        }\n\n\n\n        $scope.save = function(){\n            if(vm.action == \"add\"){\n                //console.log(\"CREATE click\");\n                $scope.create();\n            } else {\n                //console.log(\"EDIT click\");\n                //console.log(vm.package);\n                $scope.update();\n            }\n        }\n\n        \n      \n\n\n\n       \n\n\n        vm.delete_aircraft = function(aircraft, index){\n\n\n            if(vm.action == \"add\"){\n\n                vm.aircraft.splice(index, 1);\n                            vm.clean_aircraft_selection();\n\n            } else {\n                // //console.log(\"EXAM\", exam);\n                if(confirm(\"Are you sure you wish to delete this aircraft for this package? This is irreversible.\")){\n\n                    PackageService.DeletePackagePlane(aircraft.id)\n                        .then(function(data){\n                            //console.log(data);\n                            if(data.success){\n                                vm.aircraft.splice(index, 1);\n                                vm.clean_aircraft_selection();\n                            } else {\n                                alert(\"An error occurred...\");\n                            }\n                            //$state.go('dashboard.manage_club.edit_lesson', {course_id: vm.club.lesson.course_id, lesson_id: data.id, reload: true});\n                        });\n                }\n            }\n            \n        }\n\n       vm.aircraft = [];\n       vm.new_aircraft2 = {};\n       vm.new_aircraft = {};\n\n        vm.add_aircraft = function(){\n\n\n            if(vm.action == \"add\"){\n                 \n                 vm.aircraft.push(vm.new_aircraft.plane);\n                            vm.clean_aircraft_selection();\n                 vm.new_aircraft = {};\n                            vm.new_aircraft2 = {};\n\n            } else {\n\n                vm.new_aircraft2.package_id = vm.package_id; \n                vm.new_aircraft2.club_id = vm.club_id; \n                vm.new_aircraft2.plane_id = vm.new_aircraft.plane.plane_id;\n\n                PackageService.CreatePackagePlane(vm.new_aircraft2)\n                    .then(function(data){\n                        //console.log(data);\n                        if(data.success){\n\n                            vm.aircraft.push(data.item);\n\n                            vm.clean_aircraft_selection();\n                            \n                            vm.new_aircraft = {};\n                            vm.new_aircraft2 = {};\n\n                        } else {\n                            alert(\"An error occurred...\");\n                        }\n\n                        //$state.go('dashboard.manage_club.edit_lesson', {course_id: vm.club.lesson.course_id, lesson_id: data.id, reload: true});\n\n                    });\n\n            }\n\n            \n        }\n\n\n        vm.clean_aircraft_selection = function(){\n\n            // vm.aircraft ==> list of aircraft already on this package\n\n            // vm.planes ==> list of aircraft that can be added to this package\n\n            //remove vm.planes entries which match the ones in aircraft list\n\n          \n\n            //vm.planes = vm.planes.filter( ( el ) => !vm.aircraft.includes( el.plane_id ) );\n\n            // vm.planes = vm.planes_original;\n\n            vm.planes = JSON.parse(JSON.stringify(vm.planes_original));\n\n\n           \n            for(var j=0;j<vm.aircraft.length;j++) {\n\n              var i = 0;\n              while (i < vm.planes.length) {\n                if (vm.planes[i].plane_id === vm.aircraft[j].plane_id) {\n                  vm.planes.splice(i, 1);\n                } else {\n                  ++i;\n                }\n              }\n\n\n          }\n\n\n\n\n\n        }\n\n\n\n\n\n\n\n\n\n\n        vm.update_charge = function(charge, index){\n\n            delete(charge.edit_me);\n\n            PackageService.UpdateCharge(charge)\n                .then(function(data){\n                    //console.log(data);\n                    if(data.success){\n\n                        vm.instructor_charges[index].edit_me = false;\n\n                    } else {\n                        alert(\"An error occurred...\");\n                    }\n                    //refresh_tem();\n                    //$state.go('dashboard.manage_club.edit_lesson', {course_id: vm.club.lesson.course_id, lesson_id: data.id, reload: true});\n                });\n        }\n\n        vm.update_cancel_charge = function(index){\n            refresh_charges();\n        }\n\n        vm.edit_charge = function(index){\n\n            vm.instructor_charges[index].edit_me = true;\n\n        }\n\n        vm.delete_charge = function(charge, index){\n            // //console.log(\"EXAM\", exam);\n            if(confirm(\"Are you sure you wish to delete this instructor charge? This is irreversible.\")){\n\n                PackageService.DeleteCharge(charge.id)\n                    .then(function(data){\n                        //console.log(data);\n                        if(data.success){\n                            vm.instructor_charges.splice(index, 1);\n                        } else {\n                            alert(\"An error occurred...\");\n                        }\n                        //$state.go('dashboard.manage_club.edit_lesson', {course_id: vm.club.lesson.course_id, lesson_id: data.id, reload: true});\n                    });\n            }\n        }\n\n       \n        \n        vm.add_charge = function(){\n\n            vm.new_charge.course_id = $stateParams.course_id; \n            vm.new_charge.club_id = vm.club_id; \n\n            PackageService.CreateCharge(vm.new_charge)\n                .then(function(data){\n                    //console.log(data);\n                    if(data.success){\n\n                        vm.instructor_charges.push(data.item);\n\n                        vm.new_charge = {\n                            title: \"\",\n                            charge_type: \"\",\n                            price: \"\"\n                        }\n\n                    } else {\n                        alert(\"An error occurred...\");\n                    }\n\n                    //$state.go('dashboard.manage_club.edit_lesson', {course_id: vm.club.lesson.course_id, lesson_id: data.id, reload: true});\n\n                });\n        }\n\n\n\n\n        vm.convert_decimal_to_hours = function(decimal_time){\n            var temp = new Array();\n            temp = decimal_time.toString().split('.');\n            \n            var hours = temp[0];\n            if(hours < 10){\n                hours = \"0\"+hours;\n            }\n            if(temp[1]){\n               var minutes = 100 / temp[1];\n                minutes = Math.round(60 / minutes); \n\n                if(minutes < 10){\n                    minutes = \"0\"+minutes;\n                }\n            } else {\n                minutes = \"00\"\n            }\n\n            return hours + ':' + minutes;\n        }\n\n\n\n\n\n\n\n\n         vm.delete_course = function(id, index){\n            if(confirm(\"Are you sure you wish to delete this course? This is irreversible.\")){\n\n                PackageService.DeletePackage(id)\n                    .then(function(data){\n                        //console.log(data);\n                        if(data.success){\n                            vm.packages.splice(index, 1);\n                        } else {\n                            alert(\"An error occurred...\");\n                        }\n                        //$state.go('dashboard.manage_club.edit_lesson', {course_id: vm.club.lesson.course_id, lesson_id: data.id, reload: true});\n                    });\n            } \n        }\n\n        $scope.create = function(){\n            ////console.log(\"CREATE ME NOW\");\n         \n            //return false;\n            //return false;\n            vm.package.club_id = vm.club_id;\n            vm.package.aircraft = vm.aircraft;\n\n            PackageService.CreatePackage(vm.package)\n                .then(function(data){\n                    ////console.log(data);\n                        \n                    $state.go('dashboard.manage_club.package', {reload: true});\n\n                });\n\n\n        }\n\n        $scope.delete = function(){\n            //console.log(\"CLICK\");\n            alert(\"Are you sure you would like to delete this course?\");\n            PackageService.DeletePackage(vm.package.id)\n                .then(function(data){\n                    //console.log(data);\n                });\n        }\n\n        function get_update_docs(){\n            var documents = [];\n\n            for(var i=0;i<update_this_file.length;i++){\n                var id = update_this_file[i];\n                //console.log(\"looking for : \", id);\n                //console.log(\"in: \", vm.course_documents);\n\n                for(var k=0;k<vm.package.course_documents.length;k++){\n                    //console.log(\"comparing to : \", vm.package.course_documents[k].id);\n                    if(vm.package.course_documents[k].id == id){\n                        documents.push(vm.package.course_documents[k]);\n                    }\n                }\n\n            }\n\n            // //console.log(\"DOCS TO UPDATE : \", documents);\n\n            return documents;\n        }\n\n        $scope.update = function(){\n            //console.log(\"CLICK\");\n         \n\n            PackageService.UpdatePackage(vm.package)\n                .then(function(data){\n                    //console.log(data);\n                    //console.log(\"saved\");\n                    $state.go('dashboard.manage_club.package');\n                });\n        }\n\n\n\n\n\n\n        initController();\n\n        function initController() {\n           //console.log(\"check if access is okay\");\n        }\n\n\n}\n app.controller('DashboardClubPaymentsController', DashboardClubPaymentsController);\n\n    DashboardClubPaymentsController.$inject = ['UserService', 'PlaneService', '$rootScope', '$location', '$scope', '$state', '$stateParams', '$uibModal', '$log', '$window', 'LicenceService', 'MedicalService', 'DifferencesService', 'PlaneDocumentService', 'ClubPaymentService'];\n    function DashboardClubPaymentsController(UserService, PlaneService, $rootScope, $location, $scope, $state, $stateParams, $uibModal, $log, $window, LicenceService, MedicalService, DifferencesService, PlaneDocumentService, ClubPaymentService) {\n        var vm = this;\n\n        vm.user = null;\n        vm.allUsers = [];\n        vm.club = {\n            plane: {\n                requirements: {\n                    licence: [],\n                    medical: [],\n                    differences: []\n                },\n                documents: []\n            }\n        };\n\n        vm.page_title = \"\";\n        \n        vm.plane_document = {};\n        vm.plane_documents = [];\n\n        var update_this_file = [];\n        \n    \n        vm.action = $state.current.data.action;\n        vm.club_id = $rootScope.globals.currentUser.current_club_admin.id;\n        vm.user = $rootScope.globals.currentUser;\n        vm.user_id = vm.user.id;\n\n        ClubPaymentService.GetPaymentsByClub(vm.club_id)\n                .then(function(data){\n                    //console.log(\"ALL PAYMENTS...\", data);\n                    vm.payments = data.payments;\n                });\n\n        //'9' needs to refer the the user's account set to manage\n       \n        $scope.back = function(){\n            $window.history.back();\n        }\n\n        $scope.save = function(){\n            if(vm.action == \"add\"){\n                //console.log(\"CREATE click\");\n                $scope.create();\n            } else {\n                //console.log(\"EDIT click\");\n                //console.log(vm.club.plane);\n                $scope.update();\n            }\n        }\n\n\n        $scope.create = function(){\n            //console.log(\"CREATE ME NOW\");\n            vm.club.plane.club_id = vm.club_id;\n            vm.club.plane.add_documents = vm.plane_documents;\n            //console.log(\"PLANE TO ADD, \", vm.club.plane);\n            //return false;\n            PlaneService.Create(vm.club.plane)\n                .then(function(data){\n                    //console.log(data);\n                    $state.go('dashboard.manage_club.planes', {reload: true});\n\n                });\n        }\n\n        $scope.delete = function(){\n            //console.log(\"CLICK\");\n            alert(\"Are you sure you would like to delete this plane?\");\n            PlaneService.Update(vm.club.plane)\n                .then(function(data){\n                    //console.log(data);\n                });\n        }\n\n        function get_update_docs(){\n            var documents = [];\n\n            for(var i=0;i<update_this_file.length;i++){\n                var id = update_this_file[i];\n                //console.log(\"looking for : \", id);\n                //console.log(\"in: \", vm.plane_documents);\n\n                for(var k=0;k<vm.club.plane.plane_documents.length;k++){\n                    //console.log(\"comparing to : \", vm.club.plane.plane_documents[k].id);\n                    if(vm.club.plane.plane_documents[k].id == id){\n                        documents.push(vm.club.plane.plane_documents[k]);\n                    }\n                }\n\n            }\n\n            // //console.log(\"DOCS TO UPDATE : \", documents);\n\n            return documents;\n        }\n\n        $scope.update = function(){\n            //console.log(\"CLICK\");\n            vm.club.plane.club_id = vm.club_id;\n            vm.club.plane.add_documents = vm.plane_documents;\n\n            vm.club.plane.update_documents = get_update_docs();\n            //get_update_docs();\n\n            PlaneService.Update(vm.club.plane)\n                .then(function(data){\n                    //console.log(data);\n                    //console.log(\"saved\");\n                    $state.go('dashboard.manage_club.planes');\n                });\n        }\n\n        $scope.get_payment_description = function(payment_method){\n\n            if(payment_method == \"Stripe\"){\n                return \"This invoice was charged using the Stripe integration\";\n            } else if(payment_method == \"Equilibrium\"){\n                return \"This invoice amounted to 0 and hence no payment was taken\";\n            } else if(payment_method == \"GoCardless\"){\n                return \"This invoice was charged using the GoCardless integration\";\n            } else if(payment_method == \"GoCardless + Credit\"){\n                return \"This invoice was charged using the GoCardless integration as well as Credit on file.\";\n            } else if(payment_method == \"Credit\"){\n                return \"This invoice was charged using the Credit the user had on file.\";\n            }\n\n\n        }\n\n\n        function containsObject(obj, list, params) {\n\n            // //console.log(\"obj\", obj);\n            // //console.log(\"list\", list);\n            // //console.log(\"params\", params);\n\n            for(var i=0; i<list.length; i++) {\n                // //console.log(\"list i : \", list[i]);\n                // //console.log(\"obj is: \", obj);\n\n                var count_success = 0;\n                for(var j=0;j<params.length;j++){\n                    if(list[i][params[j]] && obj[params[j]] && list[i][params[j]] == obj[params[j]]){\n                        count_success++;\n                    }\n                }\n\n                if(count_success === params.length) {                    \n                    return true;\n                }\n            }\n\n            return false;\n        }\n\n\n        function check_all(){\n\n            //maybe a nice to have one day... not yet though.\n\n\n            //licences\n            vm.club.plane.requirements.licence.forEach(function(obj){\n\n            });\n\n        }\n\n      \n\n        initController();\n\n        function initController() {\n           //console.log(\"check if access is okay\");\n        }\n\n\n          var warning_msg = \"By deleting this plane, you will also cancel all reservations that this plane currently has.\"\n\n\n            $scope.open = function (payment) {\n            var modalInstance = $uibModal.open({\n              animation: true,\n              templateUrl: 'views/modals/refundModal.html',\n              controller: 'RefundModalInstanceCtrl',\n              size: \"lg\",\n              resolve: {\n                id: function () {\n                  return payment;\n                },\n                params: function() {\n                  return payment;\n                },\n                warning: function(){\n                    return warning_msg;\n                }\n              }\n            });\n            modalInstance.result.then(function (refund) {\n                var id = refund.id;\n              $log.info('PRESSED GO: ', refund);\n              \n              if(refund.to_refund > (refund.amount - refund.amount_refunded)){\n                alert(\"You are trying to refund more than the payment was for. You will need to first refund this amount in full, and then make a payment to the user for the remaining sum.\");\n                return false;\n              }\n\n              if(refund.to_refund > 0 && refund.payment_method == \"Stripe\"){\n                //then the amount is OK to refund....\n                //and this is a Stripe payment.\n\n                if(refund.to_refund == refund.amount){\n                    //total refund\n\n                } else {\n                    //partial refund\n\n                }\n\n                ClubPaymentService.Refund(refund)\n                .then(function(data){\n                    //console.log(\"HELLO REFUND\", data);\n                    //update view?\n                    \n\n                 });\n\n\n\n\n              }\n\n\n             //  PlaneService.Delete(id)\n             //  .then(function(){\n             //    //console.log(\"HELLO DELETE\");\n             //    //update view?\n             //     vm.club.planes = $.grep(vm.club.planes, function(e){ \n             //        return e.id != id; \n             //    });\n             // });\n\n            }, function () {\n              $log.info('Modal dismissed at: ' + new Date());\n            });\n\n\n          };\n\n\n\n\n\n\n\n\n\n\n          $scope.new_charge = function (charge) {\n            var modalInstance = $uibModal.open({\n              animation: true,\n              templateUrl: 'views/modals/newChargeModal.html',\n              controller: 'NewChargeModalInstanceCtrl',\n              size: \"lg\",\n              resolve: {\n                id: function () {\n                  return charge;\n                },\n                params: function() {\n                  return charge;\n                },\n                warning: function(){\n                    return warning_msg;\n                }\n              }\n            });\n            modalInstance.result.then(function (charge) {\n               \n\n              $log.info('PRESSED GO: ', charge);\n              \n                \n\n                // ClubPaymentService.Refund(refund)\n                // .then(function(data){\n                //     //console.log(\"HELLO REFUND\", data);\n                //     //update view?\n                    \n\n                //  });\n\n\n\n\n            }, function () {\n              $log.info('Modal dismissed at: ' + new Date());\n            });\n\n\n          };\n         \n\n\n    }\n app.controller('DashboardClubPlanesController', DashboardClubPlanesController);\n\n    DashboardClubPlanesController.$inject = ['UserService', 'PlaneService', 'FoxService', '$rootScope', '$location', '$scope', '$state', '$stateParams', '$uibModal', '$log', '$window', 'LicenceService', 'MedicalService', 'DifferencesService', 'PlaneDocumentService'];\n    function DashboardClubPlanesController(UserService, PlaneService, FoxService, $rootScope, $location, $scope, $state, $stateParams, $uibModal, $log, $window, LicenceService, MedicalService, DifferencesService, PlaneDocumentService) {\n        var vm = this;\n\n           //    /* PLEASE DO NOT COPY AND PASTE THIS CODE. */(function(){var w=window,C='___grecaptcha_cfg',cfg=w[C]=w[C]||{},N='grecaptcha';var gr=w[N]=w[N]||{};gr.ready=gr.ready||function(f){(cfg['fns']=cfg['fns']||[]).push(f);};(cfg['render']=cfg['render']||[]).push('explicit');(cfg['onload']=cfg['onload']||[]).push('initRecaptcha');w['__google_recaptcha_client']=true;var d=document,po=d.createElement('script');po.type='text/javascript';po.async=true;po.src='https://www.gstatic.com/recaptcha/releases/JPZ52lNx97aD96bjM7KaA0bo/recaptcha__en.js';var e=d.querySelector('script[nonce]'),n=e&&(e['nonce']||e.getAttribute('nonce'));if(n){po.setAttribute('nonce',n);}var s=d.getElementsByTagName('script')[0];s.parentNode.insertBefore(po, s);})();\n\n           // var initRecaptcha = function () { \n           //     // document.getElementById(\"SearchModule\").scope().vm.parent.isGrecaptchaLoaded = !0, \n           //     // document.getElementById(\"SearchModule\").scope().vm.showRecaptcha();\n           //     vm.showRecaptcha();\n           // };\n              \n\n\n        vm.show_loading = false;\n\n        vm.user = null;\n        vm.allUsers = [];\n        vm.club = {\n            plane: {\n                requirements: {\n                    licence: [],\n                    medical: [],\n                    differences: []\n                },\n                documents: []\n            }\n        };\n\n        vm.page_title = \"\";\n        \n        vm.plane_document = {};\n        vm.plane_documents = [];\n\n        var update_this_file = [];\n        \n        \n        vm.currency_types = [\"class\", \"type\"];\n        vm.gear_types = [\"tricycle\", \"tailwheel\", \"monowheel\", \"floats\", \"amphibian\", \"skis\"];\n        // vm.certificates = [\"Certificate of Airworthiness\", \"National Certificate of Airworthiness\", \"Permit to Fly\"];\n        vm.certificates = [{id: 1, title: \"Certificate of Airworthiness\", value: \"cofa\"}, {id: 2, title: \"National Certificate of Airworthiness\", value: \"cofa\"}, {id: 2, title: \"LAA Permit to Fly\", value: \"ptf\"}];\n        vm.classes = [\"SEP (land)\", \"SEP (sea)\", \"SET (land)\", \"SET (sea)\", \"MEP (land)\", \"MEP (sea)\", \"ME\"];\n\n        vm.charge_type = [\"airborne\", \"brakes\", \"tacho\", \"hobbs\", \"flight\", \"brakes_rounded\"];\n        vm.surcharge_type = [\"none\", \"flight\", \"hour\", \"taxi\"];\n\n        vm.action = $state.current.data.action;\n        vm.user = $rootScope.globals.currentUser;\n        //console.log(\"$rootScope.globals.currentUser : \", $rootScope.globals.currentUser);\n        vm.club_id = $rootScope.globals.currentUser.current_club_admin.id;\n        vm.user_id = vm.user.id;\n\n\n        vm.plane_certificate = {};\n        vm.plane_noise = {};\n        vm.plane_radio = {};\n        vm.plane_maintenance = {};\n        vm.plane_insurance = {};\n\n        vm.plane_engine_1 = {removed_date: \"\"};\n        vm.plane_engine_1_replace = {removed_date: \"\"};\n        vm.plane_engine_2 = {removed_date: \"\"};\n        vm.plane_engine_2_replace = {removed_date: \"\"};\n\n        vm.plane_propeller_1 = {removed_date: \"\"};\n        vm.plane_propeller_1_replace = {removed_date: \"\"};\n        vm.plane_propeller_2 = {removed_date: \"\"};\n        vm.plane_propeller_2_replace = {removed_date: \"\"};\n\n        vm.show_replace_engine_1 = false;\n        vm.show_replace_engine_2 = false;\n        vm.show_replace_prop_1 = false;\n        vm.show_replace_prop_2 = false;\n\n        // //console.log(vm.action);\n        // //console.log($stateParams);\n        // //console.log($stateParams.id);\n\n\n\n\n         LicenceService.GetAll()\n            .then(function(data){\n                //console.log(\"LICENCES : \", data.licences);\n                vm.licences = data.licences;   \n            });\n\n        LicenceService.GetRatings()\n            .then(function(data){\n                //console.log(\"RATINGS : \", data);\n                vm.ratings = data;   \n            });\n\n\n        MedicalService.GetAuthority()\n         .then(function(data){\n                //console.log(\"AUTHORITY : \", data);\n                vm.medical_authorities = data;   \n            });\n\n         MedicalService.GetComponents()\n         .then(function(data){\n                //console.log(\"COMPONENTS : \", data);\n                vm.medical_components = data;\n            });\n\n         DifferencesService.GetDifferences()\n         .then(function(data){\n                //console.log(\"DIFF : \", data);\n                vm.differences = data;\n            });\n\n\n         vm.editing = false;\n        \n        switch(vm.action){\n            case \"add\":\n                //console.log(\"adding a new plane please\");\n                vm.page_title = \"Add a New Plane\";\n            break;\n            case \"edit\":\n                vm.editing = true;\n                //console.log(\"edit an existing plane\");\n                PlaneService.GetById($stateParams.plane_id, vm.club_id)\n                    .then(function(data){\n                        vm.club.plane = data;   \n                        // vm.club.plane.requirements = {\n                        //         licence: [],\n                        //         medical: [],\n                        //         differences: [],\n                        //         hours: []\n                        // };\n\n                        console.log(vm.club.plane);\n\n                        if(vm.club.plane.colour && vm.club.plane.colour.indexOf(\"rgba\") > -1){\n                            vm.club.plane.colour = rgbaToHex(vm.club.plane.colour);\n                        }\n\n                        if(vm.club.plane.bg_colour && vm.club.plane.bg_colour.indexOf(\"rgba\") > -1){\n                            vm.club.plane.bg_colour = rgbaToHex(vm.club.plane.bg_colour);\n                        }\n\n                        vm.club.plane.airframe_hours = parseFloat(vm.club.plane.airframe_hours);\n\n                        vm.club.plane.vp = (vm.club.plane.vp == 1)? true:false;\n                        vm.club.plane.rg = (vm.club.plane.rg == 1)? true:false; \n                        vm.club.plane.tb = (vm.club.plane.tb == 1)? true:false; \n\n                        vm.plane_engine_1 = vm.club.plane.engine_1;\n                        vm.plane_engine_2 = vm.club.plane.engine_2;\n\n                        vm.plane_propeller_1 = vm.club.plane.propeller_1;\n                        vm.plane_propeller_2 = vm.club.plane.propeller_2;\n\n                        //console.log(vm.club);\n                        vm.page_title = \"Edit a Plane - \"+vm.club.plane.registration;\n                    });\n\n               \n\n\n               \n\n\n            break;\n            case \"list\":\n                //need to update this to be part of the authentication\n                //to find out club id\n                PlaneService.GetAllByClub(vm.club_id)\n                    .then(function(data){\n                        vm.club.planes = data;   \n                        //console.log(vm.club.planes);\n                    });\n\n                    //console.log(\"hello alex\");\n\n\n            break;\n            default:\n                //console.log(\"none of the above... redirect somewhere?\");\n            break;\n        }  \n\n        //'9' needs to refer the the user's account set to manage\n       \n        $scope.back = function(){\n            $window.history.back();\n        }\n\n\n\n        function rgbaToHex (rgba) {\n          var inParts = rgba.substring(rgba.indexOf(\"(\")).split(\",\"),\n              r = parseInt(trim(inParts[0].substring(1)), 10),\n              g = parseInt(trim(inParts[1]), 10),\n              b = parseInt(trim(inParts[2]), 10);\n             // a = parseFloat(trim(inParts[3].substring(0, inParts[3].length - 1))).toFixed(2);\n          var outParts = [\n            r.toString(16),\n            g.toString(16),\n            b.toString(16)\n            //,Math.round(a * 255).toString(16).substring(0, 2)\n          ];\n\n          // Pad single-digit output values\n          outParts.forEach(function (part, i) {\n            if (part.length === 1) {\n              outParts[i] = '0' + part;\n            }\n          })\n\n          return ('#' + outParts.join(''));\n        }\n\n        function trim (str) {\n          return str.replace(/^\\s+|\\s+$/gm,'');\n        }\n        function hexToRGBA(hex, opacity=1) {  \n            let r = parseInt(hex.substring(1,3), 16);  \n            let g = parseInt(hex.substring(3,5), 16);  \n            let b = parseInt(hex.substring(5), 16);  \n            var rtn = \"rgba(\"+r+\", \"+g+\", \"+b+\", \"+opacity+\")\";\n            return rtn;\n        }\n\n        $scope.save_planes_order = function(){\n            // //console.log(\"hiya\");\n            var update_order = [];\n            for(var i=0; i < vm.club.planes.length;i++){\n                var me = {\n                    id: vm.club.planes[i].plane_id,\n                    display_order: i\n                }\n                update_order.push(me);\n            }\n            // //console.log(\"organised: \", update_order);\n\n\n\n            PlaneService.UpdateOrder({\"order\": update_order})\n                .then(function(data){\n                    //console.log(data);\n\n                    // vm.items = data.items;\n                    //$state.go('dashboard.manage_club.edit_lesson', {course_id: vm.club.lesson.course_id, lesson_id: data.id, reload: true});\n\n                });\n\n        }\n\n\n        $scope.set_aircraft_details = function(){\n\n            // console.log(\"get deeeets\", vm.plane_search);\n\n            PlaneService.GetAddAircraft(vm.plane_search.registration)\n                .then(function (data) {\n                    ////console.log(data);\n\n                    // console.log(data);\n                                // return false;\n\n                    if(data){\n                        //use GB airfields first...\n                       \n                         if(data.length == 0){\n                            //console.log(\"SETTINGS HERE\");\n                                // vm.plane_search = \n                                //     {\n                                //         id: 0,\n                                //         registation: vm.plane_search.registration,\n                                //         icao_type: \"not known\"\n                                //     };\n\n                                // vm.club.plane.manufacturer = vm.plane_search.manufacturer;      \n\n                        } else {\n\n                                vm.plane_search = data;\n                                // console.log(\"SUCCESS FOUND\", data);\n                                processNewAircraft();\n                        }\n\n\n                        //console.log(\"PLANE SEARCHED\", vm.plane_search);\n\n                    } else {\n\n\n                        console.log(\"WOOOPSIES... this aircraft isn't in our database?\");\n                        //this should be very very rare...\n\n                         // vm.plane_search = \n                         //            {\n                         //                registation: vm.plane_search.registration,\n                         //                icao_type: \"not known\"\n                         //            };\n                                    // vm.club.plane.manufacturer = vm.plane_search.manufacturer;                        \n\n                    }\n\n                });\n\n\n        }\n\n        function processNewAircraft(){\n\n\n            //vm.club.plane \n\n            //TYPES -->>>\n\n              //aircraft_class --> FIXED-WING LANDPLANE\n                  //is_propeller = 1\n                  //number_of_engines  --> 1 = SEP\n                                    // --> >1 = MEP\n\n                  //is_propeller = 0\n                  //number_of_engines  --> 1 = SET\n                                    // --> >1 = ME\n\n\n            vm.club.plane.manufacturer = vm.plane_search.manufacturer;                        \n            vm.club.plane.serial_no = vm.plane_search.serial_number;                        \n            vm.club.plane.plane_type = vm.plane_search.icao_type;                        \n            vm.club.plane.type_name = vm.plane_search.type_name;                        \n            vm.club.plane.year_built = vm.plane_search.year_built;                        \n            vm.club.plane.aircraft_id = vm.plane_search.id;       \n            vm.club.plane.mtow = parseInt(vm.plane_search.mtow);\n            vm.club.plane.airframe_hours = vm.plane_search.airframe_hours;          \n\n\n            // alert(vm.plane_search.gear_type);\n\n            if(vm.plane_search.noise_level){\n\n                var regex = /[+-]?\\d+(\\.\\d+)?/g;\n\n                vm.plane_noise.noise_level = vm.plane_search.noise_level.match(regex).map(function(v) { return parseFloat(v); });\n                ////console.log(floats);\n\n            }\n            // vm.club.plane.noise_level = vm.plane_search.noise_level;//parseInt(vm.plane_search.noise_level);                 \n            \n\n\n            vm.plane_noise.noise_cert_issue = (vm.plane_search.noise_cert_issue)? new Date(vm.plane_search.noise_cert_issue) : \"\";                 \n\n            if(vm.plane_search.aircraft_class.indexOf(\"FIXED-WING\") > -1){\n\n                if(vm.plane_search.is_propeller > 0 && vm.plane_search.engine_name.indexOf(\"PT6A-\") == -1){\n\n                    vm.club.plane.plane_class = (vm.club.plane.number_of_engines > 1) ? \"MEP\" : \"SEP\";\n\n                } else {\n\n                    vm.club.plane.plane_class = (vm.club.plane.number_of_engines > 1) ? \"ME\" : \"SET\";\n\n                }\n\n                if(vm.plane_search.aircraft_class.indexOf(\"LANDPLANE\") > -1){\n                    vm.club.plane.plane_class = vm.club.plane.plane_class + \" (land)\";\n                    vm.club.plane.gear_type = \"\";\n                }\n\n                if(vm.plane_search.aircraft_class.indexOf(\"AMPHIBIAN\") > -1 || vm.plane_search.aircraft_class.indexOf(\"FLOAT\") > -1){\n                    vm.club.plane.plane_class = vm.club.plane.plane_class + \" (sea)\";\n                    vm.club.plane.gear_type = (vm.plane_search.aircraft_class.indexOf(\"AMPHIBIAN\") > -1)? \"amphibian\" : \"floats\";\n                }\n\n\n\n            }        \n\n\n\n            vm.club.plane.seats = (parseInt(vm.plane_search.seats) + 1);\n\n\n            //Certificate of Airworthiness ==> National CofA\n            //Permit to Fly ==> LAA permit\n            //EASA Certificate of Airworthiness ==> EASA CofA\n\n            if(vm.plane_maintenance && vm.plane_maintenance.cofa_category){\n                vm.plane_maintenance.cofa_category =  (vm.plane_search.cofa_category.indexOf(\"cofa\") > -1)? \"Certificate of Airworthiness\" : \"Permit to Fly\";//(vm.plane_search.cofa_category.indexOf(\"EASA\") > -1)? \"EASA Certificate of Airworthiness\" : ((vm.plane_search.cofa_category.indexOf(\"Certificate of Airworthiness\") > -1)? \"National Certificate of Airworthiness\" : \"Permit to Fly\");\n            }\n\n            vm.plane_maintenance.certificate_expiry = new Date(vm.plane_search.cofa_expiry);\n            \n            vm.club.plane.cofa_category = vm.plane_maintenance.cofa_category;//(vm.plane_search.cofa_category.indexOf(\"EASA\") > -1)? \"easa_cofa\" : ((vm.plane_search.cofa_category.indexOf(\"Certificate of Airworthiness\") > -1)? \"n_cofa\" : \"permit\")\n\n            vm.club.plane.gear_type = vm.plane_search.gear_type;\n\n\n\n            //ENGINES AND PROPS!!!\n            vm.plane_engine_1.make = vm.plane_search.engine_name;                        \n            vm.plane_engine_1.model = vm.plane_search.engine_name;                     \n\n            vm.plane_propeller_1.make = vm.plane_search.propeller_manufacturer;                        \n            vm.plane_propeller_1.model = vm.plane_search.propeller_name;                        \n\n            if(vm.plane_search.number_of_engines > 1){\n                \n                vm.number_of_engine = vm.plane_search.number_of_engines;\n\n                vm.plane_engine_2.make = vm.plane_search.engine_name;                        \n                vm.plane_engine_2.model = vm.plane_search.engine_name;\n                \n                vm.plane_propeller_2.make = vm.plane_search.propeller_manufacturer;                        \n                vm.plane_propeller_2.model = vm.plane_search.propeller_name; \n            }   \n\n        }\n\n\n        $scope.save = function(){\n            if(vm.action == \"add\"){\n                //console.log(\"CREATE click\");\n                $scope.create();\n            } else {\n                //console.log(\"EDIT click\");\n                //console.log(vm.club.plane);\n                $scope.update();\n            }\n        }\n        vm.disable_reset = false;\n        vm.disable_reset2 = false;\n\n\n        //https://local.toaviate.com/api/v1/fox/fix_uncombined\n\n        vm.fix_uncombined = function(){\n\n            var a = confirm(\"Are you sure you wish to fix uncombined flight logs - this will also reset the aerolpane logbooks and cannot be undone.\");\n            if(a && !vm.disable_reset2){\n                vm.disable_reset2 = true;\n                vm.show_loading = true;\n                //FoxService\n                FoxService.FixUncombinedLogs(vm.club_id)\n                .then(function(data){\n                    ////console.log(data);\n                    $state.go('dashboard.manage_club.planes', {reload: true});\n                    vm.disable_reset2 = true;\n                    vm.show_loading = false;\n                });\n\n            } else {\n                console.log(\"cancelled\");\n                vm.show_loading = false;\n            }\n        }\n\n        vm.reset_all_club_logs = function(){\n            var a = confirm(\"Are you sure you wish to reset this?\");\n            if(a && !vm.disable_reset){\n                vm.disable_reset = true;\n                vm.show_loading = true;\n                //FoxService\n                FoxService.ResetAllClubPlanes(vm.club_id)\n                .then(function(data){\n                    ////console.log(data);\n                    $state.go('dashboard.manage_club.planes', {reload: true});\n                    vm.disable_reset = true;\n                    vm.show_loading = false;\n                });\n\n            } else {\n                console.log(\"cancelled\");\n                vm.show_loading = false;\n            }\n        }\n\n        vm.round_brake_times_start = function(input, earlier_input=null){\n            \n                if(input){\n                  if(input.indexOf(\":\") > -1){\n                    var split = input.split(\":\");\n                    var x = split[1];\n\n\n\n                    var min_nearest_five = ((x % 5) >= 2.5 ? parseInt(x / 5) * 5 + 5 : parseInt(x / 5) * 5);\n                    \n\n\n                    if(min_nearest_five < 10){\n                      min_nearest_five = \"0\"+min_nearest_five;\n                    } else if(min_nearest_five == 60){\n                      split[0]++;\n                      min_nearest_five = \"00\";\n                    } else if(min_nearest_five > 60){\n                      split[0]++;\n                      min_nearest_five = (min_nearest_five - 60);\n                    }\n\n\n                    if(earlier_input && earlier_input.indexOf(\":\") > -1){\n                            // console.log(\"total calculated?\");\n                            // console.log(\"earlier_input: \", earlier_input);\n                            // console.log(\"input: \", input);\n                            var esplit = earlier_input.split(\":\");\n                            var ehour = esplit[0];\n                            var emin = esplit[1];\n                            var etot = (parseInt(ehour)*60) + parseInt(emin); \n                            // console.log(\"etot: \", etot);\n                            var hr = split[0];\n                            var mn = min_nearest_five;\n                            var tot = (parseInt(hr)*60) + parseInt(mn);\n                            // console.log(\"tot: \", tot);\n\n                            if(etot < tot){\n                                //the earlier time is after the end time\n                                // console.log(\"etot < tot\");\n                                min_nearest_five = parseInt(min_nearest_five) - 5;\n                                if(min_nearest_five == 60){\n                                    split[0]++; \n                                    min_nearest_five = \"00\";\n                                } else if(min_nearest_five > 60){\n                                    split[0]++;\n                                    min_nearest_five = (min_nearest_five - 60);\n                                    if(min_nearest_five < 10 ){\n                                      min_nearest_five = \"0\"+min_nearest_five;\n                                    }\n                                } else if(min_nearest_five < 0){\n                                    split[0]--;\n                                    min_nearest_five = (60 + parseInt(min_nearest_five));\n                                }\n                                // console.log(\"split: \", split[0]);\n                                // console.log(\"min_nearest_five: \", min_nearest_five);\n                            }\n\n                    }\n                    //essentially we add 5 in case something happens over the limit\n\n                    return split[0] + \":\" + min_nearest_five;\n                  } else {\n                    return input;\n                  }\n                } else {\n                  return '';\n                }\n          \n\n          }\n\n\n        $scope.create = function(){\n            ////console.log(\"CREATE ME NOW\");\n            vm.club.plane.club_id = vm.club_id;\n            vm.club.plane.add_documents = vm.plane_documents;\n            vm.club.plane.registration = vm.plane_search.registration;\n\n            vm.club.maintenance_type = vm.plane_maintenance.cofa_category.value;\n\n            console.log(\"vm.plane_maintenance.cofa_category \", vm.club.maintenance_type );\n            //return false;\n            \n            vm.plane_maintenance.file = vm.files.cert[0];\n            vm.plane_radio.file = vm.files.radio[0];\n            vm.plane_noise.file = vm.files.noise[0];\n            vm.plane_insurance.file = vm.files.insurance[0];\n\n            vm.club.plane.maintenance = vm.plane_maintenance;\n            vm.club.plane.insurance = vm.plane_insurance;\n            vm.club.plane.noise_cert = vm.plane_noise;\n            vm.club.plane.radio_licence= vm.plane_radio;\n\n            vm.club.plane.vp = (vm.club.plane.vp)? 1:0;\n            vm.club.plane.rg = (vm.club.plane.rg)? 1:0; \n            vm.club.plane.tb = (vm.club.plane.tb)? 1:0; \n\n            vm.club.plane.engine_1 = vm.plane_engine_1;\n            vm.club.plane.engine_2 = vm.plane_engine_2;\n            vm.club.plane.propeller_1 = vm.plane_propeller_1;\n            vm.club.plane.propeller_2 = vm.plane_propeller_2;\n\n\n            if(vm.club.plane.colour && vm.club.plane.colour !== \"\" && vm.club.plane.colour.indexOf(\"rgba\") == -1){\n                vm.club.plane.colour = hexToRGBA(vm.club.plane.colour, 0.75);\n            } \n\n            if(vm.club.plane.bg_colour && vm.club.plane.bg_colour !== \"\" && vm.club.plane.bg_colour.indexOf(\"rgba\") == -1){\n                vm.club.plane.bg_colour = hexToRGBA(vm.club.plane.bg_colour, 0.25);\n            } \n\n\n            //return false;\n            //console.log(\"PLANE TO ADD, \", vm.club.plane);\n            //return false;\n            PlaneService.Create(vm.club.plane)\n                .then(function(data){\n                    ////console.log(data);\n                    $state.go('dashboard.manage_club.planes', {reload: true});\n\n                });\n        }\n\n        $scope.delete = function(){\n            //console.log(\"CLICK\");\n            alert(\"Are you sure you would like to delete this plane?\");\n            PlaneService.Update(vm.club.plane)\n                .then(function(data){\n                    //console.log(data);\n                });\n        }\n\n        function get_update_docs(){\n            var documents = [];\n\n            for(var i=0;i<update_this_file.length;i++){\n                var id = update_this_file[i];\n                //console.log(\"looking for : \", id);\n                //console.log(\"in: \", vm.plane_documents);\n\n                for(var k=0;k<vm.club.plane.plane_documents.length;k++){\n                    //console.log(\"comparing to : \", vm.club.plane.plane_documents[k].id);\n                    if(vm.club.plane.plane_documents[k].id == id){\n                        documents.push(vm.club.plane.plane_documents[k]);\n                    }\n                }\n\n            }\n\n            // //console.log(\"DOCS TO UPDATE : \", documents);\n\n            return documents;\n        }\n\n        $scope.update = function(){\n            //console.log(\"CLICK\");\n            vm.club.plane.club_id = vm.club_id;\n            vm.club.plane.add_documents = vm.plane_documents;\n\n            vm.club.plane.update_documents = get_update_docs();\n            //get_update_docs();\n\n            if(vm.club.plane.colour && vm.club.plane.colour !== \"\" && vm.club.plane.colour.indexOf(\"rgba\") == -1){\n                vm.club.plane.colour = hexToRGBA(vm.club.plane.colour, 0.75);\n            } \n\n            if(vm.club.plane.bg_colour && vm.club.plane.bg_colour !== \"\" && vm.club.plane.bg_colour.indexOf(\"rgba\") == -1){\n                vm.club.plane.bg_colour = hexToRGBA(vm.club.plane.bg_colour, 0.25);\n            } \n\n            PlaneService.Update(vm.club.plane)\n                .then(function(data){\n                    //console.log(data);\n                    //console.log(\"saved\");\n                    $state.go('dashboard.manage_club.planes');\n                });\n        }\n\n        vm.save_new_aircraft_bit = function(item, num){\n            \n            // console.log(item);\n            // console.log(num);\n\n            //this assumes there was an engine and prop already saved\n\n\n            var comb = \"plane_\"+item+\"_\"+num;\n            var comb2 = \"plane_\"+item+\"_\"+num+\"_replace\";\n\n            var item_update = {};\n            \n            if(vm[comb] && vm[comb] !== \"\"){\n                //only if there is one set --> FIRST!!!\n                vm[comb].removed_date = vm[comb2].removed_date;\n                delete(vm[comb2].removed_date);\n\n                item_update = {\n                    old_item: vm[comb],\n                    new_item: vm[comb2],\n                    plane_id: vm.club.plane.id,\n                    item: item,\n                    no: num\n                };\n            } else {\n                item_update = {\n                    old_item: {},\n                    new_item: vm[comb2],\n                    plane_id: vm.club.plane.id,\n                    item: item,\n                    no: num\n                };\n            }\n\n            \n\n            // if(item == \"engine\"){\n            //     if(num == 1){\n                    \n            //         console.log( \"engine\", vm );\n            //         console.log( \"engine\", vm.plane_engine_1 );\n            //         console.log( \"engine\", vm.plane_engine_1.removed_date );\n            //         console.log( \"engine\", vm.plane_engine_1_replace );\n            //         console.log( \"engine\", vm.plane_engine_1_replace.removed_date );\n\n            //         vm.plane_engine_1.removed_date = vm.plane_engine_1_replace.removed_date;\n            //         delete(vm.plane_engine_1_replace.removed_date);\n            //         item_update.old_item = vm.plane_engine_1;\n            //         item_update.new_item = vm.plane_engine_1_replace;\n\n            //     } else if(num == 2){\n            //         vm.plane_engine_2.removed_date = vm.plane_engine_2_replace.removed_date;\n            //         delete(vm.plane_engine_2_replace.removed_date);\n            //         item_update.old_item = vm.plane_engine_2;\n            //         item_update.new_item = vm.plane_engine_2_replace;\n            //     }\n            // } else if(item == \"propeller\"){\n            //     if(num == 1){\n            //         vm.plane_propeller_1.removed_date = vm.plane_engine_1_replace.removed_date;\n            //         delete(vm.plane_engine_1_replace.removed_date);\n            //         item_update.old_item = vm.plane_propeller_1;\n            //         item_update.new_item = vm.plane_engine_1_replace;\n            //     } else if(num == 2){\n            //         vm.plane_propeller_2.removed_date = vm.plane_engine_2_replace.removed_date;\n            //         delete(vm.plane_engine_2_replace.removed_date);\n            //         item_update.old_item = vm.plane_propeller_2;\n            //         item_update.new_item = vm.plane_engine_2_replace;\n            //     }\n            // }\n\n           \n            console.log(\"LETS SEE WHAT WOULD BE SENT\", item_update);\n\n\n            PlaneService.UpdateAircraftBit(item_update)\n                .then(function(data){\n                    console.log(data);\n                    //console.log(\"saved\");\n                    $state.go('dashboard.manage_club.planes');\n                });\n\n        }\n\n\n        function containsObject(obj, list, params) {\n\n            // //console.log(\"obj\", obj);\n            // //console.log(\"list\", list);\n            // //console.log(\"params\", params);\n\n            for(var i=0; i<list.length; i++) {\n                // //console.log(\"list i : \", list[i]);\n                // //console.log(\"obj is: \", obj);\n\n                var count_success = 0;\n                for(var j=0;j<params.length;j++){\n                    if(list[i][params[j]] && obj[params[j]] && list[i][params[j]] == obj[params[j]]){\n                        count_success++;\n                    }\n                }\n\n                if(count_success === params.length) {                    \n                    return true;\n                }\n            }\n\n            return false;\n        }\n\n\n        function check_all(){\n\n            //maybe a nice to have one day... not yet though.\n\n\n            //licences\n            vm.club.plane.requirements.licence.forEach(function(obj){\n\n            });\n\n        }\n\n      \n\n\n        $scope.add_item = function(type){\n            //console.log(\"ADD\");\n            switch(type){\n                case \"licence\":\n                    //console.log(\"licence\");\n                    if(vm.temporary.licence && vm.temporary.licence !== \"\" && vm.temporary.rating && vm.temporary.rating !== \"\"){\n                        //then we can add it\n                        //console.log(\"here we go\");\n                        var add_licence = {\n                            licence_id: vm.temporary.licence.id,\n                            licence_title: vm.temporary.licence.abbreviation,\n                            rating_title: vm.temporary.rating.abbreviation,\n                            rating_id: vm.temporary.rating.id\n                        };\n\n                        //check if it doesnt exist first...\n                        if(containsObject(add_licence, vm.club.plane.requirements.licence, new Array(\"licence_id\", \"rating_id\")) == false){\n                            vm.club.plane.requirements.licence.push(add_licence);\n                        }\n\n                        delete vm.temporary.licence;\n                        delete vm.temporary.rating;\n\n                    } else {\n                        alert(\"Please select a licence and rating that is required to book the plane solo!\");\n                    }\n\n                break;\n\n\n                case \"medical\":\n                    //console.log(\"medical\");\n                    if(vm.temporary.medical_authority && vm.temporary.medical_authority !== \"\" && vm.temporary.medical_component && vm.temporary.medical_component !== \"\"){\n                        //then we can add it\n                        //console.log(\"here we go\");\n                        var add_medical = {\n                            authority_id: vm.temporary.medical_authority.id,\n                            authority_title: vm.temporary.medical_authority.abbreviation,\n                            medical_component_id: vm.temporary.medical_component.id,\n                            medical_component_title: vm.temporary.medical_component.title\n                        };\n\n                        //check if it doesnt exist first...\n                        if(containsObject(add_medical, vm.club.plane.requirements.medical, new Array(\"authority_id\", \"medical_component_id\")) == false){\n                            vm.club.plane.requirements.medical.push(add_medical);\n                        }\n\n                        delete vm.temporary.medical_authority;\n                        delete vm.temporary.medical_component;\n\n                    } else {\n                        alert(\"Please select a medical that is required to book the plane solo!\");\n                    }\n\n                break;\n\n\n                case \"differences\":\n                    //console.log(\"difference\");\n                    if(vm.temporary.difference && vm.temporary.difference !== \"\"){\n                        //then we can add it\n                        //console.log(\"here we go\");\n                        var add_difference = {\n                            difference_id: vm.temporary.difference.id,\n                            difference_title: vm.temporary.difference.title\n                        };\n\n                        //check if it doesnt exist first...\n                        if(containsObject(add_difference, vm.club.plane.requirements.differences, new Array(\"difference_id\", \"difference_title\")) == false){\n                            vm.club.plane.requirements.differences.push(add_difference);\n                        }\n\n                        delete vm.temporary.difference;\n\n                    } else {\n                        alert(\"Please select a difference that is required to book the plane solo!\");\n                    }\n\n                break;\n\n\n            }\n\n\n\n        }\n\n\n        $scope.remove_item = function(type, index){\n            //console.log(\"REMOVE\");\n\n            vm.club.plane.requirements[type].splice(index, 1);\n\n\n            // switch(type){\n            //     case \"licence\":\n            //             //console.log(\"licence\");\n                   \n            //             //check if it doesnt exist first...\n            //             // if(containsObject(add_licence, vm.club.plane.requirements.licence, new Array(\"licence_id\", \"rating_id\")) == false){\n            //             //     vm.club.plane.requirements.licence.push(add_licence);\n            //             // }\n\n            //             vm.club.plane.requirements.licence.splice(index, 1);\n                      \n                   \n\n            //     break;\n\n\n            //     case \"medical\":\n            //         //console.log(\"medical\");\n            //         if(vm.temporary.medical_authority && vm.temporary.medical_authority !== \"\" && vm.temporary.medical_component && vm.temporary.medical_component !== \"\"){\n            //             //then we can add it\n            //             //console.log(\"here we go\");\n            //             var add_medical = {\n            //                 authority_id: vm.temporary.medical_authority.id,\n            //                 authority_title: vm.temporary.medical_authority.abbreviation,\n            //                 medical_component_id: vm.temporary.medical_component.id,\n            //                 medical_component_title: vm.temporary.medical_component.title\n            //             };\n\n            //             //check if it doesnt exist first...\n            //             if(containsObject(add_medical, vm.club.plane.requirements.medical, new Array(\"authority_id\", \"medical_component_id\")) == false){\n            //                 vm.club.plane.requirements.medical.push(add_medical);\n            //             }\n\n            //             delete vm.temporary.medical_authority;\n            //             delete vm.temporary.medical_component;\n\n            //         } else {\n            //             alert(\"Please select a medical that is required to book the plane solo!\");\n            //         }\n\n            //     break;\n\n\n            //     case \"differences\":\n            //         //console.log(\"difference\");\n            //         if(vm.temporary.difference && vm.temporary.difference !== \"\"){\n            //             //then we can add it\n            //             //console.log(\"here we go\");\n            //             var add_difference = {\n            //                 difference_id: vm.temporary.difference.id,\n            //                 difference_title: vm.temporary.difference.title\n            //             };\n\n            //             //check if it doesnt exist first...\n            //             if(containsObject(add_difference, vm.club.plane.requirements.differences, new Array(\"difference_id\", \"difference_title\")) == false){\n            //                 vm.club.plane.requirements.differences.push(add_difference);\n            //             }\n\n            //             delete vm.temporary.difference;\n\n            //         } else {\n            //             alert(\"Please select a difference that is required to book the plane solo!\");\n            //         }\n\n            //     break;\n\n\n            // }\n\n\n\n        }\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n        $scope.update_this_file = function(file){\n            //console.log(\"==== update is : \", file.id);\n            if(update_this_file.indexOf(file.id) === -1){\n                update_this_file.push(file.id)\n            } else {\n               ////console.log(\"This item already exists\"); \n            } \n        }\n\n\n         $scope.remove_real_file = function(file){\n\n                //remove_file\n\n                vm.club.plane.plane_documents = $.grep(vm.club.plane.plane_documents, function(e){ \n                        return e.id != file.id; \n                    });\n\n                //no need to actually remove the file as it will be archived accordingly on the backend whilst it is missing! :)\n                PlaneDocumentService.Delete(vm.user_id, file.id)\n                .then(function (data) {\n                    //console.log(data);\n                    if(data.success){\n                        //console.log(\"HUZZAH\", current_files);\n                        //then we need to remove this from the list of files...\n                        //clear files\n                        vm.plane_documents = [];\n                        //and re-process available files\n                        $scope.processFiles(current_files);\n\n                    } else {\n                        //console.log(\"WOOOPSIES...\");\n                        //this should be very very rare...\n                    }\n\n                });\n\n          }\n\n\n        vm.files = {\n            radio: [],\n            cert: [],\n            insurance: [],\n            noise: []\n        }\n\n\n           $scope.processFile = function(files, location){\n                 //console.log(\"files\", files[0].file_return);\n\n                     // //console.log(\"JSON\", files[i].file_return);\n                    var j = JSON.parse(files[0].file_return);\n                     ////console.log(\"PARSED\", j);\n                    // //console.log(\"J is : \",j);\n                    // //console.log(\"name is : \", j.files.file.name);\n\n                    files[0].file.temp_path = j.saved_url;\n                    files[0].file.save_name = j.files.file.name;\n\n                    var ft = j.files.file.name;\n                    //console.log(\"ft\", ft);\n                    var fft = ft.split('.').pop();\n                    files[0].file.extension = fft;\n                    //console.log(\"FILE is : \", files[0]);\n\n                    // //console.log(\"file\", files[i].file);\n                    vm.files[location].push(files[0].file);\n\n\n            }\n\n            $scope.set_title = function(file){\n                //console.log(\"return\", file);\n                return file.save_name;\n            }\n\n\n          \n          $scope.remove_file = function(file, current_files){\n\n            //remove_file\n            var j = JSON.parse(file.file_return);\n            //console.log(\"REMOVE: \", j);\n            //console.log(\"REMOVE: \", j.saved_url);\n\n            //to delete the temp file created: j.saved_url\n            //tmp_rm.php POST tmp = filename\n            \n            PoidService.DeleteTmp(j.saved_url)\n                .then(function (data) {\n                    //console.log(data);\n                    if(data.success){\n                        //console.log(\"HUZZAH\", current_files);\n                        //then we need to remove this from the list of files...\n                        //clear files\n                        vm.plane_documents = [];\n                        //and re-process available files\n                        $scope.processFiles(current_files);\n\n                    } else {\n                        //console.log(\"WOOOPSIES...\");\n                        //this should be very very rare...\n                    }\n\n                });\n\n          }\n          \n\n          // $scope.$on('flow::fileAdded', function (event, $flow, flowFile) {\n          //     event.preventDefault();//prevent file from uploading\n          //     //console.log(\"FILE ADDED\");\n          //     //console.log($flow);\n          //   });\n\n            $scope.processFiles = function(files){\n                // //console.log(\"files\", files);\n\n                for(var i=0; i<files.length; i++){\n                    // //console.log(\"JSON\", files[i].file_return);\n                    var j = JSON.parse(files[i].file_return);\n                    // //console.log(\"PARSED\", j);\n                    //console.log(\"J is : \",j);\n                    //console.log(\"name is : \", j.files.file.name);\n\n                    files[i].file.temp_path = j.saved_url;\n                    files[i].file.save_name = j.files.file.name;\n                    var ft = j.files.file.name;\n                    ft = ft.split('.').pop();\n                    files[i].file.extension = ft;\n\n                    // //console.log(\"file\", files[i].file);\n                    vm.plane_documents.push(files[i].file);\n                }\n\n\n            }\n\n            $scope.set_title = function(file){\n                //console.log(\"return\", file);\n                return file.save_name;\n            }\n\n            $scope.get_icon = function(file){\n\n                var ft = file.name;\n                ft = ft.split('.').pop();\n                var icon_name = \"\";\n\n                // //console.log(\"FILE:\", ft);\n                // //console.log(\"index : \", ft.indexOf(\"pdf\"));\n                switch(true){\n                    case (ft.indexOf(\"pdf\") > -1):\n                        icon_name = \"pdf.png\";\n                    break;\n                    case (ft.indexOf(\"doc\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"docx\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"xls\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"xlsx\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"ppt\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"pptx\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"jpg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"jpeg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"png\") > -1):\n                        icon_name = \"png.png\";\n                    break;\n                    case (ft.indexOf(\"gif\") > -1):\n                        icon_name = \"gif.png\";\n                    break;\n                    case (ft.indexOf(\"zip\") > -1):\n                        icon_name = \"zip.png\";\n                    break;\n                    case (ft.indexOf(\"avi\") > -1):\n                        icon_name = \"avi.png\";\n                    break;\n                    case (ft.indexOf(\"mp4\") > -1):\n                        icon_name = \"mp4.png\";\n                    break;\n                    default:\n                        icon_name = \"file.png\";\n                    break;\n                }\n\n                // //console.log(\"FILE:\", icon_name);\n\n                return \"images/file_icons/\"+icon_name;\n            }\n\n\n            $scope.get_icon2 = function(file){\n\n                var ft = file.split('.').pop();\n                // //console.log(\"ICON 2 : \", ft);\n                var icon_name = \"\";\n\n                // //console.log(\"FILE:\", ft);\n                // //console.log(\"index : \", ft.indexOf(\"pdf\"));\n                switch(true){\n                    case (ft.indexOf(\"pdf\") > -1):\n                        icon_name = \"pdf.png\";\n                    break;\n                    case (ft.indexOf(\"doc\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"docx\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"xls\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"xlsx\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"ppt\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"pptx\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"jpg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"jpeg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"png\") > -1):\n                        icon_name = \"png.png\";\n                    break;\n                    case (ft.indexOf(\"gif\") > -1):\n                        icon_name = \"gif.png\";\n                    break;\n                    case (ft.indexOf(\"zip\") > -1):\n                        icon_name = \"zip.png\";\n                    break;\n                    case (ft.indexOf(\"avi\") > -1):\n                        icon_name = \"avi.png\";\n                    break;\n                    case (ft.indexOf(\"mp4\") > -1):\n                        icon_name = \"mp4.png\";\n                    break;\n                    default:\n                        icon_name = \"file.png\";\n                    break;\n                }\n\n                // //console.log(\"FILE:\", icon_name);\n\n                return \"images/file_icons/\"+icon_name;\n            }\n\n\n\n            $scope.delete_poid = function(id){\n\n              \n                var a = prompt(\"Are you sure you wish to delete this poid? \\n\\n This change is irreversible! To confirm please type YES in the box below.\");\n                if(a == \"YES\"){\n\n\n                    //console.log(\"WE DELETE IT\");\n\n\n                    // PoidService.Delete(vm.user_id, id)\n                    //     .then(function (data) {\n                    //         //console.log(data);\n                    //         if(data.success){\n                    //             //console.log(\"HUZZAH\", data);\n                    //             //then we need to remove this from the list of files...\n                    //             vm.user_poids = $.grep(vm.user_poids, function(e){ \n                    //                 return e.id != id; \n                    //             });\n                                \n                    //             //refresh?\n                    //             $state.reload();\n                    //             $state.go('dashboard.my_account.poid');\n\n                    //         } else {\n\n                    //             alert(\"Something went terribly wrong... \\n\\n \"+data.message);\n\n                    //         }\n\n                    //     });\n\n\n\n                } else {\n                    //console.log(\"ignore123\");\n                }\n\n\n            }\n\n\n\n\n            $scope.save_plane_documents = function(){\n\n               \n              \n\n                //console.log(\"plane_documents: \", vm.plane_documents);\n\n\n                //compile the required elements YAY\n\n                //console.log(\"plane_document \", vm.plane_document);\n\n\n                 //clean shizzle before sending\n                 //why keep sending back heavy data?\n\n                    // for(var i=0;i<vm.plane_document.images.length;i++){\n                    //     delete vm.plane_document.images[i].data_uri;\n                    // }\n\n                    // // vm.plane_document.images = vm.plane_documents;\n                    // vm.plane_document.images = vm.plane_document.images.concat(vm.plane_documents);\n                    // vm.plane_document.user_id = vm.user_id;\n\n\n\n\n            //     if(vm.plane_document.id){\n            //         //then its an udpate\n\n            //         //merge the images left?\n            //         PoidService.Update(vm.plane_document)\n            //             .then(function (data) {\n            //                 //console.log(data);\n            //                 if(data.success){\n            //                     //console.log(\"HUZZAH\", vm.plane_document);\n            //                     //console.log(\"HUZZAH\", data);\n            //                     //then we need to remove this from the list of files...\n                                \n                                \n            //                     //move somewhere?\n            //                     $state.go('dashboard.my_account.poid', {}, { reload: true });\n\n\n\n\n\n            //                 } else {\n\n            //                     alert(\"Something went terribly wrong... \\n\\n \"+data.message);\n\n            //                 }\n\n            //             });\n\n            //     } else {\n\n\n                   \n\n\n            //         //then its a create\n            //         //console.log(vm.plane_document);\n\n            //         PoidService.Create(vm.plane_document)\n            //             .then(function (data) {\n            //                 //console.log(data);\n            //                 if(data.success){\n            //                     //console.log(\"HUZZAH\", vm.plane_document);\n            //                     //console.log(\"HUZZAH\", data);\n            //                     //then we need to remove this from the list of files...\n                                \n                                \n            //                     //move somewhere?\n            //                    // $state.reload();\n            //                    // $state.go('dashboard.my_account.poid', {}, { reload: true });\n\n\n            //                 } else {\n\n            //                     alert(\"Something went terribly wrong... \\n\\n \"+data.message);\n\n            //                 }\n\n            //             });\n\n\n            //     }\n\n\n\n             };\n\n\n\n\n             $scope.change_file_name = function(file){\n                \n                //this is terribly ineficient... unfortunately... can't \n                //work out how else to do it! (lol)\n\n                // //console.log(\"TO BE CHANGED\", file);\n\n                // //console.log(\"BEFORE BEFORE\", vm.plane_documents);\n\n                vm.plane_documents = $.grep(vm.plane_documents, function(e){ \n                    return e.temp_path != file.temp_path; \n                });\n\n                // //console.log(\"BEFORE\", vm.plane_documents);\n\n                vm.plane_documents.push(file);\n\n                // //console.log(\"AFTER\", vm.plane_documents);\n\n             }\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n        initController();\n\n        function initController() {\n           //console.log(\"check if access is okay\");\n        }\n\n\n          var warning_msg = \"By deleting this plane, you will also cancel all reservations that this plane currently has.\"\n\n          // $scope.open = function (plane_id) {\n          //   var modalInstance = $uibModal.open({\n          //     animation: true,\n          //     templateUrl: 'views/modals/deleteModal.html',\n          //     controller: 'ModalInstanceCtrl',\n          //     //params: {},\n          //     size: \"lg\",\n          //     resolve: {\n          //       id: function () {\n          //         return plane_id;\n          //       },\n          //       warning: function(){\n          //           return warning_msg;\n          //       }\n          //     }\n          //   });\n          //   modalInstance.result.then(function (plane_id) {\n          //     $log.info('PRESSED GO: '+plane_id);\n          //     PlaneService.Delete(plane_id)\n          //     .then(function(){\n          //       //console.log(\"HELLO DELETE\");\n          //       //update view?\n          //        vm.club.planes = $.grep(vm.club.planes, function(e){ \n          //           return e.plane_id != plane_id; \n          //       });\n          //     })\n          //   }, function () {\n          //     $log.info('Modal dismissed at: ' + new Date());\n          //   });\n          // };\n\n            $scope.open = function (club_plane_id) {\n            var modalInstance = $uibModal.open({\n              animation: true,\n              templateUrl: 'views/modals/deleteModal.html',\n              controller: 'ModalInstanceCtrl',\n              size: \"lg\",\n              resolve: {\n                id: function () {\n                  return club_plane_id;\n                },\n                params: function() {\n                  return {id: club_plane_id};\n                },\n                warning: function(){\n                    return warning_msg;\n                }\n              }\n            });\n            modalInstance.result.then(function (plane) {\n                var id = plane.id;\n              $log.info('PRESSED GO: ', id);\n              \n              PlaneService.Delete(id)\n              .then(function(){\n                //console.log(\"HELLO DELETE\");\n                //update view?\n                 vm.club.planes = $.grep(vm.club.planes, function(e){ \n                    return e.id != id; \n                });\n             });\n\n            }, function () {\n              $log.info('Modal dismissed at: ' + new Date());\n            });\n\n\n          };\n         \n\n         vm.aircraft;\n         vm.plane_search;\n         vm.plane_to_add;\n\n         $scope.get_aircraft = function(registration){\n\n            if(registration.length > 3){\n\n                 PlaneService.GetAddAircraft(registration)\n                .then(function (data) {\n                    ////console.log(data);\n                    if(data){\n                        //use GB airfields first...\n                         \n                        // vm.aircraft = data;\n                        // console.log(\"one is : \", data[0]);\n                       \n                         if(data.length == 0){\n                            // console.log(\"SETTINGS HERE\");\n                              vm.aircraft = [\n                                    {\n                                        icao_type: \"not known\",\n                                        registration: registration.toUpperCase()\n                                    }];\n                        } else {\n                            vm.aircraft = data;\n                        }\n\n                    } else {\n\n                          vm.aircraft = [\n                                    {\n                                        icao_type: \"not known\",\n                                        registration: registration.toUpperCase()\n                                    }];\n\n                                    //console.log(vm.aircraft);\n                        // console.log(\"WOOOPSIES...\");\n                        //this should be very very rare...\n                    }\n\n                });\n\n\n            }\n\n            \n        }\n\n\n    }\n app.controller('DashboardClubPropellerLogbookController', DashboardClubPropellerLogbookController);\n\n    DashboardClubPropellerLogbookController.$inject = ['UserService', 'PlaneService', '$rootScope', '$location', '$scope', '$state', '$stateParams', '$uibModal', '$log', '$window', 'LicenceService', 'MedicalService', 'DifferencesService', 'PlaneDocumentService', '$http'];\n    function DashboardClubPropellerLogbookController(UserService, PlaneService, $rootScope, $location, $scope, $state, $stateParams, $uibModal, $log, $window, LicenceService, MedicalService, DifferencesService, PlaneDocumentService, $http) {\n        var vm = this;\n\n       \n        \n        switch(vm.action){\n            case \"add\":\n                // //console.log(\"adding a new plane please\");\n                vm.page_title = \"Add a New Plane\";\n            break;\n            case \"edit\":\n                // //console.log(\"edit an existing plane\");\n                \n                PlaneService.GetByIdMaintenance2($stateParams.plane_id, vm.club_id)\n                    .then(function(data){\n                        vm.club.plane = data;  \n                        vm.this_plane_id = $stateParams.plane_id; \n\n                        if(vm.club.plane && vm.club.plane.maintenance){\n                            //console.log(\"vm.club.plane == > \", vm.club.plane);\n                            vm.obj.hours_remaining = vm.club.plane.maintenance.hours_remaining;\n                            vm.obj.next_check = new Date(vm.club.plane.maintenance.next_maintenance);\n                            vm.obj.check_date = new Date();\n                            vm.obj.extension_granted = new Date();\n                        }\n                       \n\n                        // vm.club.plane.requirements = {\n                        //         licence: [],\n                        //         medical: [],\n                        //         differences: [],\n                        //         hours: []\n                        // };\n                        // //console.log(\"BOOOO - get all planes....\");\n                        vm.page_title = \"Edit a Plane Maintenance - \"+vm.club.plane.registration;\n                    });\n\n                PlaneService.GetOpenIssues($stateParams.plane_id)\n                    .then(function (data) {\n                            ////console.log(\"data is : \", data);\n                           vm.reported_defects = data;\n                        });\n\n\n               \n\n\n            break;\n            case \"list\":\n                //need to update this to be part of the authentication\n                //to find out club id\n                // PlaneService.GetAllByClubMaintenance(vm.club_id)\n                //     .then(function(data){\n                //         vm.club.planes = data;   \n                //         // //console.log(vm.club.planes);\n                //     });\n            break;\n            default:\n                //console.log(\"none of the above... redirect somewhere?\");\n            break;\n        }  \n\n       \n\n        $scope.get_hours_from_decimal = function(time){\n\n            if(time){\n                 var sign = time < 0 ? \"-\" : \"\";\n                 var hour = Math.floor(Math.abs(time));\n                 var min = Math.round((Math.abs(time) * 60) % 60);\n                 if(min == 60){\n                     hour++;\n                     min = 0;\n                 }\n                 return sign + (hour < 10 ? \"0\" : \"\") + hour + \":\" + (min < 10 ? \"0\" : \"\") + min;\n             } else {\n                 return \"N/A\";\n             }\n            \n\n        }\n\n        vm.prop_no = \"\";\n\n        // PlaneService.GetAircraftJourneyLogs($stateParams.plane_id, 0, 25)\n        //     .then(function (data) {\n        //             // //console.log(\"ALL is : \", data);\n        //            // vm.logs = data.logs;\n        //            vm.aircraft = data.aircraft;\n        //            if(vm.aircraft.propeller_2_id > 0){\n\n        //                    // console.log(vm.aircraft);\n\n        //                if(vm.aircraft.propeller_2_id == $stateParams.prop_id){\n        //                    // console.log(\"show 2\");\n        //                    vm.prop_no = \"2\";\n        //                } else {\n        //                    // console.log(\"show 1\");\n        //                    vm.prop_no = \"1\";\n        //                }\n        //            }\n\n\n        //         });\n\n\n            PlaneService.GetPropLogs($stateParams.prop_id, $stateParams.plane_id, 0, 25)\n            .then(function (data) {\n                    // //console.log(\"ALL is : \", data);\n                   vm.logs = data.logs;\n                   vm.propeller = data.propeller;\n\n\n                });\n\n            vm.current_offset = 0;\n            vm.loaded_per_batch = 25;\n            vm.all_loaded = false;\n\n            vm.load_more = function(){\n                vm.current_offset = vm.current_offset + vm.loaded_per_batch;\n                PlaneService.GetPropLogs($stateParams.prop_id,$stateParams.plane_id, vm.current_offset, vm.loaded_per_batch)\n                .then(function (data) {\n                        // //console.log(\"ALL is : \", data);\n                        if(data.logs.length > 0){\n                            data.logs.forEach(log => vm.logs.push(log));\n                        } else {\n                            vm.all_loaded = true;\n                        }\n                       //vm.logs = data.logs;\n                       vm.propeller = data.propeller;\n\n\n                    });\n\n            }\n\n            vm.get_initial = function(text){\n                return text.charAt(0);\n            }\n\n\n            vm.clean_times = function(time){\n                if(time == \"00:00:00\"){\n                    return \" - \";\n                }\n                return time.substring(0,5);\n            }\n\n            vm.update_logbooks = function(){\n                \n\n                PlaneService.UpdateAircraftLogbooks($stateParams.plane_id)\n                .then(function (data) {\n                        \n                        if(data.success){\n\n                           PlaneService.GetPropLogs($stateParams.prop_id, $stateParams.plane_id, 0, 25)\n                            .then(function (data) {\n                                    // //console.log(\"ALL is : \", data);\n                                   vm.logs = data.logs;\n                                   vm.propeller = data.propeller;\n\n\n                                });\n\n                        }\n\n\n                    });\n            }\n\n\n\n        $scope.update_this_file = function(file){\n            //console.log(\"==== update is : \", file.id);\n            if(update_this_file.indexOf(file.id) === -1){\n                update_this_file.push(file.id)\n            } else {\n               ////console.log(\"This item already exists\"); \n            } \n        }\n\n\n         $scope.remove_real_file = function(file){\n\n                //remove_file\n\n                vm.club.plane.plane_documents = $.grep(vm.club.plane.plane_documents, function(e){ \n                        return e.id != file.id; \n                    });\n\n                //no need to actually remove the file as it will be archived accordingly on the backend whilst it is missing! :)\n                PlaneDocumentService.Delete(vm.user_id, file.id)\n                .then(function (data) {\n                    // //console.log(data);\n                    if(data.success){\n                        // //console.log(\"HUZZAH\", current_files);\n                        //then we need to remove this from the list of files...\n                        //clear files\n                        vm.plane_documents = [];\n                        //and re-process available files\n                        $scope.processFiles(current_files);\n\n                    } else {\n                        //console.log(\"WOOOPSIES...\");\n                        //this should be very very rare...\n                    }\n\n                });\n\n          }\n\n\n          \n          $scope.remove_file = function(file, current_files){\n\n            //remove_file\n            var j = JSON.parse(file.file_return);\n            // //console.log(\"REMOVE: \", j);\n            // //console.log(\"REMOVE: \", j.saved_url);\n\n            //to delete the temp file created: j.saved_url\n            //tmp_rm.php POST tmp = filename\n            \n\n            //this SHOULD BE TO THE CURRENT POSITION\n\n            // PoidService.DeleteTmp(j.saved_url)\n            //     .then(function (data) {\n            //         //console.log(data);\n            //         if(data.success){\n            //             //console.log(\"HUZZAH\", current_files);\n            //             //then we need to remove this from the list of files...\n            //             //clear files\n            //             vm.plane_documents = [];\n            //             //and re-process available files\n            //             $scope.processFiles(current_files);\n\n            //         } else {\n            //             //console.log(\"WOOOPSIES...\");\n            //             //this should be very very rare...\n            //         }\n\n            //     });\n\n          }\n          \n\n          // $scope.$on('flow::fileAdded', function (event, $flow, flowFile) {\n          //     event.preventDefault();//prevent file from uploading\n          //     //console.log(\"FILE ADDED\");\n          //     //console.log($flow);\n          //   });\n\n            vm.files = {\n                radio: [],\n                cert: [],\n                insurance: []\n            }\n\n\n            $scope.processFiles = function(files, location){\n                // //console.log(\"files\", files);\n\n                for(var i=0; i<files.length; i++){\n                    // //console.log(\"JSON\", files[i].file_return);\n                    var j = JSON.parse(files[i].file_return);\n                    // //console.log(\"PARSED\", j);\n                    // //console.log(\"J is : \",j);\n                    // //console.log(\"name is : \", j.files.file.name);\n\n                    files[i].file.temp_path = j.saved_url;\n                    files[i].file.save_name = j.files.file.name;\n                    var ft = j.files.file.name;\n                    ft = ft.split('.').pop();\n                    files[i].file.extension = ft;\n\n                    // //console.log(\"file\", files[i].file);\n                    vm.files[location].push(files[i].file);\n                }\n\n\n            }\n\n\n             $scope.processFile = function(files, location){\n                 //console.log(\"files\", files[0].file_return);\n\n                    // //console.log(\"JSON\", files[i].file_return);\n                    var j = JSON.parse(files[0].file_return);\n                    // //console.log(\"PARSED\", j);\n                    // //console.log(\"J is : \",j);\n                    // //console.log(\"name is : \", j.files.file.name);\n\n                    files[0].file.temp_path = j.saved_url;\n                    files[0].file.save_name = j.files.file.name;\n\n                    var ft = j.files.file.name;\n                    // //console.log(\"ft\", ft);\n                    var fft = ft.split('.').pop();\n                    files[0].file.extension = fft;\n                    // //console.log(\"FILE is : \", files[0]);\n\n                    // //console.log(\"file\", files[i].file);\n                    vm.files[location].push(files[0]);\n\n\n            }\n\n            $scope.set_title = function(file){\n                // //console.log(\"return\", file);\n                return file.save_name;\n            }\n\n            $scope.get_icon = function(file){\n\n                var ft = file.name;\n                ft = ft.split('.').pop();\n                var icon_name = \"\";\n\n                // //console.log(\"FILE:\", ft);\n                // //console.log(\"index : \", ft.indexOf(\"pdf\"));\n                switch(true){\n                    case (ft.indexOf(\"pdf\") > -1):\n                        icon_name = \"pdf.png\";\n                    break;\n                    case (ft.indexOf(\"doc\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"docx\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"xls\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"xlsx\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"ppt\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"pptx\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"jpg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"jpeg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"png\") > -1):\n                        icon_name = \"png.png\";\n                    break;\n                    case (ft.indexOf(\"gif\") > -1):\n                        icon_name = \"gif.png\";\n                    break;\n                    case (ft.indexOf(\"zip\") > -1):\n                        icon_name = \"zip.png\";\n                    break;\n                    case (ft.indexOf(\"avi\") > -1):\n                        icon_name = \"avi.png\";\n                    break;\n                    case (ft.indexOf(\"mp4\") > -1):\n                        icon_name = \"mp4.png\";\n                    break;\n                    default:\n                        icon_name = \"file.png\";\n                    break;\n                }\n\n                // //console.log(\"FILE:\", icon_name);\n\n                return \"images/file_icons/\"+icon_name;\n            }\n\n\n            $scope.get_icon2 = function(file){\n                ////console.log(\"FILE\", file);\n                if(!file || file == \"\"){\n                    return \"\";\n                }\n                var ft = file.split('.').pop();\n                // //console.log(\"ICON 2 : \", ft);\n                var icon_name = \"\";\n\n                // //console.log(\"FILE:\", ft);\n                // //console.log(\"index : \", ft.indexOf(\"pdf\"));\n                switch(true){\n                    case (ft.indexOf(\"pdf\") > -1):\n                        icon_name = \"pdf.png\";\n                    break;\n                    case (ft.indexOf(\"doc\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"docx\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"xls\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"xlsx\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"ppt\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"pptx\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"jpg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"jpeg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"png\") > -1):\n                        icon_name = \"png.png\";\n                    break;\n                    case (ft.indexOf(\"gif\") > -1):\n                        icon_name = \"gif.png\";\n                    break;\n                    case (ft.indexOf(\"zip\") > -1):\n                        icon_name = \"zip.png\";\n                    break;\n                    case (ft.indexOf(\"avi\") > -1):\n                        icon_name = \"avi.png\";\n                    break;\n                    case (ft.indexOf(\"mp4\") > -1):\n                        icon_name = \"mp4.png\";\n                    break;\n                    default:\n                        icon_name = \"file.png\";\n                    break;\n                }\n\n                // //console.log(\"FILE:\", icon_name);\n\n                return \"images/file_icons/\"+icon_name;\n            }\n\n\n            vm.defect_severity;\n                vm.defect_severities = [\n                    { title: \"No Fly Item - Ground the plane\"},\n                    { title: \"Flyable - needs to be checked at next maintenance\"},\n                    { title: \"Not urgent - but needs noting\"},\n                    { title: \"Unsure of severity\"}\n                ]; \n\n\n            $scope.delete_poid = function(id){\n\n              \n                var a = prompt(\"Are you sure you wish to delete this poid? \\n\\n This change is irreversible! To confirm please type YES in the box below.\");\n                if(a == \"YES\"){\n\n\n                    //console.log(\"WE DELETE IT\");\n\n\n                    // PoidService.Delete(vm.user_id, id)\n                    //     .then(function (data) {\n                    //         //console.log(data);\n                    //         if(data.success){\n                    //             //console.log(\"HUZZAH\", data);\n                    //             //then we need to remove this from the list of files...\n                    //             vm.user_poids = $.grep(vm.user_poids, function(e){ \n                    //                 return e.id != id; \n                    //             });\n                                \n                    //             //refresh?\n                    //             $state.reload();\n                    //             $state.go('dashboard.my_account.poid');\n\n                    //         } else {\n\n                    //             alert(\"Something went terribly wrong... \\n\\n \"+data.message);\n\n                    //         }\n\n                    //     });\n\n\n\n                } else {\n                    //console.log(\"ignore123\");\n                }\n\n\n            }\n\n\n\n\n            $scope.save_plane_documents = function(){\n\n               \n              \n\n                // //console.log(\"plane_documents: \", vm.plane_documents);\n\n\n                //compile the required elements YAY\n\n                // //console.log(\"plane_document \", vm.plane_document);\n\n\n                 //clean shizzle before sending\n                 //why keep sending back heavy data?\n\n                    // for(var i=0;i<vm.plane_document.images.length;i++){\n                    //     delete vm.plane_document.images[i].data_uri;\n                    // }\n\n                    // // vm.plane_document.images = vm.plane_documents;\n                    // vm.plane_document.images = vm.plane_document.images.concat(vm.plane_documents);\n                    // vm.plane_document.user_id = vm.user_id;\n\n\n\n\n            //     if(vm.plane_document.id){\n            //         //then its an udpate\n\n            //         //merge the images left?\n            //         PoidService.Update(vm.plane_document)\n            //             .then(function (data) {\n            //                 //console.log(data);\n            //                 if(data.success){\n            //                     //console.log(\"HUZZAH\", vm.plane_document);\n            //                     //console.log(\"HUZZAH\", data);\n            //                     //then we need to remove this from the list of files...\n                                \n                                \n            //                     //move somewhere?\n            //                     $state.go('dashboard.my_account.poid', {}, { reload: true });\n\n\n\n\n\n            //                 } else {\n\n            //                     alert(\"Something went terribly wrong... \\n\\n \"+data.message);\n\n            //                 }\n\n            //             });\n\n            //     } else {\n\n\n                   \n\n\n            //         //then its a create\n            //         //console.log(vm.plane_document);\n\n            //         PoidService.Create(vm.plane_document)\n            //             .then(function (data) {\n            //                 //console.log(data);\n            //                 if(data.success){\n            //                     //console.log(\"HUZZAH\", vm.plane_document);\n            //                     //console.log(\"HUZZAH\", data);\n            //                     //then we need to remove this from the list of files...\n                                \n                                \n            //                     //move somewhere?\n            //                    // $state.reload();\n            //                    // $state.go('dashboard.my_account.poid', {}, { reload: true });\n\n\n            //                 } else {\n\n            //                     alert(\"Something went terribly wrong... \\n\\n \"+data.message);\n\n            //                 }\n\n            //             });\n\n\n            //     }\n\n\n\n             };\n\n\n\n\n             $scope.change_file_name = function(file){\n                \n                //this is terribly ineficient... unfortunately... can't \n                //work out how else to do it! (lol)\n\n                // //console.log(\"TO BE CHANGED\", file);\n\n                // //console.log(\"BEFORE BEFORE\", vm.plane_documents);\n\n                vm.plane_documents = $.grep(vm.plane_documents, function(e){ \n                    return e.temp_path != file.temp_path; \n                });\n\n                // //console.log(\"BEFORE\", vm.plane_documents);\n\n                vm.plane_documents.push(file);\n\n                // //console.log(\"AFTER\", vm.plane_documents);\n\n             }\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n        initController();\n\n        function initController() {\n           //console.log(\"check if access is okay\");\n        }\n\n\n          //var warning_msg = \"By deleting this plane, you will also cancel all reservations that this plane currently has.\"\n\n          // $scope.open = function (plane_id) {\n          //   var modalInstance = $uibModal.open({\n          //     animation: true,\n          //     templateUrl: 'views/modals/deleteModal.html',\n          //     controller: 'ModalInstanceCtrl',\n          //     //params: {},\n          //     size: \"lg\",\n          //     resolve: {\n          //       id: function () {\n          //         return plane_id;\n          //       },\n          //       warning: function(){\n          //           return warning_msg;\n          //       }\n          //     }\n          //   });\n          //   modalInstance.result.then(function (plane_id) {\n          //     $log.info('PRESSED GO: '+plane_id);\n          //     PlaneService.Delete(plane_id)\n          //     .then(function(){\n          //       //console.log(\"HELLO DELETE\");\n          //       //update view?\n          //        vm.club.planes = $.grep(vm.club.planes, function(e){ \n          //           return e.plane_id != plane_id; \n          //       });\n          //     })\n          //   }, function () {\n          //     $log.info('Modal dismissed at: ' + new Date());\n          //   });\n          // };\n\n            $scope.open = function (club_plane_id) {\n            var modalInstance = $uibModal.open({\n              animation: true,\n              templateUrl: 'views/modals/deleteModal.html',\n              controller: 'ModalInstanceCtrl',\n              size: \"lg\",\n              resolve: {\n                id: function () {\n                  return club_plane_id;\n                },\n                params: function() {\n                  return {id: club_plane_id};\n                },\n                warning: function(){\n                    return warning_msg;\n                }\n              }\n            });\n            modalInstance.result.then(function (plane) {\n                var id = plane.id;\n              $log.info('PRESSED GO: ', id);\n              \n              PlaneService.Delete(id)\n              .then(function(){\n                // //console.log(\"HELLO DELETE\");\n                //update view?\n                 vm.club.planes = $.grep(vm.club.planes, function(e){ \n                    return e.id != id; \n                });\n             });\n\n            }, function () {\n              $log.info('Modal dismissed at: ' + new Date());\n            });\n\n\n          };\n         \n          \n\n\n        //   $scope.downloadCertificate = function(doc) {\n        //     var data = $.param({\n        //         id: doc\n        //     });\n\n        //     var ddd = doc.replace(/^.*[\\\\\\/]/, '');\n\n        //     $http.get('api/v1/plane_certificate/show_file/'+ddd, {\n        //             responseType: 'arraybuffer'\n        //         })\n        //         .success(function(data, status, headers) {\n        //             var zipName = processArrayBufferToBlob(data, headers);\n\n        //             //Delete file from temp folder in server - file needs to remain open until blob is created\n        //             //deleteFileFromServerTemp(zipName);\n        //         }).error(function(data, status) {\n        //             alert(\"There was an error downloading the selected document(s).\");\n        //         })\n        // };\n\n\n        // $scope.downloadInsurance = function(doc) {\n        //     var data = $.param({\n        //         id: doc\n        //     });\n\n        //     var ddd = doc.replace(/^.*[\\\\\\/]/, '');\n\n        //     $http.get('api/v1/plane_insurance/show_file/'+ddd, {\n        //             responseType: 'arraybuffer'\n        //         })\n        //         .success(function(data, status, headers) {\n        //             var zipName = processArrayBufferToBlob(data, headers);\n\n        //             //Delete file from temp folder in server - file needs to remain open until blob is created\n        //             //deleteFileFromServerTemp(zipName);\n        //         }).error(function(data, status) {\n        //             alert(\"There was an error downloading the selected document(s).\");\n        //         })\n        // };\n\n\n\n\n        $scope.downloadDocument = function(doc, type = 'docs') {\n            var data = $.param({\n                id: doc\n            });\n\n            var controller = \"plane_documents\";\n\n            switch(type){\n                 case \"radio\": \n                    controller = \"plane_radio_licence\";\n                break;\n                 case \"insurance\": \n                    controller = \"plane_insurance\";\n                break;\n                 case \"certificate\": \n                    controller = \"plane_certificate\";\n                break;\n                case \"noise\": \n                    controller = \"plane_noise_certificate\";\n                break;\n                case \"docs\": \n                    controller = \"plane_documents\";\n                break;\n                default:\n                    controller = \"plane_documents\";\n                break;\n\n            }\n\n\n\n            var ddd = doc.replace(/^.*[\\\\\\/]/, '');\n\n            $http.get('api/v1/'+controller+'/show_file/'+ddd, {\n                    responseType: 'arraybuffer'\n                })\n                .success(function(data, status, headers) {\n                    var zipName = processArrayBufferToBlob(data, headers);\n\n                    //Delete file from temp folder in server - file needs to remain open until blob is created\n                    //deleteFileFromServerTemp(zipName);\n                }).error(function(data, status) {\n                    alert(\"There was an error downloading the selected document(s).\");\n                })\n        };\n\n        $scope.downloadClubDocument = function(doc) {\n            var data = $.param({\n                id: doc\n            });\n\n            var ddd = doc.replace(/^.*[\\\\\\/]/, '');\n\n            $http.get('api/v1/club_documents/show_file/'+ddd, {\n                    responseType: 'arraybuffer'\n                })\n                .success(function(data, status, headers) {\n                    var zipName = processArrayBufferToBlob(data, headers);\n\n                    //Delete file from temp folder in server - file needs to remain open until blob is created\n                    //deleteFileFromServerTemp(zipName);\n                }).error(function(data, status) {\n                    alert(\"There was an error downloading the selected document(s).\");\n                })\n        };\n\n        function processArrayBufferToBlob(data, headers) {\n            var octetStreamMime = 'application/octet-stream';\n            var success = false;\n\n            // Get the headers\n            headers = headers();\n            //var ttt = title.toLowerCase().replace(/\\W/g, '_');\n            // Get the filename from the x-filename header or default to \"download.bin\"\n            var filename = headers['x-filename'] || 'download.zip';\n\n            // Determine the content type from the header or default to \"application/octet-stream\"\n            var contentType = headers['content-type'] || octetStreamMime;\n\n            try {\n                // Try using msSaveBlob if supported\n                var blob = new Blob([data], {\n                    type: contentType\n                });\n                if (navigator.msSaveBlob)\n                    navigator.msSaveBlob(blob, filename);\n                else {\n                    // Try using other saveBlob implementations, if available\n                    var saveBlob = navigator.webkitSaveBlob || navigator.mozSaveBlob || navigator.saveBlob;\n                    if (saveBlob === undefined) throw \"Not supported\";\n                    saveBlob(blob, filename);\n                }\n                success = true;\n            } catch (ex) {\n                $log.info(\"saveBlob method failed with the following exception:\");\n                $log.info(ex);\n            }\n\n            if (!success) {\n                // Get the blob url creator\n                var urlCreator = window.URL || window.webkitURL || window.mozURL || window.msURL;\n                if (urlCreator) {\n                    // Try to use a download link\n                    var link = document.createElement('a');\n                    if ('download' in link) {\n                        // Try to simulate a click\n                        try {\n                            // Prepare a blob URL\n                            var blob = new Blob([data], {\n                                type: contentType\n                            });\n                            var url = urlCreator.createObjectURL(blob);\n                            link.setAttribute('href', url);\n\n                            // Set the download attribute (Supported in Chrome 14+ / Firefox 20+)\n                            link.setAttribute(\"download\", filename);\n\n                            // Simulate clicking the download link\n                            var event = document.createEvent('MouseEvents');\n                            event.initMouseEvent('click', true, true, window, 1, 0, 0, 0, 0, false, false, false, false, 0, null);\n                            link.dispatchEvent(event);\n                            success = true;\n\n                        } catch (ex) {\n                            $log.info(\"Download link method with simulated click failed with the following exception:\");\n                            $log.info(ex);\n                        }\n                    }\n\n                    if (!success) {\n                        // Fallback to window.location method\n                        try {\n                            // Prepare a blob URL\n                            // Use application/octet-stream when using window.location to force download\n                            var blob = new Blob([data], {\n                                type: octetStreamMime\n                            });\n                            var url = urlCreator.createObjectURL(blob);\n                            window.location = url;\n                            success = true;\n                        } catch (ex) {\n                            $log.info(\"Download link method with window.location failed with the following exception:\");\n                            $log.info(ex);\n                        }\n                    }\n                }\n            }\n\n            if (!success) {\n                // Fallback to window.open method\n                $log.info(\"No methods worked for saving the arraybuffer, using last resort window.open\");\n                window.open(httpPath, '_blank', '');\n            }\n            return filename;\n        };\n\n\n\n        $scope.search2 = function(row){\n            //(angular.lowercase(row.first_name).indexOf(angular.lowercase($scope.my_search2) || '') !== -1)  || (angular.lowercase(row.last_name).indexOf(angular.lowercase($scope.my_search2) || '') !== -1)\n            ////console.log(\"answer\", (angular.lowercase(row.flight_date).indexOf(angular.lowercase($scope.my_search2) || '') !== -1));\n            // return ((angular.lowercase(row.flight_date).indexOf(angular.lowercase($scope.my_search2) || (angular.lowercase(row.flight_time).indexOf(angular.lowercase($scope.my_search2)) || '') !== -1)));\n            //(angular.lowercase(row.flight_date).indexOf(angular.lowercase($scope.my_search2) || '') !== -1)\n           \n            // if( (test_date($scope.my_search2, row.flight_date)) || (angular.lowercase(row.destination_airport).indexOf(angular.lowercase($scope.my_search2) || '') !== -1) || (angular.lowercase(row.departure_airport).indexOf(angular.lowercase($scope.my_search2) || '') !== -1) || (angular.lowercase(row.destination_airport_code).indexOf(angular.lowercase($scope.my_search2) || '') !== -1) || (angular.lowercase(row.departure_airport_code).indexOf(angular.lowercase($scope.my_search2) || '') !== -1)){\n            //     return true;\n            // } else {\n            //     return false;\n            // }test_aircraft\n\n            //console.log(\"TEST \" , test_date($scope.my_search2));\n\n            ////console.log($scope.my_search2);\n            if(!$scope.my_search2 || ($scope.my_search2 == \"\")){\n                return true;\n            } else if(test_date($scope.my_search2, row.entry_date)){\n                return true;\n            } else {\n                return false;\n            }\n\n            // we are testing for the date, the pilot, the departure and destination.\n\n            // return (angular.lowercase(row.flight_date).indexOf(angular.lowercase($scope.my_search2) || '') !== -1); // ? (angular.lowercase(row.flight_date).indexOf(angular.lowercase($scope.my_search2) || '') !== -1) : (angular.lowercase(row.flight_time).indexOf(angular.lowercase($scope.my_search2) || '') !== -1);\n\n        };\n\n        function test_date(search, date){\n\n\n            if(search.length < 2){\n                return false;\n            }\n\n            if(search && search.length <= 3){\n                if(date.indexOf(search) > -1){\n                    return true;\n                }\n            } else {\n                var parsed_date = \"\";\n                var b = moment(search);\n                if(b.isValid() && b.format(\"YYYY\") != \"2001\"){\n                    parsed_date = b.format(\"YYYY-MM-DD\");\n                } else if(b.isValid()){\n                    parsed_date = b.format(\"MM-DD\");\n                }\n\n\n                var search_type = 0;\n\n                if(parsed_date !== \"\" && date.indexOf(parsed_date) > -1){\n                    // //console.log(\"found\");\n                    return true;\n                } else {\n\n                    //backup in case of wrong parsing data::;\n                    //european method\n\n                    if(search.length <= 5 && search.length >= 4){\n\n                        var c = moment(search, \"DDMM\");\n                        // //console.log(\"C is : \", c);\n                        if(c.isValid()){\n                            var c2 = c.format(\"MM-DD\");\n                            if(date.indexOf(c2) > -1){\n                                return true;\n                            }\n                        }\n\n                    } else if(search.length == 8 || search.length == 10){\n                        \n                        var c = moment(search, \"DDMMYYYY\");\n                        // //console.log(\"C is : \", c);\n                        if(c.isValid()){\n                            var c2 = c.format(\"YYYY-MM-DD\");\n                            if(date.indexOf(c2) > -1){\n                                return true;\n                            }\n                        }\n\n                    }\n\n                    // //console.log(\"not found\");\n                    return false;\n                }\n            }\n\n        }\n\n        $scope.getMySearchCount = function(str){\n            var docs = str.documents;\n            var total = 0;\n            for(var i=0;i<docs.length;i++){\n                if($scope.search(docs[i])){\n                    total++;\n                }\n            }\n            return total;\n        }\n\n        $scope.getMySearchCount2 = function(str){\n            var charges = str.charges;\n            var total = 0;\n            for(var i=0;i<charges.length;i++){\n                if($scope.search(charges[i])){\n                    total++;\n                }\n            }\n            return total;\n        }\n\n\n    }\n app.controller('DashboardClubReceiptsApprovalController', DashboardClubReceiptsApprovalController);\n\n    DashboardClubReceiptsApprovalController.$inject = ['UserService', 'PlaneService', '$rootScope', '$location', '$scope', '$state', '$stateParams', '$uibModal', '$log', '$window', 'LicenceService', 'MedicalService', 'DifferencesService', 'ItemService', '$sce'];\n    function DashboardClubReceiptsApprovalController(UserService, PlaneService, $rootScope, $location, $scope, $state, $stateParams, $uibModal, $log, $window, LicenceService, MedicalService, DifferencesService, ItemService, $sce) {\n        var vm = this;\n\n        vm.user = null;\n        vm.allUsers = [];\n        vm.club = {};\n        vm.page_title = \"\";\n        \n        vm.plane_document = {};\n        vm.plane_documents = [];\n\n        var update_this_file = [];\n        \n        vm.action = $state.current.data.action;\n        vm.club_id = $rootScope.globals.currentUser.current_club_admin.id;\n        vm.user = $rootScope.globals.currentUser;\n        vm.user_id = vm.user.id;\n\n        // //console.log(\"club_id : \"+vm.club_id);\n        // //console.log(vm.action);\n        // //console.log($stateParams);\n        // //console.log($stateParams.id);\n        \n        PlaneService.GetCurrencies(vm.club_id)\n         .then(function(data){\n                        vm.currencies = data.currencies;   \n                        vm.club_currency = data.club_currency;\n\n                    });\n\n\n        PlaneService.GetReceiptsApproval(vm.club_id)\n                    .then(function(data){\n                        vm.receipts = data.receipts;   \n                           \n                           //check for modded\n                           vm.receipts.forEach(receipt => {\n                               vm.verify_reimbursement(receipt);\n                           })\n\n                    });\n\n\n        $scope.get_currency = function(iso_code){\n\n           return $.grep(vm.currencies, function(e){ \n                        return e.iso_code == iso_code; \n                    })[0];\n\n        }\n        //'9' needs to refer the the user's account set to manage\n       \n\n        vm.update_price = function(receipt){\n            //console.log(\"change price\", receipt.modified_price);\n            var obj = {\n                modified_price: receipt.modified_price\n            };\n            PlaneService.UpdateReceipt(receipt.id, obj)\n            .then(function(data){\n                //console.log(\"UPDATE ::: \", data);\n\n                //maybe that's where we re-calculate the price?\n\n                vm.verify_reimbursement(receipt);\n\n            });\n        }\n\n        vm.verify_reimbursement = function(receipt){\n            //console.log(\"WE GET HERE VERIFY REIMBURSEMENT\");\n            // receipt.reimbursed_amount = 12.5;\n            // //console.log(\"receipt\", receipt);\n            if(receipt.modified_price && !receipt.modified_currency){\n                receipt.modified_reimbursed_amount = receipt.modified_price;\n                receipt.modified_reimbursed_difference = parseFloat(parseFloat(receipt.modified_reimbursed_amount) - parseFloat(receipt.reimbursed_amount));\n            } else if((!receipt.modified_price || !receipt.modified_currency) || receipt.reimbursement == 0){\n                return false;\n            }\n\n            //console.log(\"WE GET THERE\");\n\n            var receipt = $.grep(vm.receipts, function(e){ \n                        return e.id == receipt.id; \n                    })[0];\n\n            var obj = {\n                club_id: receipt.club_id,\n                currency: (receipt.modified_currency)? receipt.modified_currency : receipt.currency,\n                price: (receipt.modified_price) ? receipt.modified_price : receipt.price,\n                requested_at: receipt.created_at\n            }\n            PlaneService.CheckReimbursement(obj)\n            .then(function(data){\n                ////console.log(\"CHANGE ::: \", data.reimburse.reimbursed_amount);\n\n                //maybe that's where we re-calculate the price?\n                receipt.modified_reimbursed_amount = data.reimburse.reimbursed_amount;\n                receipt.modified_reimbursed_rate = data.reimburse.rate;\n\n                //currency is always the same\n                receipt.modified_reimbursed_difference = parseFloat(parseFloat(receipt.modified_reimbursed_amount) - parseFloat(receipt.reimbursed_amount));\n                if(receipt.modified_reimbursed_difference == 0){\n                    receipt.modified_reimbursed_difference = 0;\n                    // //console.log(\"TOTAL CHANGE IS : \", receipt.modified_reimbursed_difference)\n                }\n                    // //console.log(\"TOTAL CHANGE IS : \", receipt.modified_reimbursed_difference)\n\n            });\n\n\n\n\n        }\n\n\n        vm.modified_reimbursement_tooltip = function(receipt){\n\n            var currency = (receipt.modified_currency) ? receipt.modified_currency : receipt.currency;\n            var price = (receipt.modified_price) ? parseFloat(receipt.modified_price).toFixed(2) : parseFloat(receipt.price).toFixed(2);\n\n            var added_currency = currency+\"\"+parseFloat(price).toFixed(2);\n            if((receipt.modified_currency && (receipt.modified_currency !== receipt.reimbursed_currency)) || (receipt.reimbursed_currency !== receipt.currency) && receipt.modified_reimbursed_rate){\n                //currency was modified\n                var datetime = moment(receipt.created_at).format(\"DD MMM YYYY HH:mm\");\n                added_currency = added_currency+\" which on \"+datetime+\" the Transferwise currency conversion of \"+parseFloat(receipt.modified_reimbursed_rate).toFixed(5)+\" gave a value of \"+receipt.reimbursed_currency+\"\"+parseFloat(receipt.modified_reimbursed_amount).toFixed(2);\n            }\n            // if(receipt.)\n            var reimbursing = \"<br /><br /> By approving this receipt, we will automatically adjust the reimbursement by \"+receipt.reimbursed_currency+\"\"+parseFloat(receipt.modified_reimbursed_difference).toFixed(2)+\" for this claim.\";\n            if(receipt.modified_reimbursed_difference == 0){\n                reimbursing = \"<br /><br /> By approving this receipt, there will be no financial charge for this change.\";\n            }\n\n           return $sce.getTrustedHtml(\"<div>This is the amount that should have been removed from the associated invoice. <br /><br /> This is based on the receipt value of \"+added_currency+\". \"+reimbursing+\"</div>\");// {{ receipt.modified_currency || receipt.currency }}{{ receipt.modified_price | number:2 || receipt.price | number:2 }}\n        }\n\n        vm.update_currency = function(receipt){\n            //console.log(\"change currency\", receipt.modified_currency);\n            var obj = {\n                modified_currency: receipt.modified_currency\n            };\n            PlaneService.UpdateReceipt(receipt.id, obj)\n            .then(function(data){\n                //console.log(\"UPDATE ::: \", data);\n\n                //maybe that's where we re-calculate the price?\n                // verify_reimbursement(data);\n                // //console.log(\"receipts\", vm.receipts);\n                vm.verify_reimbursement(receipt);\n\n            });\n        }\n\n        vm.update_invoice_no = function(receipt){\n            //console.log(\"change currency\", receipt.modified_currency);\n            var obj = {\n                invoice_number: receipt.invoice_number\n            };\n            PlaneService.UpdateReceipt(receipt.id, obj)\n            .then(function(data){\n                //console.log(\"UPDATE ::: \", data);\n\n                //maybe that's where we re-calculate the price?\n                // verify_reimbursement(data);\n                // //console.log(\"receipts\", vm.receipts);\n                //vm.verify_reimbursement(receipt);\n\n            });\n        }\n\n        vm.update_qty = function(receipt){\n            //console.log(\"change quantity\", receipt.modified_quantity);\n            var obj = {\n                modified_quantity: receipt.modified_quantity\n            };\n            PlaneService.UpdateReceipt(receipt.id, obj)\n            .then(function(data){\n                //console.log(\"UPDATE ::: \", data);\n                //we don't do anything here...   \n                // verify_reimbursement(data);\n\n            });\n        }\n\n\n\n\n\n        $scope.back = function(){\n            $window.history.back();\n        }\n\n        $scope.save = function(){\n            if(vm.action == \"add\"){\n                //console.log(\"CREATE click\");\n                $scope.create();\n            } else {\n                //console.log(\"EDIT click\");\n                //console.log(vm.club.plane);\n                $scope.update();\n            }\n        }\n\n\n        $scope.create = function(){\n            //console.log(\"CREATE ME NOW\");\n            vm.club.item.club_id = vm.club_id;\n            ItemService.Create(vm.club.item)\n                .then(function(data){\n                    //console.log(data);\n                    $state.go('dashboard.manage_club.items');\n\n                });\n        }\n\n        $scope.delete = function(){\n            //console.log(\"CLICK\");\n            alert(\"Are you sure you would like to delete this plane?\");\n            ItemService.Delete(vm.user.id, vm.club.item)\n                .then(function(data){\n                    //console.log(data);\n                });\n        }\n\n        function get_update_docs(){\n            var documents = [];\n\n            for(var i=0;i<update_this_file.length;i++){\n                var id = update_this_file[i];\n                //console.log(\"looking for : \", id);\n                //console.log(\"in: \", vm.plane_documents);\n\n                for(var k=0;k<vm.club.plane.plane_documents.length;k++){\n                    //console.log(\"comparing to : \", vm.club.plane.plane_documents[k].id);\n                    if(vm.club.plane.plane_documents[k].id == id){\n                        documents.push(vm.club.plane.plane_documents[k]);\n                    }\n                }\n\n            }\n\n            // //console.log(\"DOCS TO UPDATE : \", documents);\n\n            return documents;\n        }\n\n        $scope.update = function(){\n            //console.log(\"CLICK\");\n            vm.club.item.club_id = vm.club_id;\n            ItemService.Update(vm.club.item, vm.user.id)\n                .then(function(data){\n                    //console.log(data);\n                    //console.log(\"saved\");\n                    $state.go('dashboard.manage_club.items');\n                });\n        }\n\n\n        function containsObject(obj, list, params) {\n\n            // //console.log(\"obj\", obj);\n            // //console.log(\"list\", list);\n            // //console.log(\"params\", params);\n\n            for(var i=0; i<list.length; i++) {\n                // //console.log(\"list i : \", list[i]);\n                // //console.log(\"obj is: \", obj);\n\n                var count_success = 0;\n                for(var j=0;j<params.length;j++){\n                    if(list[i][params[j]] && obj[params[j]] && list[i][params[j]] == obj[params[j]]){\n                        count_success++;\n                    }\n                }\n\n                if(count_success === params.length) {                    \n                    return true;\n                }\n            }\n\n            return false;\n        }\n\n\n        function check_all(){\n\n            //maybe a nice to have one day... not yet though.\n\n\n            //licences\n            vm.club.plane.requirements.licence.forEach(function(obj){\n\n            });\n\n        }\n\n      \n\n\n        $scope.add_item = function(type){\n            //console.log(\"ADD\");\n            switch(type){\n                case \"licence\":\n                    //console.log(\"licence\");\n                    if(vm.temporary.licence && vm.temporary.licence !== \"\" && vm.temporary.rating && vm.temporary.rating !== \"\"){\n                        //then we can add it\n                        //console.log(\"here we go\");\n                        var add_licence = {\n                            licence_id: vm.temporary.licence.id,\n                            licence_title: vm.temporary.licence.abbreviation,\n                            rating_title: vm.temporary.rating.abbreviation,\n                            rating_id: vm.temporary.rating.id\n                        };\n\n                        //check if it doesnt exist first...\n                        if(containsObject(add_licence, vm.club.plane.requirements.licence, new Array(\"licence_id\", \"rating_id\")) == false){\n                            vm.club.plane.requirements.licence.push(add_licence);\n                        }\n\n                        delete vm.temporary.licence;\n                        delete vm.temporary.rating;\n\n                    } else {\n                        alert(\"Please select a licence and rating that is required to book the plane solo!\");\n                    }\n\n                break;\n\n\n                case \"medical\":\n                    //console.log(\"medical\");\n                    if(vm.temporary.medical_authority && vm.temporary.medical_authority !== \"\" && vm.temporary.medical_component && vm.temporary.medical_component !== \"\"){\n                        //then we can add it\n                        //console.log(\"here we go\");\n                        var add_medical = {\n                            authority_id: vm.temporary.medical_authority.id,\n                            authority_title: vm.temporary.medical_authority.abbreviation,\n                            medical_component_id: vm.temporary.medical_component.id,\n                            medical_component_title: vm.temporary.medical_component.title\n                        };\n\n                        //check if it doesnt exist first...\n                        if(containsObject(add_medical, vm.club.plane.requirements.medical, new Array(\"authority_id\", \"medical_component_id\")) == false){\n                            vm.club.plane.requirements.medical.push(add_medical);\n                        }\n\n                        delete vm.temporary.medical_authority;\n                        delete vm.temporary.medical_component;\n\n                    } else {\n                        alert(\"Please select a medical that is required to book the plane solo!\");\n                    }\n\n                break;\n\n\n                case \"differences\":\n                    //console.log(\"difference\");\n                    if(vm.temporary.difference && vm.temporary.difference !== \"\"){\n                        //then we can add it\n                        //console.log(\"here we go\");\n                        var add_difference = {\n                            difference_id: vm.temporary.difference.id,\n                            difference_title: vm.temporary.difference.title\n                        };\n\n                        //check if it doesnt exist first...\n                        if(containsObject(add_difference, vm.club.plane.requirements.differences, new Array(\"difference_id\", \"difference_title\")) == false){\n                            vm.club.plane.requirements.differences.push(add_difference);\n                        }\n\n                        delete vm.temporary.difference;\n\n                    } else {\n                        alert(\"Please select a difference that is required to book the plane solo!\");\n                    }\n\n                break;\n\n\n            }\n\n\n\n        }\n\n\n        $scope.remove_item = function(type, index){\n            //console.log(\"REMOVE\");\n\n            vm.club.plane.requirements[type].splice(index, 1);\n\n\n            // switch(type){\n            //     case \"licence\":\n            //             //console.log(\"licence\");\n                   \n            //             //check if it doesnt exist first...\n            //             // if(containsObject(add_licence, vm.club.plane.requirements.licence, new Array(\"licence_id\", \"rating_id\")) == false){\n            //             //     vm.club.plane.requirements.licence.push(add_licence);\n            //             // }\n\n            //             vm.club.plane.requirements.licence.splice(index, 1);\n                      \n                   \n\n            //     break;\n\n\n            //     case \"medical\":\n            //         //console.log(\"medical\");\n            //         if(vm.temporary.medical_authority && vm.temporary.medical_authority !== \"\" && vm.temporary.medical_component && vm.temporary.medical_component !== \"\"){\n            //             //then we can add it\n            //             //console.log(\"here we go\");\n            //             var add_medical = {\n            //                 authority_id: vm.temporary.medical_authority.id,\n            //                 authority_title: vm.temporary.medical_authority.abbreviation,\n            //                 medical_component_id: vm.temporary.medical_component.id,\n            //                 medical_component_title: vm.temporary.medical_component.title\n            //             };\n\n            //             //check if it doesnt exist first...\n            //             if(containsObject(add_medical, vm.club.plane.requirements.medical, new Array(\"authority_id\", \"medical_component_id\")) == false){\n            //                 vm.club.plane.requirements.medical.push(add_medical);\n            //             }\n\n            //             delete vm.temporary.medical_authority;\n            //             delete vm.temporary.medical_component;\n\n            //         } else {\n            //             alert(\"Please select a medical that is required to book the plane solo!\");\n            //         }\n\n            //     break;\n\n\n            //     case \"differences\":\n            //         //console.log(\"difference\");\n            //         if(vm.temporary.difference && vm.temporary.difference !== \"\"){\n            //             //then we can add it\n            //             //console.log(\"here we go\");\n            //             var add_difference = {\n            //                 difference_id: vm.temporary.difference.id,\n            //                 difference_title: vm.temporary.difference.title\n            //             };\n\n            //             //check if it doesnt exist first...\n            //             if(containsObject(add_difference, vm.club.plane.requirements.differences, new Array(\"difference_id\", \"difference_title\")) == false){\n            //                 vm.club.plane.requirements.differences.push(add_difference);\n            //             }\n\n            //             delete vm.temporary.difference;\n\n            //         } else {\n            //             alert(\"Please select a difference that is required to book the plane solo!\");\n            //         }\n\n            //     break;\n\n\n            // }\n\n\n\n        }\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n        $scope.update_this_file = function(file){\n            //console.log(\"==== update is : \", file.id);\n            if(update_this_file.indexOf(file.id) === -1){\n                update_this_file.push(file.id)\n            } else {\n               ////console.log(\"This item already exists\"); \n            } \n        }\n\n\n         $scope.remove_real_file = function(file){\n\n                //remove_file\n\n                vm.club.plane.plane_documents = $.grep(vm.club.plane.plane_documents, function(e){ \n                        return e.id != file.id; \n                    });\n\n                //no need to actually remove the file as it will be archived accordingly on the backend whilst it is missing! :)\n                PlaneDocumentService.Delete(vm.user.id, file.id)\n                .then(function (data) {\n                    //console.log(data);\n                    if(data.success){\n                        //console.log(\"HUZZAH\", current_files);\n                        //then we need to remove this from the list of files...\n                        //clear files\n                        vm.plane_documents = [];\n                        //and re-process available files\n                        $scope.processFiles(current_files);\n\n                    } else {\n                        //console.log(\"WOOOPSIES...\");\n                        //this should be very very rare...\n                    }\n\n                });\n\n          }\n\n\n          \n          $scope.remove_file = function(file, current_files){\n\n            //remove_file\n            var j = JSON.parse(file.file_return);\n            //console.log(\"REMOVE: \", j);\n            //console.log(\"REMOVE: \", j.saved_url);\n\n            //to delete the temp file created: j.saved_url\n            //tmp_rm.php POST tmp = filename\n            \n            PoidService.DeleteTmp(j.saved_url)\n                .then(function (data) {\n                    //console.log(data);\n                    if(data.success){\n                        //console.log(\"HUZZAH\", current_files);\n                        //then we need to remove this from the list of files...\n                        //clear files\n                        vm.plane_documents = [];\n                        //and re-process available files\n                        $scope.processFiles(current_files);\n\n                    } else {\n                        //console.log(\"WOOOPSIES...\");\n                        //this should be very very rare...\n                    }\n\n                });\n\n          }\n          \n\n          // $scope.$on('flow::fileAdded', function (event, $flow, flowFile) {\n          //     event.preventDefault();//prevent file from uploading\n          //     //console.log(\"FILE ADDED\");\n          //     //console.log($flow);\n          //   });\n\n            $scope.processFiles = function(files){\n                // //console.log(\"files\", files);\n\n                for(var i=0; i<files.length; i++){\n                    // //console.log(\"JSON\", files[i].file_return);\n                    var j = JSON.parse(files[i].file_return);\n                    // //console.log(\"PARSED\", j);\n                    //console.log(\"J is : \",j);\n                    //console.log(\"name is : \", j.files.file.name);\n\n                    files[i].file.temp_path = j.saved_url;\n                    files[i].file.save_name = j.files.file.name;\n                    var ft = j.files.file.name;\n                    ft = ft.split('.').pop();\n                    files[i].file.extension = ft;\n\n                    // //console.log(\"file\", files[i].file);\n                    vm.plane_documents.push(files[i].file);\n                }\n\n\n            }\n\n            $scope.set_title = function(file){\n                //console.log(\"return\", file);\n                return file.save_name;\n            }\n\n            $scope.get_icon = function(file){\n\n                var ft = file.name;\n                ft = ft.split('.').pop();\n                var icon_name = \"\";\n\n                // //console.log(\"FILE:\", ft);\n                // //console.log(\"index : \", ft.indexOf(\"pdf\"));\n                switch(true){\n                    case (ft.indexOf(\"pdf\") > -1):\n                        icon_name = \"pdf.png\";\n                    break;\n                    case (ft.indexOf(\"doc\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"docx\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"xls\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"xlsx\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"ppt\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"pptx\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"jpg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"jpeg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"png\") > -1):\n                        icon_name = \"png.png\";\n                    break;\n                    case (ft.indexOf(\"gif\") > -1):\n                        icon_name = \"gif.png\";\n                    break;\n                    case (ft.indexOf(\"zip\") > -1):\n                        icon_name = \"zip.png\";\n                    break;\n                    case (ft.indexOf(\"avi\") > -1):\n                        icon_name = \"avi.png\";\n                    break;\n                    case (ft.indexOf(\"mp4\") > -1):\n                        icon_name = \"mp4.png\";\n                    break;\n                    default:\n                        icon_name = \"file.png\";\n                    break;\n                }\n\n                // //console.log(\"FILE:\", icon_name);\n\n                return \"images/file_icons/\"+icon_name;\n            }\n\n\n            $scope.get_icon2 = function(file){\n\n                var ft = file.split('.').pop();\n                //console.log(\"ICON 2 : \", ft);\n                var icon_name = \"\";\n\n                // //console.log(\"FILE:\", ft);\n                // //console.log(\"index : \", ft.indexOf(\"pdf\"));\n                switch(true){\n                    case (ft.indexOf(\"pdf\") > -1):\n                        icon_name = \"pdf.png\";\n                    break;\n                    case (ft.indexOf(\"doc\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"docx\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"xls\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"xlsx\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"ppt\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"pptx\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"jpg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"jpeg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"png\") > -1):\n                        icon_name = \"png.png\";\n                    break;\n                    case (ft.indexOf(\"gif\") > -1):\n                        icon_name = \"gif.png\";\n                    break;\n                    case (ft.indexOf(\"zip\") > -1):\n                        icon_name = \"zip.png\";\n                    break;\n                    case (ft.indexOf(\"avi\") > -1):\n                        icon_name = \"avi.png\";\n                    break;\n                    case (ft.indexOf(\"mp4\") > -1):\n                        icon_name = \"mp4.png\";\n                    break;\n                    default:\n                        icon_name = \"file.png\";\n                    break;\n                }\n\n                // //console.log(\"FILE:\", icon_name);\n\n                return \"images/file_icons/\"+icon_name;\n            }\n\n\n            $scope.get_icon3 = function(file){\n\n                var ft = file.split(';')[0];\n                // //console.log(\"ICON 2 : \", ft);\n                var icon_name = \"\";\n\n                // //console.log(\"FILE:\", ft);\n                // //console.log(\"index : \", ft.indexOf(\"pdf\"));\n                switch(true){\n                    case (ft.indexOf(\"pdf\") > -1):\n                        icon_name = \"pdf.png\";\n                    break;\n                    case (ft.indexOf(\"doc\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"docx\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"xls\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"xlsx\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"ppt\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"pptx\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"jpg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"jpeg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"png\") > -1):\n                        icon_name = \"png.png\";\n                    break;\n                    case (ft.indexOf(\"gif\") > -1):\n                        icon_name = \"gif.png\";\n                    break;\n                    case (ft.indexOf(\"zip\") > -1):\n                        icon_name = \"zip.png\";\n                    break;\n                    case (ft.indexOf(\"avi\") > -1):\n                        icon_name = \"avi.png\";\n                    break;\n                    case (ft.indexOf(\"mp4\") > -1):\n                        icon_name = \"mp4.png\";\n                    break;\n                    default:\n                        icon_name = \"file.png\";\n                    break;\n                }\n\n                // //console.log(\"FILE:\", icon_name);\n\n                return \"images/file_icons/\"+icon_name;\n            }\n\n\n            vm.approve_receipt_final = function(receipt){\n                //console.log(\"APPROVED THE RECEIPT\");\n                //time to make a call to an API endpoint\n                delete receipt.image;\n                PlaneService.ApproveReceipt(receipt.id, receipt)\n                .then(function(data){\n                    //console.log(\"data\", data);\n                    if(data.success){\n                        //we need to remove that one from the list\n                        vm.receipts.splice(vm.receipts.findIndex(function(i){\n                                            return i.id === receipt.id;\n                                        }), 1);\n\n                        vm.show_popup = false;\n                        vm.current_receipt = {};\n                    } else {\n                        alert(\"An error occurred: \"+data.message);\n                        vm.show_popup = false;\n                        vm.current_receipt = {};\n                    }\n                });\n            }   \n\n            vm.reject_receipt_final = function(receipt){\n                //console.log(\"REJECT THE RECEIPT\");\n                //time to make a call to an API endpoint\n                \n                delete receipt.image;\n                PlaneService.RejectReceipt(receipt.id, receipt)\n                .then(function(data){\n                    ////console.log(\"data\", data);\n                    if(data.success){\n                        //we need to remove that one from the list\n                        vm.receipts.splice(vm.receipts.findIndex(function(i){\n                                            return i.id === receipt.id;\n                                        }), 1);\n\n                        vm.show_popup = false;\n                        vm.current_receipt = {};\n                    } else {\n                        alert(\"An error occurred: \"+data.message);\n                        vm.show_popup = false;\n                        vm.current_receipt = {};\n                    }\n                });\n\n            }    \n\n\n            $scope.approve_receipt = function(receipt){\n                //console.log(\"RECEIPT: \", receipt);\n                vm.current_receipt = receipt;\n\n                if(vm.current_receipt.modified_reimbursed_amount > 0){\n                    vm.show_popup = 'approve';\n\n\n\n                } else {\n\n                    //this is where we bypass the popup\n\n                    vm.approve_receipt_final(receipt);\n\n\n\n                }\n\n\n\n\n            }\n\n            $scope.reject_receipt = function(receipt){\n                //console.log(\"RECEIPT: \", receipt);\n                vm.current_receipt = receipt;\n\n                vm.show_popup = 'reject';\n\n\n\n            }\n\n            $scope.close_popup = function(){\n                vm.show_popup = false;\n                vm.current_receipt = {};\n            }\n\n\n            $scope.delete_poid = function(id){\n\n              \n                var a = prompt(\"Are you sure you wish to delete this poid? \\n\\n This change is irreversible! To confirm please type YES in the box below.\");\n                if(a == \"YES\"){\n\n\n                    //console.log(\"WE DELETE IT\");\n\n\n                    // PoidService.Delete(vm.user_id, id)\n                    //     .then(function (data) {\n                    //         //console.log(data);\n                    //         if(data.success){\n                    //             //console.log(\"HUZZAH\", data);\n                    //             //then we need to remove this from the list of files...\n                    //             vm.user_poids = $.grep(vm.user_poids, function(e){ \n                    //                 return e.id != id; \n                    //             });\n                                \n                    //             //refresh?\n                    //             $state.reload();\n                    //             $state.go('dashboard.my_account.poid');\n\n                    //         } else {\n\n                    //             alert(\"Something went terribly wrong... \\n\\n \"+data.message);\n\n                    //         }\n\n                    //     });\n\n\n\n                } else {\n                    //console.log(\"ignore123\");\n                }\n\n\n            }\n\n\n\n\n            $scope.save_plane_documents = function(){\n\n               \n              \n\n                //console.log(\"plane_documents: \", vm.plane_documents);\n\n\n                //compile the required elements YAY\n\n                //console.log(\"plane_document \", vm.plane_document);\n\n\n                 //clean shizzle before sending\n                 //why keep sending back heavy data?\n\n                    // for(var i=0;i<vm.plane_document.images.length;i++){\n                    //     delete vm.plane_document.images[i].data_uri;\n                    // }\n\n                    // // vm.plane_document.images = vm.plane_documents;\n                    // vm.plane_document.images = vm.plane_document.images.concat(vm.plane_documents);\n                    // vm.plane_document.user_id = vm.user_id;\n\n\n\n\n            //     if(vm.plane_document.id){\n            //         //then its an udpate\n\n            //         //merge the images left?\n            //         PoidService.Update(vm.plane_document)\n            //             .then(function (data) {\n            //                 //console.log(data);\n            //                 if(data.success){\n            //                     //console.log(\"HUZZAH\", vm.plane_document);\n            //                     //console.log(\"HUZZAH\", data);\n            //                     //then we need to remove this from the list of files...\n                                \n                                \n            //                     //move somewhere?\n            //                     $state.go('dashboard.my_account.poid', {}, { reload: true });\n\n\n\n\n\n            //                 } else {\n\n            //                     alert(\"Something went terribly wrong... \\n\\n \"+data.message);\n\n            //                 }\n\n            //             });\n\n            //     } else {\n\n\n                   \n\n\n            //         //then its a create\n            //         //console.log(vm.plane_document);\n\n            //         PoidService.Create(vm.plane_document)\n            //             .then(function (data) {\n            //                 //console.log(data);\n            //                 if(data.success){\n            //                     //console.log(\"HUZZAH\", vm.plane_document);\n            //                     //console.log(\"HUZZAH\", data);\n            //                     //then we need to remove this from the list of files...\n                                \n                                \n            //                     //move somewhere?\n            //                    // $state.reload();\n            //                    // $state.go('dashboard.my_account.poid', {}, { reload: true });\n\n\n            //                 } else {\n\n            //                     alert(\"Something went terribly wrong... \\n\\n \"+data.message);\n\n            //                 }\n\n            //             });\n\n\n            //     }\n\n\n\n             };\n\n\n\n\n             $scope.change_file_name = function(file){\n                \n                //this is terribly ineficient... unfortunately... can't \n                //work out how else to do it! (lol)\n\n                // //console.log(\"TO BE CHANGED\", file);\n\n                // //console.log(\"BEFORE BEFORE\", vm.plane_documents);\n\n                vm.plane_documents = $.grep(vm.plane_documents, function(e){ \n                    return e.temp_path != file.temp_path; \n                });\n\n                // //console.log(\"BEFORE\", vm.plane_documents);\n\n                vm.plane_documents.push(file);\n\n                // //console.log(\"AFTER\", vm.plane_documents);\n\n             }\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n        initController();\n\n        function initController() {\n           //console.log(\"check if access is okay\");\n        }\n\n\n            var warning_msg = \"By deleting this plane, you will also cancel all reservations that this plane currently has.\"\n\n          $scope.open = function (plane_id) {\n            var modalInstance = $uibModal.open({\n              animation: true,\n              templateUrl: 'views/modals/deleteModal.html',\n              controller: 'ModalInstanceCtrl',\n              size: \"lg\",\n              resolve: {\n                id: function () {\n                  return plane_id;\n                },\n                params: function() {\n                  return {id: plane_id};\n                },\n                warning: function(){\n                    return warning_msg;\n                }\n              }\n            });\n            modalInstance.result.then(function (plane_id) {\n              $log.info('PRESSED GO: '+plane_id.id);\n              ItemService.Delete(vm.user.id, plane_id.id)\n              .then(function(){\n                //console.log(\"HELLO DELETE\");\n                //update view?\n                 vm.club.items = $.grep(vm.club.items, function(e){ \n                    return e.id != plane_id.id; \n                });\n              })\n            }, function () {\n              $log.info('Modal dismissed at: ' + new Date());\n            });\n          };\n\n         \n\n\n    }\n app.controller('DashboardClubReceiptsController', DashboardClubReceiptsController);\n\n    DashboardClubReceiptsController.$inject = ['UserService', 'PlaneService', '$rootScope', '$location', '$scope', '$state', '$stateParams', '$uibModal', '$log', '$window', 'LicenceService', 'MedicalService', 'DifferencesService', 'ItemService', '$sce'];\n    function DashboardClubReceiptsController(UserService, PlaneService, $rootScope, $location, $scope, $state, $stateParams, $uibModal, $log, $window, LicenceService, MedicalService, DifferencesService, ItemService, $sce) {\n        var vm = this;\n\n        vm.user = null;\n        vm.allUsers = [];\n        vm.club = {};\n        vm.page_title = \"\";\n        \n        vm.plane_document = {};\n        vm.plane_documents = [];\n\n        var update_this_file = [];\n        \n\n        vm.action = $state.current.data.action;\n        vm.club_id = $rootScope.globals.currentUser.current_club_admin.id;\n        vm.user = $rootScope.globals.currentUser;\n        vm.user_id = vm.user.id;\n        ////console.log(\"club_id : \"+vm.club_id);\n\n        // //console.log(vm.action);\n        // //console.log($stateParams);\n        // //console.log($stateParams.id);\n        \n        PlaneService.GetCurrencies(vm.club_id)\n         .then(function(data){\n                        vm.currencies = data.currencies;   \n                        vm.club_currency = data.club_currency;\n\n                    });\n\n\n\n        vm.current_offset = 0;\n        vm.loaded_per_batch = 10;\n        vm.all_loaded = false;\n\n        PlaneService.GetReceiptsClub(vm.club_id, vm.current_offset, vm.loaded_per_batc)\n                    .then(function(data){\n                        vm.receipts = data.receipts;   \n                           \n                           //check for modded\n                           vm.receipts.forEach(receipt => {\n                               vm.verify_reimbursement(receipt);\n                           })\n\n                    });\n\n        vm.load_more = function(){\n                vm.current_offset = vm.current_offset + vm.loaded_per_batch;\n                PlaneService.GetReceiptsClub(vm.club_id, vm.current_offset, vm.loaded_per_batch)\n                .then(function (data) {\n                        // //console.log(\"ALL is : \", data);\n                        if(data.receipts.length > 0){\n                            data.receipts.forEach(receipt => vm.receipts.push(receipt));\n                        } else {\n                            vm.all_loaded = true;\n                        }\n                       //vm.logs = data.logs;\n\n\n                    });\n\n            }\n            \n\n        vm.show_receipt_image = function(receipt){\n\n            vm.show_receipt = true;\n            vm.receipt_image = receipt.image;\n\n        }\n\n        $scope.get_currency = function(iso_code){\n\n           return $.grep(vm.currencies, function(e){ \n                        return e.iso_code == iso_code; \n                    })[0];\n\n        }\n        //'9' needs to refer the the user's account set to manage\n       \n\n        vm.update_price = function(receipt){\n            //console.log(\"change price\", receipt.modified_price);\n            var obj = {\n                modified_price: receipt.modified_price\n            };\n            PlaneService.UpdateReceipt(receipt.id, obj)\n            .then(function(data){\n                //console.log(\"UPDATE ::: \", data);\n\n                //maybe that's where we re-calculate the price?\n\n                vm.verify_reimbursement(receipt);\n\n            });\n        }\n\n        vm.verify_reimbursement = function(receipt){\n            //console.log(\"WE GET HERE VERIFY REIMBURSEMENT\");\n            // receipt.reimbursed_amount = 12.5;\n            // //console.log(\"receipt\", receipt);\n            if(receipt.modified_price && !receipt.modified_currency){\n                receipt.modified_reimbursed_amount = receipt.modified_price;\n                receipt.modified_reimbursed_difference = parseFloat(parseFloat(receipt.modified_reimbursed_amount) - parseFloat(receipt.reimbursed_amount));\n            } else if((!receipt.modified_price || !receipt.modified_currency) || receipt.reimbursement == 0){\n                return false;\n            }\n\n            //console.log(\"WE GET THERE\");\n\n            var receipt = $.grep(vm.receipts, function(e){ \n                        return e.id == receipt.id; \n                    })[0];\n\n            var obj = {\n                club_id: receipt.club_id,\n                currency: (receipt.modified_currency)? receipt.modified_currency : receipt.currency,\n                price: (receipt.modified_price) ? receipt.modified_price : receipt.price,\n                requested_at: receipt.created_at\n            }\n            PlaneService.CheckReimbursement(obj)\n            .then(function(data){\n                ////console.log(\"CHANGE ::: \", data.reimburse.reimbursed_amount);\n\n                //maybe that's where we re-calculate the price?\n                receipt.modified_reimbursed_amount = data.reimburse.reimbursed_amount;\n                receipt.modified_reimbursed_rate = data.reimburse.rate;\n\n                //currency is always the same\n                receipt.modified_reimbursed_difference = parseFloat(parseFloat(receipt.modified_reimbursed_amount) - parseFloat(receipt.reimbursed_amount));\n                if(receipt.modified_reimbursed_difference == 0){\n                    receipt.modified_reimbursed_difference = 0;\n                    // //console.log(\"TOTAL CHANGE IS : \", receipt.modified_reimbursed_difference)\n                }\n                    // //console.log(\"TOTAL CHANGE IS : \", receipt.modified_reimbursed_difference)\n\n            });\n\n\n\n\n        }\n\n\n        vm.modified_reimbursement_tooltip = function(receipt){\n\n            var currency = (receipt.modified_currency) ? receipt.modified_currency : receipt.currency;\n            var price = (receipt.modified_price) ? parseFloat(receipt.modified_price).toFixed(2) : parseFloat(receipt.price).toFixed(2);\n\n            var added_currency = currency+\"\"+parseFloat(price).toFixed(2);\n            if((receipt.modified_currency && (receipt.modified_currency !== receipt.reimbursed_currency)) || (receipt.reimbursed_currency !== receipt.currency) && receipt.modified_reimbursed_rate){\n                //currency was modified\n                var datetime = moment(receipt.created_at).format(\"DD MMM YYYY HH:mm\");\n                added_currency = added_currency+\" which on \"+datetime+\" the Transferwise currency conversion of \"+parseFloat(receipt.modified_reimbursed_rate).toFixed(5)+\" gave a value of \"+receipt.reimbursed_currency+\"\"+parseFloat(receipt.modified_reimbursed_amount).toFixed(2);\n            }\n            // if(receipt.)\n            var reimbursing = \"<br /><br /> By approving this receipt, we will automatically adjust the reimbursement by \"+receipt.reimbursed_currency+\"\"+parseFloat(receipt.modified_reimbursed_difference).toFixed(2)+\" for this claim.\";\n            if(receipt.modified_reimbursed_difference == 0){\n                reimbursing = \"<br /><br /> By approving this receipt, there will be no financial charge for this change.\";\n            }\n\n           return $sce.getTrustedHtml(\"<div>This is the amount that should have been removed from the associated invoice. <br /><br /> This is based on the receipt value of \"+added_currency+\". \"+reimbursing+\"</div>\");// {{ receipt.modified_currency || receipt.currency }}{{ receipt.modified_price | number:2 || receipt.price | number:2 }}\n        }\n\n        vm.update_currency = function(receipt){\n            //console.log(\"change currency\", receipt.modified_currency);\n            var obj = {\n                modified_currency: receipt.modified_currency\n            };\n            PlaneService.UpdateReceipt(receipt.id, obj)\n            .then(function(data){\n                //console.log(\"UPDATE ::: \", data);\n\n                //maybe that's where we re-calculate the price?\n                // verify_reimbursement(data);\n                // //console.log(\"receipts\", vm.receipts);\n                vm.verify_reimbursement(receipt);\n\n            });\n        }\n\n        vm.update_invoice_no = function(receipt){\n            //console.log(\"change currency\", receipt.modified_currency);\n            var obj = {\n                invoice_number: receipt.invoice_number\n            };\n            PlaneService.UpdateReceipt(receipt.id, obj)\n            .then(function(data){\n                //console.log(\"UPDATE ::: \", data);\n\n                //maybe that's where we re-calculate the price?\n                // verify_reimbursement(data);\n                // //console.log(\"receipts\", vm.receipts);\n                //vm.verify_reimbursement(receipt);\n\n            });\n        }\n\n        vm.update_qty = function(receipt){\n            //console.log(\"change quantity\", receipt.modified_quantity);\n            var obj = {\n                modified_quantity: receipt.modified_quantity\n            };\n            PlaneService.UpdateReceipt(receipt.id, obj)\n            .then(function(data){\n                //console.log(\"UPDATE ::: \", data);\n                //we don't do anything here...   \n                // verify_reimbursement(data);\n\n            });\n        }\n\n\n\n\n\n        $scope.back = function(){\n            $window.history.back();\n        }\n\n        $scope.save = function(){\n            if(vm.action == \"add\"){\n                //console.log(\"CREATE click\");\n                $scope.create();\n            } else {\n                //console.log(\"EDIT click\");\n                //console.log(vm.club.plane);\n                $scope.update();\n            }\n        }\n\n\n        $scope.create = function(){\n            //console.log(\"CREATE ME NOW\");\n            vm.club.item.club_id = vm.club_id;\n            ItemService.Create(vm.club.item)\n                .then(function(data){\n                    //console.log(data);\n                    $state.go('dashboard.manage_club.items');\n\n                });\n        }\n\n        $scope.delete = function(){\n            //console.log(\"CLICK\");\n            alert(\"Are you sure you would like to delete this plane?\");\n            ItemService.Delete(vm.user.id, vm.club.item)\n                .then(function(data){\n                    //console.log(data);\n                });\n        }\n\n        function get_update_docs(){\n            var documents = [];\n\n            for(var i=0;i<update_this_file.length;i++){\n                var id = update_this_file[i];\n                //console.log(\"looking for : \", id);\n                //console.log(\"in: \", vm.plane_documents);\n\n                for(var k=0;k<vm.club.plane.plane_documents.length;k++){\n                    //console.log(\"comparing to : \", vm.club.plane.plane_documents[k].id);\n                    if(vm.club.plane.plane_documents[k].id == id){\n                        documents.push(vm.club.plane.plane_documents[k]);\n                    }\n                }\n\n            }\n\n            // //console.log(\"DOCS TO UPDATE : \", documents);\n\n            return documents;\n        }\n\n        $scope.update = function(){\n            //console.log(\"CLICK\");\n            vm.club.item.club_id = vm.club_id;\n            ItemService.Update(vm.club.item, vm.user.id)\n                .then(function(data){\n                    //console.log(data);\n                    //console.log(\"saved\");\n                    $state.go('dashboard.manage_club.items');\n                });\n        }\n\n\n        function containsObject(obj, list, params) {\n\n            // //console.log(\"obj\", obj);\n            // //console.log(\"list\", list);\n            // //console.log(\"params\", params);\n\n            for(var i=0; i<list.length; i++) {\n                // //console.log(\"list i : \", list[i]);\n                // //console.log(\"obj is: \", obj);\n\n                var count_success = 0;\n                for(var j=0;j<params.length;j++){\n                    if(list[i][params[j]] && obj[params[j]] && list[i][params[j]] == obj[params[j]]){\n                        count_success++;\n                    }\n                }\n\n                if(count_success === params.length) {                    \n                    return true;\n                }\n            }\n\n            return false;\n        }\n\n\n        function check_all(){\n\n            //maybe a nice to have one day... not yet though.\n\n\n            //licences\n            vm.club.plane.requirements.licence.forEach(function(obj){\n\n            });\n\n        }\n\n      \n\n\n        $scope.add_item = function(type){\n            //console.log(\"ADD\");\n            switch(type){\n                case \"licence\":\n                    //console.log(\"licence\");\n                    if(vm.temporary.licence && vm.temporary.licence !== \"\" && vm.temporary.rating && vm.temporary.rating !== \"\"){\n                        //then we can add it\n                        //console.log(\"here we go\");\n                        var add_licence = {\n                            licence_id: vm.temporary.licence.id,\n                            licence_title: vm.temporary.licence.abbreviation,\n                            rating_title: vm.temporary.rating.abbreviation,\n                            rating_id: vm.temporary.rating.id\n                        };\n\n                        //check if it doesnt exist first...\n                        if(containsObject(add_licence, vm.club.plane.requirements.licence, new Array(\"licence_id\", \"rating_id\")) == false){\n                            vm.club.plane.requirements.licence.push(add_licence);\n                        }\n\n                        delete vm.temporary.licence;\n                        delete vm.temporary.rating;\n\n                    } else {\n                        alert(\"Please select a licence and rating that is required to book the plane solo!\");\n                    }\n\n                break;\n\n\n                case \"medical\":\n                    //console.log(\"medical\");\n                    if(vm.temporary.medical_authority && vm.temporary.medical_authority !== \"\" && vm.temporary.medical_component && vm.temporary.medical_component !== \"\"){\n                        //then we can add it\n                        //console.log(\"here we go\");\n                        var add_medical = {\n                            authority_id: vm.temporary.medical_authority.id,\n                            authority_title: vm.temporary.medical_authority.abbreviation,\n                            medical_component_id: vm.temporary.medical_component.id,\n                            medical_component_title: vm.temporary.medical_component.title\n                        };\n\n                        //check if it doesnt exist first...\n                        if(containsObject(add_medical, vm.club.plane.requirements.medical, new Array(\"authority_id\", \"medical_component_id\")) == false){\n                            vm.club.plane.requirements.medical.push(add_medical);\n                        }\n\n                        delete vm.temporary.medical_authority;\n                        delete vm.temporary.medical_component;\n\n                    } else {\n                        alert(\"Please select a medical that is required to book the plane solo!\");\n                    }\n\n                break;\n\n\n                case \"differences\":\n                    //console.log(\"difference\");\n                    if(vm.temporary.difference && vm.temporary.difference !== \"\"){\n                        //then we can add it\n                        //console.log(\"here we go\");\n                        var add_difference = {\n                            difference_id: vm.temporary.difference.id,\n                            difference_title: vm.temporary.difference.title\n                        };\n\n                        //check if it doesnt exist first...\n                        if(containsObject(add_difference, vm.club.plane.requirements.differences, new Array(\"difference_id\", \"difference_title\")) == false){\n                            vm.club.plane.requirements.differences.push(add_difference);\n                        }\n\n                        delete vm.temporary.difference;\n\n                    } else {\n                        alert(\"Please select a difference that is required to book the plane solo!\");\n                    }\n\n                break;\n\n\n            }\n\n\n\n        }\n\n\n\n\n        $scope.remove_item = function(type, index){\n            //console.log(\"REMOVE\");\n\n            vm.club.plane.requirements[type].splice(index, 1);\n\n\n            // switch(type){\n            //     case \"licence\":\n            //             //console.log(\"licence\");\n                   \n            //             //check if it doesnt exist first...\n            //             // if(containsObject(add_licence, vm.club.plane.requirements.licence, new Array(\"licence_id\", \"rating_id\")) == false){\n            //             //     vm.club.plane.requirements.licence.push(add_licence);\n            //             // }\n\n            //             vm.club.plane.requirements.licence.splice(index, 1);\n                      \n                   \n\n            //     break;\n\n\n            //     case \"medical\":\n            //         //console.log(\"medical\");\n            //         if(vm.temporary.medical_authority && vm.temporary.medical_authority !== \"\" && vm.temporary.medical_component && vm.temporary.medical_component !== \"\"){\n            //             //then we can add it\n            //             //console.log(\"here we go\");\n            //             var add_medical = {\n            //                 authority_id: vm.temporary.medical_authority.id,\n            //                 authority_title: vm.temporary.medical_authority.abbreviation,\n            //                 medical_component_id: vm.temporary.medical_component.id,\n            //                 medical_component_title: vm.temporary.medical_component.title\n            //             };\n\n            //             //check if it doesnt exist first...\n            //             if(containsObject(add_medical, vm.club.plane.requirements.medical, new Array(\"authority_id\", \"medical_component_id\")) == false){\n            //                 vm.club.plane.requirements.medical.push(add_medical);\n            //             }\n\n            //             delete vm.temporary.medical_authority;\n            //             delete vm.temporary.medical_component;\n\n            //         } else {\n            //             alert(\"Please select a medical that is required to book the plane solo!\");\n            //         }\n\n            //     break;\n\n\n            //     case \"differences\":\n            //         //console.log(\"difference\");\n            //         if(vm.temporary.difference && vm.temporary.difference !== \"\"){\n            //             //then we can add it\n            //             //console.log(\"here we go\");\n            //             var add_difference = {\n            //                 difference_id: vm.temporary.difference.id,\n            //                 difference_title: vm.temporary.difference.title\n            //             };\n\n            //             //check if it doesnt exist first...\n            //             if(containsObject(add_difference, vm.club.plane.requirements.differences, new Array(\"difference_id\", \"difference_title\")) == false){\n            //                 vm.club.plane.requirements.differences.push(add_difference);\n            //             }\n\n            //             delete vm.temporary.difference;\n\n            //         } else {\n            //             alert(\"Please select a difference that is required to book the plane solo!\");\n            //         }\n\n            //     break;\n\n\n            // }\n\n\n\n        }\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n        $scope.update_this_file = function(file){\n            //console.log(\"==== update is : \", file.id);\n            if(update_this_file.indexOf(file.id) === -1){\n                update_this_file.push(file.id)\n            } else {\n               ////console.log(\"This item already exists\"); \n            } \n        }\n\n\n         $scope.remove_real_file = function(file){\n\n                //remove_file\n\n                vm.club.plane.plane_documents = $.grep(vm.club.plane.plane_documents, function(e){ \n                        return e.id != file.id; \n                    });\n\n                //no need to actually remove the file as it will be archived accordingly on the backend whilst it is missing! :)\n                PlaneDocumentService.Delete(vm.user.id, file.id)\n                .then(function (data) {\n                    //console.log(data);\n                    if(data.success){\n                        //console.log(\"HUZZAH\", current_files);\n                        //then we need to remove this from the list of files...\n                        //clear files\n                        vm.plane_documents = [];\n                        //and re-process available files\n                        $scope.processFiles(current_files);\n\n                    } else {\n                        //console.log(\"WOOOPSIES...\");\n                        //this should be very very rare...\n                    }\n\n                });\n\n          }\n\n\n          \n          $scope.remove_file = function(file, current_files){\n\n            //remove_file\n            var j = JSON.parse(file.file_return);\n            //console.log(\"REMOVE: \", j);\n            //console.log(\"REMOVE: \", j.saved_url);\n\n            //to delete the temp file created: j.saved_url\n            //tmp_rm.php POST tmp = filename\n            \n            PoidService.DeleteTmp(j.saved_url)\n                .then(function (data) {\n                    //console.log(data);\n                    if(data.success){\n                        //console.log(\"HUZZAH\", current_files);\n                        //then we need to remove this from the list of files...\n                        //clear files\n                        vm.plane_documents = [];\n                        //and re-process available files\n                        $scope.processFiles(current_files);\n\n                    } else {\n                        //console.log(\"WOOOPSIES...\");\n                        //this should be very very rare...\n                    }\n\n                });\n\n          }\n          \n\n          // $scope.$on('flow::fileAdded', function (event, $flow, flowFile) {\n          //     event.preventDefault();//prevent file from uploading\n          //     //console.log(\"FILE ADDED\");\n          //     //console.log($flow);\n          //   });\n\n            $scope.processFiles = function(files){\n                // //console.log(\"files\", files);\n\n                for(var i=0; i<files.length; i++){\n                    // //console.log(\"JSON\", files[i].file_return);\n                    var j = JSON.parse(files[i].file_return);\n                    // //console.log(\"PARSED\", j);\n                    //console.log(\"J is : \",j);\n                    //console.log(\"name is : \", j.files.file.name);\n\n                    files[i].file.temp_path = j.saved_url;\n                    files[i].file.save_name = j.files.file.name;\n                    var ft = j.files.file.name;\n                    ft = ft.split('.').pop();\n                    files[i].file.extension = ft;\n\n                    // //console.log(\"file\", files[i].file);\n                    vm.plane_documents.push(files[i].file);\n                }\n\n\n            }\n\n            $scope.set_title = function(file){\n                //console.log(\"return\", file);\n                return file.save_name;\n            }\n\n            $scope.get_icon = function(file){\n\n                var ft = file.name;\n                ft = ft.split('.').pop();\n                var icon_name = \"\";\n\n                // //console.log(\"FILE:\", ft);\n                // //console.log(\"index : \", ft.indexOf(\"pdf\"));\n                switch(true){\n                    case (ft.indexOf(\"pdf\") > -1):\n                        icon_name = \"pdf.png\";\n                    break;\n                    case (ft.indexOf(\"doc\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"docx\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"xls\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"xlsx\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"ppt\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"pptx\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"jpg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"jpeg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"png\") > -1):\n                        icon_name = \"png.png\";\n                    break;\n                    case (ft.indexOf(\"gif\") > -1):\n                        icon_name = \"gif.png\";\n                    break;\n                    case (ft.indexOf(\"zip\") > -1):\n                        icon_name = \"zip.png\";\n                    break;\n                    case (ft.indexOf(\"avi\") > -1):\n                        icon_name = \"avi.png\";\n                    break;\n                    case (ft.indexOf(\"mp4\") > -1):\n                        icon_name = \"mp4.png\";\n                    break;\n                    default:\n                        icon_name = \"file.png\";\n                    break;\n                }\n\n                // //console.log(\"FILE:\", icon_name);\n\n                return \"images/file_icons/\"+icon_name;\n            }\n\n\n            $scope.get_icon2 = function(file){\n\n                var ft = file.split('.').pop();\n                //console.log(\"ICON 2 : \", ft);\n                var icon_name = \"\";\n\n                // //console.log(\"FILE:\", ft);\n                // //console.log(\"index : \", ft.indexOf(\"pdf\"));\n                switch(true){\n                    case (ft.indexOf(\"pdf\") > -1):\n                        icon_name = \"pdf.png\";\n                    break;\n                    case (ft.indexOf(\"doc\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"docx\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"xls\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"xlsx\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"ppt\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"pptx\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"jpg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"jpeg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"png\") > -1):\n                        icon_name = \"png.png\";\n                    break;\n                    case (ft.indexOf(\"gif\") > -1):\n                        icon_name = \"gif.png\";\n                    break;\n                    case (ft.indexOf(\"zip\") > -1):\n                        icon_name = \"zip.png\";\n                    break;\n                    case (ft.indexOf(\"avi\") > -1):\n                        icon_name = \"avi.png\";\n                    break;\n                    case (ft.indexOf(\"mp4\") > -1):\n                        icon_name = \"mp4.png\";\n                    break;\n                    default:\n                        icon_name = \"file.png\";\n                    break;\n                }\n\n                // //console.log(\"FILE:\", icon_name);\n\n                return \"images/file_icons/\"+icon_name;\n            }\n\n\n            $scope.get_icon3 = function(file){\n\n                var ft = file.split(';')[0];\n                // //console.log(\"ICON 2 : \", ft);\n                var icon_name = \"\";\n\n                // //console.log(\"FILE:\", ft);\n                // //console.log(\"index : \", ft.indexOf(\"pdf\"));\n                switch(true){\n                    case (ft.indexOf(\"pdf\") > -1):\n                        icon_name = \"pdf.png\";\n                    break;\n                    case (ft.indexOf(\"doc\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"docx\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"xls\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"xlsx\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"ppt\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"pptx\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"jpg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"jpeg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"png\") > -1):\n                        icon_name = \"png.png\";\n                    break;\n                    case (ft.indexOf(\"gif\") > -1):\n                        icon_name = \"gif.png\";\n                    break;\n                    case (ft.indexOf(\"zip\") > -1):\n                        icon_name = \"zip.png\";\n                    break;\n                    case (ft.indexOf(\"avi\") > -1):\n                        icon_name = \"avi.png\";\n                    break;\n                    case (ft.indexOf(\"mp4\") > -1):\n                        icon_name = \"mp4.png\";\n                    break;\n                    default:\n                        icon_name = \"file.png\";\n                    break;\n                }\n\n                // //console.log(\"FILE:\", icon_name);\n\n                return \"images/file_icons/\"+icon_name;\n            }\n\n\n            vm.approve_receipt_final = function(receipt){\n                //console.log(\"APPROVED THE RECEIPT\");\n                //time to make a call to an API endpoint\n                delete receipt.image;\n                PlaneService.ApproveReceipt(receipt.id, receipt)\n                .then(function(data){\n                    //console.log(\"data\", data);\n                    if(data.success){\n                        //we need to remove that one from the list\n                        vm.receipts.splice(vm.receipts.findIndex(function(i){\n                                            return i.id === receipt.id;\n                                        }), 1);\n\n                        vm.show_popup = false;\n                        vm.current_receipt = {};\n                    } else {\n                        alert(\"An error occurred: \"+data.message);\n                        vm.show_popup = false;\n                        vm.current_receipt = {};\n                    }\n                });\n            }   \n\n            vm.reject_receipt_final = function(receipt){\n                //console.log(\"REJECT THE RECEIPT\");\n                //time to make a call to an API endpoint\n                \n                delete receipt.image;\n                PlaneService.RejectReceipt(receipt.id, receipt)\n                .then(function(data){\n                    ////console.log(\"data\", data);\n                    if(data.success){\n                        //we need to remove that one from the list\n                        vm.receipts.splice(vm.receipts.findIndex(function(i){\n                                            return i.id === receipt.id;\n                                        }), 1);\n\n                        vm.show_popup = false;\n                        vm.current_receipt = {};\n                    } else {\n                        alert(\"An error occurred: \"+data.message);\n                        vm.show_popup = false;\n                        vm.current_receipt = {};\n                    }\n                });\n\n            }    \n\n\n            $scope.approve_receipt = function(receipt){\n                //console.log(\"RECEIPT: \", receipt);\n                vm.current_receipt = receipt;\n\n                if(vm.current_receipt.modified_reimbursed_amount > 0){\n                    vm.show_popup = 'approve';\n\n\n\n                } else {\n\n                    //this is where we bypass the popup\n\n                    vm.approve_receipt_final(receipt);\n\n\n\n                }\n\n\n\n\n            }\n\n            $scope.reject_receipt = function(receipt){\n                //console.log(\"RECEIPT: \", receipt);\n                vm.current_receipt = receipt;\n\n                vm.show_popup = 'reject';\n\n\n\n            }\n\n            $scope.close_popup = function(){\n                vm.show_popup = false;\n                vm.current_receipt = {};\n            }\n\n\n            $scope.delete_poid = function(id){\n\n              \n                var a = prompt(\"Are you sure you wish to delete this poid? \\n\\n This change is irreversible! To confirm please type YES in the box below.\");\n                if(a == \"YES\"){\n\n\n                    //console.log(\"WE DELETE IT\");\n\n\n                    // PoidService.Delete(vm.user_id, id)\n                    //     .then(function (data) {\n                    //         //console.log(data);\n                    //         if(data.success){\n                    //             //console.log(\"HUZZAH\", data);\n                    //             //then we need to remove this from the list of files...\n                    //             vm.user_poids = $.grep(vm.user_poids, function(e){ \n                    //                 return e.id != id; \n                    //             });\n                                \n                    //             //refresh?\n                    //             $state.reload();\n                    //             $state.go('dashboard.my_account.poid');\n\n                    //         } else {\n\n                    //             alert(\"Something went terribly wrong... \\n\\n \"+data.message);\n\n                    //         }\n\n                    //     });\n\n\n\n                } else {\n                    //console.log(\"ignore123\");\n                }\n\n\n            }\n\n\n\n\n            $scope.save_plane_documents = function(){\n\n               \n              \n\n                //console.log(\"plane_documents: \", vm.plane_documents);\n\n\n                //compile the required elements YAY\n\n                //console.log(\"plane_document \", vm.plane_document);\n\n\n                 //clean shizzle before sending\n                 //why keep sending back heavy data?\n\n                    // for(var i=0;i<vm.plane_document.images.length;i++){\n                    //     delete vm.plane_document.images[i].data_uri;\n                    // }\n\n                    // // vm.plane_document.images = vm.plane_documents;\n                    // vm.plane_document.images = vm.plane_document.images.concat(vm.plane_documents);\n                    // vm.plane_document.user_id = vm.user_id;\n\n\n\n\n            //     if(vm.plane_document.id){\n            //         //then its an udpate\n\n            //         //merge the images left?\n            //         PoidService.Update(vm.plane_document)\n            //             .then(function (data) {\n            //                 //console.log(data);\n            //                 if(data.success){\n            //                     //console.log(\"HUZZAH\", vm.plane_document);\n            //                     //console.log(\"HUZZAH\", data);\n            //                     //then we need to remove this from the list of files...\n                                \n                                \n            //                     //move somewhere?\n            //                     $state.go('dashboard.my_account.poid', {}, { reload: true });\n\n\n\n\n\n            //                 } else {\n\n            //                     alert(\"Something went terribly wrong... \\n\\n \"+data.message);\n\n            //                 }\n\n            //             });\n\n            //     } else {\n\n\n                   \n\n\n            //         //then its a create\n            //         //console.log(vm.plane_document);\n\n            //         PoidService.Create(vm.plane_document)\n            //             .then(function (data) {\n            //                 //console.log(data);\n            //                 if(data.success){\n            //                     //console.log(\"HUZZAH\", vm.plane_document);\n            //                     //console.log(\"HUZZAH\", data);\n            //                     //then we need to remove this from the list of files...\n                                \n                                \n            //                     //move somewhere?\n            //                    // $state.reload();\n            //                    // $state.go('dashboard.my_account.poid', {}, { reload: true });\n\n\n            //                 } else {\n\n            //                     alert(\"Something went terribly wrong... \\n\\n \"+data.message);\n\n            //                 }\n\n            //             });\n\n\n            //     }\n\n\n\n             };\n\n\n\n\n             $scope.change_file_name = function(file){\n                \n                //this is terribly ineficient... unfortunately... can't \n                //work out how else to do it! (lol)\n\n                // //console.log(\"TO BE CHANGED\", file);\n\n                // //console.log(\"BEFORE BEFORE\", vm.plane_documents);\n\n                vm.plane_documents = $.grep(vm.plane_documents, function(e){ \n                    return e.temp_path != file.temp_path; \n                });\n\n                // //console.log(\"BEFORE\", vm.plane_documents);\n\n                vm.plane_documents.push(file);\n\n                // //console.log(\"AFTER\", vm.plane_documents);\n\n             }\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n        initController();\n\n        function initController() {\n           //console.log(\"check if access is okay\");\n        }\n\n\n            var warning_msg = \"By deleting this plane, you will also cancel all reservations that this plane currently has.\"\n\n          $scope.open = function (plane_id) {\n            var modalInstance = $uibModal.open({\n              animation: true,\n              templateUrl: 'views/modals/deleteModal.html',\n              controller: 'ModalInstanceCtrl',\n              size: \"lg\",\n              resolve: {\n                id: function () {\n                  return plane_id;\n                },\n                params: function() {\n                  return {id: plane_id};\n                },\n                warning: function(){\n                    return warning_msg;\n                }\n              }\n            });\n            modalInstance.result.then(function (plane_id) {\n              $log.info('PRESSED GO: '+plane_id.id);\n              ItemService.Delete(vm.user.id, plane_id.id)\n              .then(function(){\n                //console.log(\"HELLO DELETE\");\n                //update view?\n                 vm.club.items = $.grep(vm.club.items, function(e){ \n                    return e.id != plane_id.id; \n                });\n              })\n            }, function () {\n              $log.info('Modal dismissed at: ' + new Date());\n            });\n          };\n\n         \n\n\n    }\n app.controller('DashboardClubSettingsController', DashboardClubSettingsController);\n\n    DashboardClubSettingsController.$inject = ['UserService', 'ClubService', 'PaymentService', '$rootScope', '$location', '$scope', '$state', '$stateParams', '$window', '$http', '$log'];\n    function DashboardClubSettingsController(UserService, ClubService, PaymentService, $rootScope, $location, $scope, $state, $stateParams, $window, $http, $log) {\n        var vm = this;\n\n        vm.user = null;\n        vm.allUsers = [];\n        vm.club = {};\n\n        vm.club_id = $rootScope.globals.currentUser.current_club_admin.id;\n        vm.user = $rootScope.globals.currentUser;\n        vm.user_id = vm.user.id;\n        \n        vm.action = $state.current.data.action;\n\n\n        switch(vm.action){\n            case \"list\":\n                //need to update this to be part of the authentication\n                //to find out club id\n                //'9' needs to refer the the user's account set to manage\n                ClubService.GetById(vm.club_id)\n                    .then(function(data){\n                        vm.club.settings = data;\n                        vm.club.settings.vat_registered = (vm.club.settings.vat_registered == 1)? true : false;\n                        vm.club.settings.tpc_aircraft_surchages = (vm.club.settings.tpc_aircraft_surchages == 1)? true : false;\n                        vm.club.settings.vat_rate = parseFloat(vm.club.settings.vat_rate);\n                        //console.log(vm.club);\n                    });\n\n\n            break;\n            case \"stripe_return\":\n                //need to update this to be part of the authentication\n                //to find out club id\n                vm.stripe_id = $stateParams.stripe_id;\n                //generate a link here and do something cool with it!!\n                PaymentService.SaveStripeLink(vm.club_id, vm.stripe_id)\n                .then(function(data){\n                    console.log(data);\n\n                    //$state.go('dashboard.manage_club');\n                });\n\n            break;\n            case \"stripe_refresh\":\n                //need to update this to be part of the authentication\n                vm.stripe_id = $stateParams.stripe_id;\n                //to find out club id\n                PaymentService.RefreshStripeLink(vm.club_id, vm.stripe_id)\n                    .then(function(data){\n                        //vm.club.courses = data.items;   \n                        console.log(data);\n                    });\n            break;\n            default:\n                //console.log(\"none of the above... redirect somewhere?\");\n            break;\n        }  \n\n\n       \n\n\n        $scope.processFiles = function(files, image){\n\n            for(var i=0; i<files.length; i++){\n                // //console.log(\"JSON\", files[i].file_return);\n                var j = JSON.parse(files[i].file_return);\n                // //console.log(\"PARSED\", j);\n                files[i].file.temp_path = j.saved_url;\n\n                var update_text = \"update_\"+image;\n                // //console.log(\"file\", files[i].file);\n                vm.club.settings[image] = files[i].file;\n                vm.club.settings[image] = files[i].file.temp_path;\n                vm.club.settings[update_text] = true;\n                // //console.log(vm.club.settings[image]);\n            }\n           \n        }\n\n        $scope.save = function(){\n            // //console.log(\"CLICKED\", vm.club.settings);\n            //return false;\n\n\n            if(!vm.club.settings.update_logo){\n                    delete vm.club.settings.logo;\n            }\n            if(!vm.club.settings.update_invoice_logo){\n                    delete vm.club.settings.invoice_logo;\n            }\n\n            if(vm.privacy_file){\n                vm.club.settings.privacy_terms = vm.privacy_file;\n            } else {\n                delete(vm.club.settings.privacy_terms);\n            }\n\n            if(vm.membership_file){\n                vm.club.settings.membership_terms = vm.membership_file;\n            }else {\n                delete(vm.club.settings.membership_terms);\n            }\n\n            if(vm.passenger_file){\n                vm.club.settings.passenger_terms = vm.passenger_file;\n            }else {\n                delete(vm.club.settings.passenger_terms);\n            }\n\n            delete(vm.club.settings.membership_updated);\n            delete(vm.club.settings.passenger_updated);\n            delete(vm.club.settings.privacy_updated);\n\n            delete(vm.club.settings.updated_at);\n            delete(vm.club.settings.created_at);\n            delete(vm.club.settings.gcl);\n            delete(vm.club.settings.salt);\n            delete(vm.club.settings.pepper);\n\n            vm.club.settings.vat_registered = (vm.club.settings.vat_registered)? 1 : 0;\n            vm.club.settings.tpc_aircraft_surchages = (vm.club.settings.tpc_aircraft_surchages)? 1 : 0;\n            \n\n            ClubService.Update(vm.club.settings)\n                .then(function(data){\n                    //console.log(data);\n                    $state.go('dashboard.manage_club');\n                });\n        }\n\n        initController();\n\n        function initController() {\n           //console.log(\"check if access is okay\");\n        }\n\n        vm.called_stripe_setup = false;\n        vm.generate_stripe_link = function(){\n\n            vm.called_stripe_setup = true;\n\n            //generate a link here and do something cool with it!!\n            PaymentService.GenerateStripeLink(vm.club.settings)\n                .then(function(data){\n                    console.log(data);\n\n                    if(data.success && data.onboarding_link !== ''){\n                        alert(\"You will be redirected to Stripe - please complete the setup and you will be returned to ToAviate\");\n                        window.location = data.onboarding_link;\n                    } else {\n                        alert(\"Please try the link again! Stripe didn't seem to want to connect to ToAviate\");\n                        vm.called_stripe_setup = false;\n                    }\n\n\n                    //$state.go('dashboard.manage_club');\n                });\n\n\n        }\n\n        vm.term_documents = [];\n\n         $scope.processFiles2 = function(files, current_files){\n                // //console.log(\"files\", files);\n\n                for(var i=0; i<files.length; i++){\n                    // //console.log(\"JSON\", files[i].file_return);\n                    var j = JSON.parse(files[i].file_return);\n                    // //console.log(\"PARSED\", j);\n                    // //console.log(\"J is : \",j);\n                    // //console.log(\"name is : \", j.files.file.name);\n\n                    files[i].file.temp_path = j.saved_url;\n                    files[i].file.save_name = j.files.file.name;\n                    var ft = j.files.file.name;\n                    ft = ft.split('.').pop();\n                    files[i].file.extension = ft;\n\n                    // //console.log(\"file\", files[i].file);\n                    switch(current_files){\n                        case 'privacy':\n                        vm.privacy_file = files[i].file;\n                        break;\n                        case 'membership':\n                        vm.membership_file = files[i].file;\n                        break;\n                        case 'passenger':\n                        vm.passenger_file = files[i].file;\n                        break;\n                    }\n                    //vm.term_documents[current_files] = files[i].file;\n                }\n\n\n            }\n\n            $scope.delete_file = function(filetype){\n                var to_delete;\n                    switch(filetype){\n                        case 'privacy':\n                        to_delete = vm.club.settings.privacy_terms;\n                        vm.club.settings.privacy_terms = \"\";\n                        break;\n                        case 'membership':\n                        to_delete = vm.club.settings.membership_terms;\n                        vm.club.settings.membership_terms = \"\";\n                        break;\n                        case 'passenger':\n                        to_delete = vm.club.settings.passenger_terms;\n                        vm.club.settings.passenger_terms = \"\";\n                        break;\n                    }\n                    \n                    //think about deleting the actual file API call\n\n\n\n\n\n            }\n\n            $scope.remove_file = function(file, current_files){\n\n                //remove_file\n                var j = JSON.parse(file.file_return);\n                //console.log(\"REMOVE: \", j);\n                //console.log(\"REMOVE: \", j.saved_url);\n\n\n                // PoidService.DeleteTmp(j.saved_url)\n                //     .then(function (data) {\n                //         //console.log(data);\n                //         if(data.success){\n                //             //console.log(\"HUZZAH\", current_files);\n                //             //then we need to remove this from the list of files...\n                //             //clear files\n                //             vm.plane_documents = [];\n                //             //and re-process available files\n                //             $scope.processFiles(current_files);\n\n                //         } else {\n                //             //console.log(\"WOOOPSIES...\");\n                //             //this should be very very rare...\n                //         }\n\n                //     });\n\n              }\n\n            $scope.set_title = function(file){\n                //console.log(\"return\", file);\n                return file.save_name;\n            }\n\n            $scope.back = function(){\n                $window.history.back();\n            }\n\n            $scope.get_icon = function(file){\n\n                var ft;\n                if(file && file.name){\n                     ft = file.name;\n                } else {\n                    ft = file;\n                }\n                ft = ft.split('.').pop();\n                var icon_name = \"\";\n\n                // //console.log(\"FILE:\", ft);\n                // //console.log(\"index : \", ft.indexOf(\"pdf\"));\n                switch(true){\n                    case (ft.indexOf(\"pdf\") > -1):\n                        icon_name = \"pdf.png\";\n                    break;\n                    case (ft.indexOf(\"doc\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"docx\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"xls\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"xlsx\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"ppt\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"pptx\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"jpg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"jpeg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"png\") > -1):\n                        icon_name = \"png.png\";\n                    break;\n                    case (ft.indexOf(\"gif\") > -1):\n                        icon_name = \"gif.png\";\n                    break;\n                    case (ft.indexOf(\"zip\") > -1):\n                        icon_name = \"zip.png\";\n                    break;\n                    case (ft.indexOf(\"avi\") > -1):\n                        icon_name = \"avi.png\";\n                    break;\n                    case (ft.indexOf(\"mp4\") > -1):\n                        icon_name = \"mp4.png\";\n                    break;\n                    default:\n                        icon_name = \"file.png\";\n                    break;\n                }\n\n                // //console.log(\"FILE:\", icon_name);\n\n                return \"images/file_icons/\"+icon_name;\n            }\n\n\n\n\n\n\n        $scope.downloadClubDocument = function(doc) {\n            var data = $.param({\n                id: doc\n            });\n\n            var ddd = doc.replace(/^.*[\\\\\\/]/, '');\n\n            $http.get('api/v1/club_documents/show_file/'+ddd, {\n                    responseType: 'arraybuffer'\n                })\n                .success(function(data, status, headers) {\n                    var zipName = processArrayBufferToBlob(data, headers);\n\n                    //Delete file from temp folder in server - file needs to remain open until blob is created\n                    //deleteFileFromServerTemp(zipName);\n                }).error(function(data, status) {\n                    alert(\"There was an error downloading the selected document(s).\");\n                })\n        };\n\n        function titlepath(path,name){\n\n        //In this path defined as your pdf url and name (your pdf name)\n            var prntWin = window.open();\n            prntWin.document.write(\"<html><head><title>\"+name+\"</title></head><body>\"\n                + '<embed width=\"100%\" height=\"100%\" name=\"plugin\" src=\"'+ path+ '\" '\n                + 'type=\"application/pdf\" internalinstanceid=\"21\"></body></html>');\n            prntWin.document.close();\n        }\n\n        function processArrayBufferToBlob(data, headers) {\n            var octetStreamMime = 'application/octet-stream';\n            var success = false;\n\n            // Get the headers\n            headers = headers();\n            //var ttt = title.toLowerCase().replace(/\\W/g, '_');\n            // Get the filename from the x-filename header or default to \"download.bin\"\n            var filename = headers['x-filename'] || 'download.zip';\n\n            // Determine the content type from the header or default to \"application/octet-stream\"\n            var contentType = headers['content-type'] || octetStreamMime;\n\n            try {\n                // Try using msSaveBlob if supported\n                var blob = new Blob([data], \n                    //type: contentType\n                    {type: 'application/pdf'}\n                //}\n                );\n\n\n                var fileURL = URL.createObjectURL(blob);\n                //window.open(fileURL);\n                titlepath(fileURL, \"Secure Documents\");\n                \n                // if (navigator.msSaveBlob)\n                //     navigator.msSaveBlob(blob, filename);\n                // else {\n                //     // Try using other saveBlob implementations, if available\n                //     var saveBlob = navigator.webkitSaveBlob || navigator.mozSaveBlob || navigator.saveBlob;\n                //     if (saveBlob === undefined) throw \"Not supported\";\n                //     saveBlob(blob, filename);\n                // }\n                success = true;\n            } catch (ex) {\n                $log.info(\"saveBlob method failed with the following exception:\");\n                $log.info(ex);\n            }\n\n            if (!success) {\n                // Get the blob url creator\n                var urlCreator = window.URL || window.webkitURL || window.mozURL || window.msURL;\n                if (urlCreator) {\n                    // Try to use a download link\n                    var link = document.createElement('a');\n                    if ('download' in link) {\n                        // Try to simulate a click\n                        try {\n                            // Prepare a blob URL\n                            var blob = new Blob([data], {\n                                type: contentType\n                            });\n                            var url = urlCreator.createObjectURL(blob);\n                            link.setAttribute('href', url);\n\n                            // Set the download attribute (Supported in Chrome 14+ / Firefox 20+)\n                            link.setAttribute(\"download\", filename);\n\n                            // Simulate clicking the download link\n                            var event = document.createEvent('MouseEvents');\n                            event.initMouseEvent('click', true, true, window, 1, 0, 0, 0, 0, false, false, false, false, 0, null);\n                            link.dispatchEvent(event);\n                            success = true;\n\n                        } catch (ex) {\n                            $log.info(\"Download link method with simulated click failed with the following exception:\");\n                            $log.info(ex);\n                        }\n                    }\n\n                    if (!success) {\n                        // Fallback to window.location method\n                        try {\n                            // Prepare a blob URL\n                            // Use application/octet-stream when using window.location to force download\n                            var blob = new Blob([data], {\n                                type: octetStreamMime\n                            });\n                            var url = urlCreator.createObjectURL(blob);\n                            window.location = url;\n                            success = true;\n                        } catch (ex) {\n                            $log.info(\"Download link method with window.location failed with the following exception:\");\n                            $log.info(ex);\n                        }\n                    }\n                }\n            }\n\n            if (!success) {\n                // Fallback to window.open method\n                $log.info(\"No methods worked for saving the arraybuffer, using last resort window.open\");\n                window.open(httpPath, '_blank', '');\n            }\n            return filename;\n        };\n\n\n    }\n app.controller('DashboardClubShopItemsController', DashboardClubShopItemsController);\n\n    DashboardClubShopItemsController.$inject = ['UserService', 'PlaneService', '$rootScope', '$location', '$scope', '$state', '$stateParams', '$uibModal', '$log', '$window', 'LicenceService', 'MedicalService', 'DifferencesService', 'ShopItemService'];\n    function DashboardClubShopItemsController(UserService, PlaneService, $rootScope, $location, $scope, $state, $stateParams, $uibModal, $log, $window, LicenceService, MedicalService, DifferencesService, ShopItemService) {\n        var vm = this;\n\n        vm.user = null;\n        vm.allUsers = [];\n        vm.club = {};\n        vm.page_title = \"\";\n        \n        vm.plane_document = {};\n        vm.plane_documents = [];\n\n        var update_this_file = [];\n        \n\n        vm.action = $state.current.data.action;\n        vm.club_id = $rootScope.globals.currentUser.current_club_admin.id;\n        vm.user = $rootScope.globals.currentUser;\n        vm.user_id = vm.user.id;\n        ////console.log(\"club_id : \"+vm.club_id);\n\n        // //console.log(vm.action);\n         //console.log($stateParams);\n        // //console.log($stateParams.id);\n        switch(vm.action){\n            case \"add\":\n                //console.log(\"adding a new plane please\");\n                vm.page_title = \"Add a New Plane\";\n            break;\n            case \"edit\":\n                //console.log(\"edit an existing plane\");\n                 //console.log($stateParams);\n                ShopItemService.GetById($stateParams.item_id)\n                    .then(function(data){\n                        vm.club.item = data.item;   \n                        //console.log(vm.club);\n                        vm.page_title = \"Edit an Item - \"+vm.club.item.title;\n                    });\n\n\n            break;\n            case \"list\":\n                //need to update this to be part of the authentication\n                //to find out club id\n                ShopItemService.GetByClubId(vm.club_id)\n                    .then(function(data){\n                        vm.club.items = data.items;   \n                        //console.log(vm.club.items);\n                    });\n            break;\n            default:\n                //console.log(\"none of the above... redirect somewhere?\");\n            break;\n        }  \n\n        //'9' needs to refer the the user's account set to manage\n       \n        $scope.back = function(){\n            $window.history.back();\n        }\n\n        $scope.save = function(){\n            if(vm.action == \"add\"){\n                //console.log(\"CREATE click\");\n                $scope.create();\n            } else {\n                //console.log(\"EDIT click\");\n                //console.log(vm.club.plane);\n                $scope.update();\n            }\n        }\n\n\n        $scope.create = function(){\n            //console.log(\"CREATE ME NOW\");\n            vm.club.item.club_id = vm.club_id;\n            ShopItemService.Create(vm.club.item)\n                .then(function(data){\n                    //console.log(data);\n                    $state.go('dashboard.manage_club.shop_items');\n\n                });\n        }\n\n        $scope.delete = function(item){\n            var a = confirm(\"Are you sure you would like to delete this item?\");\n            if(a){\n                ShopItemService.Delete(vm.user.id, item.id)\n                .then(function(data){\n                    \n                    if(data.success){\n\n                         ShopItemService.GetByClubId(vm.club_id)\n                        .then(function(data){\n                            vm.club.items = data.items;   \n                            // //console.log(vm.club.items);\n                        });\n\n                    } else {\n                        alert(\"An error occured when trying to delete this item.\");\n                    }\n\n                });\n            }\n            \n        }\n\n        function get_update_docs(){\n            var documents = [];\n\n            for(var i=0;i<update_this_file.length;i++){\n                var id = update_this_file[i];\n                //console.log(\"looking for : \", id);\n                //console.log(\"in: \", vm.plane_documents);\n\n                for(var k=0;k<vm.club.plane.plane_documents.length;k++){\n                    //console.log(\"comparing to : \", vm.club.plane.plane_documents[k].id);\n                    if(vm.club.plane.plane_documents[k].id == id){\n                        documents.push(vm.club.plane.plane_documents[k]);\n                    }\n                }\n\n            }\n\n            // //console.log(\"DOCS TO UPDATE : \", documents);\n\n            return documents;\n        }\n\n        $scope.update = function(){\n            //console.log(\"CLICK\");\n            vm.club.item.club_id = vm.club_id;\n            ShopItemService.Update(vm.club.item, vm.user.id)\n                .then(function(data){\n                    //console.log(data);\n                    //console.log(\"saved\");\n                    $state.go('dashboard.manage_club.shop_items');\n                });\n        }\n\n\n        function containsObject(obj, list, params) {\n\n            // //console.log(\"obj\", obj);\n            // //console.log(\"list\", list);\n            // //console.log(\"params\", params);\n\n            for(var i=0; i<list.length; i++) {\n                // //console.log(\"list i : \", list[i]);\n                // //console.log(\"obj is: \", obj);\n\n                var count_success = 0;\n                for(var j=0;j<params.length;j++){\n                    if(list[i][params[j]] && obj[params[j]] && list[i][params[j]] == obj[params[j]]){\n                        count_success++;\n                    }\n                }\n\n                if(count_success === params.length) {                    \n                    return true;\n                }\n            }\n\n            return false;\n        }\n\n\n        function check_all(){\n\n            //maybe a nice to have one day... not yet though.\n\n\n            //licences\n            vm.club.plane.requirements.licence.forEach(function(obj){\n\n            });\n\n        }\n\n      \n\n\n\n        $scope.update_this_file = function(file){\n            //console.log(\"==== update is : \", file.id);\n            if(update_this_file.indexOf(file.id) === -1){\n                update_this_file.push(file.id)\n            } else {\n               ////console.log(\"This item already exists\"); \n            } \n        }\n\n\n         $scope.remove_real_file = function(file){\n\n                //remove_file\n\n                vm.club.plane.plane_documents = $.grep(vm.club.plane.plane_documents, function(e){ \n                        return e.id != file.id; \n                    });\n\n                //no need to actually remove the file as it will be archived accordingly on the backend whilst it is missing! :)\n                PlaneDocumentService.Delete(vm.user.id, file.id)\n                .then(function (data) {\n                    //console.log(data);\n                    if(data.success){\n                        //console.log(\"HUZZAH\", current_files);\n                        //then we need to remove this from the list of files...\n                        //clear files\n                        vm.plane_documents = [];\n                        //and re-process available files\n                        $scope.processFiles(current_files);\n\n                    } else {\n                        //console.log(\"WOOOPSIES...\");\n                        //this should be very very rare...\n                    }\n\n                });\n\n          }\n\n\n          \n          $scope.remove_file = function(file, current_files){\n\n            //remove_file\n            var j = JSON.parse(file.file_return);\n            //console.log(\"REMOVE: \", j);\n            //console.log(\"REMOVE: \", j.saved_url);\n\n            //to delete the temp file created: j.saved_url\n            //tmp_rm.php POST tmp = filename\n            \n            PoidService.DeleteTmp(j.saved_url)\n                .then(function (data) {\n                    //console.log(data);\n                    if(data.success){\n                        //console.log(\"HUZZAH\", current_files);\n                        //then we need to remove this from the list of files...\n                        //clear files\n                        vm.plane_documents = [];\n                        //and re-process available files\n                        $scope.processFiles(current_files);\n\n                    } else {\n                        //console.log(\"WOOOPSIES...\");\n                        //this should be very very rare...\n                    }\n\n                });\n\n          }\n          \n\n          // $scope.$on('flow::fileAdded', function (event, $flow, flowFile) {\n          //     event.preventDefault();//prevent file from uploading\n          //     //console.log(\"FILE ADDED\");\n          //     //console.log($flow);\n          //   });\n\n            $scope.processFiles = function(files){\n                // //console.log(\"files\", files);\n\n                for(var i=0; i<files.length; i++){\n                    // //console.log(\"JSON\", files[i].file_return);\n                    var j = JSON.parse(files[i].file_return);\n                    // //console.log(\"PARSED\", j);\n                    //console.log(\"J is : \",j);\n                    //console.log(\"name is : \", j.files.file.name);\n\n                    files[i].file.temp_path = j.saved_url;\n                    files[i].file.save_name = j.files.file.name;\n                    var ft = j.files.file.name;\n                    ft = ft.split('.').pop();\n                    files[i].file.extension = ft;\n\n                    // //console.log(\"file\", files[i].file);\n                    vm.plane_documents.push(files[i].file);\n                }\n\n\n            }\n\n            $scope.set_title = function(file){\n                //console.log(\"return\", file);\n                return file.save_name;\n            }\n\n            $scope.get_icon = function(file){\n\n                var ft = file.name;\n                ft = ft.split('.').pop();\n                var icon_name = \"\";\n\n                // //console.log(\"FILE:\", ft);\n                // //console.log(\"index : \", ft.indexOf(\"pdf\"));\n                switch(true){\n                    case (ft.indexOf(\"pdf\") > -1):\n                        icon_name = \"pdf.png\";\n                    break;\n                    case (ft.indexOf(\"doc\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"docx\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"xls\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"xlsx\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"ppt\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"pptx\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"jpg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"jpeg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"png\") > -1):\n                        icon_name = \"png.png\";\n                    break;\n                    case (ft.indexOf(\"gif\") > -1):\n                        icon_name = \"gif.png\";\n                    break;\n                    case (ft.indexOf(\"zip\") > -1):\n                        icon_name = \"zip.png\";\n                    break;\n                    case (ft.indexOf(\"avi\") > -1):\n                        icon_name = \"avi.png\";\n                    break;\n                    case (ft.indexOf(\"mp4\") > -1):\n                        icon_name = \"mp4.png\";\n                    break;\n                    default:\n                        icon_name = \"file.png\";\n                    break;\n                }\n\n                // //console.log(\"FILE:\", icon_name);\n\n                return \"images/file_icons/\"+icon_name;\n            }\n\n\n            $scope.get_icon2 = function(file){\n\n                var ft = file.split('.').pop();\n                // //console.log(\"ICON 2 : \", ft);\n                var icon_name = \"\";\n\n                // //console.log(\"FILE:\", ft);\n                // //console.log(\"index : \", ft.indexOf(\"pdf\"));\n                switch(true){\n                    case (ft.indexOf(\"pdf\") > -1):\n                        icon_name = \"pdf.png\";\n                    break;\n                    case (ft.indexOf(\"doc\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"docx\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"xls\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"xlsx\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"ppt\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"pptx\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"jpg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"jpeg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"png\") > -1):\n                        icon_name = \"png.png\";\n                    break;\n                    case (ft.indexOf(\"gif\") > -1):\n                        icon_name = \"gif.png\";\n                    break;\n                    case (ft.indexOf(\"zip\") > -1):\n                        icon_name = \"zip.png\";\n                    break;\n                    case (ft.indexOf(\"avi\") > -1):\n                        icon_name = \"avi.png\";\n                    break;\n                    case (ft.indexOf(\"mp4\") > -1):\n                        icon_name = \"mp4.png\";\n                    break;\n                    default:\n                        icon_name = \"file.png\";\n                    break;\n                }\n\n                // //console.log(\"FILE:\", icon_name);\n\n                return \"images/file_icons/\"+icon_name;\n            }\n\n\n\n         \n\n\n\n\n            $scope.save_plane_documents = function(){\n\n               \n              \n\n                //console.log(\"plane_documents: \", vm.plane_documents);\n\n\n                //compile the required elements YAY\n\n                //console.log(\"plane_document \", vm.plane_document);\n\n\n                 //clean shizzle before sending\n                 //why keep sending back heavy data?\n\n                    // for(var i=0;i<vm.plane_document.images.length;i++){\n                    //     delete vm.plane_document.images[i].data_uri;\n                    // }\n\n                    // // vm.plane_document.images = vm.plane_documents;\n                    // vm.plane_document.images = vm.plane_document.images.concat(vm.plane_documents);\n                    // vm.plane_document.user_id = vm.user_id;\n\n\n\n\n            //     if(vm.plane_document.id){\n            //         //then its an udpate\n\n            //         //merge the images left?\n            //         PoidService.Update(vm.plane_document)\n            //             .then(function (data) {\n            //                 //console.log(data);\n            //                 if(data.success){\n            //                     //console.log(\"HUZZAH\", vm.plane_document);\n            //                     //console.log(\"HUZZAH\", data);\n            //                     //then we need to remove this from the list of files...\n                                \n                                \n            //                     //move somewhere?\n            //                     $state.go('dashboard.my_account.poid', {}, { reload: true });\n\n\n\n\n\n            //                 } else {\n\n            //                     alert(\"Something went terribly wrong... \\n\\n \"+data.message);\n\n            //                 }\n\n            //             });\n\n            //     } else {\n\n\n                   \n\n\n            //         //then its a create\n            //         //console.log(vm.plane_document);\n\n            //         PoidService.Create(vm.plane_document)\n            //             .then(function (data) {\n            //                 //console.log(data);\n            //                 if(data.success){\n            //                     //console.log(\"HUZZAH\", vm.plane_document);\n            //                     //console.log(\"HUZZAH\", data);\n            //                     //then we need to remove this from the list of files...\n                                \n                                \n            //                     //move somewhere?\n            //                    // $state.reload();\n            //                    // $state.go('dashboard.my_account.poid', {}, { reload: true });\n\n\n            //                 } else {\n\n            //                     alert(\"Something went terribly wrong... \\n\\n \"+data.message);\n\n            //                 }\n\n            //             });\n\n\n            //     }\n\n\n\n             };\n\n\n\n\n             $scope.change_file_name = function(file){\n                \n                //this is terribly ineficient... unfortunately... can't \n                //work out how else to do it! (lol)\n\n                // //console.log(\"TO BE CHANGED\", file);\n\n                // //console.log(\"BEFORE BEFORE\", vm.plane_documents);\n\n                vm.plane_documents = $.grep(vm.plane_documents, function(e){ \n                    return e.temp_path != file.temp_path; \n                });\n\n                // //console.log(\"BEFORE\", vm.plane_documents);\n\n                vm.plane_documents.push(file);\n\n                // //console.log(\"AFTER\", vm.plane_documents);\n\n             }\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n        initController();\n\n        function initController() {\n           //console.log(\"check if access is okay\");\n        }\n\n\n            var warning_msg = \"By deleting this plane, you will also cancel all reservations that this plane currently has.\"\n\n          $scope.open = function (plane_id) {\n            var modalInstance = $uibModal.open({\n              animation: true,\n              templateUrl: 'views/modals/deleteModal.html',\n              controller: 'ModalInstanceCtrl',\n              size: \"lg\",\n              resolve: {\n                id: function () {\n                  return plane_id;\n                },\n                params: function() {\n                  return {id: plane_id};\n                },\n                warning: function(){\n                    return warning_msg;\n                }\n              }\n            });\n            modalInstance.result.then(function (plane_id) {\n              $log.info('PRESSED GO: '+plane_id.id);\n              ItemService.Delete(vm.user.id, plane_id.id)\n              .then(function(){\n                //console.log(\"HELLO DELETE\");\n                //update view?\n                 vm.club.items = $.grep(vm.club.items, function(e){ \n                    return e.id != plane_id.id; \n                });\n              })\n            }, function () {\n              $log.info('Modal dismissed at: ' + new Date());\n            });\n          };\n\n         \n\n\n    }\n\n\n\n\n\n\n app.controller('DashboardClubShopSaleController', DashboardClubShopSaleController);\n\n    DashboardClubShopSaleController.$inject = ['$timeout', '$sce', 'ExperiencesService', 'PaymentService', '$scope', '$rootScope', 'MemberService', 'ClubService', 'ShopItemService', '$state', 'PackageService'];\n    function DashboardClubShopSaleController($timeout, $sce, ExperiencesService, PaymentService, $scope, $rootScope,   MemberService, ClubService, ShopItemService, $state, PackageService) {         \n\n          var vm = this;\n\n            $scope.to_refund = 0;\n            $scope.reason = \"\";\n            $scope.club_id = $rootScope.globals.currentUser.current_club_admin.id;\n            vm.club_id = $scope.club_id;\n\n            $scope.club_settings = {};\n\n            $scope.new_client = {\n              first_name: \"\",\n              last_name: \"\",\n              email: \"\"\n            };\n\n            $scope.items = [];\n            $scope.item = {\n              title: \"\",\n              quantity: 1,\n              vat: 0,\n              price: 0\n            };\n\n            $scope.selected_client;\n            $scope.selected_card;\n\n            vm.selected_voucher;\n\n\n            $scope.members = [];\n\n            $scope.show_direct_debit_details = false;\n            vm.custom_item = false;\n\n\n            var iconBank = '<svg viewBox=\"0 0 24 24\"><path d=\"M3 10h18M4 10V8l8-5 8 5v2M5 10v8M9 10v8M15 10v8M19 10v8M3 18h18M2 20h20\" fill=\"none\" stroke=\"#4f46e5\" stroke-width=\"1.6\"/></svg>';\n            var iconCard = '<svg viewBox=\"0 0 24 24\"><rect x=\"2\" y=\"4\" width=\"20\" height=\"16\" rx=\"2\" ry=\"2\" fill=\"none\" stroke=\"#4f46e5\" stroke-width=\"1.6\"/><path d=\"M2 9h20M6 14h6\" stroke=\"#4f46e5\" stroke-width=\"1.6\"/></svg>';\n            var iconNew  = '<svg viewBox=\"0 0 24 24\"><circle cx=\"12\" cy=\"12\" r=\"9\" fill=\"none\" stroke=\"#4f46e5\" stroke-width=\"1.6\"/><path d=\"M12 8v8M8 12h8\" stroke=\"#4f46e5\" stroke-width=\"1.6\"/></svg>';\n            var iconTerm = '<svg viewBox=\"0 0 24 24\"><rect x=\"6\" y=\"2\" width=\"12\" height=\"14\" rx=\"2\" fill=\"none\" stroke=\"#4f46e5\" stroke-width=\"1.6\"/><rect x=\"8\" y=\"5\" width=\"8\" height=\"3\" fill=\"none\" stroke=\"#4f46e5\" stroke-width=\"1.6\"/><rect x=\"9\" y=\"10\" width=\"6\" height=\"3\" fill=\"none\" stroke=\"#4f46e5\" stroke-width=\"1.6\"/></svg>';\n            vm.close_pay_now = function(){\n               vm.show_pay_now = false;\n               vm.show_loading = false;\n            }\n\n              vm.donConfirm = function(methodLabel, paymentIntent){\n                // console.log(\"confirmation is called\", methodLabel);\n                // console.log(\"paymentIntent\", paymentIntent);\n              //alert('Parent received D confirmation: ' + methodLabel);\n                vm.complete_now(methodLabel, paymentIntent);\n              };\n\n              vm.default_payment = 'new-card';\n\n              vm.methods = [\n                { id: 'direct-debit', title: 'Direct Debit', subtitle: 'Use your BACS mandate', type: 'direct-debit', iconSvg: $sce.trustAsHtml(iconBank), visible: true },\n                { id: 'saved-card',   title: 'Saved card',   subtitle: 'Use a card on file',    type: 'saved-card',  iconSvg: $sce.trustAsHtml(iconCard), visible: true },\n                { id: 'new-card',     title: 'New card',     subtitle: 'Add a new debit/credit card', type: 'new-card', iconSvg: $sce.trustAsHtml(iconNew), visible: true },\n                { id: 'card-machine', title: 'Card Machine', subtitle: 'Pay in person',          type: 'card-machine', iconSvg: $sce.trustAsHtml(iconTerm), visible: true }\n              ];\n\n               vm.savedCards = [];\n\n\n\n             ShopItemService.GetByClubId(vm.club_id)\n                    .then(function(data){\n                        vm.shop_items = data.items;   \n                    });\n\n            ClubService.GetById($scope.club_id)\n            .then(function(data){\n                $scope.club_settings = data;\n                $scope.item.vat = parseFloat($scope.club_settings.vat_rate);                            \n                $scope.club_settings.vat_registered = ($scope.club_settings.vat_registered == 1)? true : false;\n                // //console.log(\"settings\", $scope.club_settings);\n            });\n\n           ExperiencesService.GetByClubId($scope.club_id)\n                  .then(function(data){\n                      //console.log(\"planes\", data);\n                      vm.vouchers = data.items;\n                  });\n            ExperiencesService.GetDiscountsByClubId($scope.club_id)\n                .then(function(data){\n                    //console.log(\"discounts\", data);\n                    vm.discounts = data.items;\n                });\n\n\n            PackageService.GetPackagesByClubId($scope.club_id)\n            .then(function(data){\n                vm.packages = data.items;\n\n                // //console.log(\"PACKPACK\", vm.packages);\n            });\n\n            MemberService.GetAllByClub($scope.club_id)\n                    .then(function(data){\n                        $scope.members = data;   \n                        $scope.members.unshift({id: -12, first_name: \"New\", last_name: \"Client\"});\n                        // $scope.item.title = \"hjel\";\n                        // //console.log(\"members\",$scope.members);\n                    });\n\n\n            $scope.delete_receipt = function(number){\n\n                \n              $scope.items.splice(number, 1);\n           \n              calculate_charges();\n\n            }\n\n            $scope.card_selected = function(data){\n              $scope.selected_card = data;\n\n              if(data.id == -12){\n                //  setTimeout(function(){\n                //   setupStripe();\n                // }, 1000);\n              }\n\n            }\n\n            $scope.member_selected = function(data){\n              //console.log(\"selected\", data);\n              \n              $scope.selected_client = data;\n\n              if(data && data.account_ending && data.account_ending !== ''){\n                  $scope.show_direct_debit_details = true;\n                } else {\n                  $scope.show_direct_debit_details = false;\n                  //  setTimeout(function(){\n                  //   setupStripe();\n                  // }, 1000);\n\n\n                }\n\n              if(data && data.id == -12){\n                \n                // setTimeout(function(){\n                //   setupStripe();\n                // }, 1000);\n\n              } \n            }\n\n            $scope.selected_item;\n\n            $scope.item_selected = function(item){\n              // //console.log(item);\n              $scope.selected_item = item;\n            }\n\n            $scope.package_selected = function(item){\n              // //console.log(item);\n              $scope.selected_package = item;\n            }\n\n\n                vm.new_item_qty = 1;\n\n            vm.add_selected_voucher = function(){\n\n              if($scope.items.find(x => x.voucher_id === vm.selected_voucher.id) && vm.selected_voucher.id > 0){\n\n                  // //console.log(\"already exists\");\n                  $scope.items.find(x => x.voucher_id === vm.selected_voucher.id).quantity = $scope.items.find(x => x.voucher_id === vm.selected_voucher.id).quantity + 1;\n\n                } else {\n                  if(vm.selected_voucher.id > 0){\n                    var add_me = vm.selected_voucher;\n                    add_me.quantity = 1;\n                    add_me.item_id = vm.selected_voucher.id;\n                    \n                    add_me.unit_price = vm.selected_voucher.price;\n\n                    add_me.voucher_id = vm.selected_voucher.id;\n                    if(vm.selected_discount && vm.selected_discount.id && vm.selected_discount.id > 0){\n                      add_me.discount_id = vm.selected_discount.id;\n                    } else {\n                      add_me.discount_id = 0;\n                    }\n\n                    if(add_me.vat_rate){\n                      add_me.vat = parseFloat(vm.selected_voucher.vat_rate);\n                      delete(add_me.vat_rate);\n                    }\n                    $scope.items.push(add_me);\n                  }\n                   \n                }\n\n\n                // //console.log(\"OBJ TO SEND: \", $scope.item);\n\n               \n                $scope.item = {\n                            quantity: 1,\n                            price: 0,\n                            vat: parseFloat($scope.club_settings.vat_rate),\n                            title: \"\"\n                          };\n                \n                vm.new_item_qty = 1;\n\n                calculate_charges();\n\n                ExperiencesService.GetDiscountsByClubIdAndExperienceId($scope.club_id, vm.selected_voucher.id)\n                .then(function(data){\n                    ////console.log(\"discounts\", data);\n                    vm.discounts = data.items;\n                });\n\n            }\n\n            vm.add_selected_discount = function(){\n\n                var new_price = 0;\n\n                if(vm.selected_discount.discount_type == 1){\n                    //fixed price\n                    new_price = vm.selected_discount.discount.price;\n                } else {\n                    //percentage...\n                    new_price = vm.selected_voucher.price - (vm.selected_voucher.price * (vm.selected_discount.percentage / 100) );\n\n                }\n\n\n                if($scope.items.find(x => x.voucher_id === vm.selected_voucher.id) && vm.selected_voucher.id > 0){\n\n                  // //console.log(\"already exists\");\n                  $scope.items.find(x => x.voucher_id === vm.selected_voucher.id).price = new_price;\n                  $scope.items.find(x => x.voucher_id === vm.selected_voucher.id).unit_price = new_price;\n                  $scope.items.find(x => x.voucher_id === vm.selected_voucher.id).discount_id = vm.selected_discount.id;\n                  $scope.items.find(x => x.voucher_id === vm.selected_voucher.id).discount_code = vm.selected_discount.discount_code;\n                  // $scope.items.find(x => x.voucher_id === vm.selected_voucher.id).price = new_price;\n                                              // vat: parseFloat($scope.club_settings.vat_rate),\n\n\n                }\n                //$scope.items.push(add_me);\n\n\n                                calculate_charges();\n\n            }\n\n            $scope.add_selected_item = function(){\n\n\n                // //console.log(\"HELLO ADDING\", item_sent);\n                 // //console.log(\"HELLO ADDING\", $scope.items.find(x => x.id === $scope.selected_item.id));\n                \n\n                if($scope.items.find(x => x.item_id === $scope.selected_item.id)){\n\n                  // //console.log(\"already exists\");\n                  $scope.items.find(x => x.item_id === $scope.selected_item.id).quantity = $scope.items.find(x => x.item_id === $scope.selected_item.id).quantity + vm.new_item_qty;\n\n                } else {\n                    var add_me = $scope.selected_item;\n                    add_me.quantity = vm.new_item_qty;\n                    add_me.item_id = $scope.selected_item.id;\n                    if(add_me.vat_rate){\n                      add_me.vat = parseFloat($scope.selected_item.vat_rate);\n                      delete(add_me.vat_rate);\n                    }\n                    $scope.items.push(add_me);\n\n                }\n\n\n\n                // //console.log(\"OBJ TO SEND: \", $scope.item);\n\n               \n                $scope.item = {\n                            quantity: 1,\n                            price: 0,\n                            vat: parseFloat($scope.club_settings.vat_rate),\n                            title: \"\"\n                          };\n                \n                vm.new_item_qty = 1;\n\n                calculate_charges();\n\n            }\n\n\n            $scope.selected_package;             \n\n\n            $scope.add_selected_package = function(){\n\n\n                // //console.log(\"HELLO ADDING\", item_sent);\n                \n\n                if($scope.items.find(x => x.package_id === $scope.selected_package.id)){\n\n                  //console.log(\"already exists\");\n                  $scope.items.find(x => x.package_id === $scope.selected_package.id).quantity++;\n\n                } else {\n                    var add_me = $scope.selected_package;\n                    add_me.quantity = 1;\n                    add_me.package_id = $scope.selected_package.id;\n                    add_me.vat_rate = parseFloat($scope.club_settings.vat_rate)\n                    if(add_me.vat_rate){\n                      add_me.package_id = $scope.selected_package.id;\n                      add_me.vat = $scope.selected_package.vat_rate;\n                      delete(add_me.vat_rate);\n                    }\n                    $scope.items.push(add_me);\n\n                }\n\n\n\n                // //console.log(\"OBJ TO SEND: \", $scope.item);\n\n               \n                $scope.item = {\n                            quantity: 1,\n                            price: 0,\n                            vat: parseFloat($scope.club_settings.vat_rate),\n                            title: \"\"\n                          };\n                \n                vm.new_item_qty = 1;\n\n                calculate_charges();\n            }\n\n            \n\n\n            $scope.add_item = function(item_sent){\n                $scope.item = item_sent;\n\n                // //console.log(\"HELLO ADDING\", item_sent);\n                // //console.log(\"HELLO ADDING\", $scope.items);\n\n                $scope.items.push($scope.item);\n\n                // //console.log(\"OBJ TO SEND: \", $scope.item);\n\n               \n                $scope.item = {\n                            quantity: 1,\n                            price: 0,\n                            vat: parseFloat($scope.club_settings.vat_rate),\n                            title: \"\"\n                          };\n\n                calculate_charges();\n\n            }\n\n\n            function calculate_charges(){\n\n\n              // //console.log(\"Calculate everything now...\");\n              var total = 0;\n              var the_vat = 0;\n              for(var i=0; i < $scope.items.length; i++){\n\n                $scope.items[i].total = ($scope.items[i].quantity * $scope.items[i].price);\n                if($scope.items[i].vat > 0){\n                  this_vat = ( $scope.items[i].total * ($scope.items[i].vat / 100) );\n                  the_vat = the_vat + this_vat;\n                }\n                total = total + $scope.items[i].total;\n\n              }\n\n              $scope.the_vat = the_vat;\n              $scope.the_total = total;\n\n            }\n\n\n          vm.complete_now = function(method, paymentIntent){\n              //user_id\n              //club_id\n              //invoice_id\n              //\n\n              var obj = {\n                user_id: $scope.selected_client.user_id,\n                club_id: $scope.club_id,\n                user: $scope.selected_client,\n                invoice_id: vm.invoice_id,\n                method: method,\n                paymentIntent: paymentIntent\n              }\n\n              PaymentService.CompleteCustom(obj)\n                .then(function (data) {\n                    if(data.success){\n                      console.log(\"complete\", data);\n                      //alert(\"success!\");\n\n                      $timeout(function() {\n                        $state.go('dashboard.manage_club', {}, { reload: true });\n                      }, 2000); // delay in milliseconds (2 seconds here)\n\n                      //$state.go('dashboard.manage_club', {}, { reload: true });\n\n                    }\n              });\n\n          }\n           \n          vm.invoice_id = 0;\n\n          $scope.ok = function () {\n\n\n            //guessing this is where it would all be happening 14/11/2025\n\n            //all we need to do is call the payment with \"amount\"\n            //then we add the payment_id to the request below --> unless this is Direct Debit for existing client\n\n            //some nice ideas about what to offer admins to be able to enter\n\n\n\n            vm.show_loading = true;\n\n            // obj.reason = $scope.reason;\n            // obj.to_refund = $scope.to_refund\n\n\n            //let's create all that is required to issue the invoice.\n            if($scope.selected_client.id == -12){\n\n\n              $scope.selected_client.first_name = $scope.new_client.first_name;\n              $scope.selected_client.last_name = $scope.new_client.last_name;\n              $scope.selected_client.email = $scope.new_client.email;\n\n            } else{\n\n               $scope.selected_client.first_name = $scope.selected_client.first_name;\n               $scope.selected_client.last_name = $scope.selected_client.last_name;\n               $scope.selected_client.email = $scope.selected_client.email;\n            \n            }\n\n\n            var obj_to_send = {\n                items: $scope.items,\n                user: $scope.selected_client,\n                user_id: $scope.selected_client.user_id,\n                club_id: $scope.club_id\n              };\n\n\n              // SAMPLE OF WHERE WE NEED TO SEND THE SHIZZLE....\n              PaymentService.CreateCustom(obj_to_send)\n              .then(function (data) {\n                  if(data.success){\n                    //alert(\"Invoice successfully created!\");\n                      ////console.log(\"CARD: \"+data);\n                      //fill the drop down menu\n\n                      //show payment now\n                      vm.invoice_id = data.invoice_id;\n                      //set payment bits here woo\n                        vm.send = {\n                            club_id: data.club_id,\n                            user_id: data.user_id,\n                            invoice_id: data.invoice_id\n                        }\n                        //console.log(vm.send);\n                        \n                        //get user cards\n                        //get user info\n\n                        MemberService.GetMandate(data.user_id, data.club_id)\n                                .then(function (data) {\n                                       // console.log(\"data is : \", data);\n                                         //return false;\n                                if(data.success){\n                                    vm.info = data.info;\n\n                                    vm.savedCards = data.cards;\n\n                                    if(vm.savedCards.length > 0){\n                                        vm.methods[1].visible = true;\n                                    } else {\n                                        vm.methods[1].visible = false;\n                                    }\n\n                                    if(vm.info == null){\n                                        vm.methods[0].visible = false;\n                                    } else {\n                                        vm.methods[0].visible = true;\n                                    }\n\n                                    vm.machine = data.machine;\n                                    if(vm.machine.success){\n                                        vm.methods[3].visible = true;\n                                    } else {\n                                        vm.methods[3].visible = false;\n                                    }\n\n                                    vm.show_pay_now = true;\n                                    vm.show_loading = false;\n                                }\n\n                            });\n\n                       \n\n                    \n\n\n\n                      //vm.show_loading = false;\n                  } else {\n                      //console.log(\"WOOOPSIES...\", data);\n                      //this should be very very rare...\n                      vm.show_loading = false;\n\n                  }\n\n              });\n\n\n\n\n\n\n\n            // if($scope.selected_client.id == -12 || !$scope.show_direct_debit_details){\n            //   //if there is a custom card entered - then we continue here...\n            //   var obj_to_send = {\n            //     payment: card_obj,\n            //     items: $scope.items,\n            //     user: $scope.selected_client,\n            //     club_id: $scope.club_id\n            //   };\n\n\n            //   // SAMPLE OF WHERE WE NEED TO SEND THE SHIZZLE....\n            //   PaymentService.CreateCustom(obj_to_send)\n            //   .then(function (data) {\n            //       if(data.success){\n            //         alert(\"Invoice successfully created & payment made!\");\n            //           ////console.log(\"CARD: \"+data);\n            //           //fill the drop down menu\n            //           $state.go('dashboard.manage_club', {}, { reload: true });\n            //            vm.show_loading = false;\n            //       } else {\n            //           //console.log(\"WOOOPSIES...\", data);\n            //           //this should be very very rare...\n            //            vm.show_loading = false;\n\n            //       }\n\n            //   });\n\n\n            //   var options = {};\n            //   // stripe.createToken(card, options).then(function(result) {\n            //   //   if (result.error) {\n            //   //     // Inform the user if there was an error\n            //   //     var errorElement = document.getElementById('card-errors');\n            //   //     errorElement.textContent = result.error.message;\n            //   //   } else {\n\n            //   //     //stripeTokenHandler(result.token);\n            //   //     ////console.log(\"RESULT\", result);\n\n            //   //     if(result.token.id){\n            //   //       ////console.log(\"STUFF\", result.token.id);\n\n            //   //       //prepare a basic object...\n            //   //       var card_obj = {\n            //   //           brand: result.token.card.brand,\n            //   //           last4: result.token.card.last4,\n            //   //           hash: result.token.card.id,\n            //   //           token: result.token.id,\n            //   //           funding: result.token.card.funding,\n            //   //           name: result.token.card.name,\n            //   //           client_ip: result.token.client_ip\n            //   //       };\n\n\n            //   //       var obj_to_send = {\n            //   //         payment: card_obj,\n            //   //         items: $scope.items,\n            //   //         user: $scope.selected_client,\n            //   //         club_id: $scope.club_id\n            //   //       };\n\n\n            //   //       // SAMPLE OF WHERE WE NEED TO SEND THE SHIZZLE....\n            //   //       PaymentService.CreateCustom(obj_to_send)\n            //   //       .then(function (data) {\n            //   //           if(data.success){\n            //   //             alert(\"Invoice successfully created & payment made!\");\n            //   //               ////console.log(\"CARD: \"+data);\n            //   //               //fill the drop down menu\n            //   //               $state.go('dashboard.manage_club', {}, { reload: true });\n            //   //                vm.show_loading = false;\n            //   //           } else {\n            //   //               //console.log(\"WOOOPSIES...\", data);\n            //   //               //this should be very very rare...\n            //   //                vm.show_loading = false;\n\n            //   //           }\n\n            //   //       });\n                    \n\n\n            //   //     }\n\n            //   //   }\n            //   // });\n\n            // } else {\n\n            //   //this should now be when we charge a saved card.\n\n            //   //create a new charge request? is that server side?\n\n\n            //   // var obj_to_send = {\n            //   //     payment: {},\n            //   //     items: $scope.items,\n            //   //     user: $scope.selected_client,\n            //   //     club_id: $scope.club_id\n            //   //   };\n\n            //   //   if($scope.selected_client.account_ending !== \"\"){\n            //   //     obj_to_send.payment.direct_debit = true;\n            //   //     obj_to_send.payment.pay_now = vm.direct_debit_pay_now;\n            //   //   }\n\n\n            //   // PaymentService.CreateCustom(obj_to_send)\n            //   //       .then(function (data) {\n            //   //           if(data.success){\n            //   //               alert(\"Invoice successfully created!\");\n\n            //   //               //$state.go('dashboard.my_account.payment_methods', {}, { reload: true });\n            //   //               $state.go('dashboard.manage_club', {}, { reload: true });\n            //   //           } else {\n            //   //               //console.log(\"WOOOPSIES...\", data);\n            //   //               //this should be very very rare...\n\n            //   //           }\n            //   //       });\n\n\n            //   var obj_to_send = {\n            //     payment: card_obj,\n            //     items: $scope.items,\n            //     user: $scope.selected_client,\n            //     club_id: $scope.club_id\n            //   };\n\n\n            //   // SAMPLE OF WHERE WE NEED TO SEND THE SHIZZLE....\n            //   PaymentService.CreateCustom(obj_to_send)\n            //   .then(function (data) {\n            //       if(data.success){\n            //         alert(\"Invoice successfully created & payment made!\");\n            //           ////console.log(\"CARD: \"+data);\n            //           //fill the drop down menu\n            //           $state.go('dashboard.manage_club', {}, { reload: true });\n            //            vm.show_loading = false;\n            //       } else {\n            //           //console.log(\"WOOOPSIES...\", data);\n            //           //this should be very very rare...\n            //            vm.show_loading = false;\n\n            //       }\n\n            //   });\n\n\n\n\n\n\n\n            //   //then we don't need a stripe token...\n\n            //    // SAMPLE OF WHERE WE NEED TO SEND THE SHIZZLE....\n            //   // PaymentService.Create(obj)\n            //   // .then(function (data) {\n            //   //     if(data.success){\n\n            //   //         //console.log(\"CARD: \"+data);\n            //   //         //fill the drop down menu\n            //   //         $state.go('dashboard.my_account.payment_methods', {}, { reload: true });\n            //     //            $uibModalInstance.close(obj);\n\n            //   //     } else {\n            //   //         //console.log(\"WOOOPSIES...\", data);\n            //   //         //this should be very very rare...\n\n            //   //     }\n            //   // });\n\n\n\n\n\n            // }\n            \n\n\n\n\n          };\n\n          $scope.cancel = function () {\n\n                            $state.go('dashboard.manage_club', {}, { reload: true });\n\n          };\n\n         \n\n\n\n\n\n\n\n\n          //STRIPE STUFF HERE PLEASE!!! :-)\n\n\n        // var stripe = Stripe('pk_test_Ers4ZfdIMZ59ac4wKy6FDAH2');\n        // var elements = stripe.elements();\n\n        // var card_options = {\n        //       hidePostalCode: true,\n        //       style: {\n        //         base: {\n        //           iconColor: '#666EE8',\n        //           color: '#31325F',\n        //           lineHeight: '40px',\n        //           fontWeight: 300,\n        //           fontFamily: 'Helvetica Neue',\n        //           fontSize: '15px',\n        //           '::placeholder': {\n        //             color: '#CFD7E0',\n        //           },\n        //         },\n        //       }\n        //     };\n\n        // var card = elements.create('card', card_options);\n\n        // var run = false;\n        // var timeout;\n\n        // function setupStripe(){\n        //     clearTimeout(timeout);\n        //     if(run == false){\n        //         run = true;\n\n        //         card.mount('#card-element');\n            \n        //         form = document.getElementById('payment-form');\n        //         form.addEventListener('submit', function(e) {\n        //           e.preventDefault();\n        //           createToken();\n        //         });\n        //     } \n        // }   \n\n\n        // // $scope.$on('$viewContentLoaded', function(){\n        // //         clearTimeout(timeout);\n        // //         if(run2 == false){\n        // //             run2 = true;\n        // //             timeout = setTimeout(function(){ setupStripe(); }, 1500); \n        // //         }\n        // // });\n\n     \n\n        // function stripeTokenHandler(token) {\n        //   // Insert the token ID into the form so it gets submitted to the server\n        //   var form = document.getElementById('payment-form');\n        //   var hiddenInput = document.createElement('input');\n        //   hiddenInput.setAttribute('type', 'hidden');\n        //   hiddenInput.setAttribute('name', 'stripeToken');\n        //   hiddenInput.setAttribute('value', token.id);\n        //   form.appendChild(hiddenInput);\n\n        //   // Submit the form\n        //   ////console.log(\"TOKEN\", token);\n        //   //form.submit();\n        // }\n\n        // function create_invoice() {\n        //   ////console.log(\"HELLO CREATE TOKEN? 1\");\n        //    var options = {\n        //     // name: document.getElementById('name').value,\n        //     //  address_line1: document.getElementById('address-line1').value,\n        //     // address_line2: document.getElementById('address-line2').value,\n        //     // address_city: document.getElementById('address-city').value,\n        //     // address_zip: document.getElementById('address-postcode').value,\n        //     // address_country: document.getElementById('address-country').value,\n        //   };\n\n        //   stripe.createToken(card, options).then(function(result) {\n        //     if (result.error) {\n        //       // Inform the user if there was an error\n        //       var errorElement = document.getElementById('card-errors');\n        //       errorElement.textContent = result.error.message;\n        //     } else {\n        //       // Send the token to your server\n        //       //stripeTokenHandler(result.token);\n        //       ////console.log(\"RESULT\", result);\n\n        //       if(result.token.id){\n        //       ////console.log(\"STUFF\", result.token.id);\n\n        //         //prepare a basic object...\n        //         var obj = {\n        //             user_id: vm.user.id,\n        //             brand: result.token.card.brand,\n        //             last4: result.token.card.last4,\n        //             hash: result.token.card.id,\n        //             token: result.token.id,\n        //             funding: result.token.card.funding,\n        //             name: result.token.card.name,\n        //             client_ip: result.token.client_ip\n        //         };\n\n\n        //         PaymentService.Create(obj)\n        //         .then(function (data) {\n        //             if(data.success){\n\n        //                 //console.log(\"CARD: \"+data);\n        //                 //fill the drop down menu\n        //                 alert(\"success creating invoice\");\n        //                 //$state.go('dashboard.my_account.payment_methods', {}, { reload: true });\n\n        //             } else {\n        //                 //console.log(\"WOOOPSIES...\", data);\n        //                 //this should be very very rare...\n\n        //             }\n        //         });\n\n\n\n        //       }\n\n        //     }\n        //   });\n        // };\n\n\n\n\n\n\n\n    }\n app.controller('DashboardClubVouchersAddController', DashboardClubVouchersAddController);\n\n    DashboardClubVouchersAddController.$inject = ['UserService', 'PlaneService', '$rootScope', '$location', '$scope', '$state', '$stateParams', '$uibModal', '$log', '$window', 'LicenceService', 'MedicalService', 'DifferencesService', 'ExperiencesService', 'VoucherService'];\n    function DashboardClubVouchersAddController(UserService, PlaneService, $rootScope, $location, $scope, $state, $stateParams, $uibModal, $log, $window, LicenceService, MedicalService, DifferencesService, ExperiencesService, VoucherService) {\n        var vm = this;\n\n        //console.log(\"HELLOOOO ADD vouchers\");\n\n        vm.user = null;\n        vm.allUsers = [];\n        vm.club = {\n            item: {\n            }\n        };\n        vm.page_title = \"\";\n        \n        vm.plane_document = {};\n        vm.plane_documents = [];\n\n        var update_this_file = [];\n        \n\n        vm.action = $state.current.data.action;\n        vm.club_id = $rootScope.globals.currentUser.current_club_admin.id;\n        vm.user = $rootScope.globals.currentUser;\n        vm.user_id = vm.user.id;\n\n        vm.charge_type = [\"brakes\", \"session\", \"plane\"];\n\n        vm.discounts = [];\n\n        vm.planes = [];\n        vm.show_paid = false;\n\n        ExperiencesService.GetByClubId(vm.club_id)\n                    .then(function(data){\n                        //console.log(\"planes\", data);\n                        vm.experiences = data.items;\n                    });\n\n\n\n\n    \n                //console.log(\"adding a new plane please\");\n                vm.page_title = \"Add a Voucher\";\n\n                VoucherService.GetUniqueCode(vm.club_id)\n                    .then(function(data){\n                        //console.log(data);\n                        vm.club.item.code = data.code;\n                    });\n\n\n                var stripe = Stripe('pk_test_Ers4ZfdIMZ59ac4wKy6FDAH2');\n                var elements = stripe.elements();\n\n                var card_options = {\n                      hidePostalCode: true,\n                      style: {\n                        base: {\n                          iconColor: '#666EE8',\n                          color: '#31325F',\n                          lineHeight: '40px',\n                          fontWeight: 300,\n                          fontFamily: 'Helvetica Neue',\n                          fontSize: '15px',\n                          '::placeholder': {\n                            color: '#CFD7E0',\n                          },\n                        },\n                      }\n                    };\n\n                var card = elements.create('card', card_options);\n                var form;\n\n                var timeout;\n                var run = false;\n                var run2 = false;\n\n                ExperiencesService.GetDiscountsByClubId(vm.club_id)\n                .then(function(data){\n                    //console.log(\"discounts\", data);\n                    vm.discounts = data.items;\n                });\n\n                function setupStripe(){\n                    clearTimeout(timeout);\n                    if(run == false){\n                        run = true;\n\n                        card.mount('#card-element');\n                    \n                        form = document.getElementById('payment-form2');\n                        form.addEventListener('submit', function(e) {\n                          e.preventDefault();\n                          createToken();\n                        });\n                    } \n                }   \n                $scope.$on('$viewContentLoaded', function(){\n                        clearTimeout(timeout);\n                        if(run2 == false){\n                            run2 = true;\n                            timeout = setTimeout(function(){ setupStripe(); }, 1500); \n                        }\n                });\n\n             \n\n                function stripeTokenHandler(token) {\n                  // Insert the token ID into the form so it gets submitted to the server\n                  var form = document.getElementById('payment-form');\n                  var hiddenInput = document.createElement('input');\n                  hiddenInput.setAttribute('type', 'hidden');\n                  hiddenInput.setAttribute('name', 'stripeToken');\n                  hiddenInput.setAttribute('value', token.id);\n                  form.appendChild(hiddenInput);\n\n                  // Submit the form\n                  //console.log(\"TOKEN\", token);\n                  //form.submit();\n                }\n\n                function createToken() {\n                  \n                };\n\n\n\n\n        //'9' needs to refer the the user's account set to manage\n       \n\n        $scope.check_code = function(){\n            //console.log(\"CHECKING NOW\");\n        }\n\n        $scope.back = function(){\n            $window.history.back();\n        }\n\n        $scope.save = function(){\n            if(vm.action == \"add\"){\n                //console.log(\"CREATE click\");\n                $scope.create();\n            } else {\n                //console.log(\"EDIT click\");\n                //console.log(vm.club.plane);\n                $scope.update();\n            }\n        }\n\n        $scope.create = function(){\n            //console.log(\"CREATE ME NOW\");\n\n\n            //first sanity check goes here...\n            if(!vm.club.item.experience || !vm.club.item.experience.id){\n                alert(\"You must select an experience to issue this voucher...\");\n                return false;\n            }\n            if(!vm.club.item.first_name || !vm.club.item.last_name || !vm.club.item.email){\n                alert(\"You must enter the purchasor's first name, last name and email address.\");\n                return false;\n            }\n\n            if(vm.already_paid){\n                if(vm.club.item.price_paid < 0 || !vm.club.item.payment_method){\n                    alert(\"Please fill in how much was paid and what payment method was used to complete the payment\");\n                    return false;\n                }\n            }\n\n\n\n\n\n\n            vm.club.item.experience_title = vm.club.item.experience.title;\n            vm.club.item.experience_id = vm.club.item.experience.id;\n            if(vm.club.item.discount && vm.club.item.discount.id >0){\n                vm.club.item.discount_id = vm.club.item.discount.id;\n            }\n\n            //applying a discount?\n            //vm.club.item.price = vm.club.item.experience.price;\n            \n\n           \n            vm.club.item.club_id = vm.club_id;\n\n\n            if(!vm.already_paid){\n\n                   var options = {\n                    name: document.getElementById('name').value,\n                    address_zip: document.getElementById('address-postcode').value,\n                  };\n\n                  stripe.createToken(card, options).then(function(result) {\n                    if (result.error) {\n                      // Inform the user if there was an error\n                      var errorElement = document.getElementById('card-errors');\n                      errorElement.textContent = result.error.message;\n                    } else {\n                      // Send the token to your server\n                      //stripeTokenHandler(result.token);\n                      ////console.log(\"RESULT\", result);\n\n                      if(result.token.id){\n                      ////console.log(\"STUFF\", result.token.id);\n\n                        //prepare a basic object...\n                        var obj = {\n                            user_id: vm.user.id,\n                            brand: result.token.card.brand,\n                            last4: result.token.card.last4,\n                            hash: result.token.card.id,\n                            token: result.token.id,\n                            exp_month: result.token.card.exp_month,\n                            exp_year: result.token.card.exp_year,\n                            funding: result.token.card.funding,\n                            name: result.token.card.name,\n                            address_postcode: result.token.card.address_zip,\n                            client_ip: result.token.client_ip\n                        };\n\n                        vm.club.item.payment = obj;\n\n                        delete vm.club.item.experience;\n                        //delete vm.club.item.discount;\n\n                        //console.log(\"READY WITH : \", vm.club.item);\n                        //return false;\n                        \n                        VoucherService.Create(vm.club.item)\n                        .then(function(data){\n                            //console.log(data);\n                            //$state.reload();\n                            $state.go('dashboard.manage_club.vouchers', {}, {reload: true});\n\n                        });\n\n\n\n                      }\n\n                    }\n                  });\n\n              } else {\n                //then the payment was already taken by other means...\n                var obj = {\n                    payment_method: vm.club.item.payment_method,\n                    amount: vm.club.item.price_paid \n                }\n\n                vm.club.item.price = vm.club.item.price_paid;\n\n                vm.club.item.payment = obj;\n                \n                delete vm.club.item.payment_method;\n                delete vm.club.item.price_paid;\n\n                //console.log(\"READY WITH NO STRIPE : \", vm.club.item);\n\n                        //return false;\n\n                VoucherService.Create(vm.club.item)\n                    .then(function(data){\n                        //console.log(data);\n                        //$state.reload();\n                        $state.go('dashboard.manage_club.vouchers', {}, {reload: true});\n\n                    });\n\n              }\n\n\n\n           \n        }\n\n        $scope.delete = function(){\n            //console.log(\"CLICK\");\n            alert(\"Are you sure you would like to delete this plane?\");\n            VoucherService.Delete(vm.user.id, vm.club.item)\n                .then(function(data){\n                    //console.log(data);\n                });\n        }\n\n        function get_update_docs(){\n            var documents = [];\n\n            for(var i=0;i<update_this_file.length;i++){\n                var id = update_this_file[i];\n                //console.log(\"looking for : \", id);\n                //console.log(\"in: \", vm.plane_documents);\n\n                for(var k=0;k<vm.club.plane.plane_documents.length;k++){\n                    //console.log(\"comparing to : \", vm.club.plane.plane_documents[k].id);\n                    if(vm.club.plane.plane_documents[k].id == id){\n                        documents.push(vm.club.plane.plane_documents[k]);\n                    }\n                }\n\n            }\n\n            // //console.log(\"DOCS TO UPDATE : \", documents);\n            return documents;\n        }\n\n        $scope.update = function(){\n            //console.log(\"CLICK\");\n            vm.club.item.club_id = vm.club_id;\n            VoucherService.Update(vm.club.item, vm.user.id)\n                .then(function(data){\n                    //console.log(data);\n                    //console.log(\"saved\");\n                    //$state.reload();\n                    $state.go('dashboard.manage_club.vouchers', {}, {reload: true});\n                });\n        }\n\n        $scope.update_experience = function(){\n            //console.log(\"UPDATE EXP\");\n            var days = vm.club.item.experience.valid_for;\n            if(days > 0){\n                 var expiry_date = moment().day(+days);\n                //console.log(\"NEW DATE: \", expiry_date);\n                vm.club.item.expiry_date = new Date(expiry_date);\n            } else {\n                var expiry_date = moment().year(+2100);\n                vm.club.item.expiry_date = new Date(expiry_date);\n            }\n            vm.club.item.price = vm.club.item.experience.price;\n\n            ExperiencesService.GetDiscountsByClubIdAndExperienceId(vm.club_id, vm.club.item.experience.id)\n            .then(function(data){\n                ////console.log(\"discounts\", data);\n                vm.discounts = data.items;\n            });\n\n        }\n\n        $scope.update_discount = function(){\n\n            if(vm.club.item.discount.discount_type == 1){\n                //fixed price\n                vm.club.item.price = vm.club.item.discount.price;\n            } else {\n                //percentage...\n                vm.club.item.price = vm.club.item.experience.price - (vm.club.item.experience.price * (vm.club.item.discount.percentage / 100) );\n\n            }\n\n        }\n\n        function containsObject(obj, list, params) {\n\n            // //console.log(\"obj\", obj);\n            // //console.log(\"list\", list);\n            // //console.log(\"params\", params);\n\n            for(var i=0; i<list.length; i++) {\n                // //console.log(\"list i : \", list[i]);\n                // //console.log(\"obj is: \", obj);\n\n                var count_success = 0;\n                for(var j=0;j<params.length;j++){\n                    if(list[i][params[j]] && obj[params[j]] && list[i][params[j]] == obj[params[j]]){\n                        count_success++;\n                    }\n                }\n\n                if(count_success === params.length) {                    \n                    return true;\n                }\n            }\n\n            return false;\n        }\n\n\n\n\n        function check_all(){\n\n            //maybe a nice to have one day... not yet though.\n\n\n            //licences\n            vm.club.plane.requirements.licence.forEach(function(obj){\n\n            });\n\n        }\n\n      \n\n        initController();\n\n        function initController() {\n\n\n\n\n        }\n\n\n        var warning_msg = \"By deleting this plane, you will also cancel all reservations that this plane currently has.\"\n\n          $scope.open = function (plane_id) {\n            var modalInstance = $uibModal.open({\n              animation: true,\n              templateUrl: 'views/modals/deleteModal.html',\n              controller: 'ModalInstanceCtrl',\n              size: \"lg\",\n              resolve: {\n                id: function () {\n                  return plane_id;\n                },\n                params: function() {\n                  return {id: plane_id};\n                },\n                warning: function(){\n                    return warning_msg;\n                }\n              }\n            });\n            modalInstance.result.then(function (plane_id) {\n              $log.info('PRESSED GO: '+plane_id.id);\n              ExperiencesService.Delete(vm.user.id, plane_id.id)\n              .then(function(){\n                //console.log(\"HELLO DELETE\");\n                //update view?\n                 vm.club.items = $.grep(vm.club.items, function(e){ \n                    return e.id != plane_id.id; \n                });\n              })\n            }, function () {\n              $log.info('Modal dismissed at: ' + new Date());\n            });\n          };\n\n         \n\n\n    }\n app.controller('DashboardClubVouchersController', DashboardClubVouchersController);\n\n    DashboardClubVouchersController.$inject = ['UserService', 'PlaneService', '$rootScope', '$location', '$scope', '$state', '$stateParams', '$uibModal', '$log', '$window', 'LicenceService', 'MedicalService', 'DifferencesService', 'ExperiencesService', 'VoucherService'];\n    function DashboardClubVouchersController(UserService, PlaneService, $rootScope, $location, $scope, $state, $stateParams, $uibModal, $log, $window, LicenceService, MedicalService, DifferencesService, ExperiencesService, VoucherService) {\n        var vm = this;\n\n        //console.log(\"HELLOOOO vouchers\");\n\n        vm.user = null;\n        vm.allUsers = [];\n        vm.club = {\n            item: {\n            }\n        };\n        vm.page_title = \"\";\n        \n        vm.plane_document = {};\n        vm.plane_documents = [];\n\n        var update_this_file = [];\n        \n\n        vm.action = $state.current.data.action;\n        vm.club_id = $rootScope.globals.currentUser.current_club_admin.id;\n        vm.user = $rootScope.globals.currentUser;\n        vm.user_id = vm.user.id;\n\n        vm.charge_type = [\"brakes\", \"session\", \"plane\"];\n\n        vm.discounts = [];\n\n        vm.planes = [];\n   \n\n        ExperiencesService.GetByClubId(vm.club_id)\n                    .then(function(data){\n                        //console.log(\"planes\", data);\n                        vm.experiences = data.items;\n                    });\n\n\n\n\n        ////console.log(\"club_id : \"+vm.club_id);\n\n        // //console.log(vm.action);\n         //console.log($stateParams);\n        // //console.log($stateParams.id);\n      \n                //need to update this to be part of the authentication\n                //to find out club id\n                VoucherService.GetByClubId(vm.club_id)\n                    .then(function(data){\n                        vm.club.items = data.items;   \n                        //console.log(vm.club.items);\n                    });\n           \n\n        //'9' needs to refer the the user's account set to manage\n       \n\n        $scope.check_code = function(){\n            //console.log(\"CHECKING NOW\");\n        }\n\n        $scope.back = function(){\n            $window.history.back();\n        }\n\n        $scope.save = function(){\n            if(vm.action == \"add\"){\n                //console.log(\"CREATE click\");\n                $scope.create();\n            } else {\n                //console.log(\"EDIT click\");\n                //console.log(vm.club.plane);\n                $scope.update();\n            }\n        }\n\n\n        $scope.create = function(){\n            //console.log(\"CREATE ME NOW\");\n\n\n            //first sanity check goes here...\n            if(!vm.club.item.experience || !vm.club.item.experience.id){\n                alert(\"You must select an experience to issue this voucher...\");\n                return false;\n            }\n            if(!vm.club.item.first_name || !vm.club.item.last_name || !vm.club.item.email){\n                alert(\"You must enter the purchasor's first name, last name and email address.\");\n                return false;\n            }\n\n            if(vm.already_paid){\n                if(!vm.club.item.price_paid || !vm.club.item.payment_method){\n                    alert(\"Please fill in how much was paid and what payment method was used to complete the payment\");\n                    return false;\n                }\n            }\n\n\n\n\n\n\n\n\n            vm.club.item.experience_title = vm.club.item.experience.title;\n            vm.club.item.experience_id = vm.club.item.experience.id;\n            vm.club.item.discount_id = vm.club.item.discount.id;\n\n            //applying a discount?\n            //vm.club.item.price = vm.club.item.experience.price;\n            \n\n           \n            vm.club.item.club_id = vm.club_id;\n\n\n            if(!vm.already_paid){\n\n                   var options = {\n                    name: document.getElementById('name').value,\n                    address_zip: document.getElementById('address-postcode').value,\n                  };\n\n                  stripe.createToken(card, options).then(function(result) {\n                    if (result.error) {\n                      // Inform the user if there was an error\n                      var errorElement = document.getElementById('card-errors');\n                      errorElement.textContent = result.error.message;\n                    } else {\n                      // Send the token to your server\n                      //stripeTokenHandler(result.token);\n                      ////console.log(\"RESULT\", result);\n\n                      if(result.token.id){\n                      ////console.log(\"STUFF\", result.token.id);\n\n                        //prepare a basic object...\n                        var obj = {\n                            user_id: vm.user.id,\n                            brand: result.token.card.brand,\n                            last4: result.token.card.last4,\n                            hash: result.token.card.id,\n                            token: result.token.id,\n                            exp_month: result.token.card.exp_month,\n                            exp_year: result.token.card.exp_year,\n                            funding: result.token.card.funding,\n                            name: result.token.card.name,\n                            address_postcode: result.token.card.address_zip,\n                            client_ip: result.token.client_ip\n                        };\n\n                        vm.club.item.payment = obj;\n\n                        delete vm.club.item.experience;\n                        //delete vm.club.item.discount;\n\n                        //console.log(\"READY WITH : \", vm.club.item);\n                        //return false;\n                        \n                        VoucherService.Create(vm.club.item)\n                        .then(function(data){\n                            //console.log(data);\n                            //$state.reload();\n                            $state.go('dashboard.manage_club.vouchers', {}, {reload: true});\n\n                        });\n\n\n\n                      }\n\n                    }\n                  });\n\n              } else {\n                //then the payment was already taken by other means...\n                var obj = {\n                    payment_method: vm.club.item.payment_method,\n                    amount: vm.club.item.price_paid \n                }\n\n            \n\n                vm.club.item.payment = obj;\n                \n                delete vm.club.item.payment_method;\n                delete vm.club.item.price_paid;\n\n                //console.log(\"READY WITH NO STRIPE : \", vm.club.item);\n\n                        //return false;\n\n                VoucherService.Create(vm.club.item)\n                    .then(function(data){\n                        //console.log(data);\n                        //$state.reload();\n                        $state.go('dashboard.manage_club.vouchers', {}, {reload: true});\n\n                    });\n\n              }\n\n\n\n           \n        }\n\n        $scope.delete = function(){\n            //console.log(\"CLICK\");\n            alert(\"Are you sure you would like to delete this plane?\");\n            VoucherService.Delete(vm.user.id, vm.club.item)\n                .then(function(data){\n                    //console.log(data);\n                });\n        }\n\n        function get_update_docs(){\n            var documents = [];\n\n            for(var i=0;i<update_this_file.length;i++){\n                var id = update_this_file[i];\n                //console.log(\"looking for : \", id);\n                //console.log(\"in: \", vm.plane_documents);\n\n                for(var k=0;k<vm.club.plane.plane_documents.length;k++){\n                    //console.log(\"comparing to : \", vm.club.plane.plane_documents[k].id);\n                    if(vm.club.plane.plane_documents[k].id == id){\n                        documents.push(vm.club.plane.plane_documents[k]);\n                    }\n                }\n\n            }\n\n            // //console.log(\"DOCS TO UPDATE : \", documents);\n            return documents;\n        }\n\n        $scope.update = function(){\n            //console.log(\"CLICK\");\n            vm.club.item.club_id = vm.club_id;\n            VoucherService.Update(vm.club.item, vm.user.id)\n                .then(function(data){\n                    //console.log(data);\n                    //console.log(\"saved\");\n                    //$state.reload();\n                    $state.go('dashboard.manage_club.vouchers', {}, {reload: true});\n                });\n        }\n\n        $scope.update_experience = function(){\n            //console.log(\"UPDATE EXP\");\n            var days = vm.club.item.experience.valid_for;\n            if(days > 0){\n                 var expiry_date = moment().day(+days);\n                //console.log(\"NEW DATE: \", expiry_date);\n                vm.club.item.expiry_date = new Date(expiry_date);\n            } else {\n                var expiry_date = moment().year(+2100);\n                vm.club.item.expiry_date = new Date(expiry_date);\n            }\n            vm.club.item.price = vm.club.item.experience.price;\n\n            ExperiencesService.GetDiscountsByClubIdAndExperienceId(vm.club_id, vm.club.item.experience.id)\n            .then(function(data){\n                ////console.log(\"discounts\", data);\n                vm.discounts = data.items;\n            });\n\n        }\n\n        $scope.update_discount = function(){\n\n            if(vm.club.item.discount.discount_type == 1){\n                //fixed price\n                vm.club.item.price = vm.club.item.discount.price;\n            } else {\n                //percentage...\n                vm.club.item.price = vm.club.item.experience.price - (vm.club.item.experience.price * (vm.club.item.discount.percentage / 100) );\n\n            }\n\n        }\n\n        function containsObject(obj, list, params) {\n\n            // //console.log(\"obj\", obj);\n            // //console.log(\"list\", list);\n            // //console.log(\"params\", params);\n\n            for(var i=0; i<list.length; i++) {\n                // //console.log(\"list i : \", list[i]);\n                // //console.log(\"obj is: \", obj);\n\n                var count_success = 0;\n                for(var j=0;j<params.length;j++){\n                    if(list[i][params[j]] && obj[params[j]] && list[i][params[j]] == obj[params[j]]){\n                        count_success++;\n                    }\n                }\n\n                if(count_success === params.length) {                    \n                    return true;\n                }\n            }\n\n            return false;\n        }\n\n\n\n\n        function check_all(){\n\n            //maybe a nice to have one day... not yet though.\n\n\n            //licences\n            vm.club.plane.requirements.licence.forEach(function(obj){\n\n            });\n\n        }\n\n      \n\n\n\n        $scope.add_item = function(type){\n            //console.log(\"ADD\");\n            switch(type){\n                case \"plane\":\n                    //console.log(\"plane\");\n                    if(vm.temporary.plane && vm.temporary.plane !== \"\"){\n                        //then we can add it\n                        //console.log(\"here we go\");\n                        // var add_plane = {\n                        //     id: vm.temporary.plane.id\n                        // };\n\n                        //check if it doesnt exist first...\n                        //if(vm.club.item.planes && vm.club.item.planes.indexOf(vm.temporary.plane.plane_id) == -1){\n\n\n                        if(!vm.club.item.planes){\n                            vm.club.item.planes = [];\n                        }\n\n                        if(containsObject(vm.temporary.plane, vm.club.item.planes, new Array(\"plane_id\") ) == false){\n                            vm.club.item.planes.push(vm.temporary.plane);\n\n                            // vm.club.item.planes.indexOf(vm.temporary.plane)\n                            // vm.planes.filter(function(el) { return el.plane_id !== vm.temporary.plane.plane_id; });\n                        } \n\n                        delete vm.temporary.plane;\n\n                    } else {\n                        alert(\"Please select a plane that this activity be done on!\");\n                    }\n\n                break;\n\n            }\n\n\n\n        }\n\n\n        $scope.remove_item = function(type, index){\n            //console.log(\"REMOVE\");\n\n            vm.club.item.planes.splice(index, 1);\n\n\n            // switch(type){\n            //     case \"plane\":\n            //             //console.log(\"plane\");\n                   \n            //             //check if it doesnt exist first...\n            //             // if(containsObject(add_licence, vm.club.plane.requirements.licence, new Array(\"licence_id\", \"rating_id\")) == false){\n            //             //     vm.club.plane.requirements.licence.push(add_licence);\n            //             // }\n\n            //             vm.club.item.planes.splice(index, 1);\n                      \n            //     break;\n            // }\n\n\n            //     case \"medical\":\n            //         //console.log(\"medical\");\n            //         if(vm.temporary.medical_authority && vm.temporary.medical_authority !== \"\" && vm.temporary.medical_component && vm.temporary.medical_component !== \"\"){\n            //             //then we can add it\n            //             //console.log(\"here we go\");\n            //             var add_medical = {\n            //                 authority_id: vm.temporary.medical_authority.id,\n            //                 authority_title: vm.temporary.medical_authority.abbreviation,\n            //                 medical_component_id: vm.temporary.medical_component.id,\n            //                 medical_component_title: vm.temporary.medical_component.title\n            //             };\n\n            //             //check if it doesnt exist first...\n            //             if(containsObject(add_medical, vm.club.plane.requirements.medical, new Array(\"authority_id\", \"medical_component_id\")) == false){\n            //                 vm.club.plane.requirements.medical.push(add_medical);\n            //             }\n\n            //             delete vm.temporary.medical_authority;\n            //             delete vm.temporary.medical_component;\n\n            //         } else {\n            //             alert(\"Please select a medical that is required to book the plane solo!\");\n            //         }\n\n            //     break;\n\n\n            //     case \"differences\":\n            //         //console.log(\"difference\");\n            //         if(vm.temporary.difference && vm.temporary.difference !== \"\"){\n            //             //then we can add it\n            //             //console.log(\"here we go\");\n            //             var add_difference = {\n            //                 difference_id: vm.temporary.difference.id,\n            //                 difference_title: vm.temporary.difference.title\n            //             };\n\n            //             //check if it doesnt exist first...\n            //             if(containsObject(add_difference, vm.club.plane.requirements.differences, new Array(\"difference_id\", \"difference_title\")) == false){\n            //                 vm.club.plane.requirements.differences.push(add_difference);\n            //             }\n\n            //             delete vm.temporary.difference;\n\n            //         } else {\n            //             alert(\"Please select a difference that is required to book the plane solo!\");\n            //         }\n\n            //     break;\n\n\n            // }\n\n\n\n        }\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n        $scope.update_this_file = function(file){\n            //console.log(\"==== update is : \", file.id);\n            if(update_this_file.indexOf(file.id) === -1){\n                update_this_file.push(file.id)\n            } else {\n               ////console.log(\"This item already exists\"); \n            } \n        }\n\n\n         $scope.remove_real_file = function(file){\n\n                //remove_file\n\n                vm.club.plane.plane_documents = $.grep(vm.club.plane.plane_documents, function(e){ \n                        return e.id != file.id; \n                    });\n\n                //no need to actually remove the file as it will be archived accordingly on the backend whilst it is missing! :)\n                PlaneDocumentService.Delete(vm.user.id, file.id)\n                .then(function (data) {\n                    //console.log(data);\n                    if(data.success){\n                        //console.log(\"HUZZAH\", current_files);\n                        //then we need to remove this from the list of files...\n                        //clear files\n                        vm.plane_documents = [];\n                        //and re-process available files\n                        $scope.processFiles(current_files);\n\n                    } else {\n                        //console.log(\"WOOOPSIES...\");\n                        //this should be very very rare...\n                    }\n\n                });\n\n          }\n\n\n          \n          $scope.remove_file = function(file, current_files){\n\n            //remove_file\n            var j = JSON.parse(file.file_return);\n            //console.log(\"REMOVE: \", j);\n            //console.log(\"REMOVE: \", j.saved_url);\n\n            //to delete the temp file created: j.saved_url\n            //tmp_rm.php POST tmp = filename\n            \n            PoidService.DeleteTmp(j.saved_url)\n                .then(function (data) {\n                    //console.log(data);\n                    if(data.success){\n                        //console.log(\"HUZZAH\", current_files);\n                        //then we need to remove this from the list of files...\n                        //clear files\n                        vm.plane_documents = [];\n                        //and re-process available files\n                        $scope.processFiles(current_files);\n\n                    } else {\n                        //console.log(\"WOOOPSIES...\");\n                        //this should be very very rare...\n                    }\n\n                });\n\n          }\n          \n\n          // $scope.$on('flow::fileAdded', function (event, $flow, flowFile) {\n          //     event.preventDefault();//prevent file from uploading\n          //     //console.log(\"FILE ADDED\");\n          //     //console.log($flow);\n          //   });\n\n            $scope.processFiles = function(files){\n                // //console.log(\"files\", files);\n\n                for(var i=0; i<files.length; i++){\n                    // //console.log(\"JSON\", files[i].file_return);\n                    var j = JSON.parse(files[i].file_return);\n                    // //console.log(\"PARSED\", j);\n                    //console.log(\"J is : \",j);\n                    //console.log(\"name is : \", j.files.file.name);\n\n                    files[i].file.temp_path = j.saved_url;\n                    files[i].file.save_name = j.files.file.name;\n                    var ft = j.files.file.name;\n                    ft = ft.split('.').pop();\n                    files[i].file.extension = ft;\n\n                    // //console.log(\"file\", files[i].file);\n                    vm.plane_documents.push(files[i].file);\n                }\n\n\n            }\n\n            $scope.set_title = function(file){\n                //console.log(\"return\", file);\n                return file.save_name;\n            }\n\n            $scope.get_icon = function(file){\n\n                var ft = file.name;\n                ft = ft.split('.').pop();\n                var icon_name = \"\";\n\n                // //console.log(\"FILE:\", ft);\n                // //console.log(\"index : \", ft.indexOf(\"pdf\"));\n                switch(true){\n                    case (ft.indexOf(\"pdf\") > -1):\n                        icon_name = \"pdf.png\";\n                    break;\n                    case (ft.indexOf(\"doc\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"docx\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"xls\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"xlsx\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"ppt\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"pptx\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"jpg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"jpeg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"png\") > -1):\n                        icon_name = \"png.png\";\n                    break;\n                    case (ft.indexOf(\"gif\") > -1):\n                        icon_name = \"gif.png\";\n                    break;\n                    case (ft.indexOf(\"zip\") > -1):\n                        icon_name = \"zip.png\";\n                    break;\n                    case (ft.indexOf(\"avi\") > -1):\n                        icon_name = \"avi.png\";\n                    break;\n                    case (ft.indexOf(\"mp4\") > -1):\n                        icon_name = \"mp4.png\";\n                    break;\n                    default:\n                        icon_name = \"file.png\";\n                    break;\n                }\n\n                // //console.log(\"FILE:\", icon_name);\n\n                return \"images/file_icons/\"+icon_name;\n            }\n\n\n            $scope.get_icon2 = function(file){\n\n                var ft = file.split('.').pop();\n                // //console.log(\"ICON 2 : \", ft);\n                var icon_name = \"\";\n\n                // //console.log(\"FILE:\", ft);\n                // //console.log(\"index : \", ft.indexOf(\"pdf\"));\n                switch(true){\n                    case (ft.indexOf(\"pdf\") > -1):\n                        icon_name = \"pdf.png\";\n                    break;\n                    case (ft.indexOf(\"doc\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"docx\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"xls\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"xlsx\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"ppt\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"pptx\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"jpg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"jpeg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"png\") > -1):\n                        icon_name = \"png.png\";\n                    break;\n                    case (ft.indexOf(\"gif\") > -1):\n                        icon_name = \"gif.png\";\n                    break;\n                    case (ft.indexOf(\"zip\") > -1):\n                        icon_name = \"zip.png\";\n                    break;\n                    case (ft.indexOf(\"avi\") > -1):\n                        icon_name = \"avi.png\";\n                    break;\n                    case (ft.indexOf(\"mp4\") > -1):\n                        icon_name = \"mp4.png\";\n                    break;\n                    default:\n                        icon_name = \"file.png\";\n                    break;\n                }\n\n                // //console.log(\"FILE:\", icon_name);\n\n                return \"images/file_icons/\"+icon_name;\n            }\n\n\n\n            $scope.delete_poid = function(id){\n\n              \n                var a = prompt(\"Are you sure you wish to delete this poid? \\n\\n This change is irreversible! To confirm please type YES in the box below.\");\n                if(a == \"YES\"){\n\n\n                    //console.log(\"WE DELETE IT\");\n\n\n                    // PoidService.Delete(vm.user_id, id)\n                    //     .then(function (data) {\n                    //         //console.log(data);\n                    //         if(data.success){\n                    //             //console.log(\"HUZZAH\", data);\n                    //             //then we need to remove this from the list of files...\n                    //             vm.user_poids = $.grep(vm.user_poids, function(e){ \n                    //                 return e.id != id; \n                    //             });\n                                \n                    //             //refresh?\n                    //             $state.reload();\n                    //             $state.go('dashboard.my_account.poid');\n\n                    //         } else {\n\n                    //             alert(\"Something went terribly wrong... \\n\\n \"+data.message);\n\n                    //         }\n\n                    //     });\n\n\n\n                } else {\n                    //console.log(\"ignore123\");\n                }\n\n\n            }\n\n\n\n\n            $scope.save_plane_documents = function(){\n\n               \n              \n\n                //console.log(\"plane_documents: \", vm.plane_documents);\n\n\n                //compile the required elements YAY\n\n                //console.log(\"plane_document \", vm.plane_document);\n\n\n                 //clean shizzle before sending\n                 //why keep sending back heavy data?\n\n                    // for(var i=0;i<vm.plane_document.images.length;i++){\n                    //     delete vm.plane_document.images[i].data_uri;\n                    // }\n\n                    // // vm.plane_document.images = vm.plane_documents;\n                    // vm.plane_document.images = vm.plane_document.images.concat(vm.plane_documents);\n                    // vm.plane_document.user_id = vm.user_id;\n\n\n\n\n            //     if(vm.plane_document.id){\n            //         //then its an udpate\n\n            //         //merge the images left?\n            //         PoidService.Update(vm.plane_document)\n            //             .then(function (data) {\n            //                 //console.log(data);\n            //                 if(data.success){\n            //                     //console.log(\"HUZZAH\", vm.plane_document);\n            //                     //console.log(\"HUZZAH\", data);\n            //                     //then we need to remove this from the list of files...\n                                \n                                \n            //                     //move somewhere?\n            //                     $state.go('dashboard.my_account.poid', {}, { reload: true });\n\n\n\n\n\n            //                 } else {\n\n            //                     alert(\"Something went terribly wrong... \\n\\n \"+data.message);\n\n            //                 }\n\n            //             });\n\n            //     } else {\n\n\n                   \n\n\n            //         //then its a create\n            //         //console.log(vm.plane_document);\n\n            //         PoidService.Create(vm.plane_document)\n            //             .then(function (data) {\n            //                 //console.log(data);\n            //                 if(data.success){\n            //                     //console.log(\"HUZZAH\", vm.plane_document);\n            //                     //console.log(\"HUZZAH\", data);\n            //                     //then we need to remove this from the list of files...\n                                \n                                \n            //                     //move somewhere?\n            //                    // $state.reload();\n            //                    // $state.go('dashboard.my_account.poid', {}, { reload: true });\n\n\n            //                 } else {\n\n            //                     alert(\"Something went terribly wrong... \\n\\n \"+data.message);\n\n            //                 }\n\n            //             });\n\n\n            //     }\n\n\n\n             };\n\n\n\n\n             $scope.change_file_name = function(file){\n                \n                //this is terribly ineficient... unfortunately... can't \n                //work out how else to do it! (lol)\n\n                // //console.log(\"TO BE CHANGED\", file);\n\n                // //console.log(\"BEFORE BEFORE\", vm.plane_documents);\n\n                vm.plane_documents = $.grep(vm.plane_documents, function(e){ \n                    return e.temp_path != file.temp_path; \n                });\n\n                // //console.log(\"BEFORE\", vm.plane_documents);\n\n                vm.plane_documents.push(file);\n\n                // //console.log(\"AFTER\", vm.plane_documents);\n\n             }\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n        initController();\n\n        function initController() {\n           //console.log(\"check if access is okay\");\n        }\n\n\n            var warning_msg = \"By deleting this plane, you will also cancel all reservations that this plane currently has.\"\n\n          $scope.open = function (plane_id) {\n            var modalInstance = $uibModal.open({\n              animation: true,\n              templateUrl: 'views/modals/deleteModal.html',\n              controller: 'ModalInstanceCtrl',\n              size: \"lg\",\n              resolve: {\n                id: function () {\n                  return plane_id;\n                },\n                params: function() {\n                  return {id: plane_id};\n                },\n                warning: function(){\n                    return warning_msg;\n                }\n              }\n            });\n            modalInstance.result.then(function (plane_id) {\n              $log.info('PRESSED GO: '+plane_id.id);\n              ExperiencesService.Delete(vm.user.id, plane_id.id)\n              .then(function(){\n                //console.log(\"HELLO DELETE\");\n                //update view?\n                 vm.club.items = $.grep(vm.club.items, function(e){ \n                    return e.id != plane_id.id; \n                });\n              })\n            }, function () {\n              $log.info('Modal dismissed at: ' + new Date());\n            });\n          };\n\n         \n\n\n    }\n app.controller('DashboardClubVouchersEditController', DashboardClubVouchersEditController);\n\n    DashboardClubVouchersEditController.$inject = ['UserService', 'PlaneService', '$rootScope', '$location', '$scope', '$state', '$stateParams', '$uibModal', '$log', '$window', 'LicenceService', 'MedicalService', 'DifferencesService', 'ExperiencesService', 'VoucherService'];\n    function DashboardClubVouchersEditController(UserService, PlaneService, $rootScope, $location, $scope, $state, $stateParams, $uibModal, $log, $window, LicenceService, MedicalService, DifferencesService, ExperiencesService, VoucherService) {\n        var vm = this;\n\n        //console.log(\"HELLOOOO vouchers\");\n\n        vm.user = null;\n        vm.allUsers = [];\n        vm.club = {\n            item: {\n            }\n        };\n        vm.page_title = \"\";\n        \n        vm.plane_document = {};\n        vm.plane_documents = [];\n\n        var update_this_file = [];\n        \n\n        vm.action = $state.current.data.action;\n        vm.club_id = $rootScope.globals.currentUser.current_club_admin.id;\n        vm.user = $rootScope.globals.currentUser;\n        vm.user_id = vm.user.id;\n\n        vm.charge_type = [\"brakes\", \"session\", \"plane\"];\n\n        vm.discounts = [];\n\n        vm.planes = [];\n\n        vm.show_paid = true;\n   \n\n        ExperiencesService.GetByClubId(vm.club_id)\n                    .then(function(data){\n                        //console.log(\"planes\", data);\n                        vm.experiences = data.items;\n                    });\n\n  \n\n               \n                VoucherService.GetById($stateParams.id)\n                    .then(function(data){\n\n\n\n                            data.item.expiry_date = new Date(data.item.expiry_date);\n                            vm.club.item = data.item; \n\n                            //console.log(vm.club);\n\n                        \n                        // vm.page_title = \"Edit an Experience - \"+vm.club.item.title;\n                    });\n\n\n        $scope.update_experience = function(){\n            //console.log(\"UPDATE EXP\");\n            var days = vm.club.item.experience.valid_for;\n            if(days > 0){\n                 var expiry_date = moment().day(+days);\n                //console.log(\"NEW DATE: \", expiry_date);\n                vm.club.item.expiry_date = new Date(expiry_date);\n            } else {\n                var expiry_date = moment().year(+2100);\n                vm.club.item.expiry_date = new Date(expiry_date);\n            }\n            vm.club.item.price = vm.club.item.experience.price;\n\n            ExperiencesService.GetDiscountsByClubIdAndExperienceId(vm.club_id, vm.club.item.experience.id)\n            .then(function(data){\n                ////console.log(\"discounts\", data);\n                vm.discounts = data.items;\n            });\n\n        }\n\n        $scope.update_discount = function(){\n\n            if(vm.club.item.discount.discount_type == 1){\n                //fixed price\n                vm.club.item.price = vm.club.item.discount.price;\n            } else {\n                //percentage...\n                vm.club.item.price = vm.club.item.experience.price - (vm.club.item.experience.price * (vm.club.item.discount.percentage / 100) );\n\n            }\n\n        }\n\n        //'9' needs to refer the the user's account set to manage\n       \n\n        $scope.check_code = function(){\n            //console.log(\"CHECKING NOW\");\n        }\n\n        $scope.back = function(){\n            $window.history.back();\n        }\n\n        $scope.save = function(){\n            if(vm.action == \"add\"){\n                //console.log(\"CREATE click\");\n                $scope.create();\n            } else {\n                //console.log(\"EDIT click\");\n                //console.log(vm.club.plane);\n                $scope.update();\n            }\n        }\n\n\n        $scope.create = function(){\n            //console.log(\"CREATE ME NOW\");\n\n\n            //first sanity check goes here...\n            if(!vm.club.item.experience || !vm.club.item.experience.id){\n                alert(\"You must select an experience to issue this voucher...\");\n                return false;\n            }\n            if(!vm.club.item.first_name || !vm.club.item.last_name || !vm.club.item.email){\n                alert(\"You must enter the purchasor's first name, last name and email address.\");\n                return false;\n            }\n\n            if(vm.already_paid){\n                if(!vm.club.item.price_paid || !vm.club.item.payment_method){\n                    alert(\"Please fill in how much was paid and what payment method was used to complete the payment\");\n                    return false;\n                }\n            }\n\n\n\n\n\n\n\n\n            vm.club.item.experience_title = vm.club.item.experience.title;\n            vm.club.item.experience_id = vm.club.item.experience.id;\n            vm.club.item.discount_id = vm.club.item.discount.id;\n\n            //applying a discount?\n            //vm.club.item.price = vm.club.item.experience.price;\n            \n\n           \n            vm.club.item.club_id = vm.club_id;\n\n\n            if(!vm.already_paid){\n\n                   var options = {\n                    name: document.getElementById('name').value,\n                    address_zip: document.getElementById('address-postcode').value,\n                  };\n\n                  stripe.createToken(card, options).then(function(result) {\n                    if (result.error) {\n                      // Inform the user if there was an error\n                      var errorElement = document.getElementById('card-errors');\n                      errorElement.textContent = result.error.message;\n                    } else {\n                      // Send the token to your server\n                      //stripeTokenHandler(result.token);\n                      ////console.log(\"RESULT\", result);\n\n                      if(result.token.id){\n                      ////console.log(\"STUFF\", result.token.id);\n\n                        //prepare a basic object...\n                        var obj = {\n                            user_id: vm.user.id,\n                            brand: result.token.card.brand,\n                            last4: result.token.card.last4,\n                            hash: result.token.card.id,\n                            token: result.token.id,\n                            exp_month: result.token.card.exp_month,\n                            exp_year: result.token.card.exp_year,\n                            funding: result.token.card.funding,\n                            name: result.token.card.name,\n                            address_postcode: result.token.card.address_zip,\n                            client_ip: result.token.client_ip\n                        };\n\n                        vm.club.item.payment = obj;\n\n                        delete vm.club.item.experience;\n                        //delete vm.club.item.discount;\n\n                        //console.log(\"READY WITH : \", vm.club.item);\n                        //return false;\n                        \n                        VoucherService.Create(vm.club.item)\n                        .then(function(data){\n                            //console.log(data);\n                            //$state.reload();\n                            $state.go('dashboard.manage_club.vouchers', {}, {reload: true});\n\n                        });\n\n\n\n                      }\n\n                    }\n                  });\n\n              } else {\n                //then the payment was already taken by other means...\n                var obj = {\n                    payment_method: vm.club.item.payment_method,\n                    amount: vm.club.item.price_paid \n                }\n\n            \n\n                vm.club.item.payment = obj;\n                \n                delete vm.club.item.payment_method;\n                delete vm.club.item.price_paid;\n\n                //console.log(\"READY WITH NO STRIPE : \", vm.club.item);\n\n                        //return false;\n\n                VoucherService.Create(vm.club.item)\n                    .then(function(data){\n                        //console.log(data);\n                        //$state.reload();\n                        $state.go('dashboard.manage_club.vouchers', {}, {reload: true});\n\n                    });\n\n              }\n\n\n\n           \n        }\n\n\n        $scope.cancel = function(){\n\n            VoucherService.CancelVoucher(vm.user.id, vm.club.item.id)\n                .then(function(data){\n                    //console.log(data);\n                    $state.go('dashboard.manage_club.vouchers', {}, {reload: true});\n                });\n\n        }\n\n        $scope.delete = function(){\n            //console.log(\"CLICK\");\n            alert(\"Are you sure you would like to delete this plane?\");\n            VoucherService.CancelVoucher(vm.user.id, vm.club.item)\n                .then(function(data){\n                    //console.log(data);\n                });\n        }\n\n        function get_update_docs(){\n            var documents = [];\n\n            for(var i=0;i<update_this_file.length;i++){\n                var id = update_this_file[i];\n                //console.log(\"looking for : \", id);\n                //console.log(\"in: \", vm.plane_documents);\n\n                for(var k=0;k<vm.club.plane.plane_documents.length;k++){\n                    //console.log(\"comparing to : \", vm.club.plane.plane_documents[k].id);\n                    if(vm.club.plane.plane_documents[k].id == id){\n                        documents.push(vm.club.plane.plane_documents[k]);\n                    }\n                }\n\n            }\n\n            // //console.log(\"DOCS TO UPDATE : \", documents);\n            return documents;\n        }\n\n        $scope.update = function(){\n            //console.log(\"CLICK\");\n            vm.club.item.club_id = vm.club_id;\n            VoucherService.Update(vm.club.item, vm.user.id)\n                .then(function(data){\n                    //console.log(data);\n                    //console.log(\"saved\");\n                    //$state.reload();\n                    $state.go('dashboard.manage_club.vouchers', {}, {reload: true});\n                });\n        }\n\n        $scope.update_experience = function(){\n            //console.log(\"UPDATE EXP\");\n            var days = vm.club.item.experience.valid_for;\n            if(days > 0){\n                 var expiry_date = moment().day(+days);\n                //console.log(\"NEW DATE: \", expiry_date);\n                vm.club.item.expiry_date = new Date(expiry_date);\n            } else {\n                var expiry_date = moment().year(+2100);\n                vm.club.item.expiry_date = new Date(expiry_date);\n            }\n            vm.club.item.price = vm.club.item.experience.price;\n\n            ExperiencesService.GetDiscountsByClubIdAndExperienceId(vm.club_id, vm.club.item.experience.id)\n            .then(function(data){\n                ////console.log(\"discounts\", data);\n                vm.discounts = data.items;\n            });\n\n        }\n\n        $scope.update_discount = function(){\n\n            if(vm.club.item.discount.discount_type == 1){\n                //fixed price\n                vm.club.item.price = vm.club.item.discount.price;\n            } else {\n                //percentage...\n                vm.club.item.price = vm.club.item.experience.price - (vm.club.item.experience.price * (vm.club.item.discount.percentage / 100) );\n\n            }\n\n        }\n\n        function containsObject(obj, list, params) {\n\n            // //console.log(\"obj\", obj);\n            // //console.log(\"list\", list);\n            // //console.log(\"params\", params);\n\n            for(var i=0; i<list.length; i++) {\n                // //console.log(\"list i : \", list[i]);\n                // //console.log(\"obj is: \", obj);\n\n                var count_success = 0;\n                for(var j=0;j<params.length;j++){\n                    if(list[i][params[j]] && obj[params[j]] && list[i][params[j]] == obj[params[j]]){\n                        count_success++;\n                    }\n                }\n\n                if(count_success === params.length) {                    \n                    return true;\n                }\n            }\n\n            return false;\n        }\n\n\n\n\n        function check_all(){\n\n            //maybe a nice to have one day... not yet though.\n\n\n            //licences\n            vm.club.plane.requirements.licence.forEach(function(obj){\n\n            });\n\n        }\n\n      \n\n\n\n        $scope.add_item = function(type){\n            //console.log(\"ADD\");\n            switch(type){\n                case \"plane\":\n                    //console.log(\"plane\");\n                    if(vm.temporary.plane && vm.temporary.plane !== \"\"){\n                        //then we can add it\n                        //console.log(\"here we go\");\n                        // var add_plane = {\n                        //     id: vm.temporary.plane.id\n                        // };\n\n                        //check if it doesnt exist first...\n                        //if(vm.club.item.planes && vm.club.item.planes.indexOf(vm.temporary.plane.plane_id) == -1){\n\n\n                        if(!vm.club.item.planes){\n                            vm.club.item.planes = [];\n                        }\n\n                        if(containsObject(vm.temporary.plane, vm.club.item.planes, new Array(\"plane_id\") ) == false){\n                            vm.club.item.planes.push(vm.temporary.plane);\n\n                            // vm.club.item.planes.indexOf(vm.temporary.plane)\n                            // vm.planes.filter(function(el) { return el.plane_id !== vm.temporary.plane.plane_id; });\n                        } \n\n                        delete vm.temporary.plane;\n\n                    } else {\n                        alert(\"Please select a plane that this activity be done on!\");\n                    }\n\n                break;\n\n            }\n\n\n\n        }\n\n\n        $scope.remove_item = function(type, index){\n            //console.log(\"REMOVE\");\n\n            vm.club.item.planes.splice(index, 1);\n\n\n            // switch(type){\n            //     case \"plane\":\n            //             //console.log(\"plane\");\n                   \n            //             //check if it doesnt exist first...\n            //             // if(containsObject(add_licence, vm.club.plane.requirements.licence, new Array(\"licence_id\", \"rating_id\")) == false){\n            //             //     vm.club.plane.requirements.licence.push(add_licence);\n            //             // }\n\n            //             vm.club.item.planes.splice(index, 1);\n                      \n            //     break;\n            // }\n\n\n            //     case \"medical\":\n            //         //console.log(\"medical\");\n            //         if(vm.temporary.medical_authority && vm.temporary.medical_authority !== \"\" && vm.temporary.medical_component && vm.temporary.medical_component !== \"\"){\n            //             //then we can add it\n            //             //console.log(\"here we go\");\n            //             var add_medical = {\n            //                 authority_id: vm.temporary.medical_authority.id,\n            //                 authority_title: vm.temporary.medical_authority.abbreviation,\n            //                 medical_component_id: vm.temporary.medical_component.id,\n            //                 medical_component_title: vm.temporary.medical_component.title\n            //             };\n\n            //             //check if it doesnt exist first...\n            //             if(containsObject(add_medical, vm.club.plane.requirements.medical, new Array(\"authority_id\", \"medical_component_id\")) == false){\n            //                 vm.club.plane.requirements.medical.push(add_medical);\n            //             }\n\n            //             delete vm.temporary.medical_authority;\n            //             delete vm.temporary.medical_component;\n\n            //         } else {\n            //             alert(\"Please select a medical that is required to book the plane solo!\");\n            //         }\n\n            //     break;\n\n\n            //     case \"differences\":\n            //         //console.log(\"difference\");\n            //         if(vm.temporary.difference && vm.temporary.difference !== \"\"){\n            //             //then we can add it\n            //             //console.log(\"here we go\");\n            //             var add_difference = {\n            //                 difference_id: vm.temporary.difference.id,\n            //                 difference_title: vm.temporary.difference.title\n            //             };\n\n            //             //check if it doesnt exist first...\n            //             if(containsObject(add_difference, vm.club.plane.requirements.differences, new Array(\"difference_id\", \"difference_title\")) == false){\n            //                 vm.club.plane.requirements.differences.push(add_difference);\n            //             }\n\n            //             delete vm.temporary.difference;\n\n            //         } else {\n            //             alert(\"Please select a difference that is required to book the plane solo!\");\n            //         }\n\n            //     break;\n\n\n            // }\n\n\n\n        }\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n        $scope.update_this_file = function(file){\n            //console.log(\"==== update is : \", file.id);\n            if(update_this_file.indexOf(file.id) === -1){\n                update_this_file.push(file.id)\n            } else {\n               ////console.log(\"This item already exists\"); \n            } \n        }\n\n\n         $scope.remove_real_file = function(file){\n\n                //remove_file\n\n                vm.club.plane.plane_documents = $.grep(vm.club.plane.plane_documents, function(e){ \n                        return e.id != file.id; \n                    });\n\n                //no need to actually remove the file as it will be archived accordingly on the backend whilst it is missing! :)\n                PlaneDocumentService.Delete(vm.user.id, file.id)\n                .then(function (data) {\n                    //console.log(data);\n                    if(data.success){\n                        //console.log(\"HUZZAH\", current_files);\n                        //then we need to remove this from the list of files...\n                        //clear files\n                        vm.plane_documents = [];\n                        //and re-process available files\n                        $scope.processFiles(current_files);\n\n                    } else {\n                        //console.log(\"WOOOPSIES...\");\n                        //this should be very very rare...\n                    }\n\n                });\n\n          }\n\n\n          \n          $scope.remove_file = function(file, current_files){\n\n            //remove_file\n            var j = JSON.parse(file.file_return);\n            //console.log(\"REMOVE: \", j);\n            //console.log(\"REMOVE: \", j.saved_url);\n\n            //to delete the temp file created: j.saved_url\n            //tmp_rm.php POST tmp = filename\n            \n            PoidService.DeleteTmp(j.saved_url)\n                .then(function (data) {\n                    //console.log(data);\n                    if(data.success){\n                        //console.log(\"HUZZAH\", current_files);\n                        //then we need to remove this from the list of files...\n                        //clear files\n                        vm.plane_documents = [];\n                        //and re-process available files\n                        $scope.processFiles(current_files);\n\n                    } else {\n                        //console.log(\"WOOOPSIES...\");\n                        //this should be very very rare...\n                    }\n\n                });\n\n          }\n          \n\n\n        initController();\n\n        function initController() {\n\n\n        }\n\n\n            var warning_msg = \"By deleting this plane, you will also cancel all reservations that this plane currently has.\"\n\n          $scope.open = function (plane_id) {\n            var modalInstance = $uibModal.open({\n              animation: true,\n              templateUrl: 'views/modals/deleteModal.html',\n              controller: 'ModalInstanceCtrl',\n              size: \"lg\",\n              resolve: {\n                id: function () {\n                  return plane_id;\n                },\n                params: function() {\n                  return {id: plane_id};\n                },\n                warning: function(){\n                    return warning_msg;\n                }\n              }\n            });\n            modalInstance.result.then(function (plane_id) {\n              $log.info('PRESSED GO: '+plane_id.id);\n              ExperiencesService.Delete(vm.user.id, plane_id.id)\n              .then(function(){\n                //console.log(\"HELLO DELETE\");\n                //update view?\n                 vm.club.items = $.grep(vm.club.items, function(e){ \n                    return e.id != plane_id.id; \n                });\n              })\n            }, function () {\n              $log.info('Modal dismissed at: ' + new Date());\n            });\n          };\n\n         \n\n\n    }\n app\n.filter(\"asDate\", function () {\n    return function (input) {\n        if(input && input !== \"\"){\n            return moment(input).toDate();//new Date(input);\n        } else {\n            return \"\";\n        }\n    }\n});\n\n app.controller('DashboardController', DashboardController);\n\n    DashboardController.$inject = ['UserService','$cookieStore', 'BookingService', 'BookoutService', '$rootScope', '$location', 'AuthenticationService'];\n    function DashboardController(UserService, $cookieStore, BookingService, BookoutService, $rootScope, $location, AuthenticationService) {\n        var vm = this;\n\n        if(!$rootScope.globals.currentUser){\n            if(AuthenticationService.CheckLoggedIn() == false){\n                //console.log(\"STOPPING HERE\");\n                $location.path('/login');\n                return false;\n            }\n            // .then(function(data){\n            //     //console.log(\"DATA : \", data);\n            // });\n        }\n\n        vm.user = $rootScope.globals.currentUser;\n        ////console.log(\"ROOTSCOPE\", $rootScope.globals);\n\n         //CheckLoggedIn\n\n        vm.bookings = [];\n        vm.bookouts = [];\n        vm.to_pay = [];\n        vm.to_complete_split = [];\n        \n        // //console.log(\"vmuser\", vm.user);\n        vm.allUsers = [];\n\n        vm.clubs = [];\n\n        vm.force_show_admins = false;\n\n        if(vm.user && vm.user.access && vm.user.access.manager){\n           vm.force_show_admins = true;\n        } else if(vm.user && vm.user.access && vm.user.access.instructor){\n           vm.force_show_admins = true;\n        }\n        \n\n        UserService.GetAdminClubs(vm.user.id)\n        .then(function(data){\n            if(data.success){\n                 vm.clubs = data.clubs;   \n                //think about preferences and setting the \"most favoured\" one.\n                $rootScope.globals.currentUser.current_club_admin = vm.clubs[0];\n                // $cookieStore.remove('globals');\n                $cookieStore.put('globals', $rootScope.globals);\n                ////console.log(\"vm.clubs[0]\", vm.clubs[0]);\n            } else {\n                //console.log(\"ERROR FAIL / LOGOUT\", data);\n\n                //clear all cookie data?\n\n                $location.path('/login');\n\n            }\n           \n                        \n        });\n\n\n        initController();\n\n        function initController() {\n           //console.log(\"check if access is okay\");\n           load_bookings();\n        }\n\n        function load_bookings(){\n\n            BookingService.GetTodayBookingsUser(vm.user.id)\n                        .then(function(data){\n\n                            vm.bookings = data.bookings;   \n                            vm.to_pay = data.to_pay; \n                            vm.to_complete_split = data.to_complete_split;  \n                            //console.log(\"to_pay\", data.to_pay);\n                        });\n\n            \n\n\n            BookoutService.GetBookoutsToComplete(vm.user.id)\n                        .then(function(data){\n\n                            vm.bookouts = data.bookouts;   \n                            \n                        });\n        }\n\n        vm.logout = function(){\n            //alert(\"LOG ME OUT\");\n            AuthenticationService.Logout(function(data){\n\n                           AuthenticationService.ClearCredentials();\n                             \n                            $cookieStore.remove('globals');\n                            $cookieStore.remove('session');\n\n                            $location.path('/login');\n\n\n                         \n                        \n                    });\n        }\n\n\n        vm.cancel_bookout = function(id){\n            // //console.log(\"CANCEL BOOKOUT ID: \", id);\n            var a = confirm(\"Are you sure you wish to cancel the bookout?\");\n            if(a){\n                BookoutService.CancelBookout(id)\n                 .then(function(data){\n\n                     if(data.success){\n\n                       load_bookings();\n\n\n                     } else {\n                         alert(data.message);\n                     }\n                                                \n                    });\n\n\n                // //console.log(\"CANCEL\");\n\n            } else {\n                return false;\n            }\n        }\n\n        vm.cancel_booking = function(id){\n            // //console.log(\"CANCEL BOOKOUT ID: \", id);\n            var a = confirm(\"Are you sure you wish to cancel the booking?\");\n            if(a){\n                BookoutService.DeleteBooking(vm.user.id, id)\n                 .then(function(data){\n\n                     if(data.success){\n\n                       load_bookings();\n\n\n                     } else {\n                         alert(data.message);\n                     }\n                                                \n                    });\n\n\n                // //console.log(\"CANCEL\");\n\n            } else {\n                return false;\n            }\n        }\n\n    }\n app.controller('DashboardCourseSyllabusController', DashboardCourseSyllabusController);\n\n    DashboardCourseSyllabusController.$inject = ['UserService', '$rootScope', '$location', '$scope', '$state', '$stateParams', '$uibModal', '$log', '$window', 'CourseService'];\n    function DashboardCourseSyllabusController(UserService, $rootScope, $location, $scope, $state, $stateParams, $uibModal, $log, $window, CourseService) {\n        var vm = this;\n\n           //    /* PLEASE DO NOT COPY AND PASTE THIS CODE. */(function(){var w=window,C='___grecaptcha_cfg',cfg=w[C]=w[C]||{},N='grecaptcha';var gr=w[N]=w[N]||{};gr.ready=gr.ready||function(f){(cfg['fns']=cfg['fns']||[]).push(f);};(cfg['render']=cfg['render']||[]).push('explicit');(cfg['onload']=cfg['onload']||[]).push('initRecaptcha');w['__google_recaptcha_client']=true;var d=document,po=d.createElement('script');po.type='text/javascript';po.async=true;po.src='https://www.gstatic.com/recaptcha/releases/JPZ52lNx97aD96bjM7KaA0bo/recaptcha__en.js';var e=d.querySelector('script[nonce]'),n=e&&(e['nonce']||e.getAttribute('nonce'));if(n){po.setAttribute('nonce',n);}var s=d.getElementsByTagName('script')[0];s.parentNode.insertBefore(po, s);})();\n\n           // var initRecaptcha = function () { \n           //     // document.getElementById(\"SearchModule\").scope().vm.parent.isGrecaptchaLoaded = !0, \n           //     // document.getElementById(\"SearchModule\").scope().vm.showRecaptcha();\n           //     vm.showRecaptcha();\n           // };\n              \n\n\n\n\n        vm.user = null;\n        vm.allUsers = [];\n      \n\n        vm.action = $state.current.data.action;\n        vm.user = $rootScope.globals.currentUser;\n         //console.log(\"$rootScope.globals.currentUser : \", $rootScope.globals.currentUser);\n\n        vm.club_id =( $rootScope.globals.currentUser && $rootScope.globals.currentUser.current_club_admin && $rootScope.globals.currentUser.current_club_admin.id) ? $rootScope.globals.currentUser.current_club_admin.id : 0;\n        vm.user_id = vm.user.id;\n\n        vm.exams = [];\n\n        \n        switch(vm.action){\n            case \"add\":\n                //console.log(\"adding a new course please\");\n                vm.page_title = \"Add a New Course\";\n            break;\n            case \"view\":\n\n                //console.log(\"view an existing course\");\n                load_course();\n\n\n            break;\n            case \"view_lesson\":\n\n                //console.log(\"view an existing lesson\");\n                load_lesson();\n\n\n            break;\n            case \"list\":\n                //console.log(\"view list of existing courses\");\n                CourseService.GetCoursesByClubId(vm.club_id)\n                    .then(function(data){\n                        vm.courses = data.items;   \n                    });\n            break;\n            case \"list_member\":\n                //console.log(\"view list of existing courses\");\n                CourseService.GetCoursesByUserId(vm.user.id)\n                    .then(function(data){\n                        vm.clubs = data.items;   \n                    });\n            break;\n            default:\n                //console.log(\"none of the above... redirect somewhere?\");\n            break;\n        }  \n\n\n        function load_course(){\n\n\n             //console.log(\"PARAMS\", $state);\n            CourseService.GetCourseById($stateParams.course_id)\n                    .then(function(data){\n                        vm.course = data.item;   \n            \n                    });\n             \n            CourseService.GetExamsByCourseId($stateParams.course_id)\n                    .then(function(data){\n                        vm.course.exams = data.items;   \n                \n                    });\n\n            CourseService.GetLessonsByCourseId($stateParams.course_id)\n                    .then(function(data){\n                        vm.course.lessons = data.items;   \n                    });\n\n\n\n        }\n\n\n        function load_lesson(){\n\n            CourseService.GetLessonById($stateParams.lesson_id)\n                    .then(function(data){\n                        vm.lesson = data.item;   \n            \n                    });\n\n\n            CourseService.GetBulletsByLessonId($stateParams.lesson_id)\n                    .then(function(data){\n\n                        vm.lesson.bullets = data.bullets;\n            \n                    });\n\n            CourseService.GetTemByLessonId($stateParams.lesson_id)\n                .then(function(data){\n                    //console.log(data);\n\n                    vm.lesson.tem = data.items;\n\n                });\n\n            CourseService.GetItemsByLessonId($stateParams.lesson_id)\n                .then(function(data){\n                    //console.log(data);\n\n                    vm.lesson.items = data.items;\n\n                });\n\n        }\n\n       \n        $scope.back = function(){\n            $window.history.back();\n        }\n\n\n\n        initController();\n\n        function initController() {\n           //console.log(\"check if access is okay\");\n        }\n\n\n       \n\n\n    }\n app.controller('DashboardCourseSyllabusViewController', DashboardCourseSyllabusViewController);\n\n    DashboardCourseSyllabusViewController.$inject = ['UserService', '$rootScope', '$location', '$scope', '$state', '$stateParams', '$uibModal', '$log', '$window', 'CourseService'];\n    function DashboardCourseSyllabusViewController(UserService, $rootScope, $location, $scope, $state, $stateParams, $uibModal, $log, $window, CourseService) {\n        var vm = this;\n\n           //    /* PLEASE DO NOT COPY AND PASTE THIS CODE. */(function(){var w=window,C='___grecaptcha_cfg',cfg=w[C]=w[C]||{},N='grecaptcha';var gr=w[N]=w[N]||{};gr.ready=gr.ready||function(f){(cfg['fns']=cfg['fns']||[]).push(f);};(cfg['render']=cfg['render']||[]).push('explicit');(cfg['onload']=cfg['onload']||[]).push('initRecaptcha');w['__google_recaptcha_client']=true;var d=document,po=d.createElement('script');po.type='text/javascript';po.async=true;po.src='https://www.gstatic.com/recaptcha/releases/JPZ52lNx97aD96bjM7KaA0bo/recaptcha__en.js';var e=d.querySelector('script[nonce]'),n=e&&(e['nonce']||e.getAttribute('nonce'));if(n){po.setAttribute('nonce',n);}var s=d.getElementsByTagName('script')[0];s.parentNode.insertBefore(po, s);})();\n\n           // var initRecaptcha = function () { \n           //     // document.getElementById(\"SearchModule\").scope().vm.parent.isGrecaptchaLoaded = !0, \n           //     // document.getElementById(\"SearchModule\").scope().vm.showRecaptcha();\n           //     vm.showRecaptcha();\n           // };\n              \n\n\n\n\n        vm.user = null;\n        vm.allUsers = [];\n      \n\n        vm.action = $state.current.data.action;\n        vm.user = $rootScope.globals.currentUser;\n        // //console.log(\"$rootScope.globals.currentUser : \", $rootScope.globals.currentUser);\n\n        vm.club_id =( $rootScope.globals.currentUser && $rootScope.globals.currentUser.current_club_admin && $rootScope.globals.currentUser.current_club_admin.id) ? $rootScope.globals.currentUser.current_club_admin.id : 0;\n        vm.user_id = vm.user.id;\n\n        vm.exams = [];\n\n        vm.course = {\n            exams: [],\n            lessons: []\n        };\n\n        vm.lesson = {\n            tem: [],\n            bullets: {},\n            items: []\n        }\n        \n        switch(vm.action){\n            case \"add\":\n                //console.log(\"adding a new course please\");\n                vm.page_title = \"Add a New Course\";\n            break;\n            case \"view\":\n\n                //console.log(\"view an existing course\");\n                load_course();\n\n\n            break;\n            case \"view_lesson\":\n\n                //console.log(\"view an existing lesson\");\n                load_lesson();\n\n\n            break;\n            case \"list\":\n                //console.log(\"view list of existing courses\");\n                CourseService.GetCoursesByClubId(vm.club_id)\n                    .then(function(data){\n                        vm.courses = data.items;   \n                    });\n            break;\n            default:\n                //console.log(\"none of the above... redirect somewhere?\");\n            break;\n        }  \n\n\n        function load_course(){\n\n\n            vm.course_id = $stateParams.course_id;\n\n             //console.log(\"PARAMS\", $state);\n            CourseService.GetCourseById($stateParams.course_id)\n                    .then(function(data){\n                        vm.course = data.item;   \n                            \n\n                         CourseService.GetExamsByCourseId($stateParams.course_id)\n                                .then(function(data){\n                                    vm.course.exams = data.items;   \n                            \n                                });\n\n                        CourseService.GetLessonsByCourseId($stateParams.course_id)\n                                .then(function(data){\n                                    vm.course.lessons = data.items;   \n                                });\n\n\n                    });\n             \n          \n\n\n        }\n\n\n        function load_lesson(){\n\n            vm.course_id = $stateParams.course_id;\n\n            CourseService.GetLessonById($stateParams.lesson_id)\n                    .then(function(data){\n                        vm.lesson = data.item;   \n\n                        CourseService.GetBulletsByLessonId($stateParams.lesson_id)\n                            .then(function(data){\n\n                                    vm.lesson.bullets = data.bullets;\n                        \n                                });\n\n                        CourseService.GetTemByLessonId($stateParams.lesson_id)\n                            .then(function(data){\n                                //console.log(data);\n\n                                vm.lesson.tem = data.items;\n\n                            });\n\n                        CourseService.GetItemsByLessonId($stateParams.lesson_id)\n                            .then(function(data){\n                                //console.log(data);\n\n                                vm.lesson.items = data.items;\n\n                            });\n            \n                    });\n\n\n            \n\n        }\n\n       \n        $scope.back = function(){\n            $window.history.back();\n        }\n\n\n\n        initController();\n\n        function initController() {\n           //console.log(\"check if access is okay\");\n        }\n\n\n       \n\n\n    }\n app.controller('DashboardInstructorBriefController', DashboardInstructorBriefController);\n\n    DashboardInstructorBriefController.$inject = ['UserService', '$rootScope', '$location', '$scope', '$state', '$stateParams', '$uibModal', '$log', '$window', 'CourseService', 'BookingService'];\n    function DashboardInstructorBriefController(UserService, $rootScope, $location, $scope, $state, $stateParams, $uibModal, $log, $window, CourseService, BookingService) {\n        var vm = this;\n\n           //    /* PLEASE DO NOT COPY AND PASTE THIS CODE. */(function(){var w=window,C='___grecaptcha_cfg',cfg=w[C]=w[C]||{},N='grecaptcha';var gr=w[N]=w[N]||{};gr.ready=gr.ready||function(f){(cfg['fns']=cfg['fns']||[]).push(f);};(cfg['render']=cfg['render']||[]).push('explicit');(cfg['onload']=cfg['onload']||[]).push('initRecaptcha');w['__google_recaptcha_client']=true;var d=document,po=d.createElement('script');po.type='text/javascript';po.async=true;po.src='https://www.gstatic.com/recaptcha/releases/JPZ52lNx97aD96bjM7KaA0bo/recaptcha__en.js';var e=d.querySelector('script[nonce]'),n=e&&(e['nonce']||e.getAttribute('nonce'));if(n){po.setAttribute('nonce',n);}var s=d.getElementsByTagName('script')[0];s.parentNode.insertBefore(po, s);})();\n\n           // var initRecaptcha = function () { \n           //     // document.getElementById(\"SearchModule\").scope().vm.parent.isGrecaptchaLoaded = !0, \n           //     // document.getElementById(\"SearchModule\").scope().vm.showRecaptcha();\n           //     vm.showRecaptcha();\n           // };\n              \n\n\n\n\n        vm.user = null;\n        vm.allUsers = [];\n      \n\n        vm.action = $state.current.data.action;\n        vm.user = $rootScope.globals.currentUser;\n         ////console.log(\"$rootScope.globals.currentUser : \", $rootScope.globals.currentUser);\n\n        vm.club_id = $rootScope.globals.currentUser.current_club_instructor;\n        vm.user_id = vm.user.id;\n\n        vm.exams = [];\n\n        \n        switch(vm.action){\n            case \"add\":\n                //console.log(\"adding a new course please\");\n                vm.page_title = \"Add a New Course\";\n            break;\n            case \"view\":\n\n                //console.log(\"view an existing course\");\n                load_course();\n\n\n            break;\n            case \"view_lesson\":\n                vm.selected_lesson = $stateParams.lesson_id;\n\n                //console.log(\"view an existing lesson\");\n                load_lesson();\n\n\n            break;\n            case \"list\":\n                //console.log(\"view list of existing courses\");\n                \n                BookingService.GetBookingsToBrief(vm.user.id)\n                    .then(function(data){\n\n                        vm.briefings = data.briefings;   \n                        \n                    });\n\n\n            break;\n            case \"debrief_list\":\n                //console.log(\"view list of existing courses\");\n                \n                BookingService.GetBookingsToDebrief(vm.user.id)\n                    .then(function(data){\n\n                        vm.briefings = data.briefings;   \n                        \n                    });\n\n\n            break;\n            case \"debrief\":\n                //console.log(\"plane_log_sheet\", $stateParams.plane_log_sheet_id);\n                //console.log(\"booking_id\", $stateParams.booking_id);\n                vm.plane_log_sheet_id = $stateParams.plane_log_sheet_id;\n                vm.booking_id = $stateParams.booking_id;\n                \n                console.log(\"STATEPARAMS: \", $stateParams);\n\n                vm.show_split = 0;\n                if($stateParams.split_next_id && $stateParams.split_next_id > 0){\n                    vm.split_next_id = $stateParams.split_next_id;\n                    vm.show_split = 1;\n                    console.log(\"SPLIT NEXT ID!!\", vm.split_next_id);\n                }\n                if($stateParams.split_booking_id && $stateParams.split_booking_id > 0){\n                    vm.split_booking_id = $stateParams.split_booking_id;\n                    vm.show_split = 1;\n                }\n\n                //vm.pls_id = $stateParams.plane_log_sheet_id;\n\n                if(vm.plane_log_sheet_id > 0){\n\n                    //if we claim without a bookout....ugh...\n                    //for_debrief_pls\n                    //get progress for course\n                    BookingService.GetForForDebriefPls(vm.plane_log_sheet_id)\n                        .then(function(data){\n                            if(data.success){\n                                vm.competences = data.competences;   \n                                vm.course_id = data.course_id;   \n                                vm.record_club_id = data.club_id;\n                                vm.lesson = data.lesson;   \n                                vm.all_items = data.all_items;   \n                                vm.my_search = vm.lesson.id;\n                                vm.student = data.student;\n                                vm.instructor = data.instructor;\n                                vm.plane_log_sheet = data.log_sheet;\n\n\n\n                                CourseService.GetLessonsByCourseId(vm.course_id)\n                                .then(function(data){\n                                    vm.all_lessons = data.items;   \n                                });\n\n                                CourseService.GetTagsByCourseId(vm.course_id)\n                                .then(function(data){\n                                    vm.all_tags = data.items;   \n                                    vm.selected_flight_tags = [];\n                                });\n\n                            } else {\n                                alert(\"We could not obtain the debriefing information for you...\");\n                            }\n                            \n                        });\n\n\n\n                } else {\n                    //get progress for course\n                    BookingService.GetForForDebrief(vm.booking_id)\n                        .then(function(data){\n                            if(data.success){\n                                vm.competences = data.competences;   \n                                vm.course_id = data.course_id;   \n                                vm.record_club_id = data.club_id;\n                                vm.lesson = data.lesson;   \n                                vm.all_items = data.all_items;   \n                                vm.my_search = vm.lesson.id;\n                                vm.student = data.student;\n                                vm.instructor = data.instructor;\n                                vm.plane_log_sheet = data.log_sheet;\n\n\n\n                                CourseService.GetLessonsByCourseId(vm.course_id)\n                                .then(function(data){\n                                    vm.all_lessons = data.items;   \n                                });\n\n                                CourseService.GetTagsByCourseId(vm.course_id)\n                                .then(function(data){\n                                    vm.all_tags = data.items;   \n                                    vm.selected_flight_tags = [];\n                                });\n\n                            } else {\n                                alert(\"We could not obtain the debriefing information for you...\");\n                            }\n                            \n                        });\n                }\n\n                vm.show_whole_lesson = true;\n\n\n\n                \n\n            break;\n            default:\n                //console.log(\"none of the above... redirect somewhere?\");\n            break;\n        }  \n\n        vm.show_all_lessons = false;\n        vm.tag_full_flight = true;\n\n        vm.update_flight_tag = function(){\n            console.log(vm.plane_log_sheet);\n\n            vm.tag_full_flight = true;\n        }\n\n        vm.update_flight_full_flight = function(){\n\n            if((Math.round(vm.tag_flight_time / 5) * 5) > (vm.plane_log_sheet.brakes_times_rounded * 60)){\n                vm.tag_flight_time = (vm.plane_log_sheet.brakes_times_rounded * 60);\n                vm.tag_flight_time = Math.round(vm.tag_flight_time / 5) * 5;\n            }\n\n            if((Math.round(vm.tag_flight_time / 5) * 5) == 0){\n                vm.tag_flight_time = 5;\n            }\n\n            if(vm.tag_full_flight){\n                vm.tag_flight_time = (vm.plane_log_sheet.brakes_times_rounded * 60);\n                vm.tag_flight_time = Math.round(vm.tag_flight_time / 5) * 5;\n            } else {\n                console.log(\"tag full flight\");\n                console.log(vm.plane_log_sheet);\n            }\n            \n        }\n\n        vm.show_whole_course = function(){\n            vm.show_all_lessons = !vm.show_all_lessons;\n            if(vm.show_all_lessons){\n                vm.my_search = \"\";\n                vm.my_search2 = \"\";\n            } else {\n                vm.my_search = vm.lesson.id;\n                vm.my_search2 = \"\";\n            }\n        }\n\n        vm.set_updated_search = function(){\n\n            if(vm.show_all_lessons){\n                vm.my_search = vm.my_search2;\n            } else {\n                    if(vm.my_search2.length > 1){\n                        vm.my_search = vm.my_search2;\n                    } else {\n                        vm.my_search = vm.lesson.id;\n                    }\n            }\n            \n        }\n\n        vm.save_progress = function(){\n\n            var compiled_items = [];\n            for(var i=0;i<vm.all_items.length;i++){\n                if( (vm.all_items[i].result && vm.all_items[i].result > 0) || (vm.all_items[i].remarks && vm.all_items[i].result !== \"\") ){\n                    compiled_items.push(vm.all_items[i]);\n                }\n            }\n\n\n\n            //some rough checks:::\n\n            // //console.log(\"PROGRESS: \", vm.general_remarks);\n            // //console.log(\"PROGRESS: \", compiled_items.length);\n\n            if(compiled_items.length < 1 && (!vm.general_remarks || vm.general_remarks == \"\")){\n                alert(\"To save student records, you need to tick at least one student progress record item OR add a general remark\");\n                return false;\n            }\n\n            var next_lesson = vm.lesson.id;\n\n            if(vm.lesson_completed == 1 && vm.next_lesson && vm.next_lesson.id > 0){\n                next_lesson = vm.next_lesson.id;\n            }\n\n            //vm.selected_flight_tags.push(vm.flight_tag);\n\n            vm.compiled_save = {\n                club_id: vm.record_club_id,\n                items: compiled_items,\n                general_remarks: vm.general_remarks,\n                lesson_id: vm.lesson.id,\n                course_id: vm.course_id,\n                user_id: vm.student.id,\n                instructor_id: vm.instructor.id,\n                completed_by: vm.user.id,\n                plane_log_sheet_id: vm.plane_log_sheet.id,\n                next_lesson_id: next_lesson,\n                completed: (vm.lesson_completed) ? 1 : 0,\n                booking_id: vm.booking_id,\n                flight_tags: vm.selected_flight_tags\n            };\n\n            // console.log(vm.compiled_save);\n            // return false;\n\n            //IF EDIT?? NEED TO CHANGE THIS CALL SURELY?\n\n            CourseService.CreateTrainingRecord(vm.compiled_save)\n                .then(function(data){\n                    if(data.success){\n\n                        alert(\"THANK YOU!\");\n                        if(vm.show_split && vm.split_next_id && vm.split_next_id > 0){\n                            $state.go('dashboard.my_account.book_in', {id: vm.split_next_id});\n                            //dashboard.my_account.book_in({id: log.plane_log_sheet_id})\n                        } else {\n                            $state.go('dashboard.manage_user', {reload: true});\n                        }\n\n\n\n                    } else {\n                        alert(\"We could not save your training records...\");\n                    }\n        \n                });\n\n\n\n\n        }\n        \n        vm.tag_flight_time = 0;\n\n        vm.add_tag = function(){\n            //CHECK IF ADD DOES ALREADY EXIST!!!\n            if(vm.selected_flight_tags.find(tag => tag.id === vm.flight_tag.id)){\n                alert(\"You already have this tag on this flight!\");\n                return false;\n            }\n\n            if((Math.round(vm.tag_flight_time / 5) * 5) > (vm.plane_log_sheet.brakes_times_rounded * 60)){\n                vm.tag_flight_time = (vm.plane_log_sheet.brakes_times_rounded * 60);\n                vm.tag_flight_time = Math.round(vm.tag_flight_time / 5) * 5;\n            }\n\n            if((Math.round(vm.tag_flight_time / 5) * 5) == 0){\n                vm.tag_flight_time = 5;\n            }\n\n            if(vm.tag_full_flight){\n                vm.tag_flight_time = (vm.plane_log_sheet.brakes_times_rounded * 60);\n                vm.tag_flight_time = Math.round(vm.tag_flight_time / 5) * 5;\n            }\n\n            vm.flight_tag.logging_time = vm.tag_flight_time;\n            // if(!vm.tag_full_flight){\n            //     vm.flight_tag.logging_time = Math.round(vm.tag_flight_time / 5) * 5;\n            // } else {\n            //     vm.flight_tag.logging_time = (vm.plane_log_sheet.brakes_times_rounded * 60);\n            //     vm.tag_flight_time = Math.round(vm.tag_flight_time / 5) * 5;\n            // }\n\n            vm.selected_flight_tags.push(vm.flight_tag);\n            vm.flight_tag = \"\";\n            vm.tag_flight_time = (vm.plane_log_sheet.brakes_times_rounded * 60);\n            vm.tag_flight_time = Math.round(vm.tag_flight_time / 5) * 5;\n            vm.tag_full_flight = true;\n        }\n\n        vm.delete_tag = function(tag, index){\n            vm.selected_flight_tags.splice(index, 1);\n\n        }\n\n        vm.tag_time_to_five = function(){\n            if(vm.tag_flight_time % 5 !== 0){\n                vm.tag_flight_time = Math.round(vm.tag_flight_time / 5) * 5;\n            }            \n        }\n\n        vm.save_edit_record = function(){\n            console.log(\"SAVE THE UPDATE NOW!! WHOOP WHOOP!!\");\n\n            console.log(\"FLIGHT TAGS : \", vm.selected_flight_tags);\n\n            var compiled_items = [];\n            for(var i=0;i<vm.all_items.length;i++){\n                if( (vm.all_items[i].result && vm.all_items[i].result > 0) || (vm.all_items[i].remarks && vm.all_items[i].result !== \"\") ){\n                    compiled_items.push(vm.all_items[i]);\n                }\n            }\n\n            //some rough checks:::\n\n            // //console.log(\"PROGRESS: \", vm.general_remarks);\n            // //console.log(\"PROGRESS: \", compiled_items.length);\n\n            if(compiled_items.length < 1 && (!vm.general_remarks || vm.general_remarks == \"\")){\n                alert(\"To save student records, you need to tick at least one student progress record item OR add a general remark\");\n                return false;\n            }\n\n            var next_lesson = vm.lesson.id;\n\n            if(vm.lesson_completed == 1 && vm.next_lesson && vm.next_lesson.id > 0){\n                next_lesson = vm.next_lesson.id;\n            }\n\n\n            vm.compiled_save = {\n                club_id: vm.record_club_id,\n                items: compiled_items,\n                general_remarks: vm.general_remarks,\n                lesson_id: vm.lesson.id,\n                course_id: vm.course_id,\n                user_id: vm.student.id,\n                instructor_id: vm.instructor.id,\n                completed_by: vm.user.id,\n                plane_log_sheet_id: vm.plane_log_sheet.id,\n                next_lesson_id: next_lesson,\n                completed: (vm.lesson_completed) ? 1 : 0,\n                booking_id: vm.booking_id,\n                flight_tags: vm.selected_flight_tags\n            };\n            console.log(\"COMPILED SAVE\");\n            console.log(vm.compiled_save);\n            console.log(\"COMPILED SAVE\");\n\n        }\n\n        function load_course(){\n\n\n             //console.log(\"PARAMS\", $state);\n            CourseService.GetCourseById($stateParams.course_id)\n                    .then(function(data){\n                        vm.course = data.item;   \n\n                        CourseService.GetExamsByCourseId($stateParams.course_id)\n                                .then(function(data){\n                                    vm.course.exams = data.items;   \n                            \n                                });\n\n                        CourseService.GetLessonsByCourseId($stateParams.course_id)\n                                .then(function(data){\n                                    vm.course.lessons = data.items;   \n                                });\n\n                        CourseService.GetTagsByCourseId($stateParams.course_id)\n                        .then(function(data){\n                            vm.all_tags = data.items;   \n\n                        });\n            \n                    });\n             \n            \n\n\n\n        }\n\n        vm.lesson = {};\n        vm.show_dropdown = false;\n\n        vm.change_lesson = function(){\n            // console.log(\"CHANGE LESSON TO\", vm.selected_lesson);\n            load_lesson();\n            vm.show_dropdown = false;\n\n        }\n\n        function load_lesson(){\n\n            vm.booking_id = $stateParams.booking_id;\n\n            CourseService.GetLessonById(vm.selected_lesson)\n                    .then(function(data){\n\n                        if(data.success){\n\n\n\n                             vm.lesson = data.item;   \n\n\n                             CourseService.GetLessonsByCourseId(data.item.course_id)\n                              .then(function(data){\n\n                                        vm.all_lessons = data.items;\n                            \n                                    });\n            \n                             CourseService.GetBulletsByLessonId(vm.selected_lesson)\n                                    .then(function(data){\n\n                                        vm.lesson.bullets = data.bullets;\n                            \n                                    });\n\n                            CourseService.GetTemByLessonId(vm.selected_lesson)\n                                .then(function(data){\n                                    //console.log(data);\n\n                                    vm.lesson.tem = data.items;\n\n                                });\n\n                            CourseService.GetItemsByLessonId(vm.selected_lesson)\n                                .then(function(data){\n                                    //console.log(data);\n\n                                    vm.lesson.items = data.items;\n\n                                });\n                        }\n\n                      \n\n\n                    });\n\n\n           \n\n        }\n\n        vm.go_book_out = function(){\n\n            var set_briefed = {booking_id: vm.booking_id, briefed: 1};\n            BookingService.SetBookingToBriefed(vm.booking_id)\n                    .then(function(data){\n\n                        if(data.success){\n\n                            $state.go('dashboard.my_account.bookout_with_booking', {booking_id: vm.booking_id});\n\n                        } else {\n\n                            alert(\"Could not complete the briefing!\");\n\n                        }\n                        \n                    });\n        }\n\n       \n        $scope.back = function(){\n            $window.history.back();\n        }\n\n\n\n        initController();\n\n        function initController() {\n           //console.log(\"check if access is okay\");\n        }\n\n\n       \n\n\n    }\n app.controller('DashboardStudentRecordsController', DashboardStudentRecordsController);\n\n    DashboardStudentRecordsController.$inject = ['ClubService', 'UserService', '$rootScope', '$location', '$scope', '$state', '$stateParams', '$uibModal', '$log', '$window', 'CourseService', 'BookingService', 'MemberService', '$sce'];\n    function DashboardStudentRecordsController(ClubService, UserService, $rootScope, $location, $scope, $state, $stateParams, $uibModal, $log, $window, CourseService, BookingService, MemberService, $sce) {\n        var vm = this;\n\n           //    /* PLEASE DO NOT COPY AND PASTE THIS CODE. */(function(){var w=window,C='___grecaptcha_cfg',cfg=w[C]=w[C]||{},N='grecaptcha';var gr=w[N]=w[N]||{};gr.ready=gr.ready||function(f){(cfg['fns']=cfg['fns']||[]).push(f);};(cfg['render']=cfg['render']||[]).push('explicit');(cfg['onload']=cfg['onload']||[]).push('initRecaptcha');w['__google_recaptcha_client']=true;var d=document,po=d.createElement('script');po.type='text/javascript';po.async=true;po.src='https://www.gstatic.com/recaptcha/releases/JPZ52lNx97aD96bjM7KaA0bo/recaptcha__en.js';var e=d.querySelector('script[nonce]'),n=e&&(e['nonce']||e.getAttribute('nonce'));if(n){po.setAttribute('nonce',n);}var s=d.getElementsByTagName('script')[0];s.parentNode.insertBefore(po, s);})();\n\n           // var initRecaptcha = function () { \n           //     // document.getElementById(\"SearchModule\").scope().vm.parent.isGrecaptchaLoaded = !0, \n           //     // document.getElementById(\"SearchModule\").scope().vm.showRecaptcha();\n           //     vm.showRecaptcha();\n           // };\n              \n\n        vm.user = null;\n        vm.allUsers = [];\n      \n\n        vm.action = $state.current.data.action;\n        vm.user = $rootScope.globals.currentUser;\n         ////console.log(\"$rootScope.globals.currentUser : \", $rootScope.globals.currentUser);\n\n        // // vm.club_id = $rootScope.globals.currentUser.current_club_instructor;\n        // if($rootScope.globals.currentUser.access){\n        //     // $rootScope.globals.currentUser.manager;\n        //     // $rootScope.globals.currentUser.pilot;\n        //     // $rootScope.globals.currentUser.instructor;\n\n        //     vm.combined_clubs = [].concat(\n        //       $rootScope.globals.currentUser.manager || [],\n        //       $rootScope.globals.currentUser.pilot || [],\n        //       $rootScope.globals.currentUser.instructor || []\n        //     );\n\n        // }\n        // vm.club_id = $rootScope.globals.currentUser;\n        vm.user_id = vm.user.id;\n\n        vm.exams = [];\n\n        \n        switch(vm.action){\n            \n            case \"student_records\":\n                // //console.log(\"view list of existing courses\");\n\n              \n\n                // CourseService.GetCoursesByClubId(vm.club_id)\n                //     .then(function(data){\n\n                //         vm.courses = data.items;\n\n                //     });\n\n                MemberService.GetAllByClubStudents(vm.club_id)\n                    .then(function(data){\n\n                        vm.courses = data.courses;\n                        vm.members = data.members;\n\n                    });\n\n               \n\n\n            break;\n            case \"student_record\":\n                console.log(\"view list of existing courses\", vm.user_id);\n\n                vm.student_id = vm.user_id;\n\n                \n\n\n                    //get clubs\n                    ClubService.GetAllForUser(vm.user_id).then(function(data){\n\n                        vm.clubs = data.clubs;\n                        if(vm.clubs.length < 2 && vm.clubs.length > 0){\n                            vm.club_id = vm.clubs[0].id;\n                            vm.update_club_selector();\n                        }\n                    });\n\n                    // CourseService.GetCoursesByUserId(vm.student_id)\n                    // .then(function(data){\n\n                    //     vm.courses = data.items;\n\n                    // });\n\n                    // CourseService.GetCoursesByClubId(vm.club_id)\n                    // .then(function(data){\n\n                    //     vm.courses = data.items;\n\n                    // });\n                    \n\n              \n\n               \n\n\n            break;\n            default:\n                // //console.log(\"none of the above... redirect somewhere?\");\n            break;\n        }  \n\n        vm.show_record = false;\n        vm.show_add_exam = false;\n\n        vm.update_club_selector = function(){\n\n            CourseService.GetCoursesByClubId(vm.club_id)\n                    .then(function(data){\n\n                        vm.courses = data.items;\n\n                    });\n        }\n\n        vm.load_records = function(){\n            if(!vm.member || !vm.course){\n                alert(\"You need to select a member and a course to see their training records\");\n            } else {\n                vm.student_id = vm.member.user_id;\n                vm.course_id = vm.course.id;\n\n                 CourseService.GetStudentTrainingRecords(vm.student_id, vm.course_id)\n                    .then(function(data){\n                        vm.show_record = true;\n                        vm.all_items = data.all_items;   \n                        vm.student = data.student;\n                        vm.training_records = data.training_records;   \n                        vm.exams = data.exams;\n                        vm.exam_records = data.exam_records;\n                        vm.course_totals = data.course_hours;\n                        vm.log_sheets = data.log_sheets;\n                    });\n\n            }\n        }\n\n        vm.get_initial = function(text){\n                return text.charAt(0);\n            }\n\n            vm.list_pilots = function(row){\n\n            var p1 = \"\";\n            var put = \"\";\n\n            // if(row.instructor_first_name && row.instructor_first_name !== null){\n            //     p1 = \"PIC: \"+row.instructor_first_name+\" \"+row.instructor_last_name;\n            //     put = \"<br />PUT: \"+row.first_name+\" \"+row.last_name;\n            // } else {\n            //     if(row.first_name && row.first_name !== null){\n            //         p1 = \"PIC: \"+row.first_name+\" \"+row.last_name;\n            //     } else {\n            //         p1 = \"PIC not yet set!\";\n            //     }\n            // }\n\n            p1 = \"PIC: \"+ vm.get_pic(row);\n            put = vm.get_put(row);\n            if(put && put !== \"\"){\n                put = \"<br />PUT: \" + put;\n            }\n\n            if(p1 && p1 == \"\"){\n                p1 = \"No PIC set yet!\";\n            }\n\n            return $sce.getTrustedHtml('<div>'+p1+' '+put+'</div>');\n\n        }\n\n        vm.get_pic = function(log){\n\n            var p1 = \"\";\n\n            if(log.pic_first_name && log.pic_first_name !== null){\n                p1 = vm.get_initial(log.pic_first_name) + \". \" + log.pic_last_name;\n            } else if(log.instructor_first_name && log.instructor_first_name !== \"\"){\n                p1 = vm.get_initial(log.instructor_first_name) + \". \" + log.instructor_last_name;\n            } else if(log.instructor_id == 0 && log.first_name && log.first_name !== \"\"){\n                p1 = vm.get_initial(log.first_name) + \". \" + log.last_name;\n            }\n\n            return p1;\n\n        }\n\n        vm.get_put = function(log){\n\n            var put = \"\";\n\n            if(log.put_first_name && log.put_first_name !== null){\n                put = vm.get_initial(log.put_first_name) + \". \" + log.put_last_name;\n            } else if(log.instructor_id > 0 && log.first_name && log.first_name !== \"\"){\n                put = vm.get_initial(log.first_name) + \". \" + log.last_name;\n            } \n\n            return put;\n\n        }\n\n        vm.get_hours_from_decimal = function(time){\n\n            if(time){\n                 var sign = time < 0 ? \"-\" : \"\";\n                 var hour = Math.floor(Math.abs(time));\n                 var min = Math.round((Math.abs(time) * 60) % 60);\n                 if(min == 60){\n                     hour++;\n                     min = 0;\n                 }\n                 return sign + (hour < 10 ? \"0\" : \"\") + hour + \":\" + (min < 10 ? \"0\" : \"\") + min;\n             } else {\n                 return \"N/A\";\n             }\n        }\n\n        vm.clean_times = function(time){\n                return time.substring(0,5);\n            }\n\n\n\n        vm.search3 = function(row){\n            //(angular.lowercase(row.first_name).indexOf(angular.lowercase($scope.my_search2) || '') !== -1)  || (angular.lowercase(row.last_name).indexOf(angular.lowercase($scope.my_search2) || '') !== -1)\n            ////console.log(\"answer\", (angular.lowercase(row.flight_date).indexOf(angular.lowercase($scope.my_search2) || '') !== -1));\n            // return ((angular.lowercase(row.flight_date).indexOf(angular.lowercase($scope.my_search2) || (angular.lowercase(row.flight_time).indexOf(angular.lowercase($scope.my_search2)) || '') !== -1)));\n            //(angular.lowercase(row.flight_date).indexOf(angular.lowercase($scope.my_search2) || '') !== -1)\n           \n            // if( (test_date($scope.my_search2, row.flight_date)) || (angular.lowercase(row.destination_airport).indexOf(angular.lowercase($scope.my_search2) || '') !== -1) || (angular.lowercase(row.departure_airport).indexOf(angular.lowercase($scope.my_search2) || '') !== -1) || (angular.lowercase(row.destination_airport_code).indexOf(angular.lowercase($scope.my_search2) || '') !== -1) || (angular.lowercase(row.departure_airport_code).indexOf(angular.lowercase($scope.my_search2) || '') !== -1)){\n            //     return true;\n            // } else {\n            //     return false;\n            // }\n            ////console.log($scope.my_search2);\n            if(!vm.my_search3 || (vm.my_search3 == \"\")){\n                return true;\n            }else if(test_date(vm.my_search3, row.flight_date)){\n                return true;\n            } else if(test_name(row.first_name, row.last_name, vm.my_search3 )){\n                return true;\n            } else if(test_name(row.pic_first_name, row.pic_last_name, vm.my_search3 )){\n                return true;\n            } else if(test_name(row.instructor_first_name, row.instructor_last_name, vm.my_search3 )){\n                return true;\n            } else if(test_aircraft(row.registration, vm.my_search3 )){\n                return true;\n            } else if(test_airfield(vm.my_search3, row.departure_airport, row.departure_airport_code)){\n                return true;\n            } else if(test_airfield(vm.my_search3, row.destination_airport, row.destination_airport_code)){\n                return true;\n            }else {\n                return false;\n            }\n\n            // we are testing for the date, the pilot, the departure and destination.\n\n            // return (angular.lowercase(row.flight_date).indexOf(angular.lowercase($scope.my_search2) || '') !== -1); // ? (angular.lowercase(row.flight_date).indexOf(angular.lowercase($scope.my_search2) || '') !== -1) : (angular.lowercase(row.flight_time).indexOf(angular.lowercase($scope.my_search2) || '') !== -1);\n\n        };\n\n        function test_date(search, date){\n\n\n            if(search.length < 2){\n                return false;\n            }\n\n            if(search && search.length <= 3){\n                if(date.indexOf(search) > -1){\n                    return true;\n                }\n            } else {\n                var parsed_date = \"\";\n                var b = moment(search);\n                if(b.isValid() && b.format(\"YYYY\") != \"2001\"){\n                    parsed_date = b.format(\"YYYY-MM-DD\");\n                } else if(b.isValid()){\n                    parsed_date = b.format(\"MM-DD\");\n                }\n\n\n                var search_type = 0;\n\n                if(parsed_date !== \"\" && date.indexOf(parsed_date) > -1){\n                    // //console.log(\"found\");\n                    return true;\n                } else {\n\n                    //backup in case of wrong parsing data::;\n                    //european method\n\n                    if(search.length <= 5 && search.length >= 4){\n\n                        var c = moment(search, \"DDMM\");\n                        // //console.log(\"C is : \", c);\n                        if(c.isValid()){\n                            var c2 = c.format(\"MM-DD\");\n                            if(date.indexOf(c2) > -1){\n                                return true;\n                            }\n                        }\n\n                    } else if(search.length == 8 || search.length == 10){\n                        \n                        var c = moment(search, \"DDMMYYYY\");\n                        // //console.log(\"C is : \", c);\n                        if(c.isValid()){\n                            var c2 = c.format(\"YYYY-MM-DD\");\n                            if(date.indexOf(c2) > -1){\n                                return true;\n                            }\n                        }\n\n                    }\n\n                    // //console.log(\"not found\");\n                    return false;\n                }\n            }\n\n        }\n\n\n        function test_name(fname, lname, search){\n\n            var search2 = search.toLowerCase();\n            var fullname = fname+\" \"+lname;\n            fullname = fullname.toLowerCase();    \n            // //console.log(\"fullname: \", fullname);\n            // //console.log(\"search: \", search2);\n            // //console.log(\"match: \", (fullname.indexOf(search2) > -1));\n            if(search.length > 2 && (fullname.indexOf(search2) > -1) ){\n                return true;\n            } else {\n                return false;\n            }\n\n        }\n\n        function test_aircraft(registration, search){\n\n            var search2 = search.toLowerCase().replace(\"-\", \"\");\n            var fullname = registration.replace(\"-\", \"\");\n            fullname = fullname.toLowerCase();    \n            //  //console.log(\"fullname: \", fullname);\n            // //console.log(\"search: \", search2);\n            // //console.log(\"match: \", (fullname.indexOf(search2) > -1));\n            if(search.length > 2 && (fullname.indexOf(search2) > -1) ){\n                return true;\n            } else {\n                return false;\n            }\n\n        }\n\n        function test_airfield(search, name, code){\n            var name2 = name.toLowerCase();\n            var code2 = code.toLowerCase();\n            var search2 = search.toLowerCase();\n\n            if(search2.length > 2 && (name2.indexOf(search2) > -1)){\n                return true;\n            } else if(search2.length > 2 && (code2.indexOf(search2) > -1)){\n                return true;\n            } else {\n                return false;\n            }\n\n\n\n        }\n\n        vm.load_records_user = function(){\n            if( !vm.course){\n                alert(\"You need to select a course to see your training records\");\n            } else {\n\n                vm.course_id = vm.course.id;\n\n                 CourseService.GetStudentTrainingRecords(vm.student_id, vm.course_id)\n                    .then(function(data){\n                        vm.show_record = true;\n                        vm.all_items = data.all_items;   \n                        vm.student = data.student;\n                        vm.training_records = data.training_records;   \n                        vm.exams = data.exams;\n                        vm.exam_records = data.exam_records;\n                        vm.course_totals = data.course_hours;\n                        vm.log_sheets = data.log_sheets;\n                    });\n\n            }\n        }\n\n        vm.load_selected_flight = function(flight_id){\n\n\n        }\n\n        vm.add_exam_record = function(){\n            //console.log(\"NEW EXAM\", vm.new_exam);\n            vm.new_exam.user_id = vm.student_id;\n            vm.new_exam.course_id = vm.course_id;\n            CourseService.CreateExamRecord(vm.new_exam)\n                                .then(function(data){\n                                    if(data.success){\n                                        vm.load_records();\n                                        vm.show_add_exam = false;\n\n                                        //clear the vm.new_exam\n\n                                    } else {\n                                        alert(\"The exam could not be added\");\n                                    }\n                                });\n        }\n\n        vm.get_remarks = function(item_id, record){\n\n             var object = record.items.find(function(item){ return item.lesson_item_id === item_id; });\n             \n\n            return (object) ? object.remarks : \"\";\n\n        }\n\n        vm.get_result = function(item_id, record){\n\n            var object = record.items.find(function(item){ return item.lesson_item_id === item_id; });\n\n            return (object) ? object.grade_name : \"\";\n\n        }\n\n        vm.get_result3 = function(item_id){\n\n            var object = record.items.find(function(item){ return item.lesson_item_id === item_id; });\n\n            return (object) ? object.grade_name : \"\";\n\n        }\n\n        vm.get_competence = function(item_id, record){\n\n            var object = record.items.find(function(item){ return item.lesson_item_id === item_id; });\n            var icons = \"\";\n            var icons2 = \"\";\n            if(object && object.grade_colour && object.grade_name){\n                icons = $sce.getTrustedHtml('<span style=\"color: '+object.grade_colour+'\" ><i class=\"fa fa-'+object.grade_icon+'\" style=\"color: '+object.grade_colour+'\"></i></span>');\n                \n                icons2 = $sce.trustAsHtml('<span style=\"color: '+object.grade_colour+'\" ><i class=\"fa fa-'+object.grade_icon+'\" style=\"color: '+object.grade_colour+'\"></i></span>');\n                // console.log(\"COLOUR: \"+object.grade_colour+\" AND NAME: \"+object.grade_name+\" AND TITLE: \"+object.grade_name);\n            }\n\n\n\n            return (object) ? icons2 : \"\";\n            \n        }\n\n        vm.get_competence2 = function(object){\n\n            //var object = record.items.find(function(item){ return item.lesson_item_id === item_id; });\n            var icons = \"\";\n            var icons2 = \"\";\n            if(object && object.grade_colour && object.grade_name){\n                icons = $sce.getTrustedHtml('<span style=\"color: '+object.grade_colour+'\" ><i class=\"fa fa-'+object.grade_icon+'\" style=\"color: '+object.grade_colour+'\"></i></span>');\n                \n                icons2 = $sce.trustAsHtml('<span style=\"color: '+object.grade_colour+'\" ><i class=\"fa fa-'+object.grade_icon+'\" style=\"color: '+object.grade_colour+'\"></i></span>');\n                // console.log(\"COLOUR: \"+object.grade_colour+\" AND NAME: \"+object.grade_name+\" AND TITLE: \"+object.grade_name);\n            }\n\n\n\n            return (object) ? icons2 : \"\";\n            \n        }\n\n        vm.get_flight_date = function(item_id, record){\n            var item = record.items.find(function(item){ return item.lesson_item_id === item_id; });\n            return (item) ? item.flight_date : \"\";\n        }\n\n        vm.user_can_edit = false;\n\n        vm.get_record_details = function(item_id, record){\n            \n            var item = record.items.find(function(item){ return item.lesson_item_id === item_id; });\n\n            if(item){\n\n\n                var record_details = \"<h4>Training Record Details</h4><table class='inner_overlay_tble'>\";\n\n                if(item.flight_date && item.flight_date !== \"\"){\n                    record_details += \"<tr><td>Flight Date:</td><td>\"+item.flight_date+\"</td></tr>\";\n                }\n\n                if(item.instructor_id > 0 && item.instructor_first_name !== \"\"){\n                    record_details += \"<tr><td><span class='instructor'>Instructor:</span></td><td>\"+vm.get_initial(item.instructor_first_name)+\" \"+item.instructor_last_name+\"</td></tr>\";\n                }\n\n                if(item.completed_by > 0 && item.completed_by_first_name !== \"\" && item.completed_by !== item.instructor_id){\n                    record_details += \"<tr><td><span class='instructor'>Record By:</span></td><td>\"+vm.get_initial(item.completed_by_first_name)+\" \"+item.completed_by_last_name+\"</td></tr>\";\n                }\n\n                if(item.remarks && item.remarks !== \"\"){\n                    record_details += \"<tr><td><span class='instructor'>Remarks:</td><td></td></tr><tr><td colspan='2'>\"+item.remarks+\"</td> </tr>\";\n                }\n\n                if(record_details && record_details !== \"\"){\n                    record_details += \"</table>\";\n                }\n\n\n\n                return $sce.getTrustedHtml(record_details);\n            } else{\n                return \" \";\n            }\n        }\n\n        vm.get_record_details2 = function(item){\n            \n            //var item = record.items.find(function(item){ return item.lesson_item_id === item_id; });\n\n            if(item){\n\n\n                var record_details = \"<h4>Training Record Details</h4><table class='inner_overlay_tble'>\";\n\n                if(item.flight_date && item.flight_date !== \"\"){\n                    record_details += \"<tr><td>Flight Date:</td><td>\"+item.flight_date+\"</td></tr>\";\n                }\n\n                if(item.registration && item.registration !== \"\"){\n                    record_details += \"<tr><td>Aircraft:</td><td>\"+item.registration+\"</td></tr>\";\n                    record_details += \"<tr><td>Type:</td><td>\"+item.plane_type+\"</td></tr>\";\n                }\n\n\n\n                if(item.instructor_id > 0 && item.instructor_first_name !== \"\"){\n                    record_details += \"<tr><td><span class='instructor'>Instructor:</span></td><td>\"+vm.get_initial(item.instructor_first_name)+\" \"+item.instructor_last_name+\"</td></tr>\";\n                }\n\n                if(item.completed_by > 0 && item.completed_by_first_name !== \"\" && item.completed_by !== item.instructor_id){\n                    record_details += \"<tr><td><span class='instructor'>Record By:</span></td><td>\"+vm.get_initial(item.completed_by_first_name)+\" \"+item.completed_by_last_name+\"</td></tr>\";\n                }\n\n                if(item.remarks && item.remarks !== \"\"){\n                    record_details += \"<tr><td><span class='instructor'>Remarks:</td><td></td></tr><tr><td colspan='2'>\"+item.remarks+\"</td> </tr>\";\n                }\n\n                if(record_details && record_details !== \"\"){\n                    record_details += \"</table>\";\n                }\n\n\n\n                return $sce.getTrustedHtml(record_details);\n            } else{\n                return \"This objective has not yet been marked as complete by your instructor\";\n            }\n        }\n\n        vm.get_exam = function(exam_id){\n\n            var object = vm.exam_records.find(function(item){ return item.exam_id === exam_id; });\n            return (object) ? object : \"\";\n        }\n\n        vm.open_training_detail = function(pls_id, plane_log_sheet){\n            vm.show_popup = true;\n            show_edit_training_record = false;\n            vm.show_popup_name = \"see_records\";\n            vm.flight_detail_id = pls_id;\n            vm.user_can_edit = vm.user_can_edit_record();\n\n            vm.selected_flight = plane_log_sheet;\n\n            //fetch the new one here?\n            vm.selected_record = {};\n            vm.selected_record_remarks = \"\";\n\n            CourseService.GetStudentTrainingRecordsForFlight(vm.student_id, vm.course_id, vm.flight_detail_id)\n                    .then(function(data){\n                        \n                        vm.competences = data.competences;   \n                        vm.selected_record = data.all_items;\n                        vm.selected_record_remarks = data.general_remarks;\n                        vm.this_entry = data.this_entry;\n\n                    });\n        }\n\n        vm.close_popup = function(){\n            vm.show_popup = false;\n\n            vm.show_edit_training_record = false;\n\n            vm.selected_record = {};\n            vm.selected_record_remarks = \"\";\n            vm.this_entry = {};\n\n        }\n\n\n        function load_course(){\n\n\n             ////console.log(\"PARAMS\", $state);\n            CourseService.GetCourseById($stateParams.course_id)\n                    .then(function(data){\n                        vm.course = data.item;   \n            \n                    });\n             \n            CourseService.GetExamsByCourseId($stateParams.course_id)\n                    .then(function(data){\n                        vm.course.exams = data.items;   \n                \n                    });\n\n            CourseService.GetLessonsByCourseId($stateParams.course_id)\n                    .then(function(data){\n                        vm.course.lessons = data.items;   \n                    });\n\n\n\n        }\n\n\n       \n\n       \n        $scope.back = function(){\n            $window.history.back();\n        }\n\n\n\n        initController();\n\n        function initController() {\n           //console.log(\"check if access is okay\");\n        }\n\n        vm.set_updated_search = function(){\n\n            if(vm.show_all_lessons){\n                vm.my_search = vm.my_search2;\n            } else {\n                    if(vm.my_search2.length > 1){\n                        vm.my_search = vm.my_search2;\n                    } else {\n                        vm.my_search = vm.lesson.id;\n                    }\n            }\n            \n        }\n        vm.all_tags = [];\n        vm.show_edit_training_record = false;\n        vm.show_edit_record = function(){\n\n            //OK let's edit some records!!!\n            vm.show_edit_training_record = true;\n            vm.lesson = vm.selected_record;\n            vm.plane_log_sheet = vm.selected_flight;//vm.lesson.log_sheets;\n\n            console.log(\"PLS : \", vm.plane_log_sheet);\n            console.log(\"TAGS : \", vm.plane_log_sheet.flight_tags);\n\n            CourseService.GetTagsByCourseId(vm.course_id)\n            .then(function(data){\n                for(var i=0;i<data.items.length;i++){\n                    data.items.flight_tag_id = data.items.id;\n                }  \n                vm.all_tags = data.items; \n            });\n\n            //cleaning it??\n            vm.selected_flight_tags = vm.plane_log_sheet.flight_tags;\n            for(var i=0;i<vm.selected_flight_tags.length;i++){\n                vm.selected_flight_tags[i][\"logging_time\"] = Math.round((vm.selected_flight_tags[i].tag_time * 60) / 5) * 5;\n            }\n\n\n            CourseService.GetExamsByCourseId(vm.course_id)\n                                .then(function(data){\n                                    vm.course.exams = data.items;   \n                            \n                                });\n\n            CourseService.GetLessonsByCourseId(vm.course_id)\n                    .then(function(data){\n                        vm.course.lessons = data.items;   \n                    });\n\n            vm.is_lesson_completed = (vm.this_entry.completed == 1)? true : false;\n\n        }\n\n        vm.tag_flight_time = 0;\n\n        vm.add_tag = function(){\n            //CHECK IF ADD DOES ALREADY EXIST!!!\n            if(vm.selected_flight_tags.find(tag => tag.flight_tag_id === vm.flight_tag.id)){\n                alert(\"You already have this tag on this flight!\");\n                return false;\n            }\n\n            //matching the correct tag IDs\n            vm.flight_tag.flight_tag_id = vm.flight_tag.id;\n\n            if((Math.round(vm.tag_flight_time / 5) * 5) > (vm.plane_log_sheet.brakes_times_rounded * 60)){\n                vm.tag_flight_time = (vm.plane_log_sheet.brakes_times_rounded * 60);\n                vm.tag_flight_time = Math.round(vm.tag_flight_time / 5) * 5;\n            }\n\n            if((Math.round(vm.tag_flight_time / 5) * 5) == 0){\n                vm.tag_flight_time = 5;\n            }\n\n            if(vm.tag_full_flight){\n                vm.tag_flight_time = (vm.plane_log_sheet.brakes_times_rounded * 60);\n                vm.tag_flight_time = Math.round(vm.tag_flight_time / 5) * 5;\n            }\n\n            vm.flight_tag.logging_time = vm.tag_flight_time;\n            // if(!vm.tag_full_flight){\n            //     vm.flight_tag.logging_time = Math.round(vm.tag_flight_time / 5) * 5;\n            // } else {\n            //     vm.flight_tag.logging_time = (vm.plane_log_sheet.brakes_times_rounded * 60);\n            //     vm.tag_flight_time = Math.round(vm.tag_flight_time / 5) * 5;\n            // }\n\n            vm.selected_flight_tags.push(vm.flight_tag);\n            vm.flight_tag = \"\";\n            vm.tag_flight_time = (vm.plane_log_sheet.brakes_times_rounded * 60);\n            vm.tag_flight_time = Math.round(vm.tag_flight_time / 5) * 5;\n            vm.tag_full_flight = true;\n        }\n\n        vm.delete_tag = function(tag, index){\n            vm.selected_flight_tags.splice(index, 1);\n\n        }\n\n        vm.tag_time_to_five = function(){\n            if(vm.tag_flight_time % 5 !== 0){\n                vm.tag_flight_time = Math.round(vm.tag_flight_time / 5) * 5;\n            }            \n        }\n\n\n        /*\n            vm.save_edit_record = function(){\n            console.log(\"SAVE THE UPDATE NOW!! WHOOP WHOOP!!\");\n\n            console.log(\"FLIGHT TAGS : \", vm.selected_flight_tags);\n\n            var compiled_items = [];\n            for(var i=0;i<vm.all_items.length;i++){\n                if( (vm.all_items[i].result && vm.all_items[i].result > 0) || (vm.all_items[i].remarks && vm.all_items[i].result !== \"\") ){\n                    compiled_items.push(vm.all_items[i]);\n                }\n            }\n\n            //some rough checks:::\n\n            // //console.log(\"PROGRESS: \", vm.general_remarks);\n            // //console.log(\"PROGRESS: \", compiled_items.length);\n\n            if(compiled_items.length < 1 && (!vm.general_remarks || vm.general_remarks == \"\")){\n                alert(\"To save student records, you need to tick at least one student progress record item OR add a general remark\");\n                return false;\n            }\n\n            var next_lesson = vm.lesson.id;\n\n            if(vm.lesson_completed == 1 && vm.next_lesson && vm.next_lesson.id > 0){\n                next_lesson = vm.next_lesson.id;\n            }\n\n\n            vm.compiled_save = {\n                club_id: vm.record_club_id,\n                items: compiled_items,\n                general_remarks: vm.general_remarks,\n                lesson_id: vm.lesson.id,\n                course_id: vm.course_id,\n                user_id: vm.student.id,\n                instructor_id: vm.instructor.id,\n                completed_by: vm.user.id,\n                plane_log_sheet_id: vm.plane_log_sheet.id,\n                next_lesson_id: next_lesson,\n                completed: (vm.lesson_completed) ? 1 : 0,\n                booking_id: vm.booking_id,\n                flight_tags: vm.selected_flight_tags\n            };\n            console.log(\"COMPILED SAVE\");\n            console.log(vm.compiled_save);\n            console.log(\"COMPILED SAVE\");\n\n        }\n\n        */\n\n        vm.save_edit_record = function(){\n\n            console.log(\"SAVE THE UPDATE NOW!! WHOOP WHOOP!!\");\n\n            console.log(\"THIS ENTRY : \", vm.this_entry);\n            console.log(\"FLIGHT TAGS : \", vm.selected_flight_tags);\n            console.log(\"SELECTED RECORD?? : \", vm.selected_record);\n\n            var compiled_items = [];\n            for(var i=0;i<vm.selected_record.length;i++){\n                if( (vm.selected_record[i].this_entry && (vm.selected_record[i].this_entry.result || vm.selected_record[i].this_entry.remarks) && (vm.selected_record[i].this_entry.result > -1 || vm.selected_record[i].this_entry.remarks !== \"\")) ){\n                    var entry = {\"remarks\": vm.selected_record[i].this_entry.remarks, \"result\": vm.selected_record[i].this_entry.result, \"lesson_item_id\": vm.selected_record[i].id};\n                    compiled_items.push(entry);\n                }\n            }\n// {\"id\":100,\"training_record_id\":6,\"lesson_item_id\":1,\"result\":4,\"completed_by\":2,\"remarks\":\"\",\"updated_at\":\"2024-10-31 18:46:17\",\"created_at\":\"2024-10-31 18:46:17\",\"deleted\":0,\"deleted_at\":\"0000-00-00 00:00:00\",\"grade_name\":\"Competent\",\"grade_icon\":\"star\",\"grade_colour\":\"#4CBB17\",\"plane_log_sheet_id\":138,\"general_remarks\":\"Flew very well almost there\",\"pic_id\":2,\"put_id\":3,\"user_id\":3,\"instructor_id\":2,\"flight_date\":\"2024-09-29\",\"plane_id\":13,\"instructor_first_name\":\"Alex\",\"instructor_last_name\":\"Reynier\",\"pic_first_name\":\"Alex\",\"pic_last_name\":\"Reynier\",\"put_first_name\":\"Camilla\",\"put_last_name\":\"Barber\",\"usr_first_name\":\"Camilla\",\"usr_last_name\":\"Barber\",\"completed_by_first_name\":\"Alex\",\"completed_by_last_name\":\"Reynier\",\"registration\":\"G-NIXIS\",\"plane_type\":\"C182\",\"type_name\":\"SKYLANE\"}}\n            //some rough checks:::\n\n            console.log(\"COMPILED ITEMS: \", compiled_items);\n            // //console.log(\"PROGRESS: \", compiled_items.length);\n\n            if(compiled_items.length < 1 && (!vm.general_remarks || vm.general_remarks == \"\")){\n                alert(\"To save student records, you need to tick at least one student progress record item OR add a general remark\");\n                return false;\n            }\n\n            var next_lesson = vm.this_entry.next_lesson_id;\n\n            console.log(\"NEXT LESSON: \", next_lesson);\n\n            if(vm.lesson_completed == 1 && vm.next_lesson && vm.next_lesson.id > 0){\n                next_lesson = vm.next_lesson.id;\n            }\n\n            console.log(\"NEXT LESSON: \", next_lesson);\n            console.log(\"vm.booking_id : \", vm.booking_id);\n\n            vm.compiled_save = {\n                update_record_id: vm.this_entry.id,\n                club_id: vm.this_entry.club_id,\n                items: compiled_items,\n                general_remarks: vm.this_entry.general_remarks,//vm.general_remarks,\n                lesson_id: vm.this_entry.lesson_id,\n                course_id: vm.this_entry.course_id,\n                user_id: vm.this_entry.user_id, // vm.student.id,\n                instructor_id: vm.this_entry.instructor_id,\n                completed_by: vm.this_entry.completed_by,\n                plane_log_sheet_id: vm.selected_flight.id,\n                next_lesson_id: next_lesson,\n                edited_by: vm.user.id,\n                completed: (vm.lesson_completed) ? 1 : 0,\n                //booking_id: vm.booking_id,\n                flight_tags: vm.selected_flight_tags,\n                edit_reason: vm.edit_reason\n            };\n\n            console.log(\"COMPILED SAVE\");\n            console.log(vm.compiled_save);\n            console.log(\"COMPILED SAVE\");\n\n            \n            //SENT THIS COMPILED SAVE TO THE SERVER\n\n\n            CourseService.UpdateTrainingRecord(vm.compiled_save, vm.this_entry.id)\n                .then(function(data){\n                    if(data.success){\n\n                        alert(\"THANK YOU!\");\n                        //$state.go('dashboard.manage_user', {reload: true});\n                        //vm.show_record = false;\n                        //vm.show_edit_record = false;\n                        \n\n                        CourseService.GetStudentTrainingRecords(vm.student_id, vm.course_id)\n                        .then(function(data){\n                            vm.show_record = true;\n                            vm.all_items = data.all_items;   \n                            vm.student = data.student;\n                            vm.training_records = data.training_records;   \n                            vm.exams = data.exams;\n                            vm.exam_records = data.exam_records;\n                            vm.course_totals = data.course_hours;\n                            vm.log_sheets = data.log_sheets;\n                        });\n\n                        vm.show_edit_training_record = false;\n                        vm.close_popup();\n\n                        //clearing this\n                        vm.lesson = {};\n                        vm.plane_log_sheet = {};\n                        vm.compiled_save = {};\n                        vm.this_entry = {};\n\n                    } else {\n                        alert(\"We could not save your training records...\");\n                    }\n        \n                });\n\n\n            // CLOSE THIS VIEW\n\n            // RELOAD THE BELOW VIEW\n\n\n\n\n            \n        }\n\n\n        vm.tag_full_flight = true;\n\n        vm.update_flight_tag = function(){\n            console.log(vm.plane_log_sheet);\n\n            vm.tag_full_flight = true;\n        }\n\n        vm.update_flight_full_flight = function(){\n\n            if((Math.round(vm.tag_flight_time / 5) * 5) > (vm.plane_log_sheet.brakes_times_rounded * 60)){\n                vm.tag_flight_time = (vm.plane_log_sheet.brakes_times_rounded * 60);\n                vm.tag_flight_time = Math.round(vm.tag_flight_time / 5) * 5;\n            }\n\n            if((Math.round(vm.tag_flight_time / 5) * 5) == 0){\n                vm.tag_flight_time = 5;\n            }\n\n            if(vm.tag_full_flight){\n                vm.tag_flight_time = (vm.plane_log_sheet.brakes_times_rounded * 60);\n                vm.tag_flight_time = Math.round(vm.tag_flight_time / 5) * 5;\n            } else {\n                console.log(\"tag full flight\");\n                console.log(vm.plane_log_sheet);\n            }\n            \n        }\n\n        vm.user_can_edit_record = function(){\n            // vm.training_records.club_id\n            // vm.user.access.manager\n            var is_manager = (vm.user.access.manager.find(function(item){ return item === vm.training_records.club_id; }))? true : false;\n\n            if(vm.training_records.instructor_id == vm.user_id || vm.user_id == vm.training_records.completed_by || is_manager){\n                console.log(\"should have access to edit this record\");\n                return true;\n            }\n\n            console.log(\"should NOT have access to edit this record - tempo return true though\");\n            //this should be false\n            return true;\n        }\n       \n\n\n    }\n app.controller('DashboardUserInstructorController', DashboardUserInstructorController);\n\n    DashboardUserInstructorController.$inject = ['UserService', 'MemberService', 'InstructorService', 'MembershipService', 'PlaneService', '$rootScope', '$location', '$scope', '$state', '$stateParams', '$uibModal', '$log', '$window'];\n    function DashboardUserInstructorController(UserService, MemberService, InstructorService, MembershipService, PlaneService, $rootScope, $location, $scope, $state, $stateParams, $uibModal, $log, $window) {\n        var vm = this;\n\n        vm.user = null;\n        vm.allUsers = [];\n        vm.club = {};\n        vm.page_title = \"\";\n        vm.club.member = {};\n        \n        vm.imported_new_headers = [];\n\n        // vm.club.member.membership_id = {};\n        \n        vm.action = $state.current.data.action;\n        \n\n        vm.user = $rootScope.globals.currentUser;\n        // vm.club_id = 6;\n        // vm.user_id = 59;\n        vm.user_id = vm.user.id;\n\n\n\n        vm.no_show_cols = [\"membership_start\", \"membership_id\", \"selected\"];\n\n\n        $scope.sortType     = 'Email'; // set the default sort type\n        $scope.sortReverse  = false;  // set the default sort order\n        $scope.searchTool   = '';     // set the default search/filter term\n\n\n\n\n          $scope.mytime = new Date();\n\n          $scope.hstep = 1;\n          $scope.mstep = 15;\n\n         vm.days = [\n            {\n                day: \"Monday\",\n                from_variable: \"monday_from_time\",\n                to_variable: \"monday_to_time\",\n                disabled_variable: \"monday_disabled\"\n            },\n            {\n                day: \"Tuesday\",\n                from_variable: \"tuesday_from_time\",\n                to_variable: \"tuesday_to_time\",\n                disabled_variable: \"tuesday_disabled\"\n            },\n            {\n                day: \"Wednesday\",\n                from_variable: \"wednesday_from_time\",\n                to_variable: \"wednesday_to_time\",\n                disabled_variable: \"wednesday_disabled\"\n            },\n            {\n                day: \"Thursday\",\n                from_variable: \"thursday_from_time\",\n                to_variable: \"thursday_to_time\",\n                disabled_variable: \"thursday_disabled\"\n            },\n            {\n                day: \"Friday\",\n                from_variable: \"friday_from_time\",\n                to_variable: \"friday_to_time\",\n                disabled_variable: \"friday_disabled\"\n            },\n            {\n                day: \"Saturday\",\n                from_variable: \"saturday_from_time\",\n                to_variable: \"saturday_to_time\",\n                disabled_variable: \"saturday_disabled\"\n            },\n            {\n                day: \"Sunday\",\n                from_variable: \"sunday_from_time\",\n                to_variable: \"sunday_to_time\",\n                disabled_variable: \"sunday_disabled\"\n            }\n         ];\n\n\n         var timezone = \"Europe/London\";\n\n        // var from_default = new Date(luxon.DateTime.now().setZone(timezone).toISO());\n        var from_default = new Date();\n        from_default.setHours( 9 );\n        from_default.setMinutes( 0 );\n\n        // var to_default = new Date(luxon.DateTime.now().setZone(timezone).toISO());\n        var to_default = moment.utc(\"2021-01-01T18:15:00Z\").toISOString(); //moment.utc(\"2021-01-01T09:00Z\").format(); //new Date();\n        // to_default.setHours( 18 );\n        // to_default.setMinutes( 0 );\n\n\n\n\n\n        InstructorService.GetAvailability(vm.user.id)\n                    .then(function(data){\n\n\n\n                        vm.available_times = data;\n                        for(var i =0;i<vm.available_times.length;i++){\n                            //resetting all the defaults to 9am to 5pm every single day - prob should be done in the backend...\n                            if(vm.available_times[i][\"monday_from_time\"] == vm.available_times[i][\"monday_to_time\"]){\n                                // alert(\"now monday ==> \", vm.available_times[i][\"monday_from_time\"]);\n                               vm.available_times[i][\"monday_from_time\"] = from_default;\n                               vm.available_times[i][\"monday_to_time\"] = to_default;\n                            }\n                            if(vm.available_times[i][\"tuesday_from_time\"] == vm.available_times[i][\"tuesday_to_time\"]){\n                               vm.available_times[i][\"tuesday_from_time\"] = from_default;\n                               vm.available_times[i][\"tuesday_to_time\"] = to_default;\n                            }\n                            if(vm.available_times[i][\"wednesday_from_time\"] == vm.available_times[i][\"wednesday_to_time\"]){\n                               vm.available_times[i][\"wednesday_from_time\"] = from_default;\n                               vm.available_times[i][\"wednesday_to_time\"] = to_default;\n                            }\n                            if(vm.available_times[i][\"thursday_from_time\"] == vm.available_times[i][\"thursday_to_time\"]){\n                               vm.available_times[i][\"thursday_from_time\"] = from_default;\n                               vm.available_times[i][\"thursday_to_time\"] = to_default;\n                            }\n                            if(vm.available_times[i][\"friday_from_time\"] == vm.available_times[i][\"friday_to_time\"]){\n                               vm.available_times[i][\"friday_from_time\"] = from_default;\n                               vm.available_times[i][\"friday_to_time\"] = to_default;\n                            }\n                            if(vm.available_times[i][\"saturday_from_time\"] == vm.available_times[i][\"saturday_to_time\"]){\n                               vm.available_times[i][\"saturday_from_time\"] = from_default;\n                               vm.available_times[i][\"saturday_to_time\"] = to_default;\n                            }\n                            if(vm.available_times[i][\"sunday_from_time\"] == vm.available_times[i][\"sunday_to_time\"]){\n                               vm.available_times[i][\"sunday_from_time\"] = from_default;\n                               vm.available_times[i][\"sunday_to_time\"] = to_default;\n                            }\n\n\n                            // console.log(\"MONDAY === \");\n                            // console.log(\"DEFAULT: \", vm.available_times[i][\"monday_from_time\"] );\n                            // var a = vm.available_times[i][\"monday_from_time\"];\n                            // var b = a.split(\":\");\n                            // console.log(\"SPLIT: \", b);\n                            // console.log(\"COMPOSED: \"+b[0]+\" and \"+b[1]);\n                            // console.log(\"PARSE\", Date.parse(\"2021-01-01T\"+vm.available_times[i][\"monday_from_time\"]+\"Z\", \"HH:mm:s\")  );\n                            // console.log(\"PARSE2\", Date.parseString(Date.parse(\"2021-01-01T\"+vm.available_times[i][\"monday_from_time\"]+\"Z\").toString(), \"HH:mm:s\")  );\n                            // //console.log('LUXON ', luxon.DateTime().fromFormat(vm.available_times[i][\"monday_from_time\"], \"HH:mm:s\") );\n                            // console.log(\"PARSE3: \", Date.parseString(vm.available_times[i][\"monday_to_time\"], \"HH:mm:s\"));\n                            // console.log(\"PARSE4: \", luxon.DateTime.fromISO(\"2021-01-01T\"+vm.available_times[i][\"monday_from_time\"]+\"Z\").setZone(\"Europe/London\").toLocaleString(luxon.DateTime.DATETIME_FULL)   ); //.toFormat('dd MMM yyyy HH:mm:s')\n\n\n                            vm.available_times[i][\"monday_from_time\"] = new Date(luxon.DateTime.fromISO(\"2021-01-01T\"+vm.available_times[i][\"monday_from_time\"]+\"Z\").setZone(\"UTC\").toHTTP()) ; //Date(luxon.DateTime.now(), \"HH:mm:s\");//Date.parseString(Date.parse(\"2021-01-01T\"+vm.available_times[i][\"monday_from_time\"]+\"Z\"), \"HH:mm:s\") ;//luxon.DateTime().fromFormat(vm.available_times[i][\"monday_from_time\"], \"HH:mm:s\") ;//Date.parseString(vm.available_times[i][\"monday_from_time\"], \"HH:mm:s\");\n                            vm.available_times[i][\"monday_to_time\"] = new Date(luxon.DateTime.fromISO(\"2021-01-01T\"+vm.available_times[i][\"monday_to_time\"]+\"Z\").setZone(\"UTC\").toHTTP());// Date.parseString(vm.available_times[i][\"monday_to_time\"], \"HH:mm:s\");\n                            vm.available_times[i][\"monday_disabled\"] = parseInt(vm.available_times[i][\"monday_disabled\"]);\n\n                            vm.available_times[i][\"tuesday_from_time\"] = new Date(luxon.DateTime.fromISO(\"2021-01-01T\"+vm.available_times[i][\"tuesday_from_time\"]+\"Z\").setZone(\"UTC\").toHTTP()) ; //Date.parseString(vm.available_times[i][\"tuesday_from_time\"], \"HH:mm:s\");\n                            vm.available_times[i][\"tuesday_to_time\"] = new Date(luxon.DateTime.fromISO(\"2021-01-01T\"+vm.available_times[i][\"tuesday_to_time\"]+\"Z\").setZone(\"UTC\").toHTTP()) ; //Date.parseString(vm.available_times[i][\"tuesday_to_time\"], \"HH:mm:s\"); \n                            vm.available_times[i][\"tuesday_disabled\"] = parseInt(vm.available_times[i][\"tuesday_disabled\"]);\n\n                            vm.available_times[i][\"wednesday_from_time\"] = new Date(luxon.DateTime.fromISO(\"2021-01-01T\"+vm.available_times[i][\"wednesday_from_time\"]+\"Z\").setZone(\"UTC\").toHTTP()) ;//Date.parseString(vm.available_times[i][\"wednesday_from_time\"], \"HH:mm:s\");\n                            vm.available_times[i][\"wednesday_to_time\"] = new Date(luxon.DateTime.fromISO(\"2021-01-01T\"+vm.available_times[i][\"wednesday_to_time\"]+\"Z\").setZone(\"UTC\").toHTTP()) ;//Date.parseString(vm.available_times[i][\"wednesday_to_time\"], \"HH:mm:s\");\n                            vm.available_times[i][\"wednesday_disabled\"] = parseInt(vm.available_times[i][\"wednesday_disabled\"]);\n\n                            vm.available_times[i][\"thursday_from_time\"] = new Date(luxon.DateTime.fromISO(\"2021-01-01T\"+vm.available_times[i][\"thursday_from_time\"]+\"Z\").setZone(\"UTC\").toHTTP()) ;//Date.parseString(vm.available_times[i][\"thursday_from_time\"], \"HH:mm:s\");\n                            vm.available_times[i][\"thursday_to_time\"] = new Date(luxon.DateTime.fromISO(\"2021-01-01T\"+vm.available_times[i][\"thursday_to_time\"]+\"Z\").setZone(\"UTC\").toHTTP()) ;//Date.parseString(vm.available_times[i][\"thursday_to_time\"], \"HH:mm:s\");\n                            vm.available_times[i][\"thursday_disabled\"] = parseInt(vm.available_times[i][\"thursday_disabled\"]);\n\n                            vm.available_times[i][\"friday_from_time\"] = new Date(luxon.DateTime.fromISO(\"2021-01-01T\"+vm.available_times[i][\"friday_from_time\"]+\"Z\").setZone(\"UTC\").toHTTP()) ; //Date.parseString(vm.available_times[i][\"friday_from_time\"], \"HH:mm:s\");\n                            vm.available_times[i][\"friday_to_time\"] = new Date(luxon.DateTime.fromISO(\"2021-01-01T\"+vm.available_times[i][\"friday_to_time\"]+\"Z\").setZone(\"UTC\").toHTTP()) ; //Date.parseString(vm.available_times[i][\"friday_to_time\"], \"HH:mm:s\");\n                            vm.available_times[i][\"friday_disabled\"] = parseInt(vm.available_times[i][\"friday_disabled\"]);\n\n                            vm.available_times[i][\"saturday_from_time\"] = new Date(luxon.DateTime.fromISO(\"2021-01-01T\"+vm.available_times[i][\"saturday_from_time\"]+\"Z\").setZone(\"UTC\").toHTTP()) ;///Date.parseString(vm.available_times[i][\"saturday_from_time\"], \"HH:mm:s\");\n                            vm.available_times[i][\"saturday_to_time\"] = new Date(luxon.DateTime.fromISO(\"2021-01-01T\"+vm.available_times[i][\"saturday_to_time\"]+\"Z\").setZone(\"UTC\").toHTTP()) ;///Date.parseString(vm.available_times[i][\"saturday_to_time\"], \"HH:mm:s\");\n                            vm.available_times[i][\"saturday_disabled\"] = parseInt(vm.available_times[i][\"saturday_disabled\"]);\n\n                            vm.available_times[i][\"sunday_from_time\"] = new Date(luxon.DateTime.fromISO(\"2021-01-01T\"+vm.available_times[i][\"sunday_from_time\"]+\"Z\").setZone(\"UTC\").toHTTP()) ;//Date.parseString(vm.available_times[i][\"sunday_from_time\"], \"HH:mm:s\");\n                            vm.available_times[i][\"sunday_to_time\"] = new Date(luxon.DateTime.fromISO(\"2021-01-01T\"+vm.available_times[i][\"sunday_to_time\"]+\"Z\").setZone(\"UTC\").toHTTP()) ;//Date.parseString(vm.available_times[i][\"sunday_to_time\"], \"HH:mm:s\");\n                            vm.available_times[i][\"sunday_disabled\"] = parseInt(vm.available_times[i][\"sunday_disabled\"]);\n\n\n\n\n                        }\n\n                        if(vm.available_times.length == 1){\n\n\n\n\n                            if(vm.available_times[0][\"monday_from_time\"] == vm.available_times[0][\"monday_to_time\"]){\n                                // alert(\"now monday ==> \", vm.available_times[i][\"monday_from_time\"]);\n                               vm.available_times[0][\"monday_from_time\"] = from_default;\n                               vm.available_times[0][\"monday_to_time\"] = to_default;\n                            }\n                            if(vm.available_times[0][\"tuesday_from_time\"] == vm.available_times[0][\"tuesday_to_time\"]){\n                               vm.available_times[0][\"tuesday_from_time\"] = from_default;\n                               vm.available_times[0][\"tuesday_to_time\"] = to_default;\n                            }\n                            if(vm.available_times[0][\"wednesday_from_time\"] == vm.available_times[0][\"wednesday_to_time\"]){\n                               vm.available_times[0][\"wednesday_from_time\"] = from_default;\n                               vm.available_times[0][\"wednesday_to_time\"] = to_default;\n                            }\n                            if(vm.available_times[0][\"thursday_from_time\"] == vm.available_times[0][\"thursday_to_time\"]){\n                               vm.available_times[0][\"thursday_from_time\"] = from_default;\n                               vm.available_times[0][\"thursday_to_time\"] = to_default;\n                            }\n                            if(vm.available_times[0][\"friday_from_time\"] == vm.available_times[0][\"friday_to_time\"]){\n                               vm.available_times[0][\"friday_from_time\"] = from_default;\n                               vm.available_times[0][\"friday_to_time\"] = to_default;\n                            }\n                            if(vm.available_times[0][\"saturday_from_time\"] == vm.available_times[0][\"saturday_to_time\"]){\n                               vm.available_times[0][\"saturday_from_time\"] = from_default;\n                               vm.available_times[0][\"saturday_to_time\"] = to_default;\n                            }\n                            if(vm.available_times[0][\"sunday_from_time\"] == vm.available_times[0][\"sunday_to_time\"]){\n                               vm.available_times[0][\"sunday_from_time\"] = from_default;\n                               vm.available_times[0][\"sunday_to_time\"] = to_default;\n                            }\n\n\n                            //instructor of only one club\n                            //alert(\"only 1\");\n\n                            vm.selected_club = vm.available_times[0];\n\n\n                            //console.log(\"selected is : \"+vm.selected_club);\n                            //console.log(vm.selected_club);\n                            //console.log(vm.selected_club.club_id);\n\n                            vm.selected_now = $.grep(vm.available_times, function(e){ \n                                    return e.club_id == vm.selected_club.club_id; \n                            });\n                            //console.log(vm.selected_now);\n                            vm.available_time = vm.selected_now[0];\n\n\n                        }\n\n\n\n\n\n                    });\n\n\n// Some testing variables\n\n        // vm.available_times = [{\n        //     club_id: 6,\n        //     club_name: \"Alex's Club\",\n            \n        //     monday_from_time: from_default,\n        //     monday_to_time: to_default,\n        //     monday_disabled: false,\n\n        //     tuesday_from_time: from_default,\n        //     tuesday_to_time: to_default,\n        //     tuesday_disabled: false,\n\n        //     wednesday_from_time: from_default,\n        //     wednesday_to_time: to_default,\n        //     wednesday_disabled: false,\n\n        //     thursday_from_time: from_default,\n        //     thursday_to_time: to_default,\n        //     thursday_disabled: false,\n\n        //     friday_from_time: from_default,\n        //     friday_to_time: to_default,\n        //     friday_disabled: false,\n\n        //     saturday_from_time: from_default,\n        //     saturday_to_time: to_default,\n        //     saturday_disabled: false,\n\n        //     sunday_from_time: from_default,\n        //     sunday_to_time: to_default,\n        //     sunday_disabled: false\n\n        // },\n        // {\n\n        //     club_id: 8,\n        //     club_name: \"Alouette Club\",\n\n        //     monday_from_time: from_default,\n        //     monday_to_time: to_default,\n        //     monday_disabled: false,\n\n        //     tuesday_from_time: from_default,\n        //     tuesday_to_time: to_default,\n        //     tuesday_disabled: false,\n\n        //     wednesday_from_time: from_default,\n        //     wednesday_to_time: to_default,\n        //     wednesday_disabled: false,\n\n        //     thursday_from_time: from_default,\n        //     thursday_to_time: to_default,\n        //     thursday_disabled: false,\n\n        //     friday_from_time: from_default,\n        //     friday_to_time: to_default,\n        //     friday_disabled: false,\n\n        //     saturday_from_time: from_default,\n        //     saturday_to_time: to_default,\n        //     saturday_disabled: false,\n\n        //     sunday_from_time: from_default,\n        //     sunday_to_time: to_default,\n        //     sunday_disabled: false\n\n        // }];\n\n\n       \n\n        // if(vm.available_times.length > 1){\n        //     vm.available_time = vm.available_times[0]; //this will be the selected state.\n        //     vm.selected_club = vm.available_times[0]; //this will be the selected state.\n        // } else {\n        //     vm.available_time = vm.available_times[0]; //this will be the selected state.\n        //     vm.selected_club = vm.available_times[0]; //this will be the selected state.\n        // }\n\n        $scope.ismeridian = false;\n        $scope.toggleMode = function() {\n            $scope.ismeridian = ! $scope.ismeridian;\n        };\n\n        $scope.update_time = function(name) {\n            var d = new Date();\n            d.setHours( 14 );\n            d.setMinutes( 0 );\n            vm.available_time[name] = d;\n        };\n\n          $scope.changed_time = function(name) {\n            console.log('Time changed to: ' + vm.available_time[name]);\n          };\n\n          $scope.disable_time = function(day){\n            vm.available_time[day] = (vm.available_time[day]) ? false : true;\n          }\n\n          $scope.change_club = function(){\n            //console.log(\"selected is : \"+vm.selected_club);\n            //console.log(vm.selected_club);\n            //console.log(vm.selected_club.club_id);\n\n            vm.selected_now = $.grep(vm.available_times, function(e){ \n                    return e.club_id == vm.selected_club.club_id; \n            });\n            //console.log(vm.selected_now);\n            vm.available_time = vm.selected_now[0];\n\n            // vm.available_time = vm.selected_club;\n          }\n\n          $scope.save_club_times = function(){\n\n            //vm.available_times\n            //console.log(\"selected club is:\", vm.available_time);\n            //console.log(\"selected club is:\", vm.selected_club);\n            //.toUTCString()\n            //actually update it...\n\n  \n\n\n            InstructorService.SetAvailability(vm.available_time)\n                    .then(function(data){\n                        //console.log(\"CHECK IT HAS BEEN DEALT WITH\");\n                        //console.log(data);\n\n\n\n                    });\n\n                    //console.log(\"LENGTH BEFORE: \"+vm.available_times.length);\n            \n                    vm.available_times = $.grep(vm.available_times, function(e){ \n                                return e.club_id != vm.available_time.club_id; \n                        });\n                    //console.log(\"LENGTH AFTER: \"+vm.available_times.length);\n\n                    //console.log(\"PUSING: \");\n                    //console.log(vm.available_time);\n\n                    vm.available_times.push(vm.available_time);\n\n                    $state.go('dashboard.manage_user.instructor_availability');\n\n            \n\n          }\n\n          // $scope.clear = function() {\n          //   $scope.mytime = null;\n          // };\n\n\n/* ----------------------------------------------------------------------- */\n\n\n\n\n/* ------------------------------------------------------------------------ */\n\n\n\n\n\n\n\n\n\n\n        ////console.log(\"club_id : \"+vm.club_id);\n\n        // //console.log(vm.action);\n        // //console.log($stateParams);\n        // //console.log($stateParams.id);\n\n        switch(vm.action){\n            case \"add\":\n                //console.log(\"adding a new member please\");\n                vm.page_title = \"Add a New member\";\n\n                \n\n            break;\n            case \"edit\":\n                //console.log(\"edit an existing membership\");\n\n                MemberService.GetMemberPlanes($stateParams.member_id, vm.club_id)\n                    .then(function(data){\n                        vm.club.planes = data;   \n                        //console.log(vm.club.planes);\n                    });\n\n                 MemberService.GetById($stateParams.member_id, vm.club_id)\n                    .then(function(data){\n                        vm.club.member = data;   \n                        //console.log(vm.club);\n                        vm.club.member.is_manager = (vm.club.member.is_manager == 1) ? true : false;\n                        vm.club.member.approved = (vm.club.member.approved == 1) ? true : false;\n                        vm.club.member.instructor = (vm.club.member.instructor == 1) ? true : false;\n                        vm.club.member.membership_start = Date.parse(vm.club.member.membership_start);\n                        vm.page_title = \"Edit a Member - \"+vm.club.member.first_name+\" \"+vm.club.member.last_name;\n\n                        vm.club.member.membership_start = new Date(vm.club.member.membership_start);\n\n                        // $(\"#membership_start\").datepicker({\n                        //     format: 'dd-mm-yyyy',\n                        //     startDate: vm.club.member.membership_start,\n                        //     endDate: ''\n                        //   }).on(\"show\", function() {\n                        //     $(this).val(new Date()).datepicker('update');\n                        //   });\n\n                    });\n\n                 MembershipService.GetAllByClub(vm.club_id)\n                    .then(function(data){\n                        vm.club.memberships = data;   \n                        // vm.club.member.membership_id.selected = vm.club.member.membership_id;\n                        // vm.membership = vm.club.member.membership_name;\n                        // vm.club.membership = vm.club.member.membership_name;\n                        //console.log(vm.club.memberships);\n                    });\n            break;\n            case \"list\":\n                //need to update this to be part of the authentication\n                //to find out club id\n                MemberService.GetAllByClub(vm.club_id)\n                    .then(function(data){\n                        vm.club.members = data;   \n                        //console.log(vm.club.members);\n                    });\n\n                 MembershipService.GetAllByClub(vm.club_id)\n                    .then(function(data){\n                        vm.club.memberships = data;   \n                        // vm.club.member.membership_id.selected = vm.club.member.membership_id;\n                        // vm.membership = vm.club.member.membership_name;\n                        // vm.club.membership = vm.club.member.membership_name;\n                        //console.log(vm.club.memberships);\n                    });\n                $scope.checkAll = function () {\n                    //console.log(\"check all\");\n                    if ($scope.selectedAll) {\n                        $scope.selectedAll = true;\n                    } else {\n                        $scope.selectedAll = false;\n                    }\n                    angular.forEach(vm.club.members, function(member) {\n                        member.selected = $scope.selectedAll;\n                    });\n                };\n\n\n            break;\n            default:\n                //console.log(\"none of the above... redirect somewhere?\");\n            break;\n        }  \n\n        //'9' needs to refer the the user's account set to manage\n       \n        $scope.back = function(){\n            $window.history.back();\n        }\n\n        $scope.save = function(){\n            if(vm.action == \"add\"){\n                //console.log(\"CREATE click\");\n                $scope.create();\n            } else {\n                //console.log(\"EDIT click\");\n                //console.log(vm.club.membership);\n                $scope.update();\n            }\n        }\n\n\n\n\n        // $scope.readCSV = function() {\n        //     // http get request to read CSV file content\n        //     $http.get('/angular/sample.csv').success($scope.processData);\n        // };\n\n\n        $scope.csvToJSON = function(content) {\n                var lines=content.csv.split(/\\r\\n|\\n/);\n                var result = [];\n                var start = 0;\n                lines[0] += \",membership_id,membership_start,selected\";\n                for (var j=1; j<lines.length; j++) {\n                    lines[j] += \",membership_id,membership_start,true\";\n                }\n                var columnCount = lines[0].split(content.separator).length;\n\n                var headers = [];\n                if (content.header) {\n                    headers=lines[0].split(content.separator);\n                    vm.imported_headers = headers;\n                    start = 1;\n                }\n\n                for (var i=start; i<lines.length; i++) {\n                    var obj = {};\n                        var currentline=lines[i].split(new RegExp(content.separator+'(?![^\"]*\"(?:(?:[^\"]*\"){2})*[^\"]*$)'));\n                        if ( currentline.length === columnCount ) {\n                            if (content.header) {\n                                for (var j=0; j<headers.length; j++) {\n                                    obj[headers[j]] = currentline[j];\n                                }\n                            } else {\n                                for (var k=0; k<currentline.length; k++) {\n                                    obj[k] = currentline[k];\n                                }\n                            }\n                            result.push(obj);\n                        }\n                   \n                }\n\n                //result = $scope.toPrettyJSON(result, 2);\n                //console.log(result);\n\n                return result;\n            };\n\n       \n\n\n        $scope.processData = function() {\n            //get the stuff\n            allText = vm.import_users;\n            var tobesorter = {\n                csv: vm.import_users,\n                separator: \",\",\n                header: true\n            }\n            vm.imported_users = $scope.csvToJSON(tobesorter);\n\n             for(var b=0;b<vm.imported_users.length;b++){\n                if(vm.imported_users[b].membership_start){\n                    vm.imported_users[b].membership_start = new Date(vm.imported_users[b].membership_start);\n                } else {\n                    vm.imported_users[b].membership_start = new Date();\n                }\n                //below set the default membership perhaps?\n                vm.imported_users[b].membership_id = 4;\n                vm.imported_users[b].membership = { membership_id: 4, membership_name: \"Annual Membership\" };\n            }\n\n            // split content based on new line\n            // var allTextLines = allText.split(/\\r\\n|\\n/);\n            // var headers = allTextLines[0].split(',');\n            // var lines = [];\n\n            // for ( var i = 0; i < allTextLines.length; i++) {\n            //     // split content based on comma\n            //     var data = allTextLines[i].split(',');\n            //     if (data.length == headers.length) {\n            //         var tarr = [];\n            //         for ( var j = 0; j < headers.length; j++) {\n            //             tarr.push(data[j]);\n            //         }\n            //         lines.push(tarr);\n            //     }\n            // }\n            // $scope.data = lines;\n        };\n       \n\n        vm.user_columns = {\n            first_name: \"First Name\", \n            last_name: \"Last Name\", \n            email: \"Email Address\",\n            dob: \"Date of Birth\",\n            membership_number: \"Membership Number\", \n            membership_start: \"Membership Start Date\",\n            membership_id: \"Membership Name\"\n        };\n\n\n        $scope.import_column = function(name){\n            // //console.log(\"update the field\");\n            // for(var i = 0; i < vm.imported_users.length; i++){\n            //     var original_val = vm.imported_users[i][name];\n            //     delete vm.imported_users[i][name];\n            //     vm.imported_users[i][vm.change_col_to] = original_val;\n            //     //console.log(vm.imported_users[i]);\n            // }\n\n        }\n\n\n        $scope.import_users = function(){\n            //console.log(\"import some users now\");\n\n\n            //first let's ignore the ones that weren't in the list\n            vm.imported_users = $.grep(vm.imported_users, function(e){ \n                    return e.selected != \"false\"; \n            });\n\n           \n            // //console.log(vm.imported_users);\n            // //console.log(vm.imported_headers);\n            // //console.log(vm.imported_new_headers);\n\n            //we need to verify that at least first name and last name in addition to email is present in the columns selected.\n            if(vm.imported_new_headers.indexOf(\"first_name\") > -1 && vm.imported_new_headers.indexOf(\"last_name\") > -1 && vm.imported_new_headers.indexOf(\"email\") > -1){\n                //console.log(\"ALL HEADERS HERE ! YAY!\");\n                \n                for(var b=0;b<vm.imported_users.length;b++){\n                    if(vm.imported_users[b].membership){\n                        if(vm.imported_users[b].membership.membership_id){\n                            vm.imported_users[b][\"membership_id\"] = vm.imported_users[b].membership.membership_id;\n                            delete vm.imported_users[b].membership;\n                        }\n                    }\n                }\n\n                //console.log(\"===--->===\");\n                //console.log(vm.imported_users);\n                //console.log(\"===--->===\");\n\n                vm.imported_new_headers.push(\"membership_id\");\n                vm.imported_new_headers.push(\"membership_start\");\n\n                //now we generate the users with the correct headings for our tables\n                var to_import_users = [];\n                for(var d=0; d<vm.imported_users.length;d++){\n                    var obj = {\n                        user: {},\n                        club_id: vm.club_id\n                    };\n                    for(var c=0; c<vm.imported_new_headers.length;c++){\n                        if(vm.imported_new_headers[c]){\n                            //console.log(vm.imported_new_headers[c]);\n                            if(vm.imported_new_headers[c] == \"first_name\" || vm.imported_new_headers[c] == \"last_name\" || vm.imported_new_headers[c] == \"dob\" || vm.imported_new_headers[c] == \"email\"){\n                                obj[\"user\"][vm.imported_new_headers[c]] = vm.imported_users[d][Object.keys(vm.imported_users[d])[c]];\n                            } else {\n                                if(vm.imported_new_headers[c] == \"membership_start\" || vm.imported_new_headers[c] == \"membership_id\"){\n                                    obj[vm.imported_new_headers[c]] = vm.imported_users[d][vm.imported_new_headers[c]];\n                                } else {\n                                    obj[vm.imported_new_headers[c]] = vm.imported_users[d][Object.keys(vm.imported_users[d])[c]];\n                                }\n                            }\n                            //we can push this into a new object with new key!\n                        } else {\n                            //we ignore this one...\n                            //console.log(\"blank\");\n                        }\n                    }\n                    to_import_users.push(obj);\n                }\n                //console.log(\"--==--\");\n                //console.log(to_import_users);\n                //console.log(\"--==--\");\n\n                //now that we have what we want to add to our \n                MemberService.CreateMany(to_import_users)\n                .then(function(data){\n                    //console.log(data);\n                    $state.go('dashboard.manage_club.members');\n                });\n\n            } else {\n                //console.log(\"missing key elements in headers!\");\n                alert(\"You must select the First Name, Last Name and Email Address to be able to add the user to the system!\");\n            }\n        \n\n\n        }\n\n\n        $scope.create = function(){\n            //console.log(\"CREATE ME NOW\");\n            vm.club.member.club_id = vm.club_id;\n            MemberService.Create(vm.club.member)\n                .then(function(data){\n                    //console.log(data);\n                    $state.go('dashboard.manage_club.members');\n                });\n        }\n\n        $scope.delete = function(){\n            //console.log(\"CLICK\");\n            alert(\"Are you sure you would like to delete this membership?\");\n            MemberService.Update(vm.club.membership)\n                .then(function(data){\n                    //console.log(data);\n                });\n        }\n\n        $scope.update = function(){\n            //console.log(\"CLICK\");\n            vm.club.member.club_id = vm.club_id;\n           \n            MemberService.Update(vm.club.member)\n                        .then(function(data){\n                            //console.log(data);\n                            //console.log(\"saved\");\n                            $state.go('dashboard.manage_club.members');\n                        });\n                        \n            MemberService.SaveMemberPlanes(vm.club.member.id, vm.club.member.club_id, vm.club.planes)\n                .then(function(data){\n                    //console.log(data);\n                    //console.log(\"saved THE PLANES\");\n                     \n                });\n\n                //         function SaveMemberPlanes(user_id, club_id, planes){\n\n        }\n\n        $scope.selected_members = function(type){\n            //get the selected members\n            //console.log(vm.club.members);\n            vm.selected_members = $.grep(vm.club.members, function(e){ \n                return e.selected == true; \n            });\n            //console.log(vm.selected_members);\n\n            //type is the action required...\n            \n\n            for(var j=0;j < vm.selected_members.length; j++){\n\n                if(type == \"approve\"){\n                    vm.selected_members[j].approved = 1;\n                } else {\n                    vm.selected_members[j].approved = 0;\n                }\n                //console.log(\"here\");\n                MemberService.Update(vm.selected_members[j])\n                    .then(function(data){\n                        //console.log(data);\n                        //console.log(\"saved\");\n                    });\n            }\n\n            $state.go('dashboard.manage_club.members');\n\n        }\n\n        $scope.update_membership = function(item, model){\n            vm.club.member.membership_id = item.membership_id;\n            vm.club.member.membership_name = item.membership_name;\n        }\n\n        initController();\n\n        function initController() {\n           //console.log(\"check if access is okay\");\n        }\n\n\n        var warning_msg = \"By deleting this membership, you will also cancel all reservations that this membership currently has.\"\n\n        $scope.open = function (member_id) {\n            var modalInstance = $uibModal.open({\n              animation: true,\n              templateUrl: 'views/modals/deleteModal.html',\n              controller: 'ModalInstanceCtrl',\n              size: \"lg\",\n              resolve: {\n                id: function () {\n                  return member_id;\n                },\n                warning: function(){\n                    return warning_msg;\n                }\n              }\n            });\n            modalInstance.result.then(function (member_id) {\n              $log.info('PRESSED GO: '+member_id);\n              MemberService.Delete(member_id)\n              .then(function(){\n                //console.log(\"HELLO DELETE\");\n                //update view?\n                 vm.club.members = $.grep(vm.club.members, function(e){ \n                    return e.id != member_id; \n                });\n              })\n            }, function () {\n              $log.info('Modal dismissed at: ' + new Date());\n            });\n          };\n\n         \n\n\n    }\n app.controller('DashboardUserInstructorHolidayController', DashboardUserInstructorHolidayController);\n\n    DashboardUserInstructorHolidayController.$inject = ['UserService', 'MemberService', 'InstructorService', 'MembershipService', 'HolidayService', '$rootScope', '$location', '$scope', '$state', '$stateParams', '$uibModal', '$log', '$window', '$compile', '$timeout', 'uiCalendarConfig'];\n    function DashboardUserInstructorHolidayController(UserService, MemberService, InstructorService, MembershipService, HolidayService, $rootScope, $location, $scope, $state, $stateParams, $uibModal, $log, $window, $compile, $timeout, uiCalendarConfig) {\n        var vm = this;\n\n        var defaultStartTime = 480;\n        var defaultEndTime = 1080;\n\n        $scope.va1 = '123';\n        \n        vm.user = null;\n        vm.allUsers = [];\n        vm.club = {};\n        vm.page_title = \"\";\n        vm.club.member = {};\n        \n        vm.imported_new_headers = [];\n\n        // vm.club.member.membership_id = {};\n        \n        vm.action = $state.current.data.action;\n\n\n\n        //vm.club_id = 6;\n        //vm.user_id = 59;\n\n        vm.user = $rootScope.globals.currentUser;\n        vm.user_id = vm.user.id;\n\n\n        vm.no_show_cols = [\"membership_start\", \"membership_id\", \"selected\"];\n\n        var newDate = new Date();\n        \n        var h_start = Math.floor( defaultStartTime / 60);          \n        var i_start = defaultStartTime % 60;\n        var h_end = Math.floor( defaultEndTime / 60);          \n        var i_end = defaultEndTime % 60;\n\n        var defaultStart = new Date(newDate.getFullYear(), newDate.getMonth(), newDate.getDate(), h_start, i_start, 0);\n        var defaultEnd = new Date(newDate.getFullYear(), newDate.getMonth(), newDate.getDate(), h_end, i_end, 0);\n\n\n        $scope.myDatetimeRange = {\n            date: {\n                from: defaultStart,\n                to: defaultEnd\n            },\n            time: {\n                from: defaultStartTime, // default low value\n                to: defaultEndTime, // default high value\n                step: 15, // step width\n                minRange: 15, // min range\n                hours24: true // true for 24hrs based time | false for PM and AM\n            }\n        };\n\n        $scope.myDatetimeLabels = {\n            date: {\n                from: 'Start date',\n                to: 'End date'\n            }\n        };\n\n    $scope.toggle = true;\n    $scope.toggleDirective = function() {\n        $scope.toggle = !$scope.toggle;\n    };\n\n    $scope.whentimechangedata = {};\n    $scope.overridePicker = true;\n\n\n\n\n    function get_times(data, tofrom){\n        var date = $scope.myDatetimeRange.date[tofrom];\n        var d = date.getDate();\n        var m = date.getMonth();\n        var y = date.getFullYear();\n        \n        //need to combuine both\n        var a = data[tofrom];\n        var h = a.slice(0,2);\n        var i = a.slice(3,5);\n        // i = (i == 00)? 0 : i;\n        \n        i = (i.toString() == \"00\")? 0 : i;\n\n        // $scope.myDatetimeRange.date.from = new Date(y, m, d, h, m, 0);\n        // //console.log(\"vars are: \"+y+\", \"+m+\", \"+d+\", \"+h+\", \"+i+\", \"+0+\" soooo\");\n        var date = new Date(y, m, d, h, i, 0);\n        return date;\n    }\n\n    $scope.whenTimeChange = function (data) {\n        // //console.log('schedule changes', data);\n      \n        var from = get_times(data, \"from\");\n        var to = get_times(data, \"to\");\n\n        $scope.myDatetimeRange.date.from = from;\n        $scope.myDatetimeRange.date.to = to;\n        //from and to are datetimes\n\n\n        $scope.whentimechangedata = data;\n    };\n\n    // show only time slider\n    $scope.timeRangePicker = {\n        time: {\n            from: 480, // default low value\n            to: 1020, // default high value\n            step: 15, // step width\n            minRange: 15, // min range\n            hours24: true // true for 24hrs based time | false for PM and AM\n        }\n    };\n\n    // show only date pickers\n    $scope.dateRangePicker = {\n        date: {\n            from: new Date(),\n            to: new Date()\n        }\n    };\n\n\n\n    // directive with max range in date pickers\n    var\n        _today      = new Date(),\n        _yesterday  = new Date( _today.getTime() - (86400000 * 10) );\n\n    $scope.datePickerWithRange = {\n        date: {\n            from: new Date(),\n            to: new Date(),\n            max: _today,\n            min: _yesterday\n        },\n        time: {\n            from: 420, // default low value\n            to: 1020, // default high value\n            step: 15, // step width\n            minRange: 15, // min range\n            hours24: true // true for 24hrs based time | false for PM and AM\n        }\n    };\n\n\n    // $scope.maxRangeDate = 5; //days\n\n/*\n        $scope.sortType     = 'Email'; // set the default sort type\n        $scope.sortReverse  = false;  // set the default sort order\n        $scope.searchTool   = '';     // set the default search/filter term\n\n        $scope.myDatetimeRange = {\n          \"time\": {\n            \"from\": 480,\n            \"to\": 1215,\n            \"dFrom\": 0,\n            \"dTo\": 1440,\n            \"step\": 15,\n            \"minRange\": 15,\n            \"hours24\": false\n          },\n          \"hasDatePickers\": false,\n          \"hasTimeSliders\": true\n        };\n\n\n   \n    $scope.myDatetimeLabels = {\n        date: {\n            from: 'Start date',\n            to: 'End date'\n        }\n    };\n\n\n    $scope.toggle = true;\n    $scope.toggleDirective = function() {\n        $scope.toggle = !$scope.toggle;\n    };\n\n    $scope.whentimechangedata = {};\n\n    $scope.whenTimeChange = function (data) {\n        //console.log('schedule changes', data);\n        $scope.whentimechangedata = data;\n    };\n\n    // show only time slider\n    $scope.timeRangePicker = {\n        time: {\n            from: 480, // default low value\n            to: 1020, // default high value\n            step: 15, // step width\n            minRange: 15, // min range\n            hours24: false // true for 24hrs based time | false for PM and AM\n        }\n    };\n\n    // show only date pickers\n    $scope.dateRangePicker = {\n        date: {\n            from: new Date(),\n            to: new Date()\n        }\n    };\n\n    // directive with max range in date pickers\n    var\n        _today      = new Date(),\n        _yesterday  = new Date( _today.getTime() - (86400000 * 10) );\n\n    $scope.datePickerWithRange = {\n        date: {\n            from: new Date(),\n            to: new Date(),\n            max: _today,\n            min: _yesterday\n        }\n    };\n    $scope.maxRangeDate = 5; //days\n\n\n          $scope.mytime = new Date();\n\n\nAND THE HTML IS:\n                            <div rg-range-picker=\"myDatetimeRange\" labels=\"myDatetimeLabels\"></div>\n\n\n*/\n\n\n\n\n\n\n\n/* ----------------------------------------------------------------------- */\n\n\n    var date = new Date();\n    var d = date.getDate();\n    var m = date.getMonth();\n    var y = date.getFullYear();\n\n    /* event source that pulls from google.com */\n    // $scope.eventSource = {\n    //         url: \"http://www.google.com/calendar/feeds/usa__en%40holiday.calendar.google.com/public/basic\",\n    //         className: 'gcal-event',           // an option!\n    //         currentTimezone: 'America/Chicago' // an option!\n    // };\n\n    /* event source that contains custom events on the scope */\n     $scope.events = [];\n    //   {title: 'All Day Event',start: new Date(y, m, 1)},\n    //   {title: 'Long Event',start: new Date(y, m, d - 5),end: new Date(y, m, d - 2)},\n    //   {id: 999,title: 'Repeating Event',start: new Date(y, m, d - 3, 16, 0),allDay: false},\n    //   {id: 999,title: 'Repeating Event',start: new Date(y, m, d + 4, 16, 0),allDay: false},\n    //   {title: 'Birthday Party',start: new Date(y, m, d + 1, 19, 0),end: new Date(y, m, d + 1, 22, 30),allDay: false},\n    //   {title: 'Click for Google',start: new Date(y, m, 28),end: new Date(y, m, 29),url: 'http://google.com/'}\n    // ];\n\n     HolidayService.GetAll(vm.user.id)\n        .then(function(data){\n             for(var i=0; i<data.length;i++){\n                 $scope.events.push({\n                     id: data[i].id,\n                     title: data[i].title,\n                     start: new Date(data[i].from_date),\n                     end: new Date(data[i].to_date),\n                     allDay: data[i].allDay,\n                     className: ['customFeed']\n                 });\n             }\n\n             //console.log(\"bits of events = \", $scope.events);\n\n        });\n\n\n    /* event source that calls a function on every view switch */\n    // $scope.eventsF = function (start, end, timezone, callback) {\n    //   var s = new Date(start).getTime() / 1000;\n    //   var e = new Date(end).getTime() / 1000;\n    //   var m = new Date(start).getMonth();\n    //   var events = [{title: 'Feed Me ' + m,start: s + (50000),end: s + (100000),allDay: false, className: ['customFeed']}];\n    //   callback(events);\n    // };\n\n    // $scope.calEventsExt = {\n    //    color: '#f00',\n    //    textColor: 'yellow',\n    //    events: [\n    //       {type:'party',title: 'Lunch',start: new Date(y, m, d, 12, 0),end: new Date(y, m, d, 14, 0),allDay: false},\n    //       {type:'party',title: 'Lunch 2',start: new Date(y, m, d, 12, 0),end: new Date(y, m, d, 14, 0),allDay: false},\n    //       {type:'party',title: 'Click for Google',start: new Date(y, m, 28),end: new Date(y, m, 29),url: 'http://google.com/'}\n    //     ]\n    // };\n\n\n\n    /* alert on eventClick */\n    $scope.alertOnEventClick = function( date, jsEvent, view){\n        $scope.alertMessage = (date.title + ' was clicked ');\n\n        //show event details\n\n    };\n\n    /* alert on Drop */\n     $scope.alertOnDrop = function(event, delta, revertFunc, jsEvent, ui, view){\n  \n        // for(var i = 0; i < $scope.events.length; i++){\n        //     if($scope.events[i]._id == event._id){\n        //         $scope.events[i].start = moment(event.start + delta);\n        //         $scope.events[i].end = moment(event.end + delta);\n        //     }\n        // }\n\n\n        // //console.log(event);\n\n        //event was updated --> please save\n        HolidayService.Update(vm.user.id, event)\n        .then(function(data){\n            //console.log(data);\n        });\n\n       $scope.alertMessage = ('Event Updated');\n    };\n\n    /* alert on Resize */\n    $scope.alertOnResize = function(event, delta, revertFunc, jsEvent, ui, view ){\n        \n        //event was updated --> please save\n        HolidayService.Update(vm.user.id, event)\n        .then(function(data){\n            //console.log(data);\n        });\n\n       $scope.alertMessage = ('Event Updated');\n    };\n\n\n\n    /* add and removes an event source of choice */\n    $scope.addRemoveEventSource = function(sources,source) {\n      var canAdd = 0;\n      angular.forEach(sources,function(value, key){\n        if(sources[key] === source){\n          sources.splice(key,1);\n          canAdd = 1;\n        }\n      });\n      if(canAdd === 0){\n        sources.push(source);\n      }\n    };\n\n\n   \n\n    $scope.whole_day_booking = false;\n    $scope.wholeDay = function(){\n\n       if($scope.whole_day_booking == true){\n            $scope.whole_day_booking = false;\n            $scope.myDatetimeRange.time.from = defaultStartTime;\n            $scope.myDatetimeRange.time.to = defaultEndTime;\n       } else {\n            $scope.whole_day_booking = true;\n            $scope.myDatetimeRange.time.from = 0;\n            $scope.myDatetimeRange.time.to = 1440;\n       }\n       \n\n    }\n\n\n\n    /* add custom event*/\n    $scope.addEvent = function() {\n\n      var myFrom = $scope.myDatetimeRange.date.from; \n      var myTo = $scope.myDatetimeRange.date.to; \n\n      // $scope.date_from = new Date(myFrom.getFullYear(), myFrom.getMonth(), myFrom.getDate(), 0, 0, 0);\n      // $scope.date_to = new Date(myTo.getFullYear(), myTo.getMonth(), myTo.getDate(), 23, 59, 59);\n\n      var new_event = {\n        title: 'Holiday',\n        start: myFrom,\n        end: myTo,\n        className: ['openSesame'],\n        allDay: $scope.whole_day_booking\n      };\n\n      $scope.events.push(new_event);\n\n      //editable: true / false can be added :)\n      //create the event in the DB\n\n      HolidayService.Create(vm.user.id, new_event)\n        .then(function(data){\n            //console.log(data);\n\n            $state.go('dashboard.manage_user.instructor_holidays');\n\n            \n        });\n\n    };\n\n    /* remove event */\n    $scope.remove = function(index) {\n\n        var delete_id = $scope.events[index].id;\n        // //console.log(\"DELETE: \"+delete_id);\n        // //console.log($scope.events[index]);\n\n      HolidayService.Delete(vm.user.id, delete_id)\n        .then(function(data){\n            \n            $scope.events.splice(index,1);\n\n        });\n\n\n    };\n\n    /* Change View */\n    $scope.changeView = function(view,calendar) {\n      uiCalendarConfig.calendars[calendar].fullCalendar('changeView',view);\n    };\n\n    /* Change View */\n    $scope.renderCalender = function(calendar) {\n      $timeout(function() {\n        if(uiCalendarConfig.calendars[calendar]){\n          uiCalendarConfig.calendars[calendar].fullCalendar('render');\n        }\n      });\n    };\n\n    \n\n    /* Render Tooltip */\n    $scope.eventRender = function( event, element, view ) {\n        element.attr({'tooltip': event.title,\n                      'tooltip-append-to-body': true});\n        $compile(element)($scope);\n    };\n\n    /* config object */\n    $scope.uiConfig = {\n      schedulerLicenseKey: 'CC-Attribution-NonCommercial-NoDerivatives',\n      calendar:{\n        height: 650,\n        editable: true,\n        header:{\n          left: 'title',\n          center: '',\n          right: 'today prev,next'\n        },\n        firstDay: 1,\n        slotEventOverlap: false,\n        eventClick: $scope.alertOnEventClick,\n        eventDrop: $scope.alertOnDrop,\n        eventResize: $scope.alertOnResize,\n        eventRender: $scope.eventRender\n      }\n    };\n\n    $scope.changeLang = function() {\n    \n        $scope.uiConfig.calendar.dayNames = [\"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\"];\n        $scope.uiConfig.calendar.dayNamesShort = [\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"];\n      \n    };\n\n    /* event sources array*/\n    $scope.eventSources = [$scope.events];\n    // $scope.eventSources2 = [$scope.calEventsExt, $scope.eventsF, $scope.events];\n\n\n\n/* ------------------------------------------------------------------------ */\n\n\n\n\n\n\n\n\n\n\n        ////console.log(\"club_id : \"+vm.club_id);\n\n        // //console.log(vm.action);\n        // //console.log($stateParams);\n        // //console.log($stateParams.id);\n\n        switch(vm.action){\n            case \"add\":\n                //console.log(\"adding a new member please\");\n                vm.page_title = \"Add a New member\";\n\n                \n\n            break;\n            case \"edit\":\n                //console.log(\"edit an existing membership\");\n\n                // MemberService.GetMemberPlanes($stateParams.member_id, vm.club_id)\n                //     .then(function(data){\n                //         vm.club.planes = data;   \n                //         //console.log(vm.club.planes);\n                //     });\n\n                //  MemberService.GetById($stateParams.member_id, vm.club_id)\n                //     .then(function(data){\n                //         vm.club.member = data;   \n                //         //console.log(vm.club);\n                //         vm.club.member.is_manager = (vm.club.member.is_manager == 1) ? true : false;\n                //         vm.club.member.approved = (vm.club.member.approved == 1) ? true : false;\n                //         vm.club.member.instructor = (vm.club.member.instructor == 1) ? true : false;\n                //         vm.club.member.membership_start = Date.parse(vm.club.member.membership_start);\n                //         vm.page_title = \"Edit a Member - \"+vm.club.member.first_name+\" \"+vm.club.member.last_name;\n\n                //         vm.club.member.membership_start = new Date(vm.club.member.membership_start);\n\n                //         // $(\"#membership_start\").datepicker({\n                //         //     format: 'dd-mm-yyyy',\n                //         //     startDate: vm.club.member.membership_start,\n                //         //     endDate: ''\n                //         //   }).on(\"show\", function() {\n                //         //     $(this).val(new Date()).datepicker('update');\n                //         //   });\n\n                //     });\n\n                //  MembershipService.GetAllByClub(vm.club_id)\n                //     .then(function(data){\n                //         vm.club.memberships = data;   \n                //         // vm.club.member.membership_id.selected = vm.club.member.membership_id;\n                //         // vm.membership = vm.club.member.membership_name;\n                //         // vm.club.membership = vm.club.member.membership_name;\n                //         //console.log(vm.club.memberships);\n                //     });\n            break;\n            case \"list\":\n                //need to update this to be part of the authentication\n                //to find out club id\n                // MemberService.GetAllByClub('6')\n                //     .then(function(data){\n                //         vm.club.members = data;   \n                //         //console.log(vm.club.members);\n                //     });\n\n                //  MembershipService.GetAllByClub(vm.club_id)\n                //     .then(function(data){\n                //         vm.club.memberships = data;   \n                //         // vm.club.member.membership_id.selected = vm.club.member.membership_id;\n                //         // vm.membership = vm.club.member.membership_name;\n                //         // vm.club.membership = vm.club.member.membership_name;\n                //         //console.log(vm.club.memberships);\n                //     });\n                // $scope.checkAll = function () {\n                //     //console.log(\"check all\");\n                //     if ($scope.selectedAll) {\n                //         $scope.selectedAll = true;\n                //     } else {\n                //         $scope.selectedAll = false;\n                //     }\n                //     angular.forEach(vm.club.members, function(member) {\n                //         member.selected = $scope.selectedAll;\n                //     });\n                // };\n\n\n            break;\n            default:\n                //console.log(\"none of the above... redirect somewhere?\");\n            break;\n        }  \n\n        //'9' needs to refer the the user's account set to manage\n       \n        $scope.back = function(){\n            $window.history.back();\n        }\n\n        $scope.save = function(){\n            if(vm.action == \"add\"){\n                //console.log(\"CREATE click\");\n                $scope.create();\n            } else {\n                //console.log(\"EDIT click\");\n                //console.log(vm.club.membership);\n                $scope.update();\n            }\n        }\n\n\n\n\n        // $scope.readCSV = function() {\n        //     // http get request to read CSV file content\n        //     $http.get('/angular/sample.csv').success($scope.processData);\n        // };\n\n\n        $scope.csvToJSON = function(content) {\n                var lines=content.csv.split(/\\r\\n|\\n/);\n                var result = [];\n                var start = 0;\n                lines[0] += \",membership_id,membership_start,selected\";\n                for (var j=1; j<lines.length; j++) {\n                    lines[j] += \",membership_id,membership_start,true\";\n                }\n                var columnCount = lines[0].split(content.separator).length;\n\n                var headers = [];\n                if (content.header) {\n                    headers=lines[0].split(content.separator);\n                    vm.imported_headers = headers;\n                    start = 1;\n                }\n\n                for (var i=start; i<lines.length; i++) {\n                    var obj = {};\n                        var currentline=lines[i].split(new RegExp(content.separator+'(?![^\"]*\"(?:(?:[^\"]*\"){2})*[^\"]*$)'));\n                        if ( currentline.length === columnCount ) {\n                            if (content.header) {\n                                for (var j=0; j<headers.length; j++) {\n                                    obj[headers[j]] = currentline[j];\n                                }\n                            } else {\n                                for (var k=0; k<currentline.length; k++) {\n                                    obj[k] = currentline[k];\n                                }\n                            }\n                            result.push(obj);\n                        }\n                   \n                }\n\n                //result = $scope.toPrettyJSON(result, 2);\n                //console.log(result);\n\n                return result;\n            };\n\n       \n\n\n        $scope.processData = function() {\n            //get the stuff\n            allText = vm.import_users;\n            var tobesorter = {\n                csv: vm.import_users,\n                separator: \",\",\n                header: true\n            }\n            vm.imported_users = $scope.csvToJSON(tobesorter);\n\n             for(var b=0;b<vm.imported_users.length;b++){\n                if(vm.imported_users[b].membership_start){\n                    vm.imported_users[b].membership_start = new Date(vm.imported_users[b].membership_start);\n                } else {\n                    vm.imported_users[b].membership_start = new Date();\n                }\n                //below set the default membership perhaps?\n                vm.imported_users[b].membership_id = 4;\n                vm.imported_users[b].membership = { membership_id: 4, membership_name: \"Annual Membership\" };\n            }\n\n            // split content based on new line\n            // var allTextLines = allText.split(/\\r\\n|\\n/);\n            // var headers = allTextLines[0].split(',');\n            // var lines = [];\n\n            // for ( var i = 0; i < allTextLines.length; i++) {\n            //     // split content based on comma\n            //     var data = allTextLines[i].split(',');\n            //     if (data.length == headers.length) {\n            //         var tarr = [];\n            //         for ( var j = 0; j < headers.length; j++) {\n            //             tarr.push(data[j]);\n            //         }\n            //         lines.push(tarr);\n            //     }\n            // }\n            // $scope.data = lines;\n        };\n       \n\n        vm.user_columns = {\n            first_name: \"First Name\", \n            last_name: \"Last Name\", \n            email: \"Email Address\",\n            dob: \"Date of Birth\",\n            membership_number: \"Membership Number\", \n            membership_start: \"Membership Start Date\",\n            membership_id: \"Membership Name\"\n        };\n\n\n        $scope.import_column = function(name){\n            // //console.log(\"update the field\");\n            // for(var i = 0; i < vm.imported_users.length; i++){\n            //     var original_val = vm.imported_users[i][name];\n            //     delete vm.imported_users[i][name];\n            //     vm.imported_users[i][vm.change_col_to] = original_val;\n            //     //console.log(vm.imported_users[i]);\n            // }\n\n        }\n\n\n        $scope.import_users = function(){\n            //console.log(\"import some users now\");\n\n\n            //first let's ignore the ones that weren't in the list\n            vm.imported_users = $.grep(vm.imported_users, function(e){ \n                    return e.selected != \"false\"; \n            });\n\n           \n            // //console.log(vm.imported_users);\n            // //console.log(vm.imported_headers);\n            // //console.log(vm.imported_new_headers);\n\n            //we need to verify that at least first name and last name in addition to email is present in the columns selected.\n            if(vm.imported_new_headers.indexOf(\"first_name\") > -1 && vm.imported_new_headers.indexOf(\"last_name\") > -1 && vm.imported_new_headers.indexOf(\"email\") > -1){\n                //console.log(\"ALL HEADERS HERE ! YAY!\");\n                \n                for(var b=0;b<vm.imported_users.length;b++){\n                    if(vm.imported_users[b].membership){\n                        if(vm.imported_users[b].membership.membership_id){\n                            vm.imported_users[b][\"membership_id\"] = vm.imported_users[b].membership.membership_id;\n                            delete vm.imported_users[b].membership;\n                        }\n                    }\n                }\n\n                //console.log(\"===--->===\");\n                //console.log(vm.imported_users);\n                //console.log(\"===--->===\");\n\n                vm.imported_new_headers.push(\"membership_id\");\n                vm.imported_new_headers.push(\"membership_start\");\n\n                //now we generate the users with the correct headings for our tables\n                var to_import_users = [];\n                for(var d=0; d<vm.imported_users.length;d++){\n                    var obj = {\n                        user: {},\n                        club_id: 6\n                    };\n                    for(var c=0; c<vm.imported_new_headers.length;c++){\n                        if(vm.imported_new_headers[c]){\n                            //console.log(vm.imported_new_headers[c]);\n                            if(vm.imported_new_headers[c] == \"first_name\" || vm.imported_new_headers[c] == \"last_name\" || vm.imported_new_headers[c] == \"dob\" || vm.imported_new_headers[c] == \"email\"){\n                                obj[\"user\"][vm.imported_new_headers[c]] = vm.imported_users[d][Object.keys(vm.imported_users[d])[c]];\n                            } else {\n                                if(vm.imported_new_headers[c] == \"membership_start\" || vm.imported_new_headers[c] == \"membership_id\"){\n                                    obj[vm.imported_new_headers[c]] = vm.imported_users[d][vm.imported_new_headers[c]];\n                                } else {\n                                    obj[vm.imported_new_headers[c]] = vm.imported_users[d][Object.keys(vm.imported_users[d])[c]];\n                                }\n                            }\n                            //we can push this into a new object with new key!\n                        } else {\n                            //we ignore this one...\n                            //console.log(\"blank\");\n                        }\n                    }\n                    to_import_users.push(obj);\n                }\n                //console.log(\"--==--\");\n                //console.log(to_import_users);\n                //console.log(\"--==--\");\n\n                //now that we have what we want to add to our \n                MemberService.CreateMany(to_import_users)\n                .then(function(data){\n                    //console.log(data);\n                    $state.go('dashboard.manage_club.members');\n                });\n\n            } else {\n                //console.log(\"missing key elements in headers!\");\n                alert(\"You must select the First Name, Last Name and Email Address to be able to add the user to the system!\");\n            }\n        \n\n\n        }\n\n\n        $scope.create = function(){\n            //console.log(\"CREATE ME NOW\");\n            vm.club.member.club_id = 6;\n            MemberService.Create(vm.club.member)\n                .then(function(data){\n                    //console.log(data);\n                    $state.go('dashboard.manage_club.members');\n                });\n        }\n\n        $scope.delete = function(){\n            //console.log(\"CLICK\");\n            alert(\"Are you sure you would like to delete this membership?\");\n            MemberService.Update(vm.club.membership)\n                .then(function(data){\n                    //console.log(data);\n                });\n        }\n\n        $scope.update = function(){\n            //console.log(\"CLICK\");\n            vm.club.member.club_id = 6;\n           \n            MemberService.Update(vm.club.member)\n                        .then(function(data){\n                            //console.log(data);\n                            //console.log(\"saved\");\n                            $state.go('dashboard.manage_club.members');\n                        });\n                        \n            MemberService.SaveMemberPlanes(vm.club.member.id, vm.club.member.club_id, vm.club.planes)\n                .then(function(data){\n                    //console.log(data);\n                    //console.log(\"saved THE PLANES\");\n                     \n                });\n\n                //         function SaveMemberPlanes(user_id, club_id, planes){\n\n        }\n\n        $scope.selected_members = function(type){\n            //get the selected members\n            //console.log(vm.club.members);\n            vm.selected_members = $.grep(vm.club.members, function(e){ \n                return e.selected == true; \n            });\n            //console.log(vm.selected_members);\n\n            //type is the action required...\n            \n\n            for(var j=0;j < vm.selected_members.length; j++){\n\n                if(type == \"approve\"){\n                    vm.selected_members[j].approved = 1;\n                } else {\n                    vm.selected_members[j].approved = 0;\n                }\n                //console.log(\"here\");\n                MemberService.Update(vm.selected_members[j])\n                    .then(function(data){\n                        //console.log(data);\n                        //console.log(\"saved\");\n                    });\n            }\n\n            $state.go('dashboard.manage_club.members');\n\n        }\n\n        $scope.update_membership = function(item, model){\n            vm.club.member.membership_id = item.membership_id;\n            vm.club.member.membership_name = item.membership_name;\n        }\n\n        initController();\n\n        function initController() {\n           //console.log(\"check if access is okay\");\n        }\n\n\n        var warning_msg = \"By deleting this membership, you will also cancel all reservations that this membership currently has.\"\n\n        $scope.open = function (member_id) {\n            var modalInstance = $uibModal.open({\n              animation: true,\n              templateUrl: 'views/modals/deleteModal.html',\n              controller: 'ModalInstanceCtrl',\n              size: \"lg\",\n              resolve: {\n                id: function () {\n                  return member_id;\n                },\n                warning: function(){\n                    return warning_msg;\n                }\n              }\n            });\n            modalInstance.result.then(function (member_id) {\n              $log.info('PRESSED GO: '+member_id);\n              MemberService.Delete(member_id)\n              .then(function(){\n                //console.log(\"HELLO DELETE\");\n                //update view?\n                 vm.club.members = $.grep(vm.club.members, function(e){ \n                    return e.id != member_id; \n                });\n              })\n            }, function () {\n              $log.info('Modal dismissed at: ' + new Date());\n            });\n          };\n\n         \n\n\n    }\n app.controller('FinishAndPayController', FinishAndPayController);\n\n    FinishAndPayController.$inject = ['$sce', 'UserService', 'MemberService', 'InstructorService', 'MembershipService', 'HolidayService', '$rootScope', '$location', '$scope', '$state', '$stateParams', '$uibModal', '$log', '$window', '$compile', '$interval', '$timeout', 'uiCalendarConfig', 'BookingService', 'LicenceService', 'BookoutService', '$filter', 'PlaneService', 'InstructorCharges', 'PaymentService', 'InvoicesService'];\n    function FinishAndPayController($sce, UserService, MemberService, InstructorService, MembershipService, HolidayService, $rootScope, $location, $scope, $state, $stateParams, $uibModal, $log, $window, $compile, $interval, $timeout, uiCalendarConfig, BookingService, LicenceService, BookoutService, $filter, PlaneService, InstructorCharges, PaymentService, InvoicesService) {\n        \n        var vm = this;\n\n        vm.user = $rootScope.globals.currentUser;\n        vm.user_id = vm.user.id;\n\n        vm.show_loading = false;\n\n\n        //this club ID needs to reflect the club that has been selected....\n        vm.club_id = 6;\n        vm.booking = {};\n\n        //base location to sort the airfields below\n        vm.wgs_n = \"51.51\";\n        vm.wgs_e = \"0.12\";\n\n        vm.change_booking = {};\n        vm.show_change_plane = false;\n        //we need to get the booking ID to pull as much data as we can!\n\n        vm.bookout = {\n            start: true,\n            passengers: [],\n            pic: {\n                id: vm.user_id\n            },\n            plane: {}\n        };\n      \n        vm.dateFormat = 'date:HH:mm \\'on\\' dd/MM/yyyy';\n        var setting_new_member;\n\n\n        vm.reported_defects = [];\n\n        vm.complete_flight = true;\n\n        vm.previous_invoice;\n\n        vm.defect_severity;\n        vm.defect_severities = [\n            { title: \"No Fly Item - Ground the plane\"},\n            { title: \"Flyable - needs to be checked at next maintenance\"},\n            { title: \"Not urgent - but needs noting\"},\n            { title: \"Unsure of severity\"}\n        ];  \n\n\n\n        // vm.dmethods = [\n        //     { id: 'direct-debit', title: 'Direct Debit', subtitle: 'Use your BACS mandate', type: 'direct-debit', iconSvg: $sce.trustAsHtml(iconBank), visible: true },\n        //     { id: 'saved-card',   title: 'Saved card',   subtitle: 'Use a card on file',    type: 'saved-card',  iconSvg: $sce.trustAsHtml(iconCard), visible: true },\n        //     { id: 'new-card',     title: 'New card',     subtitle: 'Add a new debit/credit card', type: 'new-card', iconSvg: $sce.trustAsHtml(iconNew), visible: true },\n        //     { id: 'card-machine', title: 'Card Machine', subtitle: 'Pay in person',          type: 'card-machine', iconSvg: $sce.trustAsHtml(iconTerm), visible: true }\n        //   ];\n        // vm.dsavedCards = [\n        //   // { id:'card_1', brand:'Visa', last4:'4242', exp:'06/27', isDefault:true, nick:'Personal' },\n        //   // { id:'card_2', brand:'Mastercard', last4:'1881', exp:'11/26', isDefault:false, nick:'Business' }\n        // ];\n        //direct-debit, saved-card, new-card, card-machine\n        \n\n\n\n        //SAMPLE ACCORDION MENU TO SELECT THE PAYMENT METHOD\n        // // Right-side icons (same colour/style)\n        // var iconBank = '<svg viewBox=\"0 0 24 24\"><path d=\"M3 10h18M4 10V8l8-5 8 5v2M5 10v8M9 10v8M15 10v8M19 10v8M3 18h18M2 20h20\" fill=\"none\" stroke=\"#4f46e5\" stroke-width=\"1.6\"/></svg>';\n        //   var iconCard = '<svg viewBox=\"0 0 24 24\"><rect x=\"2\" y=\"4\" width=\"20\" height=\"16\" rx=\"2\" ry=\"2\" fill=\"none\" stroke=\"#4f46e5\" stroke-width=\"1.6\"/><path d=\"M2 9h20M6 14h6\" stroke=\"#4f46e5\" stroke-width=\"1.6\"/></svg>';\n        //   var iconNew  = '<svg viewBox=\"0 0 24 24\"><circle cx=\"12\" cy=\"12\" r=\"9\" fill=\"none\" stroke=\"#4f46e5\" stroke-width=\"1.6\"/><path d=\"M12 8v8M8 12h8\" stroke=\"#4f46e5\" stroke-width=\"1.6\"/></svg>';\n        //   var iconTerm = '<svg viewBox=\"0 0 24 24\"><rect x=\"6\" y=\"2\" width=\"12\" height=\"14\" rx=\"2\" fill=\"none\" stroke=\"#4f46e5\" stroke-width=\"1.6\"/><rect x=\"8\" y=\"5\" width=\"8\" height=\"3\" fill=\"none\" stroke=\"#4f46e5\" stroke-width=\"1.6\"/><rect x=\"9\" y=\"10\" width=\"6\" height=\"3\" fill=\"none\" stroke=\"#4f46e5\" stroke-width=\"1.6\"/></svg>';\n        var iconBank = '<svg viewBox=\"0 0 24 24\"><path d=\"M3 10h18M4 10V8l8-5 8 5v2M5 10v8M9 10v8M15 10v8M19 10v8M3 18h18M2 20h20\" fill=\"none\" stroke=\"#4f46e5\" stroke-width=\"1.6\"/></svg>';\n        var iconCard = '<svg viewBox=\"0 0 24 24\"><rect x=\"2\" y=\"4\" width=\"20\" height=\"16\" rx=\"2\" ry=\"2\" fill=\"none\" stroke=\"#4f46e5\" stroke-width=\"1.6\"/><path d=\"M2 9h20M6 14h6\" stroke=\"#4f46e5\" stroke-width=\"1.6\"/></svg>';\n        var iconNew  = '<svg viewBox=\"0 0 24 24\"><circle cx=\"12\" cy=\"12\" r=\"9\" fill=\"none\" stroke=\"#4f46e5\" stroke-width=\"1.6\"/><path d=\"M12 8v8M8 12h8\" stroke=\"#4f46e5\" stroke-width=\"1.6\"/></svg>';\n        var iconTerm = '<svg viewBox=\"0 0 24 24\"><rect x=\"6\" y=\"2\" width=\"12\" height=\"14\" rx=\"2\" fill=\"none\" stroke=\"#4f46e5\" stroke-width=\"1.6\"/><rect x=\"8\" y=\"5\" width=\"8\" height=\"3\" fill=\"none\" stroke=\"#4f46e5\" stroke-width=\"1.6\"/><rect x=\"9\" y=\"10\" width=\"6\" height=\"3\" fill=\"none\" stroke=\"#4f46e5\" stroke-width=\"1.6\"/></svg>';\n        \n          vm.donConfirm = function(methodLabel, paymentIntent){\n            console.log(\"confirmation is called\", methodLabel);\n            console.log(\"paymentIntent\", paymentIntent);\n          //alert('Parent received D confirmation: ' + methodLabel);\n            vm.book_in_flight(methodLabel, paymentIntent);\n          };\n\n          vm.default_payment = 'direct-debit';\n\n          vm.methods = [\n            { id: 'direct-debit', title: 'Direct Debit', subtitle: 'Use your BACS mandate', type: 'direct-debit', iconSvg: $sce.trustAsHtml(iconBank), visible: true },\n            { id: 'saved-card',   title: 'Saved card',   subtitle: 'Use a card on file',    type: 'saved-card',  iconSvg: $sce.trustAsHtml(iconCard), visible: true },\n            { id: 'new-card',     title: 'New card',     subtitle: 'Add a new debit/credit card', type: 'new-card', iconSvg: $sce.trustAsHtml(iconNew), visible: true },\n            { id: 'card-machine', title: 'Card Machine', subtitle: 'Pay in person',          type: 'card-machine', iconSvg: $sce.trustAsHtml(iconTerm), visible: true }\n          ];\n\n           vm.savedCards = [];\n\n\n          // vm.expandedId = 'direct-debit';\n          // vm.selectedId = 'direct-debit';\n         \n\n          // vm.dd   = { name: '', email: '', sortCode: '', account: '' };\n          // vm.card = { name: '', number: '', exp: '', cvc: '' };\n\n          // vm.toggle = function(id){ vm.expandedId = (vm.expandedId === id) ? null : id; vm.selectedId = id; };\n          // vm.isExpanded = function(id){ return vm.expandedId === id; };\n          // vm.keyHeader = function(e,id){ var k=e.which||e.keyCode; if(k===13||k===32){ e.preventDefault(); vm.toggle(id);} };\n          // vm.ddReady   = function(){ return !!(vm.dd.name && vm.dd.email && vm.dd.sortCode && vm.dd.account); };\n          // vm.cardReady = function(){ return !!(vm.card.name && vm.card.number && vm.card.exp && vm.card.cvc); };\n          // vm.confirm   = function(label){ alert('Selected: ' + label); };\n          // vm.selectedTitle = function(){\n          //   for (var i=0;i<vm.methods.length;i++){ if(vm.methods[i].id===vm.selectedId){ return vm.methods[i].title; } }\n          //   return null;\n          // };\n\n          // vm.switchTo = function(type){\n          //     // find by type (no Array.find for ES5)\n          //     for (var i = 0; i < vm.methods.length; i++) {\n          //       if (vm.methods[i].type === type) {\n          //         vm.selectedId = vm.methods[i].id;\n          //         vm.expandedId = vm.methods[i].id;\n          //         return;\n          //       }\n          //     }\n          //   };\n\n          // vm.selectedSavedCardId = (vm.savedCards[0] && vm.savedCards[0].id) || null;\n\n          //   vm.selectSavedCard = function(id){\n          //     vm.selectedSavedCardId = id;\n          //   };\n\n          //   vm.keySelectTile = function(e, id){\n          //     var k = e.which || e.keyCode;\n          //     // Enter(13) or Space(32) selects\n          //     if (k === 13 || k === 32) { e.preventDefault(); vm.selectSavedCard(id); }\n          //     // Optional: ArrowLeft/ArrowRight to move focus\n          //   };\n\n          //   vm.cardBrandIcon = function(brand){\n          //     // Simple inline SVGs; extend as needed\n          //     var visa = '<svg viewBox=\"0 0 36 24\"><rect width=\"36\" height=\"24\" rx=\"4\" fill=\"#0a4595\"/><text x=\"18\" y=\"16\" text-anchor=\"middle\" font-size=\"10\" fill=\"#fff\" font-family=\"Arial, Helvetica, sans-serif\">VISA</text></svg>';\n          //     var mc = '<svg viewBox=\"0 0 36 24\"><rect width=\"36\" height=\"24\" rx=\"4\" fill=\"#1f2937\"/><circle cx=\"15\" cy=\"12\" r=\"6.5\" fill=\"#eb001b\"/><circle cx=\"21\" cy=\"12\" r=\"6.5\" fill=\"#f79e1b\" opacity=\".9\"/></svg>';\n          //     var amex = '<svg viewBox=\"0 0 36 24\"><rect width=\"36\" height=\"24\" rx=\"4\" fill=\"#2e77bb\"/><text x=\"18\" y=\"16\" text-anchor=\"middle\" font-size=\"9\" fill=\"#fff\" font-family=\"Arial, Helvetica, sans-serif\">AMEX</text></svg>';\n\n          //     var b = (brand || '').toLowerCase();\n          //     var svg = /visa/.test(b) ? visa\n          //             : /(master|mc)/.test(b) ? mc\n          //             : /(amex|american)/.test(b) ? amex\n          //             : '<svg viewBox=\"0 0 36 24\"><rect width=\"36\" height=\"24\" rx=\"4\" fill=\"#eef2ff\"/><text x=\"18\" y=\"15\" text-anchor=\"middle\" font-size=\"8\" fill=\"#4f46e5\" font-family=\"Arial, Helvetica, sans-serif\">CARD</text></svg>';\n\n          //     return $sce.trustAsHtml(svg);\n          //   };\n\n            // vm.pay_with_saved_card = function(){\n            //     vm.show_loading = true;\n            //     console.log(\"cardid = \", vm.selectedSavedCardId);\n                \n            //     // .. // .. /// .. /// .. // ... //\n            //     //we need to create a payment intent for the booking rather than a singular invoice\n            //     // PaymentService.CreatePaymentIntentBooking\n            //     var obj = {\n            //         booking_id: vm.bookout.booking_id,\n            //         user_id: vm.user.id,\n            //         card_id: vm.selectedSavedCardId\n            //     }\n\n            //     PaymentService.CreatePaymentIntentBooking(obj)\n            //                 .then(function (data) {\n            //                     //console.log(data);\n            //                     if(data.success){\n                                    \n\n\n\n\n\n\n\n\n            //                         ////console.log(\"CARDS\", vm.cards);\n            //                     } else {\n            //                        console.log(\"WOOOPSIES...\", data);\n            //                         //this should be very very rare...\n            //                     }\n            //     });\n\n\n            // }\n                \n\n\n\n\n\n        vm.complete_flight = false;\n        vm.complete_this_flight = function(){\n\n            if(vm.tacho_error_highlight){\n                alert(\"You cannot complete a fligth where the last meter reading is greater than the start meter reading!\");\n                return false;\n            }\n\n            var getShort = {club_id: vm.bookout.club_id,\n                user_id: vm.bookout.user_id};\n\n                // //console.log(\"PASSING\", getShort);\n            //let's fetch some information about the user\n            MemberService.GetMandate(vm.bookout.user_id, vm.bookout.club_id)\n                    .then(function (data) {\n                            ////console.log(\"data is : \", data);\n                           \n                            if(data.success){\n                                vm.info = data.info;\n\n\n                                vm.savedCards = data.cards;\n\n                                if(vm.savedCards.length > 0){\n                                    vm.methods[1].visible = true;\n                                } else {\n                                    vm.methods[1].visible = false;\n                                }\n\n                                vm.machine = data.machine;\n                                if(vm.machine.success){\n                                    vm.methods[3].visible = true;\n                                } else {\n                                    vm.methods[3].visible = false;\n                                }\n                            }\n\n                        });\n\n\n\n\n            vm.complete_flight = true;\n        }\n\n\n        $scope.get_airfields = function(name){\n\n            if(name.length > 2 && name.length < 5){\n\n                 BookoutService.GetAirfieldsByCode(name)\n                .then(function (data) {\n                    //console.log(data);\n                    if(data.success){\n                        //use GB airfields first...\n                        vm.airfields = data.airfields;\n                       \n                         if(vm.airfields.length == 0){\n                            //console.log(\"SETTINGS HERE\");\n                               vm.airfields = [\n                                    {\n                                        id:0,\n                                        title: \"NOT LISTED : \"+ name,\n                                        code: \"ZZZZ\",\n                                        wgs_n: \"0\",\n                                        wgs_e: \"0\"\n                                    }];\n                        }\n\n                    } else {\n\n\n                        //console.log(\"WOOOPSIES...\");\n                        //this should be very very rare...\n                    }\n\n                });\n\n\n            }\n\n            if(name.length > 4){\n                var code = name.replace(/\\s/g, \"_\");\n                BookoutService.GetAirfields(code)\n                .then(function (data) {\n                    //console.log(data);\n                    if(data.success){\n                        //use GB airfields first...\n                        vm.airfields = data.airfields;\n\n\n                        if(vm.airfields.length == 0){\n                            //console.log(\"SETTINGS HERE\");\n                               vm.airfields = [\n                                    {\n                                        id:0,\n                                        title: \"NOT LISTED : \"+ name,\n                                        code: \"ZZZZ\",\n                                        wgs_n: \"0\",\n                                        wgs_e: \"0\"\n                                    }];\n                        }\n\n                    } else {\n                        //console.log(\"WOOOPSIES...\");\n                        //this should be very very rare...\n                    }\n\n                });\n\n            }\n        }\n\n\n        $scope.update_pic = function(){\n            //console.log(\"--> \", vm.user.id);\n            //console.log(\"--> \", vm.bookout.instructor_id);\n            //console.log(\"--> \", vm.bookout.pic.user_id);\n\n            if(vm.bookout.pic.user_id == vm.user.id && vm.bookout.instructor_id > 0){\n                //console.log(\"okay... so you want the instructor to be put? interesting...\");\n                //adheres to booking\n\n            } else if(vm.bookout.instructor_id > 0 && vm.bookout.pic.user_id == vm.bookout.instructor_id) {\n                //console.log(\"okay so you now have your booked instructor as the PIC again - nice\");\n                //adheres to booking\n\n            } else {\n                //console.log(\"you've change instructor? what happened?\");\n                //availability has been checked hence we're OK\n\n            }\n        }\n\n\n        // vm.cards = [];\n        // PaymentService.GetByUserId(vm.user.id)\n        //                     .then(function (data) {\n        //                         //console.log(data);\n        //                         if(data.success){\n        //                             vm.cards = data.cards;\n        //                             ////console.log(\"CARDS\", vm.cards);\n        //                         } else {\n        //                            // //console.log(\"WOOOPSIES...\");\n        //                             //this should be very very rare...\n        //                         }\n        //                     });\n\n\n        // the ARRIVAL option should be automatically filled in when there was a departure prior to the flight and home airfield was\n        //entered as the destination\n\n       \n\n        switch($state.current.data.action){\n            case \"add\":\n\n                //console.log(\"bookout\", $stateParams.id);\n                //so now we can load the BOOKING with this ID, and therefore can sort it all out :)\n                // let us preload the content required from the booking - fetch the booking\n                //console.log(\"FETCH THE BOOKING\");\n\n                BookingService.GetForBookout(vm.user.id, $stateParams.id)\n                 .then(function (data) {\n                    ////console.log(\"data is : \", data);\n                    if(data.success){\n                        //console.log(\"success\");\n                        \n\n                        if(data.booking.complete == 1){\n                            alert(\"It appears that you have already completed this booking...\");\n                            $state.go('dashboard.my_account', {}, { reload: true });\n                        }\n\n                        vm.bookout = data.booking;\n\n                        //temporary bits to overcome the start and end times issues...\n                        vm.bookout.start_date = new Date(\"2100/07/26\");\n                        vm.bookout.end_date = new Date(\"2100/07/26\");\n\n                        MemberService.GetAllByPics(data.booking.club_id, vm.user.id)\n                            .then(function (pics) {\n                                    vm.pics = pics;\n                                    process_bookout_to_bookin(data.booking);\n                            });\n\n\n\n                    }\n                });\n\n                \n            break;\n            case \"edit\":\n\n            \n\n\n\n            break;\n            case \"list\":\n\n             \n\n\n            break;\n            default:\n                //console.log(\"none of the above... redirect somewhere?\");\n            break;\n        }  \n      \n\n        vm.calculate_invoice_for_flight = function(){\n\n            //vm.flight_units where the units are stored\n\n\n            // //vm.bookout.plane_charges where the fees are stored\n            // var plane_units = 0;\n            // //plane units\n            // if(vm.bookout.plane_charges.charge_type == \"brakes\"){\n            //     //then the units relate to the entered numbers:\n            //     plane_units = vm.flight_units.brakes_to_brakes;\n            // } else {\n            //     //then the units we need to calculate relate to the hours between brakes off and on.\n            //     plane_units = (vm.bookout.end_tacho - vm.bookout.start_tacho);\n            // }\n\n            // var plane_total = (vm.bookout.plane_charges.charge_rate_unit * plane_units);\n\n\n            // //plane surchages::::\n            // var surcharge_units = 0;\n            // if(vm.bookout.plane_charges.surcharge_type == \"flight\"){\n            //     //then the units relate to the entered numbers:\n            //     surcharge_units = 1;\n            // } else if(vm.bookout.plane_charges.surcharge_type !== \"none\") {\n            //     //then the units are based on the plane units\n            //     surcharge_units = plane_units;\n            // }\n\n            // var surcharge_total = (vm.bookout.plane_charges.surcharge_fee * surcharge_units);\n\n\n            // //landings and touch and goes etc...\n            // var landing_units = vm.bookout.landings | 0;\n            // var landings_total = (landing_units * vm.bookout.plane_charges.landing_fee);\n\n\n            // var tg_units = vm.bookout.tng | 0;\n            // var tng_total = (tg_units * vm.bookout.plane_charges.touch_and_go_fee);\n\n\n\n            // //TUITION CHARGES\n            // var tuition_charge_type = \"none\";\n            // var tuition_price = 0;\n            // var tuition_total = 0;\n            // var tuition_units = 0;\n            // if(vm.bookout.instructor_id > 0 && vm.bookout.tuition_id > 0 && vm.bookout.tuition_charges){\n\n            //     tuition_charge_type = vm.bookout.tuition_charges.charge_type;\n            //     tuition_price = vm.bookout.tuition_charges.price;\n\n            //     if(tuition_charge_type == \"brakes\"){\n            //         tuition_units = vm.flight_units.brakes_to_brakes;\n            //         tuition_charge_type = \"brakes off to brakes on hours\";\n            //     } else if(tuition_charge_type == \"plane\"){\n            //         tuition_units = (vm.bookout.end_tacho - vm.bookout.start_tacho);\n            //         tuition_charge_type = \"plane units\";\n            //     } else if(tuition_charge_type == \"session\"){\n            //         tuition_units = 1;\n            //         tuition_charge_type = \"session\";\n            //     }\n\n            //     tuition_total = (tuition_units * tuition_price);\n\n            // }\n\n            // var total_to_remove = 0;\n            // var receipts = [];\n            // //need to process the reductions due to the receipts...\n            // for(var i = 0;i<vm.lubricant_receipts.length;i++){\n\n            //     if(vm.lubricant_receipts[i].reimbursement == 1){\n            //         receipts.push(vm.lubricant_receipts[i]);\n            //         total_to_remove = Number.parseFloat(Number.parseFloat(total_to_remove) + Number.parseFloat(vm.lubricant_receipts[i].price));\n            //     }\n\n            // }\n\n            // //console.log(\"CALC HERE\", total_to_remove);\n\n\n\n\n\n\n            // var total = (plane_total + surcharge_total + landings_total + tng_total + tuition_total - total_to_remove);\n\n            vm.invoice_totals = vm.previous_total;\n\n            vm.plane_charges = {\n                // plane_charge_type: vm.bookout.plane_charges.charge_type,\n                // plane_unit_price: vm.bookout.plane_charges.charge_rate_unit,\n                // plane_units: plane_units,\n                // plane_total: plane_total,\n                // surcharge_charge_type: vm.bookout.plane_charges.surcharge_type,\n                // surcharge_unit_price: vm.bookout.plane_charges.surcharge_fee,\n                // surcharge_units: surcharge_units,\n                // surcharge_total: surcharge_total,\n                // landing_units: landing_units,\n                // landing_unit_price: vm.bookout.plane_charges.landing_fee,\n                // landing_total: landings_total,\n                // tng_units: tg_units,\n                // tng_unit_price: vm.bookout.plane_charges.touch_and_go_fee,\n                // tng_total: tng_total,\n                // tuition_charge_type: tuition_charge_type,\n                // tuition_unit_price: tuition_price,\n                // tuition_units: tuition_units,\n                // tuition_total: tuition_total,\n                //receipts: receipts,\n                total: 0\n            };\n\n            //vm.bookout.tuition_charges\n\n        }\n\n        vm.instructor_charges = []; \n\n\n        // vm.update_book_in_options = function(){\n        //     vm.complete_flight = ( (vm.bookout.flight_type.title !== \"Local\" && vm.bookout.to_airfield.id !== vm.bookout.home_airport_id) || vm.bookout.to_airfield.id !== vm.bookout.home_airport_id) ? false : true;\n        // }\n        vm.complete_flight = true;\n       \n\n\n        // var compile_invoice = function(){\n        //     var items = [];\n        //     // vm.plane_charges\n        //     //add plane costs\n        //     items.push({title: \"Plane \"+vm.plane_charges.plane_charge_type+\" Charge\", unit: vm.plane_charges.plane_units, unit_price: vm.plane_charges.plane_unit_price, total: vm.plane_charges.plane_total, organise: 0});\n        //     if(vm.plane_charges.surcharge_total > 0){\n        //         items.push({title: \"Surcharge per \"+vm.plane_charges.surcharge_charge_type, unit: vm.plane_charges.surcharge_units, unit_price: vm.plane_charges.surcharge_unit_price, total: vm.plane_charges.surcharge_total, organise: 1});\n        //     }\n        //     if(vm.plane_charges.tuition_total > 0){\n        //         items.push({title: \"Tuition Charge - \"+vm.bookout.tuition_required.title, unit: vm.plane_charges.tuition_units, unit_price: vm.plane_charges.tuition_unit_price, total: vm.plane_charges.tuition_total, organise: 2});\n        //     }\n        //     if(vm.plane_charges.landing_total > 0){\n        //         items.push({title: \"Home Landing\", unit: vm.plane_charges.landing_units, unit_price: vm.plane_charges.landing_unit_price, total: vm.plane_charges.landing_total, organise: 4});\n        //     }\n        //     if(vm.plane_charges.tng_total > 0){\n        //         items.push({title: \"Home Touch and Go\", unit: vm.plane_charges.tng_units, unit_price: vm.plane_charges.tng_unit_price, total: vm.plane_charges.tng_total, organise: 3});\n        //     }\n           \n\n        //     //RENTAL ITEMS !? --> make it free for now...\n\n        //     for(var i=0;i<vm.plane_charges.receipts.length;i++){\n        //         var org = parseInt(5 + i)\n        //         items.push({title: \"Reimbursement - \"+vm.plane_charges.receipts[i].item, unit: vm.plane_charges.receipts[i].quantity, unit_price: (vm.plane_charges.receipts[i].price / vm.plane_charges.receipts[i].quantity), total: -vm.plane_charges.receipts[i].price, organise: org});\n        //     }\n\n        //     return items;\n        // }\n\n\n\n\n\n\n        //complete the booking back in\n        vm.book_in_flight = function(method='', paymentIntent=null){\n\n            var obj = {\n                //payer_id: vm.bookout.payer_id, // >>>? is this required here?\n                user_id: vm.bookout.user_id,\n                club_id: vm.bookout.club_id,\n                plane_id: vm.bookout.plane_id,\n                booking_id: vm.bookout.booking_id,\n                paying_now: vm.complete_flight,\n                free_flight: (vm.invoice_totals == 0) ? true : false\n            };\n\n            //methods: bacs, card, new_card, cardmachine - overwritten\n            //direct-debit, saved-card, new-card, card-machine\n            if(method == \"new-card\"){\n                obj.paymentIntent = paymentIntent;\n                obj.method = method;\n            } else if(method == \"saved-card\"){\n                obj.paymentIntent = paymentIntent;\n                obj.method = method;\n            } else if(method == \"direct-debit\"){\n                //nothing to add - it should just work...\n                obj.method = method;\n            } else if(method == \"card-machine\"){\n                //nothing here at the moment?\n                obj.paymentIntent = paymentIntent;\n                obj.method = method;\n            }\n\n            // //console.log(\"TO BE SENDING : \", obj);\n            //return false;\n            BookoutService.PayBooking(vm.bookout.id, obj)\n            .then(function(data){\n                //console.log(\"SENT - \", data);\n                if(data.success){\n                        vm.show_loading = false;\n                        $state.go('dashboard.my_account', {}, { reload: true });                    \n                } else {\n                    alert(\"an error occurred.... \\n\\n \"+data.message);\n                    vm.show_loading = false;\n                    //console.log(data);\n                }\n            });\n\n        }\n\n\n\n\n        vm.start_tacho_orig;\n\n\n\n\n\n        function process_bookout_to_bookin(booking){\n\n\n            //vm.bookout is where we want to fill the content....\n            vm.bookout.booking_id = booking.id;\n            vm.bookout.club_id = booking.club_id;\n            vm.bookout.user_id = booking.user_id;\n            vm.bookout.plane = booking.plane;\n            vm.club_id = booking.club_id;\n            // vm.bookout.return = new Date(booking.end);\n            // vm.bookout.booking_start = new Date(booking.start);\n\n\n              if(((vm.user.access.instructor.indexOf(vm.club_id) > -1) || (vm.user.access.manager.indexOf(vm.club_id) > -1) ) && vm.bookout.user_id !== vm.user.id){\n                //console.log(\"NOT BOOKING FOR SELF?\");\n                vm.can_authorise = true;\n\n            }\n\n\n            vm.invoices = [];\n            vm.previous_total = 0;\n            InvoicesService.GetAllByBooking(booking.id)\n            .then(function (data) {\n                    //console.log(\"invoice data is : \", data);\n                   \n                    if(data.success){\n                        //console.log(\"we already have invoices for this booking\");\n                        vm.previous_invoice = data.invoice;\n\n                        for(var me in data.invoices){\n\n                            for (var key in data.invoices[me].flights) {\n                                //console.log(\"KEY \", key);\n\n                                if(data.invoices[me] && data.invoices[me].status && data.invoices[me].status.toLowerCase() !== \"paid\"){\n                                   vm.invoices.push(data.invoices[me].flights[key]);\n                                    vm.previous_total = (Number.parseFloat(vm.previous_total) + Number.parseFloat(data.invoices[me].flights[key][\"total\"]));\n                                }\n                                  \n\n                                //vm.calculate_invoice_for_flight();\n                                // for(var i=0;i<data.invoice.flights[key].length;i++){\n                                // }\n                            }\n\n                        }\n                        \n\n\n                        // for (var key in data.invoice.flights) {\n                        //     //console.log(\"KEY \", key);\n\n                        //     if(data.invoice && data.invoice.status && data.invoice.status.toLowerCase() !== \"paid\"){\n                        //        vm.invoices.push(data.invoice.flights[key]);\n                        //         vm.previous_total = (Number.parseFloat(vm.previous_total) + Number.parseFloat(data.invoice.flights[key][\"total\"]));\n                        //     }\n                              \n\n                        //     //vm.calculate_invoice_for_flight();\n                        //     // for(var i=0;i<data.invoice.flights[key].length;i++){\n                        //     // }\n                        // }\n                        \n                        vm.complete_this_flight();\n                        vm.invoice_totals = vm.previous_total;\n\n                        //was var send before...\n                        vm.send = {\n                            club_id: vm.bookout.club_id,\n                            user_id: vm.user.id,\n                            booking_id: booking.id\n                        }\n\n                        /*\n                        VM.SEND --> TO THE PAYMENT MODAL\n                            if invoice --> remove booking_id add invoice_id \n                            if no invoice / booking --> remove both and add amount * 100\n                            ie: amount: vm.invoice_totals * 100,\n                            user must be the user for that invoice / PAYER ID --> careful on admin functions\n                        */\n\n                        vm.show_add_card = true;\n\n                        //SETUP THE VM TO SEE THE MENU HERE???\n                        //AND INCLUDE THE SEND OBJ?\n\n                        if(vm.previous_total == 0 || vm.invoices.length == 0){\n\n                            alert(\"It appears that you have already completed this flight!\");\n                            $state.go('dashboard.my_account', {}, { reload: true });                    \n\n                        }\n\n\n\n\n\n                        /*\n        --> ORIGINAL CODE HERE\n                        PaymentService.CreatePaymentIntentNewCard(send)\n                        .then(function (data) {\n                            console.log(\"DATA HERE\", data);\n                            // Initialize Stripe.js\n                            var stripe = Stripe('pk_test_51QttFFG8WiGSRCORyxkdZTO8oajcqz9OUsvcDJFpr9FB2PAdbzJc0tS7WNnfzKYsTiqHN1YDZi5UtXk4K52SeD4h00YWXuChNd');\n\n                            const options = {\n                              clientSecret: data.client_secret,\n                              // Fully customizable with appearance API.\n                              appearance: {},\n                              paymentMethodOrder: ['card', 'apple_pay', 'google_pay']\n\n                            };\n\n                            // Set up Stripe.js and Elements using the SetupIntent's client secret\n                            const elements = stripe.elements(options);\n\n                            // Create and mount the Payment Element\n                            const paymentElementOptions = { layout: 'tabs'};\n                            const paymentElement = elements.create('payment', paymentElementOptions);\n                            paymentElement.mount('#payment-element');\n\n\n                            const submitButton = document.getElementById('submit-stripe');\n                            if (submitButton) {\n                              submitButton.addEventListener('click', async (event) => {\n\n                                $scope.$apply(() => {\n                                    vm.show_loading = true;\n                                });\n                                event.preventDefault();\n                                //console.log('Submit button clicked!');\n                                \n                                // Process the payment manually\n                                const {error, paymentIntent} = await stripe.confirmPayment({\n                                  elements,\n                                  confirmParams: {\n                                   // return_url: 'https://example.com/order/confirmation',\n                                  },\n                                  redirect: 'if_required', // Only redirect if absolutely necessary\n                                });\n                                \n                                if (error) {\n                                  console.error(error);\n\n                                  $scope.$apply(() => {\n                                        vm.show_loading = false;\n                                    });\n\n                                } else if(paymentIntent){\n                                    //console.log(\"SUCCESS??\");\n                                        if (paymentIntent.status === 'succeeded') {\n                                            //console.log(\"PAYMENT SUCCEEDED!!\");\n\n                                            //this is where I will now look at confirming that this is paid etc...paymentIntent\n\n                                            $scope.$apply(() => {\n                                                vm.book_in_flight('new_card', paymentIntent);\n                                            });\n                                            \n\n                                        } else {\n                                             //console.log(\"There was an error processing your payment\");\n                                            $scope.$apply(() => {\n                                                vm.show_loading = true;\n                                            });\n                                        }\n                                }\n                              });\n                            }\n\n\n\n\n                        });\n */\n\n\n\n\n\n\n\n                //SAMPLE ACCORDION MENU TO SELECT THE PAYMENT METHOD\n\n                        //console.log(\"FLIGHTS\", vm.invoices);\n                        //console.log(\"FLIGHTS TOTAL\", vm.previous_total);\n                        // vm.invoices = data.invoice.flights;\n                    } else {\n                        //console.log(\"no invoices have yet been issued for this flight\");\n                    }\n\n\n                });\n\n\n\n            // PlaneService.GetOpenIssues(booking.plane_id)\n            // .then(function (data) {\n            //         ////console.log(\"data is : \", data);\n            //        vm.reported_defects = data;\n            //     });\n\n            //   PlaneService.GetAllSheetReceipts(vm.bookout.id)\n            //     .then(function (data) {\n            //         ////console.log(\"data is : \", data);\n            //         vm.lubricant_receipts = data;\n            //     });\n\n\n            //     InstructorCharges.GetByClubId(booking.club_id)\n            //     .then(function(data){\n            //         vm.instructor_charges = data.items;  \n            //     });\n            //we need to update the PICS now...\n\n           \n            //we need to know where the plane was last booked-in at \n            //(ie: if last flight bookout was completed - where the plane landed at last)\n            //if the last booking was not yet completed, then we can assume that this last flight was returning to base.\n\n\n            \n            // var selected_pic = vm.pics.find(item => item.user_id === booking.pic_id);\n            // vm.bookout.pic = selected_pic;\n\n            // //console.log(\"booking.detail_type_id\", booking.detail_type_id);\n\n            // // var selected_detail_type = vm.flight_types.find(item => item.id === booking.detail_type_id);\n            // // vm.bookout.flight_type = selected_detail_type;\n\n            // if(booking.instructor && booking.instructor !== \"\" && booking.instructor.id == booking.pic_id){\n            //     vm.bookout.put = vm.bookout.user;\n            // }\n\n           \n\n            // vm.bookout.from_airfield = booking.from_airport;\n            // vm.bookout.to_airfield = booking.to_airport;\n\n            // vm.bookout.start_tacho = Number.parseFloat(booking.last_tacho);\n            \n            // vm.start_tacho_orig = booking.last_tacho;\n\n\n\n           \n             //this is where we sort out some of the last bits....\n\n\n\n            // if(booking.instructor && booking.instructor !== \"\" && booking.instructor.id > 0){\n            //     // then we need to set the PIC as the instructor\n            //     //select from pics where user_id = booking.user_id;\n            //     var selected_pic = vm.pics.find(item => item.user_id === booking.instructor.id);\n            //     //set the PIC now...\n            //     vm.bookout.pic = selected_pic;\n            //     vm.bookout.instructor_id = booking.instructor.id;\n            //     vm.bookout.instructor = booking.instructor;\n\n\n            //     var selected_put = vm.pics.find(item => item.user_id === booking.user_id);\n            //     vm.bookout.put = selected_put;\n\n            // } else {\n            //     //then the user is the PIC\n            //     var selected_pic = vm.pics.find(item => item.user_id === booking.user_id);\n            //     vm.bookout.pic = selected_pic;\n\n            // }\n\n       \n\n            // if(booking && booking.plane_details && booking.plane_details.location && booking.plane_details.location.wgs_n){\n            //     vm.wgs_n = booking.plane_details.location.wgs_n\n            //     vm.wgs_e = booking.plane_details.location.wgs_e;\n            // }\n            // var location_default = \"\";\n\n            // if(booking && booking.plane_details && booking.plane_details.location && booking.plane_details.location.code){\n            //     location_default = booking.plane_details.location.code.slice(0, -1);\n            // } else {\n            //     location_default = \"EG\";\n            // }\n\n            // //vm.update_book_in_options();\n\n            // BookoutService.GetAirfieldsByCode(location_default)\n            //     .then(function (data) {\n            //         if(data.success){\n            //             //use GB airfields first...\n            //             vm.airfields = data.airfields;\n            //             // var selected_location = vm.airfields.find(item => item.id === booking.plane_details.location.id);\n            //             // //console.log(\"selected_location\", selected_location);\n            //             // vm.bookout.from_airfield = selected_location;\n            //            }\n            //         });\n\n\n\n            //booking.plane_details.location.id\n            // vm.bookout.pic = selected_pic;\n\n\n        }\n\n\n            //nice looking date pickers\n\n\n            $scope.popup = [];\n\n            $scope.open = function(id, $event) {\n                //console.log(\"THIS\", id);\n                //this comment would allow the event not to be affect by clicking it again... not sure this is a good idea\n                if($scope.popup[id] && $scope.popup[id].opened == true){\n                    $event.preventDefault();\n                    $event.stopPropagation();\n                } else {\n                    $scope.popup[id] = {opened: true};\n                }\n            };\n\n            $scope.formats = ['dd/MM/yyyy', 'yyyy/MM/dd', 'dd.MM.yyyy', 'shortDate'];\n            $scope.format = $scope.formats[0];\n\n            $scope.datePickerOptions = {\n                                        format: 'dd/MM/yyyy',\n                                        showWeeks: false\n                                    };\n\n           \n\n         \n        \n\n\n    }\napp.controller('GalleriesController', GalleriesController);\n \n    GalleriesController.$inject = ['UserService', 'ArtpiecesService', 'ImagesService', 'KeywordsService', 'CategoryService', '$location', '$rootScope', 'FlashService', '$routeParams', '$scope', 'LocalDataService', 'GalleryService'];\n    function GalleriesController(UserService, ArtpiecesService, ImagesService, KeywordsService, CategoryService, $location, $rootScope, FlashService, $routeParams, $scope, LocalDataService, GalleryService) {\n        var vm = this;\n\n      \n\n        //get all galleries to check if name is already in use...\n        GalleryService.GetAll()\n                .then(function(data){\n                     vm.galleries = data;\n                     LocalDataService.SetAllGalleries(data);\n                     if(LocalDataService.data.selecting_for > 0){\n                        vm.galleries.forEach(function(data){\n                            if(data.id == LocalDataService.data.selecting_for){\n                                data.images = LocalDataService.data.selected_images;\n                            }\n                        });\n                        $(\"#organise_images\").fadeIn();\n                        //maybe we need to update the state of the SAVE button as it hasn't been saved yet?\n                     } else {\n                        //nothin to do?\n                     }\n                });\n\n\n\n        vm.images = LocalDataService.data.selected_images;\n\n        //this is where we do the selection of images\n        $scope.remove_image = function(image){\n            //check if set selected\n            //well its selected - so we deselect right?\n            vm.images = $.grep(vm.images, function(e){ \n                return e.id != image.id; \n            });\n            //console.log(vm.images);\n            LocalDataService.SetSelectedImages(vm.images);\n        }\n\n        $scope.check_link_unique = function(){\n            for(var i = 0; i < vm.all_galleries.length; i++){\n                if(vm.all_galleries[i].link===vm.gallery.link){\n                    return false;\n                }\n            }\n        }\n\n        $scope.edit_gallery_images = function(index){\n             var gallery = vm.galleries[index];\n             for(var i=0; i < gallery.images.length; i++){\n                gallery.images[i].selected = true;\n             }\n            LocalDataService.SetSelectedImages(gallery.images);\n            LocalDataService.SetSelectingFor(gallery.id);\n            //console.log(gallery.images);\n            //SetSelectingFor\n            $location.path(\"/select_images\");\n        }\n\n        $scope.save_images = function(){\n            //save images for \n            var images_to_save = [];\n            vm.galleries.forEach(function(data){\n                if(data.id == LocalDataService.data.selecting_for){\n                    data.images = LocalDataService.data.selected_images;\n                    for(var i = 0; i < data.images.length; i++){\n                        data.images[i].organise = i;\n                    }\n                    images_to_save = data.images;\n                }\n            }); \n\n            //vm.galleries[LocalDataService.data.selecting_for]\n            GalleryService.Update({id: LocalDataService.data.selecting_for, images: images_to_save})\n                .then(function(data){\n                    //console.log(data);\n                    LocalDataService.SetSelectingFor(0);\n                    $(\"#organise_images\").fadeOut();\n                });\n           \n        }\n\n\n        $scope.save_gallery = function(index){\n           \n            var gallery = vm.galleries[index];\n            LocalDataService.SetSelectedImages(gallery.images);\n            //we need to set the ORDER as organise in the vm.images\n            var organise = 0;\n            for(var i = 0; i < gallery.images.length; i++){\n                gallery.images[i].organise = i;\n            }\n\n\n            GalleryService.Update(vm.galleries[index])\n                .then(function(data){\n                    //console.log(data);\n                    alert(\"saved\");\n                    //$location.path(\"/\");\n                });\n        }\n\n        var check_gallery_link = function(link){\n            vm.galleries.forEach(function(data){\n                if(data.gallery_link == link){\n                    return false;\n                }\n            });\n            return true;\n        }\n\n        var generate_gallery_link = function(link){\n            var link2 = link + \"-COPY\";\n            if(check_gallery_link(link2)){\n                return link2;\n            } else {\n                return generate_gallery_link(link2+\"1\");\n            }\n        }\n\n        $scope.duplicate_gallery = function(index){\n            //console.log(\"INDEX : \"+index);\n            //HERE BE DRAGONS HORRIBLE HACKY SHIT TO DUPLICATE OBJ\n            var new_gallery = JSON.parse(JSON.stringify(vm.galleries[index]));\n            //console.log(new_gallery);\n            //unset the id to create a new one...\n            delete new_gallery.id;\n            new_gallery.opened = 0;\n            new_gallery.downloaded = 0;\n            //console.log(new_gallery);\n\n            new_gallery.gallery_link = generate_gallery_link(new_gallery.gallery_link);\n\n             GalleryService.Create(new_gallery)\n                .then(function(data){\n                    //console.log(data);\n                    vm.galleries.push(data);\n                });\n\n        }\n\n        $scope.delete_gallery = function(index){\n            //console.log(\"INDEX : \"+index);\n            var gallery = vm.galleries[index];\n            //console.log(gallery);\n            //unset the id to create a new one...\n            //console.log(gallery.id);\n\n            GalleryService.Delete(gallery.id)\n                .then(function(data){\n                    //console.log(data);\n                    \n                    vm.galleries = $.grep(vm.galleries, function(e){ \n                         return e.id != gallery.id; \n                    });\n\n                });\n\n        }\n\n       \n\n\n\n    }\n app.controller('HomeController', HomeController);\n\n    HomeController.$inject = ['UserService', '$rootScope', '$location'];\n    function HomeController(UserService, $rootScope, $location) {\n        var vm = this;\n\n        vm.user = $rootScope.globals.currentUser;\n        \n        vm.allUsers = [];\n        vm.deleteUser = deleteUser;\n\n        initController();\n\n        function initController() {\n            loadCurrentUser();\n            loadAllUsers();\n        }\n\n        function loadCurrentUser() {\n            UserService.GetById($rootScope.globals.currentUser.id)\n                .then(function (data) {\n                    vm.user = data.user;\n                });\n        }\n\n        function loadAllUsers() {\n            UserService.GetAll()\n                .then(function (data) {\n                    vm.allUsers = data.users;\n                });\n        }\n\n       \n        function deleteUser(id) {\n            UserService.Delete(id)\n            .then(function(data) {\n                if(data.success){\n\t                $location.path('/');\n                }\n            });\n        }\n    }\napp.controller('ImagesController', ImagesController);\n \n    ImagesController.$inject = ['UserService', 'ArtpiecesService', 'ImagesService', 'KeywordsService', 'CategoryService', '$location', '$rootScope', 'FlashService', '$routeParams', '$scope', 'LocalDataService'];\n    function ImagesController(UserService, ArtpiecesService, ImagesService, KeywordsService, CategoryService, $location, $rootScope, FlashService, $routeParams, $scope, LocalDataService) {\n        var vm = this;\n        $scope.filters = \"\";\n        vm.selected_images = [];\n\n\n         ImagesService.GetAll()\n                .then(function (data) {\n                    vm.images = data;\n                });\n\n          ArtpiecesService.GetAll()\n                .then(function(data){\n                    vm.all_artpieces = data;\n                    vm.artpieces = data;\n                });\n\n         CategoryService.GetAll()\n                .then(function(data){\n                    vm.categories = data;\n                });\n\n\n        //get one?\n        if($routeParams.imageId){\n            ImagesService.GetOne($routeParams.imageId)\n                    .then(function (data) {\n                        vm.one_image = data;\n                        //console.log(vm.one_image);\n\n                        //console.log(vm.one_image.keywords);\n                        //console.log(vm.one_image.keywords[0]);\n                        //console.log(vm.one_image.keywords[0].id);\n\n                        //converting the keywords to the appropriate format for the front-end\n                        var tags = [];\n                        vm.one_image.keywords.forEach(function(data){\n                            tags.push({id: data.id, text: data.keyword});\n                        });\n                        //console.log(tags);\n                        $scope.tags = tags;      \n\n                    });\n        }\n\n\n         KeywordsService.GetAll()\n                .then(function (data) {\n                    vm.all_keywords = data;\n                    //console.log(vm.all_keywords);\n                    vm.all_tags = [];\n                    vm.all_keywords.forEach(function(data){\n                        vm.all_tags.push({id: data.id, text: data.keyword});\n                    });\n                });\n\n\n        var init = function(){\n            setTimeout(function(){\n                vm.selected_images = LocalDataService.data.selected_images;\n                //console.log(\"RUN ME\");\n                var select\n                if(vm.selected_images.length > 0){\n                    //console.log(\"checking\");\n                    vm.selected_images.forEach(function(image){\n                        //console.log(\"foreach\");\n                        if(image.selected == 1){\n                            //well its selected - so we deselect right?\n\n                             //vm.selected_images.push(image);\n                            update_selected_state(image.id, true);\n\n                           \n                        } else {\n                            update_selected_state(image.id, false);\n                            vm.selected_images = $.grep(vm.selected_images, function(e){ \n                                return e.id != image.id; \n                            });\n                        }\n                    });\n                }\n            }, 500);\n        }\n\n\n        //action on the isotope bit\n        var update_image_list = function(){\n            var get_tags = $scope.tags;\n            var filtering = $scope.filters;\n            //console.log(\"FILTERING BIT\");\n            //console.log(filtering);\n            if(filtering && filtering.indexOf(\", \")){\n                var filter_array = filtering.split(\", \");\n                filtering = \"\";\n                var multi_level_filter = [];\n                filter_array.forEach(function(data){\n                    var loop_content = data;\n                    if(get_tags){\n                         get_tags.forEach(function(data){\n                            loop_content += \".\"+data.text;\n                        });\n                    }\n                    multi_level_filter.push(loop_content);\n                });\n                //console.log(multi_level_filter);\n                //console.log(\"ABOVE\");\n                filtering = multi_level_filter.join(\", \");\n            } else {\n                if(get_tags){\n                     get_tags.forEach(function(data){\n                        filtering += \".\"+data.text;\n                    });\n                }\n            }\n            //console.log(filtering);\n            $scope.$emit('iso-option', {filter: filtering});\n        }\n\n        var current_category = 0;\n\n        $scope.change_category = function(index){\n            //console.log(\"LOADING INDEX : \"+index);\n            current_category = index;\n            if(index == \"all\"){\n                //console.log(\"SHOW ALL HERE PLEASE\");\n                vm.artpieces = vm.all_artpieces;\n                $scope.filters = \"\";\n                update_image_list();\n            } else {\n                vm.artpieces = (vm.categories[index].artpieces) ? vm.categories[index].artpieces : [];\n                if(vm.categories[index].artpieces && vm.categories[index].artpieces.length > 0){\n                    var all = vm.categories[index].artpieces;\n                    var artpieces_array = [];\n                    all.forEach(function(data){\n                        artpieces_array.push(\".artpiece\"+data.id);\n                    });\n                    $scope.filters = artpieces_array.join(\", \");\n                    update_image_list();\n                    return $scope.filters;\n                } else {\n                    $scope.filters = \".hideAllPossibleItems\";\n                    update_image_list();\n                }\n            }\n        }\n\n        // filter by actpiece here :)\n        $scope.artpiece_filter = function(filter){\n            $scope.filters = (filter == \"all\") ? ( (current_category == 0) ? \"\" : $scope.change_category(current_category) ) : \".artpiece\"+filter;\n            update_image_list();\n        }        \n\n        //filter by image keyword\n        $scope.update_list = function(){\n            // 500ms delay due to not ready state called occasionally...\n            setTimeout(function(){\n                //console.log($scope.tags);\n                //this is when isotope should be called\n                //filter tag WITH all in tags \n                update_image_list();\n            }, 500);\n        }\n\n\n\n        //testing the requirements bit\n        // $scope.shuffle = function(){\n        //     var get_tags = $scope.tags;\n        //     var filtering = \"\";\n        //     get_tags.forEach(function(data){\n        //         filtering += \".\"+data.text;\n        //     });\n        //     $scope.$emit('iso-option', {filter: filtering});\n        // }\n\n        var update_selected_state = function(id, state){\n            for(var i = 0; i < vm.images.length; i++) {\n                if (vm.images[i].id === id) {\n                    vm.images[i].selected = state;\n                }\n            }\n        }\n\n\n        //this is where we do the selection of images\n        $scope.add_image = function(image){\n            //check if set selected\n            if(image.selected == 1){\n                //well its selected - so we deselect right?\n                update_selected_state(image.id, false);\n                vm.selected_images = $.grep(vm.selected_images, function(e){ \n                    return e.id != image.id; \n                });\n            } else {\n                vm.selected_images.push(image);\n                update_selected_state(image.id, true);\n            }\n            //console.log(vm.selected_images);\n            LocalDataService.SetSelectedImages(vm.selected_images);\n        }\n\n        vm.save_btn_text = (LocalDataService.data.selecting_for > 0) ? \"UPDATE GALLERY\" : \"GENERATE GALLERY\";\n\n        $scope.save = function(){\n            //console.log(LocalDataService.data.selected_images);\n            var url_save = (LocalDataService.data.selecting_for > 0) ? \"/galleries\" : \"/create_gallery\";\n            $location.path(url_save);\n        }\n\n       \n\n        $scope.editImage = function(){\n            //compile all content :::\n            vm.one_image.keywords = $scope.tags;\n            ImagesService.Update(vm.one_image)\n                .then(function (data) {\n                     $location.path(\"/images\");\n                     vm.one_image = {};\n                });\n        }\n\n        $scope.loadClasses = function(classes){\n            // var arr = [];\n            //console.log(classes);\n            return \"one two three\";\n\n        }\n\n        $scope.loadTags = function(query) {\n\n            var first = $.grep(vm.all_keywords, function(e){ var ab = e.keyword; var ab = ab.toLowerCase(); if(ab.startsWith(query.toLowerCase())){ return true; } });\n            var second = [];\n            for(var i = 0; i < first.length; i++){\n                var text_to_lower = first[i].keyword;\n                text_to_lower = text_to_lower.toLowerCase();\n                second.push({id: first[i].id, text: text_to_lower});\n            }\n            return second;\n\n        };\n\n\n\t\t$scope.deleteImage = function(id){\n\t\t\tImagesService.Delete(id)\n                .then(function (data) {\n                    vm.images = $.grep(vm.images, function(e){ \n\t\t\t\t\t     return e.id != id; \n\t\t\t\t\t});\n                });\n\t\t}\n\n        init();\n\n    }\n app.controller('InvitationsSignupController', InvitationsSignupController);\n\n    InvitationsSignupController.$inject = ['UserService', 'MemberService', 'GoCardService', '$http', '$rootScope', '$location', '$scope', '$state', '$stateParams', '$cookies', '$log'];\n    function InvitationsSignupController(UserService, MemberService, GoCardService, $http, $rootScope, $location, $scope, $state, $stateParams, $cookies, $log) {\n        \t\n        \tvar vm = this;\n\n        \t$scope.formData = {};\n\n\nvm.selected_phone;\n\n vm.countries = [\n {\n   \"CountryCode\": \"+247\",\n   \"CountryCodeISO\": \"SH\",\n   \"Country\": \"Ascension\"\n },\n {\n   \"CountryCode\": \"+246\",\n   \"CountryCodeISO\": \"DG\",\n   \"Country\": \"Diego Garcia\"\n },\n {\n   \"CountryCode\": \"+291\",\n   \"CountryCodeISO\": \"ER\",\n   \"Country\": \"Eritrea\"\n },\n {\n   \"CountryCode\": \"+500\",\n   \"CountryCodeISO\": \"FK\",\n   \"Country\": \"Falkland (Malvinas) Islands\"\n },\n {\n   \"CountryCode\": \"+692\",\n   \"CountryCodeISO\": \"MH\",\n   \"Country\": \"Marshall Islands\"\n },\n {\n   \"CountryCode\": \"+691\",\n   \"CountryCodeISO\": \"FM\",\n   \"Country\": \"Micronesia\"\n },\n {\n   \"CountryCode\": \"+683\",\n   \"CountryCodeISO\": \"NU\",\n   \"Country\": \"Niue Island\"\n },\n {\n   \"CountryCode\": \"+290\",\n   \"CountryCodeISO\": \"SH\",\n   \"Country\": \"Saint Helena\"\n },\n {\n   \"CountryCode\": \"+508\",\n   \"CountryCodeISO\": \"PM\",\n   \"Country\": \"Saint Pierre and Miquelon\"\n },\n {\n   \"CountryCode\": \"+690\",\n   \"CountryCodeISO\": \"TK\",\n   \"Country\": \"Tokelau\"\n },\n {\n   \"CountryCode\": \"+688\",\n   \"CountryCodeISO\": \"TV\",\n   \"Country\": \"Tuvalu\"\n },\n {\n   \"CountryCode\": \"+379\",\n   \"CountryCodeISO\": \"VA\",\n   \"Country\": \"Vatican City\"\n },\n {\n   \"CountryCode\": \"+681\",\n   \"CountryCodeISO\": \"WF\",\n   \"Country\": \"Wallis and Futuna\"\n },\n {\n   \"CountryCode\": \"+1\",\n   \"CountryCodeISO\": \"AS\",\n   \"Country\": \"American Samoa\"\n },\n {\n   \"CountryCode\": \"+1\",\n   \"CountryCodeISO\": \"CA\",\n   \"Country\": \"Canada\"\n },\n {\n   \"CountryCode\": \"+61\",\n   \"CountryCodeISO\": \"AU\",\n   \"Country\": \"Australia\"\n },\n {\n   \"CountryCode\": \"+93\",\n   \"CountryCodeISO\": \"AF\",\n   \"Country\": \"Afghanistan\"\n },\n {\n   \"CountryCode\": \"+355\",\n   \"CountryCodeISO\": \"AL\",\n   \"Country\": \"Albania\"\n },\n {\n   \"CountryCode\": \"+213\",\n   \"CountryCodeISO\": \"DZ\",\n   \"Country\": \"Algeria\"\n },\n {\n   \"CountryCode\": \"+376\",\n   \"CountryCodeISO\": \"AD\",\n   \"Country\": \"Andorra\"\n },\n {\n   \"CountryCode\": \"+244\",\n   \"CountryCodeISO\": \"AO\",\n   \"Country\": \"Angola\"\n },\n {\n   \"CountryCode\": \"+54\",\n   \"CountryCodeISO\": \"AR\",\n   \"Country\": \"Argentina\"\n },\n {\n   \"CountryCode\": \"+374\",\n   \"CountryCodeISO\": \"AM\",\n   \"Country\": \"Armenia\"\n },\n {\n   \"CountryCode\": \"+297\",\n   \"CountryCodeISO\": \"AW\",\n   \"Country\": \"Aruba\"\n },\n {\n   \"CountryCode\": \"+43\",\n   \"CountryCodeISO\": \"AT\",\n   \"Country\": \"Austria\"\n },\n {\n   \"CountryCode\": \"+994\",\n   \"CountryCodeISO\": \"AZ\",\n   \"Country\": \"Azerbaijan\"\n },\n {\n   \"CountryCode\": \"+973\",\n   \"CountryCodeISO\": \"BH\",\n   \"Country\": \"Bahrain\"\n },\n {\n   \"CountryCode\": \"+880\",\n   \"CountryCodeISO\": \"BD\",\n   \"Country\": \"Bangladesh\"\n },\n {\n   \"CountryCode\": \"+375\",\n   \"CountryCodeISO\": \"BY\",\n   \"Country\": \"Belarus\"\n },\n {\n   \"CountryCode\": \"+32\",\n   \"CountryCodeISO\": \"BE\",\n   \"Country\": \"Belgium\"\n },\n {\n   \"CountryCode\": \"+501\",\n   \"CountryCodeISO\": \"BZ\",\n   \"Country\": \"Belize\"\n },\n {\n   \"CountryCode\": \"+229\",\n   \"CountryCodeISO\": \"BJ\",\n   \"Country\": \"Benin\"\n },\n {\n   \"CountryCode\": \"+975\",\n   \"CountryCodeISO\": \"BT\",\n   \"Country\": \"Bhutan\"\n },\n {\n   \"CountryCode\": \"+591\",\n   \"CountryCodeISO\": \"BO\",\n   \"Country\": \"Bolivia\"\n },\n {\n   \"CountryCode\": \"+387\",\n   \"CountryCodeISO\": \"BA\",\n   \"Country\": \"Bosnia and Herzegovina\"\n },\n {\n   \"CountryCode\": \"+267\",\n   \"CountryCodeISO\": \"BW\",\n   \"Country\": \"Botswana\"\n },\n {\n   \"CountryCode\": \"+55\",\n   \"CountryCodeISO\": \"BR\",\n   \"Country\": \"Brazil\"\n },\n {\n   \"CountryCode\": \"+673\",\n   \"CountryCodeISO\": \"BN\",\n   \"Country\": \"Brunei\"\n },\n {\n   \"CountryCode\": \"+359\",\n   \"CountryCodeISO\": \"BG\",\n   \"Country\": \"Bulgaria\"\n },\n {\n   \"CountryCode\": \"+226\",\n   \"CountryCodeISO\": \"BF\",\n   \"Country\": \"Burkina Faso\"\n },\n {\n   \"CountryCode\": \"+257\",\n   \"CountryCodeISO\": \"BI\",\n   \"Country\": \"Burundi\"\n },\n {\n   \"CountryCode\": \"+855\",\n   \"CountryCodeISO\": \"KH\",\n   \"Country\": \"Cambodia\"\n },\n {\n   \"CountryCode\": \"+237\",\n   \"CountryCodeISO\": \"CM\",\n   \"Country\": \"Cameroon\"\n },\n {\n   \"CountryCode\": \"+238\",\n   \"CountryCodeISO\": \"CV\",\n   \"Country\": \"Cape Verde\"\n },\n {\n   \"CountryCode\": \"+236\",\n   \"CountryCodeISO\": \"CF\",\n   \"Country\": \"Central African Republic\"\n },\n {\n   \"CountryCode\": \"+235\",\n   \"CountryCodeISO\": \"TD\",\n   \"Country\": \"Chad\"\n },\n {\n   \"CountryCode\": \"+56\",\n   \"CountryCodeISO\": \"CL\",\n   \"Country\": \"Chile\"\n },\n {\n   \"CountryCode\": \"+86\",\n   \"CountryCodeISO\": \"CN\",\n   \"Country\": \"China\"\n },\n {\n   \"CountryCode\": \"+57\",\n   \"CountryCodeISO\": \"CO\",\n   \"Country\": \"Colombia\"\n },\n {\n   \"CountryCode\": \"+269\",\n   \"CountryCodeISO\": \"KM\",\n   \"Country\": \"Comoros\"\n },\n {\n   \"CountryCode\": \"+242\",\n   \"CountryCodeISO\": \"CG\",\n   \"Country\": \"Congo\"\n },\n {\n   \"CountryCode\": \"+682\",\n   \"CountryCodeISO\": \"CK\",\n   \"Country\": \"Cook Islands\"\n },\n {\n   \"CountryCode\": \"+506\",\n   \"CountryCodeISO\": \"CR\",\n   \"Country\": \"Costa Rica\"\n },\n {\n   \"CountryCode\": \"+385\",\n   \"CountryCodeISO\": \"HR\",\n   \"Country\": \"Croatia\"\n },\n {\n   \"CountryCode\": \"+53\",\n   \"CountryCodeISO\": \"CU\",\n   \"Country\": \"Cuba\"\n },\n {\n   \"CountryCode\": \"+357\",\n   \"CountryCodeISO\": \"CY\",\n   \"Country\": \"Cyprus\"\n },\n {\n   \"CountryCode\": \"+420\",\n   \"CountryCodeISO\": \"CZ\",\n   \"Country\": \"Czech Republic\"\n },\n {\n   \"CountryCode\": \"+243\",\n   \"CountryCodeISO\": \"CD\",\n   \"Country\": \"Democratic Republic of Congo\"\n },\n {\n   \"CountryCode\": \"+45\",\n   \"CountryCodeISO\": \"DK\",\n   \"Country\": \"Denmark\"\n },\n {\n   \"CountryCode\": \"+253\",\n   \"CountryCodeISO\": \"DJ\",\n   \"Country\": \"Djibouti\"\n },\n {\n   \"CountryCode\": \"+670\",\n   \"CountryCodeISO\": \"TL\",\n   \"Country\": \"East Timor\"\n },\n {\n   \"CountryCode\": \"+593\",\n   \"CountryCodeISO\": \"EC\",\n   \"Country\": \"Ecuador\"\n },\n {\n   \"CountryCode\": \"+20\",\n   \"CountryCodeISO\": \"EG\",\n   \"Country\": \"Egypt\"\n },\n {\n   \"CountryCode\": \"+503\",\n   \"CountryCodeISO\": \"SV\",\n   \"Country\": \"El Salvador\"\n },\n {\n   \"CountryCode\": \"+240\",\n   \"CountryCodeISO\": \"GQ\",\n   \"Country\": \"Equatorial Guinea\"\n },\n {\n   \"CountryCode\": \"+372\",\n   \"CountryCodeISO\": \"EE\",\n   \"Country\": \"Estonia\"\n },\n {\n   \"CountryCode\": \"+251\",\n   \"CountryCodeISO\": \"ET\",\n   \"Country\": \"Ethiopia\"\n },\n {\n   \"CountryCode\": \"+298\",\n   \"CountryCodeISO\": \"FO\",\n   \"Country\": \"Faroe Islands\"\n },\n {\n   \"CountryCode\": \"+679\",\n   \"CountryCodeISO\": \"FJ\",\n   \"Country\": \"Fiji\"\n },\n {\n   \"CountryCode\": \"+358\",\n   \"CountryCodeISO\": \"FI\",\n   \"Country\": \"Finland\"\n },\n {\n   \"CountryCode\": \"+33\",\n   \"CountryCodeISO\": \"FR\",\n   \"Country\": \"France\"\n },\n {\n   \"CountryCode\": \"+594\",\n   \"CountryCodeISO\": \"GF\",\n   \"Country\": \"French Guiana\"\n },\n {\n   \"CountryCode\": \"+689\",\n   \"CountryCodeISO\": \"PF\",\n   \"Country\": \"French Polynesia\"\n },\n {\n   \"CountryCode\": \"+241\",\n   \"CountryCodeISO\": \"GA\",\n   \"Country\": \"Gabon\"\n },\n {\n   \"CountryCode\": \"+220\",\n   \"CountryCodeISO\": \"GM\",\n   \"Country\": \"Gambia\"\n },\n {\n   \"CountryCode\": \"+995\",\n   \"CountryCodeISO\": \"GE\",\n   \"Country\": \"Georgia\"\n },\n {\n   \"CountryCode\": \"+49\",\n   \"CountryCodeISO\": \"DE\",\n   \"Country\": \"Germany\"\n },\n {\n   \"CountryCode\": \"+233\",\n   \"CountryCodeISO\": \"GH\",\n   \"Country\": \"Ghana\"\n },\n {\n   \"CountryCode\": \"+350\",\n   \"CountryCodeISO\": \"GI\",\n   \"Country\": \"Gibraltar\"\n },\n {\n   \"CountryCode\": \"+30\",\n   \"CountryCodeISO\": \"GR\",\n   \"Country\": \"Greece\"\n },\n {\n   \"CountryCode\": \"+299\",\n   \"CountryCodeISO\": \"GL\",\n   \"Country\": \"Greenland\"\n },\n {\n   \"CountryCode\": \"+590\",\n   \"CountryCodeISO\": \"GP\",\n   \"Country\": \"Guadeloupe\"\n },\n {\n   \"CountryCode\": \"+502\",\n   \"CountryCodeISO\": \"GT\",\n   \"Country\": \"Guatemala\"\n },\n {\n   \"CountryCode\": \"+224\",\n   \"CountryCodeISO\": \"GN\",\n   \"Country\": \"Guinea\"\n },\n {\n   \"CountryCode\": \"+245\",\n   \"CountryCodeISO\": \"GW\",\n   \"Country\": \"Guinea-Bissau\"\n },\n {\n   \"CountryCode\": \"+592\",\n   \"CountryCodeISO\": \"GY\",\n   \"Country\": \"Guyana\"\n },\n {\n   \"CountryCode\": \"+509\",\n   \"CountryCodeISO\": \"HT\",\n   \"Country\": \"Haiti\"\n },\n {\n   \"CountryCode\": \"+504\",\n   \"CountryCodeISO\": \"HN\",\n   \"Country\": \"Honduras\"\n },\n {\n   \"CountryCode\": \"+852\",\n   \"CountryCodeISO\": \"HK\",\n   \"Country\": \"Hong Kong\"\n },\n {\n   \"CountryCode\": \"+36\",\n   \"CountryCodeISO\": \"HU\",\n   \"Country\": \"Hungary\"\n },\n {\n   \"CountryCode\": \"+354\",\n   \"CountryCodeISO\": \"IS\",\n   \"Country\": \"Iceland\"\n },\n {\n   \"CountryCode\": \"+91\",\n   \"CountryCodeISO\": \"IN\",\n   \"Country\": \"India\"\n },\n {\n   \"CountryCode\": \"+62\",\n   \"CountryCodeISO\": \"ID\",\n   \"Country\": \"Indonesia\"\n },\n {\n   \"CountryCode\": \"+98\",\n   \"CountryCodeISO\": \"IR\",\n   \"Country\": \"Iran\"\n },\n {\n   \"CountryCode\": \"+964\",\n   \"CountryCodeISO\": \"IQ\",\n   \"Country\": \"Iraq\"\n },\n {\n   \"CountryCode\": \"+353\",\n   \"CountryCodeISO\": \"IE\",\n   \"Country\": \"Ireland\"\n },\n {\n   \"CountryCode\": \"+972\",\n   \"CountryCodeISO\": \"IL\",\n   \"Country\": \"Israel\"\n },\n {\n   \"CountryCode\": \"+39\",\n   \"CountryCodeISO\": \"IT\",\n   \"Country\": \"Italy\"\n },\n {\n   \"CountryCode\": \"+225\",\n   \"CountryCodeISO\": \"CI\",\n   \"Country\": \"Ivory Coast\"\n },\n {\n   \"CountryCode\": \"+81\",\n   \"CountryCodeISO\": \"JP\",\n   \"Country\": \"Japan\"\n },\n {\n   \"CountryCode\": \"+962\",\n   \"CountryCodeISO\": \"JO\",\n   \"Country\": \"Jordan\"\n },\n {\n   \"CountryCode\": \"+254\",\n   \"CountryCodeISO\": \"KE\",\n   \"Country\": \"Kenya\"\n },\n {\n   \"CountryCode\": \"+686\",\n   \"CountryCodeISO\": \"KI\",\n   \"Country\": \"Kiribati\"\n },\n {\n   \"CountryCode\": \"+965\",\n   \"CountryCodeISO\": \"KW\",\n   \"Country\": \"Kuwait\"\n },\n {\n   \"CountryCode\": \"+996\",\n   \"CountryCodeISO\": \"KG\",\n   \"Country\": \"Kyrgyzstan\"\n },\n {\n   \"CountryCode\": \"+856\",\n   \"CountryCodeISO\": \"LA\",\n   \"Country\": \"Laos\"\n },\n {\n   \"CountryCode\": \"+371\",\n   \"CountryCodeISO\": \"LV\",\n   \"Country\": \"Latvia\"\n },\n {\n   \"CountryCode\": \"+961\",\n   \"CountryCodeISO\": \"LB\",\n   \"Country\": \"Lebanon\"\n },\n {\n   \"CountryCode\": \"+266\",\n   \"CountryCodeISO\": \"LS\",\n   \"Country\": \"Lesotho\"\n },\n {\n   \"CountryCode\": \"+231\",\n   \"CountryCodeISO\": \"LR\",\n   \"Country\": \"Liberia\"\n },\n {\n   \"CountryCode\": \"+218\",\n   \"CountryCodeISO\": \"LY\",\n   \"Country\": \"Libya\"\n },\n {\n   \"CountryCode\": \"+423\",\n   \"CountryCodeISO\": \"LI\",\n   \"Country\": \"Liechtenstein\"\n },\n {\n   \"CountryCode\": \"+370\",\n   \"CountryCodeISO\": \"LT\",\n   \"Country\": \"Lithuania\"\n },\n {\n   \"CountryCode\": \"+352\",\n   \"CountryCodeISO\": \"LU\",\n   \"Country\": \"Luxembourg\"\n },\n {\n   \"CountryCode\": \"+853\",\n   \"CountryCodeISO\": \"MO\",\n   \"Country\": \"Macau\"\n },\n {\n   \"CountryCode\": \"+389\",\n   \"CountryCodeISO\": \"MK\",\n   \"Country\": \"Macedonia\"\n },\n {\n   \"CountryCode\": \"+261\",\n   \"CountryCodeISO\": \"MG\",\n   \"Country\": \"Madagascar\"\n },\n {\n   \"CountryCode\": \"+265\",\n   \"CountryCodeISO\": \"MW\",\n   \"Country\": \"Malawi\"\n },\n {\n   \"CountryCode\": \"+60\",\n   \"CountryCodeISO\": \"MY\",\n   \"Country\": \"Malaysia\"\n },\n {\n   \"CountryCode\": \"+960\",\n   \"CountryCodeISO\": \"MV\",\n   \"Country\": \"Maldives\"\n },\n {\n   \"CountryCode\": \"+223\",\n   \"CountryCodeISO\": \"ML\",\n   \"Country\": \"Mali\"\n },\n {\n   \"CountryCode\": \"+356\",\n   \"CountryCodeISO\": \"MT\",\n   \"Country\": \"Malta\"\n },\n {\n   \"CountryCode\": \"+596\",\n   \"CountryCodeISO\": \"MQ\",\n   \"Country\": \"Martinique\"\n },\n {\n   \"CountryCode\": \"+222\",\n   \"CountryCodeISO\": \"MR\",\n   \"Country\": \"Mauritania\"\n },\n {\n   \"CountryCode\": \"+230\",\n   \"CountryCodeISO\": \"MU\",\n   \"Country\": \"Mauritius\"\n },\n {\n   \"CountryCode\": \"+262\",\n   \"CountryCodeISO\": \"RE\",\n   \"Country\": \"Reunion\"\n },\n {\n   \"CountryCode\": \"+52\",\n   \"CountryCodeISO\": \"MX\",\n   \"Country\": \"Mexico\"\n },\n {\n   \"CountryCode\": \"+373\",\n   \"CountryCodeISO\": \"MD\",\n   \"Country\": \"Moldova\"\n },\n {\n   \"CountryCode\": \"+377\",\n   \"CountryCodeISO\": \"MC\",\n   \"Country\": \"Monaco\"\n },\n {\n   \"CountryCode\": \"+976\",\n   \"CountryCodeISO\": \"MN\",\n   \"Country\": \"Mongolia\"\n },\n {\n   \"CountryCode\": \"+382\",\n   \"CountryCodeISO\": \"ME\",\n   \"Country\": \"Montenegro\"\n },\n {\n   \"CountryCode\": \"+212\",\n   \"CountryCodeISO\": \"MA\",\n   \"Country\": \"Morocco\"\n },\n {\n   \"CountryCode\": \"+258\",\n   \"CountryCodeISO\": \"MZ\",\n   \"Country\": \"Mozambique\"\n },\n {\n   \"CountryCode\": \"+95\",\n   \"CountryCodeISO\": \"MM\",\n   \"Country\": \"Myanmar\"\n },\n {\n   \"CountryCode\": \"+264\",\n   \"CountryCodeISO\": \"NA\",\n   \"Country\": \"Namibia\"\n },\n {\n   \"CountryCode\": \"+674\",\n   \"CountryCodeISO\": \"NR\",\n   \"Country\": \"Nauru\"\n },\n {\n   \"CountryCode\": \"+977\",\n   \"CountryCodeISO\": \"NP\",\n   \"Country\": \"Nepal\"\n },\n {\n   \"CountryCode\": \"+31\",\n   \"CountryCodeISO\": \"NL\",\n   \"Country\": \"Netherlands\"\n },\n {\n   \"CountryCode\": \"+599\",\n   \"CountryCodeISO\": \"AN\",\n   \"Country\": \"Netherlands Antilles\"\n },\n {\n   \"CountryCode\": \"+687\",\n   \"CountryCodeISO\": \"NC\",\n   \"Country\": \"New Caledonia\"\n },\n {\n   \"CountryCode\": \"+64\",\n   \"CountryCodeISO\": \"NZ\",\n   \"Country\": \"New Zealand\"\n },\n {\n   \"CountryCode\": \"+505\",\n   \"CountryCodeISO\": \"NI\",\n   \"Country\": \"Nicaragua\"\n },\n {\n   \"CountryCode\": \"+227\",\n   \"CountryCodeISO\": \"NE\",\n   \"Country\": \"Niger\"\n },\n {\n   \"CountryCode\": \"+234\",\n   \"CountryCodeISO\": \"NG\",\n   \"Country\": \"Nigeria\"\n },\n {\n   \"CountryCode\": \"+850\",\n   \"CountryCodeISO\": \"KP\",\n   \"Country\": \"North Korea\"\n },\n {\n   \"CountryCode\": \"+47\",\n   \"CountryCodeISO\": \"NO\",\n   \"Country\": \"Norway\"\n },\n {\n   \"CountryCode\": \"+968\",\n   \"CountryCodeISO\": \"OM\",\n   \"Country\": \"Oman\"\n },\n {\n   \"CountryCode\": \"+92\",\n   \"CountryCodeISO\": \"PK\",\n   \"Country\": \"Pakistan\"\n },\n {\n   \"CountryCode\": \"+680\",\n   \"CountryCodeISO\": \"PW\",\n   \"Country\": \"Palau\"\n },\n {\n   \"CountryCode\": \"+507\",\n   \"CountryCodeISO\": \"PA\",\n   \"Country\": \"Panama\"\n },\n {\n   \"CountryCode\": \"+675\",\n   \"CountryCodeISO\": \"PG\",\n   \"Country\": \"Papua New Guinea\"\n },\n {\n   \"CountryCode\": \"+595\",\n   \"CountryCodeISO\": \"PY\",\n   \"Country\": \"Paraguay\"\n },\n {\n   \"CountryCode\": \"+51\",\n   \"CountryCodeISO\": \"PE\",\n   \"Country\": \"Peru\"\n },\n {\n   \"CountryCode\": \"+63\",\n   \"CountryCodeISO\": \"PH\",\n   \"Country\": \"Philippines\"\n },\n {\n   \"CountryCode\": \"+48\",\n   \"CountryCodeISO\": \"PL\",\n   \"Country\": \"Poland\"\n },\n {\n   \"CountryCode\": \"+351\",\n   \"CountryCodeISO\": \"PT\",\n   \"Country\": \"Portugal\"\n },\n {\n   \"CountryCode\": \"+974\",\n   \"CountryCodeISO\": \"QA\",\n   \"Country\": \"Qatar\"\n },\n {\n   \"CountryCode\": \"+40\",\n   \"CountryCodeISO\": \"RO\",\n   \"Country\": \"Romania\"\n },\n {\n   \"CountryCode\": \"+7\",\n   \"CountryCodeISO\": \"KZ\",\n   \"Country\": \"Kazakhstan\"\n },\n {\n   \"CountryCode\": \"+250\",\n   \"CountryCodeISO\": \"RW\",\n   \"Country\": \"Rwanda\"\n },\n {\n   \"CountryCode\": \"+685\",\n   \"CountryCodeISO\": \"WS\",\n   \"Country\": \"Samoa\"\n },\n {\n   \"CountryCode\": \"+378\",\n   \"CountryCodeISO\": \"SM\",\n   \"Country\": \"San Marino\"\n },\n {\n   \"CountryCode\": \"+239\",\n   \"CountryCodeISO\": \"ST\",\n   \"Country\": \"Sao Tome and Principe\"\n },\n {\n   \"CountryCode\": \"+966\",\n   \"CountryCodeISO\": \"SA\",\n   \"Country\": \"Saudi Arabia\"\n },\n {\n   \"CountryCode\": \"+221\",\n   \"CountryCodeISO\": \"SN\",\n   \"Country\": \"Senegal\"\n },\n {\n   \"CountryCode\": \"+381\",\n   \"CountryCodeISO\": \"RS\",\n   \"Country\": \"Serbia\"\n },\n {\n   \"CountryCode\": \"+248\",\n   \"CountryCodeISO\": \"SC\",\n   \"Country\": \"Seychelles\"\n },\n {\n   \"CountryCode\": \"+232\",\n   \"CountryCodeISO\": \"SL\",\n   \"Country\": \"Sierra Leone\"\n },\n {\n   \"CountryCode\": \"+65\",\n   \"CountryCodeISO\": \"SG\",\n   \"Country\": \"Singapore\"\n },\n {\n   \"CountryCode\": \"+421\",\n   \"CountryCodeISO\": \"SK\",\n   \"Country\": \"Slovakia\"\n },\n {\n   \"CountryCode\": \"+386\",\n   \"CountryCodeISO\": \"SI\",\n   \"Country\": \"Slovenia\"\n },\n {\n   \"CountryCode\": \"+677\",\n   \"CountryCodeISO\": \"SB\",\n   \"Country\": \"Solomon Islands\"\n },\n {\n   \"CountryCode\": \"+252\",\n   \"CountryCodeISO\": \"SO\",\n   \"Country\": \"Somalia\"\n },\n {\n   \"CountryCode\": \"+27\",\n   \"CountryCodeISO\": \"ZA\",\n   \"Country\": \"South Africa\"\n },\n {\n   \"CountryCode\": \"+82\",\n   \"CountryCodeISO\": \"KR\",\n   \"Country\": \"South Korea\"\n },\n {\n   \"CountryCode\": \"+34\",\n   \"CountryCodeISO\": \"ES\",\n   \"Country\": \"Spain\"\n },\n {\n   \"CountryCode\": \"+94\",\n   \"CountryCodeISO\": \"LK\",\n   \"Country\": \"Sri Lanka\"\n },\n {\n   \"CountryCode\": \"+249\",\n   \"CountryCodeISO\": \"SD\",\n   \"Country\": \"Sudan\"\n },\n {\n   \"CountryCode\": \"+597\",\n   \"CountryCodeISO\": \"SR\",\n   \"Country\": \"Suriname\"\n },\n {\n   \"CountryCode\": \"+268\",\n   \"CountryCodeISO\": \"SZ\",\n   \"Country\": \"Swaziland\"\n },\n {\n   \"CountryCode\": \"+46\",\n   \"CountryCodeISO\": \"SE\",\n   \"Country\": \"Sweden\"\n },\n {\n   \"CountryCode\": \"+41\",\n   \"CountryCodeISO\": \"CH\",\n   \"Country\": \"Switzerland\"\n },\n {\n   \"CountryCode\": \"+963\",\n   \"CountryCodeISO\": \"SY\",\n   \"Country\": \"Syria\"\n },\n {\n   \"CountryCode\": \"+886\",\n   \"CountryCodeISO\": \"TW\",\n   \"Country\": \"Taiwan\"\n },\n {\n   \"CountryCode\": \"+992\",\n   \"CountryCodeISO\": \"TJ\",\n   \"Country\": \"Tajikistan\"\n },\n {\n   \"CountryCode\": \"+255\",\n   \"CountryCodeISO\": \"TZ\",\n   \"Country\": \"Tanzania\"\n },\n {\n   \"CountryCode\": \"+66\",\n   \"CountryCodeISO\": \"TH\",\n   \"Country\": \"Thailand\"\n },\n {\n   \"CountryCode\": \"+228\",\n   \"CountryCodeISO\": \"TG\",\n   \"Country\": \"Togo\"\n },\n {\n   \"CountryCode\": \"+216\",\n   \"CountryCodeISO\": \"TN\",\n   \"Country\": \"Tunisia\"\n },\n {\n   \"CountryCode\": \"+90\",\n   \"CountryCodeISO\": \"TR\",\n   \"Country\": \"Turkey\"\n },\n {\n   \"CountryCode\": \"+993\",\n   \"CountryCodeISO\": \"TM\",\n   \"Country\": \"Turkmenistan\"\n },\n {\n   \"CountryCode\": \"+256\",\n   \"CountryCodeISO\": \"UG\",\n   \"Country\": \"Uganda\"\n },\n {\n   \"CountryCode\": \"+380\",\n   \"CountryCodeISO\": \"UA\",\n   \"Country\": \"Ukraine\"\n },\n {\n   \"CountryCode\": \"+971\",\n   \"CountryCodeISO\": \"AE\",\n   \"Country\": \"United Arab Emirates\"\n },\n {\n   \"CountryCode\": \"+44\",\n   \"CountryCodeISO\": \"GB\",\n   \"Country\": \"United Kingdom\"\n },\n {\n   \"CountryCode\": \"+1\",\n   \"CountryCodeISO\": \"VI\",\n   \"Country\": \"U.S. Virgin Islands\"\n },\n {\n   \"CountryCode\": \"+598\",\n   \"CountryCodeISO\": \"UY\",\n   \"Country\": \"Uruguay\"\n },\n {\n   \"CountryCode\": \"+998\",\n   \"CountryCodeISO\": \"UZ\",\n   \"Country\": \"Uzbekistan\"\n },\n {\n   \"CountryCode\": \"+678\",\n   \"CountryCodeISO\": \"VU\",\n   \"Country\": \"Vanuatu\"\n },\n {\n   \"CountryCode\": \"+58\",\n   \"CountryCodeISO\": \"VE\",\n   \"Country\": \"Venezuela\"\n },\n {\n   \"CountryCode\": \"+84\",\n   \"CountryCodeISO\": \"VN\",\n   \"Country\": \"Vietnam\"\n },\n {\n   \"CountryCode\": \"+967\",\n   \"CountryCodeISO\": \"YE\",\n   \"Country\": \"Yemen\"\n },\n {\n   \"CountryCode\": \"+260\",\n   \"CountryCodeISO\": \"ZM\",\n   \"Country\": \"Zambia\"\n },\n {\n   \"CountryCode\": \"+263\",\n   \"CountryCodeISO\": \"ZW\",\n   \"Country\": \"Zimbabwe\"\n },\n {\n   \"CountryCode\": \"+262\",\n   \"CountryCodeISO\": \"YT\",\n   \"Country\": \"Mayotte\"\n },\n {\n   \"CountryCode\": \"+7\",\n   \"CountryCodeISO\": \"RU\",\n   \"Country\": \"Russian Federation\"\n },\n {\n   \"CountryCode\": \"+1\",\n   \"CountryCodeISO\": \"AI\",\n   \"Country\": \"Anguilla\"\n },\n {\n   \"CountryCode\": \"+1\",\n   \"CountryCodeISO\": \"AG\",\n   \"Country\": \"Antigua and Barbuda\"\n },\n {\n   \"CountryCode\": \"+1\",\n   \"CountryCodeISO\": \"BS\",\n   \"Country\": \"Bahamas\"\n },\n {\n   \"CountryCode\": \"+1\",\n   \"CountryCodeISO\": \"BB\",\n   \"Country\": \"Barbados\"\n },\n {\n   \"CountryCode\": \"+1\",\n   \"CountryCodeISO\": \"BM\",\n   \"Country\": \"Bermuda\"\n },\n {\n   \"CountryCode\": \"+1\",\n   \"CountryCodeISO\": \"VG\",\n   \"Country\": \"British Virgin Islands\"\n },\n {\n   \"CountryCode\": \"+1\",\n   \"CountryCodeISO\": \"KY\",\n   \"Country\": \"Cayman Islands\"\n },\n {\n   \"CountryCode\": \"+1\",\n   \"CountryCodeISO\": \"DM\",\n   \"Country\": \"Dominica\"\n },\n {\n   \"CountryCode\": \"+1\",\n   \"CountryCodeISO\": \"DO\",\n   \"Country\": \"Dominican Republic\"\n },\n {\n   \"CountryCode\": \"+1\",\n   \"CountryCodeISO\": \"GD\",\n   \"Country\": \"Grenada\"\n },\n {\n   \"CountryCode\": \"+1\",\n   \"CountryCodeISO\": \"GU\",\n   \"Country\": \"Guam\"\n },\n {\n   \"CountryCode\": \"+1\",\n   \"CountryCodeISO\": \"JM\",\n   \"Country\": \"Jamaica\"\n },\n {\n   \"CountryCode\": \"+1\",\n   \"CountryCodeISO\": \"MS\",\n   \"Country\": \"Montserrat\"\n },\n {\n   \"CountryCode\": \"+1\",\n   \"CountryCodeISO\": \"MP\",\n   \"Country\": \"Northern Marianas\"\n },\n {\n   \"CountryCode\": \"+1\",\n   \"CountryCodeISO\": \"PR\",\n   \"Country\": \"Puerto Rico\"\n },\n {\n   \"CountryCode\": \"+1\",\n   \"CountryCodeISO\": \"KN\",\n   \"Country\": \"Saint Kitts and Nevis\"\n },\n {\n   \"CountryCode\": \"+1\",\n   \"CountryCodeISO\": \"LC\",\n   \"Country\": \"Saint Lucia\"\n },\n {\n   \"CountryCode\": \"+1\",\n   \"CountryCodeISO\": \"VC\",\n   \"Country\": \"Saint Vincent and the Grenadines\"\n },\n {\n   \"CountryCode\": \"+1\",\n   \"CountryCodeISO\": \"TT\",\n   \"Country\": \"Trinidad and Tobago\"\n },\n {\n   \"CountryCode\": \"+1\",\n   \"CountryCodeISO\": \"TC\",\n   \"Country\": \"Turks and Caicos Islands\"\n },\n {\n   \"CountryCode\": \"+676\",\n   \"CountryCodeISO\": \"TO\",\n   \"Country\": \"Tonga\"\n },\n {\n   \"CountryCode\": \"+1\",\n   \"CountryCodeISO\": \"US\",\n   \"Country\": \"United States of America\"\n },\n {\n   \"CountryCode\": \"+970\",\n   \"CountryCodeISO\": \"PS\",\n   \"Country\": \"Palestine\"\n },\n {\n   \"CountryCode\": \"+211\",\n   \"CountryCodeISO\": \"SS\",\n   \"Country\": \"South Sudan\"\n },\n {\n   \"CountryCode\": \"+44\",\n   \"CountryCodeISO\": \"IM\",\n   \"Country\": \"Isle of Man\"\n }\n];\n\n\t\t\t\t\n\t\t\t\t\n\n\n\n\n    \t\t\n    \t\t//automatically sort stuff out! :)\n    \t\tif($state.params.verify){\n    \t\t\talert(\"VERIFY?\");\n    \t\t\t////console.log(\"SEND VERIFICATION\");\n    \t\t\tUserService.Verify($state.params.user_id, $state.params.verify)\n                .then(function (data) {\n\t    \t\t\t// //console.log(\"SENT VERIFICATION\");\n        //         \t//console.log(data);\n                    if(data.success){\n                    \t$state.go(\"verified\");\n                    } else {\n                    \talert(data.message);\n                    \t$state.go(\"login\");\n                    }\n                });\n    \t\t}\n\n    \t\tvar loc = $location.path().split(\"/\");\n    \t\tif(loc[loc.length -1] == \"verified\"){\n\n    \t\t\t//alert(\"testing the sent\");\n\n    \t\t\tsendVerification();\n\n    \t\t}\n\n\n    \t\tif($stateParams.token){\n\n    \t\t\t\n    \t\t\tUserService.GetInvite($stateParams.token)\n                .then(function (data) {\n\t    \t\t\t////console.log(\"GETTING TOKEN\", data);\n\n\n                    if(data){\n\n                    \t$scope.total_invite = data;\n                    \t\n                    \t$scope.formData.first_name = data.first_name;\n\t\t    \t\t\t$scope.formData.last_name = data.last_name;\n\t\t    \t\t\t$scope.formData.email = data.email;\n\t\t    \t\t\t$scope.formData.membership_id = data.membership_id;\n\t\t    \t\t\t$scope.formData.club_id = data.club_id;\n\t\t    \t\t\t$scope.formData.to_pay = data.to_pay;\n\t\t    \t\t\t$scope.formData.token = data.invitation_token;\n\n\t\t    \t\t\t//maybe?\n\t\t    \t\t\t$scope.formData.invited_by = data.invited_by;\n\n\t\t    \t\t\tif(data.user_id > 0){\n\t\t    \t\t\t\t// //console.log(\"UID set\", data.user_id);\n\t\t    \t\t\t\t$cookies.put(\"uid\", data.user_id);\n\t\t    \t\t\t}\n\n\t\t    \t\t\t//$cookies.set(\"rid\", data.membership.request.membership_request_id);\n\t\t    \t\t\t//other data::\n\t\t    \t\t\t$scope.payment_now = data.payment_now;\n\t\t    \t\t\t$scope.first_payment = data.first_payment;\n\t\t    \t\t\t$scope.club = data.club;\n\t\t    \t\t\t$scope.membership = data.membership;\n\n\t\t    \t\t\t$scope.all = data;\n\n                    \t////console.log(\"success\");\n                    } else {\n                    \talert(\"Sorry we were unable to find this invitation... Please try clicking the link again.\")\n                    \t$state.go(\"login\");\n                    }\n                });\n\n    \t\t} else {\n    \t\t\t$state.go(\"login\");\n    \t\t}\n\t    \n\t\t    if($cookies.get(\"session\") !== \"\" && $location.search().redirect_flow_id){\n\t\t    \t//console.log(\"let's sort this shizzle out eh?\");\n\n\t\t    \tvar object = {\n                    mandate: $location.search().redirect_flow_id,\n                    session: $cookies.get(\"session\"),\n                    member_accepted: true\n                };\n\n                GoCardService.SetupMandate(object).then(function (data) {\n                    if(data.success){\n                        //vm.requests = data.requests;\n\t\t\t\t\t\t// $cookies.set(\"uid\");\n                        //vm.club = data.club;\n                        // //console.log(\"memberships\", vm.memberships);\n                        //vm.success = true;\n\n                    } else {\n                        // //console.log(\"WOOOPSIES...\");\n                        //vm.success = false;\n                        //this should be very very rare...\n                    }\n\n                });\n\n\t\t    }\n\n\n\t\t    //may need to alter this one to reflect most common one depending on\n\t\t    //the license type\n\t\t    \n\n\t\t    $scope.add_element = function(bit_type){\n\n\t\t    \t//remove from first array\n\t\t    \t$scope[bit_type][bit_type] = $.grep($scope[bit_type][bit_type], function(e){ \n\t\t\t\t\treturn e.id != $scope.formData.license.add_to[bit_type].id; \n\t\t\t\t});\n\n\t\t    \tif(bit_type == \"differences\"){\n\t\t    \t\t$scope.formData.license.add_to[bit_type].day = true;\n\t\t    \t\t$scope.formData.license.add_to[bit_type].vfr = true;\n\t\t    \t}\n\t\t    \t//console.log($scope.formData.license.add_to[bit_type]);\n\n\t\t    \t$scope.formData.license[bit_type].push($scope.formData.license.add_to[bit_type]);\n\t\t    \t\n\t\t    \t//clean the array to show what we want to show :)\n\t\t    \tdelete $scope.formData.license.add_to[bit_type];\n\n\t\t    }\n\n\t\t    $scope.downloadClubDocument = function(doc) {\n\t            var data = $.param({\n\t                id: doc\n\t            });\n\n\t            var ddd = doc.replace(/^.*[\\\\\\/]/, '');\n\t            $http.defaults.headers.common['Api-Key'] = \"eW91a25vd25vdGhpbmdqb25zbm93\";\n\n\t            $http.get('api/v1/term_documents/show_file/'+ddd, {\n\t                    responseType: 'arraybuffer'\n\t                })\n\t                .success(function(data, status, headers) {\n\t                    var zipName = processArrayBufferToBlob(data, headers);\n\n\t                    //Delete file from temp folder in server - file needs to remain open until blob is created\n\t                    //deleteFileFromServerTemp(zipName);\n\t                }).error(function(data, status) {\n\t                    alert(\"There was an error downloading the selected document(s).\");\n\t                })\n\t        };\n\n\n\t\t    $scope.remove_element = function(bit_type, index){\n\n\t\t \n \t\t\t\t//add to dropdown\n\t\t\t\t$scope[bit_type][bit_type].push($scope.formData.license[bit_type][index]);\n\n\t\t    \n\t\t\t\t$scope.formData.license[bit_type].splice(index,1)\n\n\t\t    \t$scope.formData.license[bit_type] = $scope.formData.license[bit_type].filter(Boolean);\n\t\t    \t//console.log($scope.formData.license[bit_type]);\n\t\t    \t//$scope.formData.license[bit_type].push($scope.formData.license.add_to[bit_type]);\n\n\t\t    }\n\n\n\n\t\t    function check_user_is_valid(){\n\n\t\t    \tif(\t\t!$scope.formData.first_name \n\t\t    \t\t|| !$scope.formData.last_name \n\t\t    \t\t|| !$scope.formData.email\n\t\t    \t\t|| !$scope.formData.dob\n\t\t    \t\t|| !$scope.formData.password\n\t\t    \t\t|| !$scope.formData.password2){\n\t\t    \t\talert(\"All form fields are required.\");\n\n\t\t    \t\t//not all fields are filled in\n\t\t    \t\treturn false;\n\t\t    \t}\n\n\t\t    \tif($scope.formData.password.length < 7){\n\t\t    \t\t//not long enough\n\t\t    \t\talert(\"Password must be more than 7 characters long\");\n\t\t    \t\treturn false;\n\t\t    \t}\n\n\t\t    \tif($scope.formData.password !== $scope.formData.password2){\n\t\t    \t\t//passwords do not match\n\t\t    \t\talert(\"Your passwords do not match...\");\n\t\t    \t\treturn false;\n\t\t    \t}\n\n\t\t    \treturn true;\n\t\t    }\n\t\t    \n\n\t\t    $scope.setup_direct_debit = function(){\n\n\n\t\t    \t// //console.log(\"CHECK IS L \", $scope.checkValid(\"verify_account\", 1));\n\n\t\t    \tif($scope.checkValid(\"verify_account\", 1)){\n\n\t\t\t    \tvar to_send = $scope.formData;\n\t\t\t    \tto_send.request_id = $scope.all.membership_request_id;\n\t\t\t    \tto_send.invitation = $stateParams.token;\n\n\t\t\t    \tto_send.payment_now = $scope.payment_now;\n\t\t\t    \tto_send.first_payment = $scope.first_payment;\n\t\t\t    \t// //console.log(\"OBJ = \", to_send);\n\n\t\t\t    \t//return false;\n\t\t\t    \t//send the create user to the invitation\n\t\t\t    \t//create_user\n\t\t\t    \t//expect the gocardless link back\n\t\t\t    \tUserService.InviteSignup(to_send)\n\t\t                .then(function (data) {\n\t\t\t    \t\t\t// //console.log(\"INVITATION BEING SENT NOW...\", data);\n\t\t                    if(data.success){\n\t\t                    \t// //console.log(\"YAY we created stuff\");\n\n\t\t                    \t//store the session::::::\n\t\t                    \t$cookies.put(\"session\", data.mandate.session);\n\n\t\t                    \t////console.log(\"GO TO \"+data.mandate.link);\n\n\t\t                    \twindow.location = data.mandate.link;\n\n\n\t\t                    } else {\n\t\t                    \talert(\"An error - occurred : \"+data.error);\n\t\t                    \treturn false;\n\t\t                    }\n\t\t            });\n\n\t            } else {\n\t            \talert(\"Please ensure that all fields are complete\");\n\t            }\n\n\n\n\n\n\t\t    }\n\n\t\t    $scope.checkValid = function(uisref, gonext=0){\n\t\t    \tif(!uisref || uisref == \"\"){\n\t\t    \t\t//console.log(\"here\");\n\t\t    \t\tuisref = $(\".btn-info\").attr(\"one-ui-sref\");\n\t\t    \t}\n\t\t    \t//console.log($('#signup-form')[0].checkValidity());\n\t\t    \tif(! $('#signup-form')[0].checkValidity()){\n\t\t    \t\t$(\".ng-pristine\").not(\".ng-valid\").removeClass(\"ng-pristine\").addClass(\"ng-invalid\");\n\t\t    \t\t$(\"input:checkbox:not(:checked):required\").addClass(\"ng-checkbox-unchecked\");\n\t\t    \t\t//console.log(\"STOP\");\n\t\t    \t\treturn false;\n\t\t    \t} else {\n\n\t\t    \t\t//console.log(\"HERE\");\n\t\t    \t\t\n\t\t    \t\tif(!check_user_is_valid()){\n\t\t    \t\t\t//console.log(\"missing first bit...\");\n\t\t\t\t    \t$state.go(\"invitations.your_details\");\n\t\t    \t\t\treturn false;\n\t\t    \t\t}\n\t\t    \t\tif(!$scope.formData.nok){\n\t\t    \t\t\t//console.log(\"missing second bit...\");\n\t\t\t\t    \t$state.go(\"invitations.next_of_kin\");\n\t\t    \t\t\treturn false;\n\t\t    \t\t}\n\t\t    \t\t// if(!$scope.formData.club){\n\t\t    \t\t// \t//console.log(\"missing second bit...\");\n\t\t\t\t    // \t$state.go(\"invitations.your_club\");\n\t\t    \t\t// \treturn false;\n\t\t    \t\t// }\n\t\t    \t\tif(!$scope.formData.tnc){\n\t\t\t    \t\t$(\"input:checkbox:not(:checked)\").addClass(\"ng-checkbox-unchecked\");\n\t\t    \t\t} else {\n\t\t    \t\t\t$(\"input:checkbox:not(:checked)\").removeClass(\"ng-checkbox-unchecked\");\n\t\t    \t\t}\n\t\t    \t\tif($scope.formData.password == $scope.formData.password2){\n\t\t\t    \t\tvar next = uisref;\n\t\t\t    \t\tif(gonext == 0){\n\t\t\t    \t\t\tif(next == \"verify_account\"){\n\t\t\t\t    \t\t\t//console.log(\"verifying account\");\n\t\t\t\t    \t\t\t$scope.processForm();\n\t\t\t\t    \t\t} else {\n\t\t\t\t\t    \t\t$state.go(next);\n\t\t\t\t    \t\t}\n\t\t\t    \t\t} else {\n\t\t\t    \t\t\treturn true;\n\t\t\t    \t\t}\n\t\t    \t\t} else {\n\t\t\t    \t\t$(\"input[type='password']\").removeClass(\"ng-pristine\").addClass(\"ng-invalid\");\n\t\t    \t\t\treturn false;\n\t\t    \t\t}\n\n\t\t    \t\t// if(!$scope.formData.user){\n\t\t\t\t    // \t\t$state.go(\"user_signup.your_details\");\n\t\t    \t\t// }\n\t\t    \t\t// if($scope.formData.user.password == $scope.formData.user.password2){\n\t\t    \t\t// \t//console.log(uisref);\n\t\t\t    \t// \t$state.go(uisref);\n\t\t    \t\t// } else {\n\t\t\t    \t// \t$(\"input[type='password']\").removeClass(\"ng-pristine\").addClass(\"ng-invalid\");\n\t\t    \t\t// \treturn false;\n\t\t    \t\t// }\n\t\t    \t}\n\t\t    }\n\n\t\t    $scope.sendVerification = function(){\n\t\t    \tvar user_id = $cookies.get(\"uid\");\n\n\t\t    \tMemberService.VerifyInvitedUser(user_id)\n\t\t                .then(function (data) {\n\t\t                    // //console.log(data);\n\t\t                    if(data.success){\n\t\t                        //use GB airfields first...\n\t\t                        //$scope.verified_mobile = true;\n\n\t\t                        // $scope.link = data.link.url;\n\t\t                    \t// $cookies.put('mid', last);\n\t\t                    \t// $cookies.put('bid', data.bid);\n\n\t\t                    \t$state.go(\"invitations.verified\");\n\n\n\n\t\t                    } else {\n\t\t                    \talert(\"Your verification code is incorrect...\");\n    \t\t\t\t\t\t\t//$scope.verified_mobile = false;\n\t\t                    }\n\n\t\t                });\n\t\t    }\n\n\n\t\t    function sendVerification(){\n\n\t\t    \tvar user_id = $cookies.get(\"uid\");\n\n\t\t    \tMemberService.VerifyInvitedUser(user_id)\n\t\t                .then(function (data) {\n\t\t                    // //console.log(data);\n\t\t                    if(data.success){\n\t\t                        //use GB airfields first...\n\t\t                        //$scope.verified_mobile = true;\n\n\t\t                        // $scope.link = data.link.url;\n\t\t                    \t// $cookies.put('mid', last);\n\t\t                    \t// $cookies.put('bid', data.bid);\n\n\t\t                    \t$state.go(\"invitations.verified\");\n\n\n\n\t\t                    } else {\n\t\t                    \talert(\"Your verification code is incorrect...\");\n    \t\t\t\t\t\t\t//$scope.verified_mobile = false;\n\t\t                    }\n\n\t\t                });\n\n\t\t    }\n\n\n\t\t    $scope.verify_mobile = function(value){\n\t\t    \tvar val = value.text_verification;\n    \t\t\t////console.log(\"called\", value.text_verification);\n    \t\t\t////console.log(\"called\", $scope.text_verification);\n\n    \t\t\tif(val.length == 6){\n    \t\t\t\t//then we check\n\n    \t\t\t\t// //console.log(\"4 chars\", vm.text_verification);\n    \t\t\t\t// //console.log(\"4 chars\", last);\n\n    \t\t\t\t//VerifyInvitedUser\n\n    \t\t\t\tMemberService.VerifyPhoneInvite(val, $cookies.get(\"uid\"))\n\t\t                .then(function (data) {\n\t\t                    // //console.log(data);\n\t\t                    if(data && data.success){\n\t\t                        //use GB airfields first...\n\t\t                        $scope.verified_mobile = true;\n\n\t\t                        //$scope.link = data.link.url;\n\t\t                    \t// $cookies.put('mid', last);\n\t\t                    \t// $cookies.put('bid', data.bid);\n\n\n\n\n\t\t                    } else {\n\t\t                    \talert(\"Your verification code is incorrect...\");\n    \t\t\t\t\t\t\t$scope.verified_mobile = false;\n\t\t                    }\n\n\t\t                });\n\n    \t\t\t\t// if(text_verification == \"1234\"){\n\n    \t\t\t\t// \t$scope.verified_mobile = true;\n    \t\t\t\t// }\n\n    \t\t\t} else {\n    \t\t\t\t//do nothing\n    \t\t\t}\n\n    \t\t}\n\n    \t\tfunction titlepath(path,name){\n\n        //In this path defined as your pdf url and name (your pdf name)\n            var prntWin = window.open();\n            prntWin.document.write(\"<html><head><title>\"+name+\"</title></head><body>\"\n                + '<embed width=\"100%\" height=\"100%\" name=\"plugin\" src=\"'+ path+ '\" '\n                + 'type=\"application/pdf\" internalinstanceid=\"21\"></body></html>');\n            prntWin.document.close();\n        }\n\n    \t\tfunction processArrayBufferToBlob(data, headers) {\n            var octetStreamMime = 'application/octet-stream';\n            var success = false;\n\n            // Get the headers\n            headers = headers();\n            //var ttt = title.toLowerCase().replace(/\\W/g, '_');\n            // Get the filename from the x-filename header or default to \"download.bin\"\n            var filename = headers['x-filename'] || 'download.zip';\n\n            // Determine the content type from the header or default to \"application/octet-stream\"\n            var contentType = headers['content-type'] || octetStreamMime;\n\n            try {\n                // Try using msSaveBlob if supported\n                var blob = new Blob([data], {\n                    //type: contentType\n                    type: 'application/pdf'\n                });\n\n                var fileURL = URL.createObjectURL(blob);\n                titlepath(fileURL, \"Secure Documents\");\n\n                // if (navigator.msSaveBlob)\n                //     navigator.msSaveBlob(blob, filename);\n                // else {\n                //     // Try using other saveBlob implementations, if available\n                //     var saveBlob = navigator.webkitSaveBlob || navigator.mozSaveBlob || navigator.saveBlob;\n                //     if (saveBlob === undefined) throw \"Not supported\";\n                //     saveBlob(blob, filename);\n                // }\n                success = true;\n            } catch (ex) {\n                console.info(\"saveBlob method failed with the following exception:\");\n                console.info(ex);\n            }\n\n            if (!success) {\n                // Get the blob url creator\n                var urlCreator = window.URL || window.webkitURL || window.mozURL || window.msURL;\n                if (urlCreator) {\n                    // Try to use a download link\n                    var link = document.createElement('a');\n                    if ('download' in link) {\n                        // Try to simulate a click\n                        try {\n                            // Prepare a blob URL\n                            var blob = new Blob([data], {\n                                type: contentType\n                            });\n                            var url = urlCreator.createObjectURL(blob);\n                            link.setAttribute('href', url);\n\n                            // Set the download attribute (Supported in Chrome 14+ / Firefox 20+)\n                            link.setAttribute(\"download\", filename);\n\n                            // Simulate clicking the download link\n                            var event = document.createEvent('MouseEvents');\n                            event.initMouseEvent('click', true, true, window, 1, 0, 0, 0, 0, false, false, false, false, 0, null);\n                            link.dispatchEvent(event);\n                            success = true;\n\n                        } catch (ex) {\n                            console.info(\"Download link method with simulated click failed with the following exception:\");\n                            console.info(ex);\n                        }\n                    }\n\n                    if (!success) {\n                        // Fallback to window.location method\n                        try {\n                            // Prepare a blob URL\n                            // Use application/octet-stream when using window.location to force download\n                            var blob = new Blob([data], {\n                                type: octetStreamMime\n                            });\n                            var url = urlCreator.createObjectURL(blob);\n                            window.location = url;\n                            success = true;\n                        } catch (ex) {\n                            $log.info(\"Download link method with window.location failed with the following exception:\");\n                            $log.info(ex);\n                        }\n                    }\n                }\n            }\n\n            if (!success) {\n                // Fallback to window.open method\n                $log.info(\"No methods worked for saving the arraybuffer, using last resort window.open\");\n                window.open(httpPath, '_blank', '');\n            }\n            return filename;\n        };\n\n\n\t\t    // function to process the form\n\t\t    $scope.processForm = function() {\n\t\t        \n\t\t    \t//basic checks of what is being sent should be added here....\n\t\t        UserService.InviteSignup($scope.formData)\n\t                .then(function (data) {\n\t\t    \t\t\t//console.log(\"INVITATION BEING SENT NOW...\", data);\n\n\n\t                    if(data){\n\t                    \t//console.log(\"success\");\n\t                    \talert(\"ALL GOOD TO GO\");\n\t                    \t$state.go(\"invitations.verified\");\n\t                    } else {\n\t                    \talert(\"Sorry we were unable to find this invitation... Please try clicking the link again.\")\n\t                    \t$state.go(\"login\");\n\t                    }\n\t                });\n\n\n\n\n\n\n\n\n\t\t    };\n\n    }\napp.controller('KeywordController', KeywordController);\n \n    KeywordController.$inject = ['KeywordsService', 'UserService', 'JSTagsCollection', '$scope'];\n    function KeywordController(KeywordsService, UserService, JSTagsCollection, $scope) {\n            \n\n        var vm = this;\n\n          // Export jsTags options, inlcuding our own tags object\n          \n\n          // **** Typeahead code **** //\n\n          // Build suggestions array\n\n          // var suggestions = [];\n\n            \n          \n\n                    $scope.tags = new JSTagsCollection();\n\n                    $scope.jsTagOptions = {\n                        'tags': $scope.tags \n                      };\n\n\n                    //var suggestions = [{\"id\":1,\"keyword\":\"hello\",\"updated_at\":\"2015-10-19 16:23:04\",\"created_at\":\"0000-00-00 00:00:00\"},{\"id\":2,\"keyword\":\"alex\",\"updated_at\":\"2015-10-19 16:23:04\",\"created_at\":\"0000-00-00 00:00:00\"}];\n                     // var suggestions = ['jsTag', 'c#', 'java', 'javascript', 'jquery', 'android' , 'php', 'c++', 'python', 'ios', 'mysql', 'iphone', 'sql', 'html', 'css', 'objective-c', 'ruby-on-rails', 'c', 'sql-server', 'ajax', 'xml', '.net', 'ruby', 'regex', 'database', 'vb.net', 'arrays', 'eclipse', 'json', 'django', 'linux', 'xcode', 'windows', 'html5', 'winforms', 'r', 'wcf', 'visual-studio-2010', 'forms', 'performance', 'excel', 'spring', 'node.js', 'git', 'apache', 'entity-framework', 'asp.net', 'web-services', 'linq', 'perl', 'oracle', 'action-script', 'wordpress', 'delphi', 'jquery-ui', 'tsql', 'mongodb', 'neo4j', 'angularJS', 'unit-testing', 'postgresql', 'scala', 'xaml', 'http', 'validation', 'rest', 'bash', 'django', 'silverlight', 'cake-php', 'elgg', 'oracle', 'cocoa', 'swing', 'mocha', 'amazon-web-services'];\n                     // suggestions = suggestions.map(function(item) { //console.log(item);  return { \"suggestion\": item } });\n                   \n                    //   //console.log(\"HELO\");\n                    // //console.log(suggestions);\n\n\n                      // Instantiate the bloodhound suggestion engine\n                       var suggestions = new Bloodhound({\n                        datumTokenizer: function(obj) { return Bloodhound.tokenizers.whitespace(obj.keyword); },\n                        identify: function(obj) { return obj.keyword; },\n                        queryTokenizer: Bloodhound.tokenizers.whitespace,\n                        prefetch: '/api/v1/keywords'\n                      });\n\n                      // Initialize the bloodhound suggestion engine\n                      suggestions.initialize();\n\n                      \n\n\n                      // Single dataset example\n                      $scope.exampleData = {\n                        displayKey: 'keyword',\n                        source: suggestions.ttAdapter()\n                      };\n\n                      // Typeahead options object\n                      $scope.exampleOptions = {\n                        hint: false,\n                        highlight: true\n                      };\n           \n                      $scope.CheckContent = function(){\n                        //console.log(\"CLICK\");\n                        //console.log($scope.tags.tags);\n                      }\n                   \n         \n       \n\n    }\napp.controller('KeywordsController', KeywordsController);\n \n    KeywordsController.$inject = ['UserService', 'KeywordsService', '$location', '$rootScope', 'FlashService', '$routeParams', '$scope'];\n    function KeywordsController(UserService, KeywordsService, $location, $rootScope, FlashService, $routeParams, $scope) {\n        var vm = this;\n\n         KeywordsService.GetAll()\n                .then(function (data) {\n                    vm.keywords = data;\n                });\n\n       \tvm.id = 1;\n       \tvm.myModel = 'Click here and delete me';\n\t\t$scope.myUpdateHandler = function(id, keyword){\n\t\t  // check your console\n\t\t  //console.log('value of '+id+' your model is now: ' + keyword);\n\t\t  var update = {\"id\": id, \"keyword\": keyword};\n\t\t  KeywordsService.Update(update)\n                .then(function (data) {\n                    //console.log(\"SAVED :)\");\n                });\n\t\t};\n\n\t\t$scope.addKeyword = function(){\n\t\t\t//console.log(\"ADD ONE \"+vm.new_keyword);\n\t\t\t//need to call the outside world here and now :0\n\t\t\tvar add_one = {\"keyword\": vm.new_keyword};\n\t\t\tKeywordsService.Create(add_one)\n                .then(function (data) {\n                    vm.keywords.push(data);\n                    //reset\n\t\t\t\t\tvm.new_keyword = \"\";\n                });\n\t\t}\n\n\t\t$scope.deleteKeyword = function(id){\n\n\t\t\tKeywordsService.Delete(id)\n                .then(function (data) {\n\n                    vm.keywords = $.grep(vm.keywords, function(e){ \n\t\t\t\t\t     return e.id != id; \n\t\t\t\t\t});\n\n                });\n\t\t}\n\n    }\napp.controller('LoginController', LoginController);\n \n    LoginController.$inject = ['$location', 'AuthenticationService', 'FlashService'];\n    function LoginController($location, AuthenticationService, FlashService) {\n        var vm = this;\n \n        vm.login = login;\n\n        vm.login_session;\n        vm.login_key;\n \n        (function initController() {\n            // reset login status\n            //AuthenticationService.ClearCredentials();\n            var check = AuthenticationService.CheckLoggedIn();\n            if(check){\n                $location.path('/dashboard');\n            } else {\n                AuthenticationService.ClearCredentials();\n            }\n\n\n            AuthenticationService.Login0( function (response) {\n                if (response.success) {\n                    // //console.log(\"HELLO success\", response.login_session);\n                    // AuthenticationService.SetCredentials(vm.email, vm.password, response.user, response.session);\n                    // setTimeout(function(){\n                    //     $location.path('/dashboard');\n                    // }, 20);\n\n                    vm.login_session = response.login_session;\n\n                } else {\n                    // //console.log(\"HELLO FAIL\", response);\n                    //FlashService.Error(response.error);\n                    // vm.error = response.error;\n                    // vm.dataLoading = false;\n                }\n            });\n\n\n            // AuthenticationService.Login1(\"thisisuser\", \"session\", function (response) {\n            //     if (response.success) {\n            //         //console.log(\"HELLO success\", response);\n            //         // AuthenticationService.SetCredentials(vm.email, vm.password, response.user, response.session);\n            //         // setTimeout(function(){\n            //         //     $location.path('/dashboard');\n            //         // }, 20);\n            //     } else {\n            //         //console.log(\"HELLO FAIL\", response);\n            //         //FlashService.Error(response.error);\n            //         // vm.error = response.error;\n            //         // vm.dataLoading = false;\n            //     }\n            // });\n\n\n\n\n\n\n        })();\n\n\n\n       \n \n        function login() {\n\n            vm.dataLoading = true;\n\n            AuthenticationService.Login1(vm.email, vm.login_session, function (response) {\n                if (response.success) {\n                    // //console.log(\"HELLO success\", response);\n                    // AuthenticationService.SetCredentials(vm.email, vm.password, response.user, response.session);\n                    // setTimeout(function(){\n                    //     $location.path('/dashboard');\n                    // }, 20);\n\n                    var login_key = response.login_key;\n\n\n                    //if success --> THEN we do the next bit\n                    AuthenticationService.Login2(vm.password, login_key, function (response) {\n                    if (response.success) {\n                        // //console.log(\"HELLO success\", response);\n                        // AuthenticationService.SetCredentials(vm.email, vm.password, response.user, response.session);\n                        // setTimeout(function(){\n                        //     $location.path('/dashboard');\n                        // }, 20);\n\n\n                        //if success --> THEN we do the next bit\n\n                        AuthenticationService.SetCredentials2(vm.email, vm.password, response.user, response.session, function(response){\n                            // //console.log(\"TWO :: \", response);\n                             // setTimeout(function(){\n                                 if(response && (response.access.instructor.length > 0 || response.access.manager.length > 0)){\n                                     $location.path('/dashboard');\n                                 } else {\n                                     $location.path('/dashboard/my_account');\n                                 }\n\n                                \n                            // }, 20);\n                        });\n                       \n\n\n\n\n\n\n\n                    } else {\n                        // //console.log(\"HELLO FAIL\", response);\n                        //FlashService.Error(response.error);\n                        // vm.error = response.error;\n                        // vm.dataLoading = false;\n                        vm.error = response.error;\n                        vm.dataLoading = false;\n                    }\n                });\n\n\n\n\n\n\n\n\n                } else {\n                    // //console.log(\"HELLO FAIL\", response);\n                    //FlashService.Error(response.error);\n                    // vm.error = response.error;\n                    // vm.dataLoading = false;\n                    vm.error = response.error;\n                    vm.dataLoading = false;\n                }\n            });\n\n\n\n\n\n\n\n\n            // vm.dataLoading = true;\n            // AuthenticationService.Login(vm.email, vm.password, function (response) {\n            //     if (response.success) {\n            //         AuthenticationService.SetCredentials(vm.email, vm.password, response.user, response.session);\n            //         setTimeout(function(){\n            //             $location.path('/dashboard');\n            //         }, 20);\n            //     } else {\n            //         //FlashService.Error(response.error);\n            //         vm.error = response.error;\n            //         vm.dataLoading = false;\n            //     }\n            // });\n        };\n\n        function logout(){\n            // reset login status\n            AuthenticationService.ClearCredentials();\n        }\n\n\n    }\n app.controller('ManageAccountController', ManageAccountController);\n\n    ManageAccountController.$inject = ['UserService', 'MemberService', 'InstructorService', 'MembershipService', 'HolidayService', '$rootScope', '$location', '$scope', '$state', '$stateParams', '$uibModal', '$log', '$window', '$compile', '$timeout', 'uiCalendarConfig', 'BookingService', 'PaymentService'];\n    function ManageAccountController(UserService, MemberService, InstructorService, MembershipService, HolidayService, $rootScope, $location, $scope, $state, $stateParams, $uibModal, $log, $window, $compile, $timeout, uiCalendarConfig, BookingService, PaymentService) {\n        \n        var vm = this;\n        vm.user = $rootScope.globals.currentUser;\n        //vm.user_id = vm.user.id;\n        vm.avatar = \"\";\n        vm.address = \"Please choose address...\";\n        vm.user.address_line1 = \"Please choose\";\n        vm.addresses = {};\n        vm.show_addresses = false;\n        vm.show_address = false;\n        vm.show_search = false;\n\n\n        UserService.GetById(vm.user.id)\n                .then(function (data) {\n                    if(data.success){\n                        data.user.dob = new Date(data.user.dob);\n                        vm.user = data.user;\n\n                        if(vm.user.address_line1 !== \"\"){\n                            vm.show_address = true;\n                            vm.show_search = false;\n                            vm.show_addresses = false;\n                        }\n\n                        // //console.log(\"NOK\", vm.user);\n\n                    } else {\n                        //console.log(\"WOOOPSIES...\");\n                        //this should be very very rare...\n                    }\n                });\n\n\n        $scope.processFiles = function(files){\n\n            for(var i=0; i<files.length; i++){\n                // //console.log(\"JSON\", files[i].file_return);\n                var j = JSON.parse(files[i].file_return);\n                // //console.log(\"PARSED\", j);\n                files[i].file.temp_path = j.saved_url;\n                // //console.log(\"file\", files[i].file);\n                vm.avatar = files[i].file;\n                vm.user.avatar = vm.avatar.temp_path;\n                vm.user.update_avatar = true;\n                // //console.log(vm.avatar);\n            }\n           \n        }\n\n\n        $scope.show_form = function(){\n            // //console.log(\"show form\");\n            vm.show_address = true;\n        }\n\n        $scope.set_address = function(){\n            // //console.log(\"set address\");\n\n            vm.user.address_line1 = vm.address.line1;\n            vm.user.address_line2 = vm.address.line2;\n            vm.user.address_line3 = vm.address.line3;\n            vm.user.address_line4 = vm.address.line4;\n            vm.user.address_postcode = vm.address.postcode;\n            vm.user.address_locality = vm.address.locality;\n            vm.user.address_city = vm.address.city;\n            vm.user.address_county = vm.address.county;\n            vm.user.address_country = vm.address.country;\n\n            vm.show_address = true;\n\n        }\n\n        $scope.get_addresses = function(){\n\n            vm.address = {};\n\n            //  trial key\n            //  auth: api-key: BP-8KOdw8ka3F2eDU-Zz-g5865   \n            //  https://api.getAddress.io/v2/uk/{postcode}\n            // PaymentService.getAddress()\n\n            PaymentService.GetAddresses(vm.postcode)\n                .then(function (data) {\n                    if(data.success){\n\n                        // //console.log(\"addresses: \"+data.addresses);\n                        vm.addresses = data.addresses;\n\n                        if(vm.addresses && vm.addresses.length > 0){\n                            vm.show_addresses = true;\n                        } else {\n                            alert(\"We couldn't find your address from your postcode, please enter it manually\")\n                            vm.show_addresses = false;\n                            vm.show_address = true;\n                        }\n                        //fill the drop down menu\n\n                    } else {\n                        // //console.log(\"WOOOPSIES...\");\n                        //this should be very very rare...\n                        alert(\"We couldn't find your address from your postcode, please enter it manually\")\n                        vm.show_addresses = false;\n                        vm.show_address = true;\n\n                    }\n                });\n\n\n\n        }\n\n\n\n        \n        $scope.save_user = function(valid){\n\n            // //console.log(\"VALID\", valid);\n\n            if(valid){\n                //now let's double check the content of the form\n\n\n                //avatar - not required --> check if updated\n                //above not required i don't think\n                if(!vm.user.update_avatar){\n                    delete vm.user.avatar;\n                }\n\n                //phone number\n                if(!vm.user.phone_number || vm.user.phone_number == \"\"){\n                    alert(\"Please enter a mobile phone number\");\n                    return false;\n                }\n\n                //updated_password\n                if(vm.user.new_password){\n                    if(vm.user.new_password !== vm.user.new_password2){\n                        alert(\"Please ensure your updated passwords match\");\n                        return false;\n                    } else {\n\n\n                          //lets add complexity here :-)\n                           var strongPassword = new RegExp('(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[^A-Za-z0-9])(?=.{8,})')\n                            if(strongPassword.test(vm.user.new_password)) {\n                              //console.log(\"password strength OK\");\n                            } else {\n                              vm.show_error = true;\n                              alert(\"Your password must be at least 8 characters in length, contain 1 uppercase, 1 lowercase, 1 number, and 1 special character\");\n                              return false;\n                            }\n\n\n                       // if(vm.user.new_password.length > 7){\n                       //      //at the moment this will suffice!\n                       //      // //console.log(\"Password basic tests are OK to send!\")\n\n\n                       // } else {\n                       //      alert(\"Password must be at least 8 characters\");\n                       //      return false;\n                       // }\n\n                    }\n                }\n\n\n\n\n\n                //current password to save changes\n                if(!vm.user.password){\n                    alert(\"Please enter your current password to ensure that these changes are made by you.\");\n                    return false;\n                }\n\n\n                //if we get here then at least we know to a certain degree that everything is working as we expect.\n                 UserService.Update(vm.user)\n                    .then(function (data) {\n                        if(data.success){\n                            alert(\"Changes updated successfully.\");\n                            $state.go('dashboard.my_account', {}, { reload: true });\n\n                        } else {\n                            if(data.message == \"Password entered failed\"){\n                                alert(\"The password entered was incorrect\");\n                            } else {\n                                alert(\"something horrible happened!\");\n                            }\n                            //this should be very very rare...\n                        }\n                    });\n\n\n\n            } else {\n\n                // //console.log(\"something went wrong here...\");\n\n            }\n\n\n        }\n        \n        \n\n\n    }\n app.controller('ManageDifferencesController', ManageDifferencesController);\n\n    ManageDifferencesController.$inject = ['UserService', 'MemberService', 'InstructorService', 'MembershipService', 'HolidayService', '$rootScope', '$location', '$scope', '$state', '$stateParams', '$uibModal', '$log', '$window', '$compile', '$timeout', 'uiCalendarConfig', 'BookingService', 'DifferencesService'];\n    function ManageDifferencesController(UserService, MemberService, InstructorService, MembershipService, HolidayService, $rootScope, $location, $scope, $state, $stateParams, $uibModal, $log, $window, $compile, $timeout, uiCalendarConfig, BookingService, DifferencesService) {\n        \n        var vm = this;\n\n         DifferencesService.GetDifferences()\n                .then(function (data) {\n                    // //console.log(data);\n                        vm.all_differences = data;\n                });\n\n        vm.user = $rootScope.globals.currentUser;\n        vm.user_id = vm.user.id;\n\n          DifferencesService.GetByUserId(vm.user.id)\n                .then(function (data) {\n                        var diff = data.differences.differences;\n                        for(var i=0;i<diff.length;i++){\n                            if(diff[i].sign_off_date == \"0000-00-00\"){\n                               delete diff[i].sign_off_date;\n                            }\n                            diff[i].sign_off_date = new Date(diff[i].sign_off_date);\n                            diff[i].day = (diff[i].day == 1)? true : false;\n                            diff[i].night = (diff[i].night == 1)? true : false;\n                            diff[i].vfr = (diff[i].vfr == 1)? true : false;\n                            diff[i].ifr = (diff[i].ifr == 1)? true : false;\n                        }\n                        data.differences.differences = diff;\n                        vm.differences = data.differences;\n                        // //console.log(\"GET DIFFS\", vm.differences);\n                        clean_differences_list();\n\n                });\n\n        vm.differences = {\n            images: [],\n            differences: [],\n            user_id: vm.user.id\n        };\n\n        vm.differences_images = [];\n        \n\n        function clean_differences_list(){\n            // //console.log(\"HIT\");\n            if(vm.differences.differences.length > 0){\n                // //console.log(\"got > 0 diffs\");\n                 for(var i=0;i<vm.differences.differences.length;i++){\n                    // //console.log(\"i : \", i);\n                    vm.all_differences = $.grep(vm.all_differences, function(el){ \n                        return el.id != vm.differences.differences[i].differences_id; \n                    });\n\n                 }\n                 \n            }\n\n           \n        }\n\n\n\n         $scope.add_differences = function(){\n\n                //remove from first array\n                if(vm.selected_differences){\n                    vm.all_differences = $.grep(vm.all_differences, function(el){ \n                        return el.id != vm.selected_differences.id; \n                    });\n\n                    vm.selected_differences.day = true;\n                    vm.selected_differences.vfr = true;\n\n\n                    vm.differences.differences.push(vm.selected_differences);\n\n                    //clear selected\n                    delete vm.selected_differences;\n                }\n                \n                \n                //clean the array to show what we want to show :)\n                //delete $scope.formData.license.add_to[bit_type];\n\n            }\n\n            $scope.remove_differences = function(index){\n\n                //add to dropdown\n                vm.all_differences.push(vm.differences.differences[index]);\n                vm.differences.differences.splice(index,1)\n\n                //$scope.formData.license[bit_type] = $scope.formData.license[bit_type].filter(Boolean);\n\n                //  //console.log($scope.formData.license[bit_type]);\n                //  $scope.formData.license[bit_type].push($scope.formData.license.add_to[bit_type]);\n            }\n\n\n\n            $scope.popup = [];\n\n            $scope.open = function(id, $event) {\n                // //console.log(\"THIS\", id);\n                //this comment would allow the event not to be affect by clicking it again... not sure this is a good idea\n                if($scope.popup[id] && $scope.popup[id].opened == true){\n                    $event.preventDefault();\n                    $event.stopPropagation();\n                } else {\n                    $scope.popup[id] = {opened: true};\n                }\n            };\n\n            $scope.formats = ['dd/MM/yyyy', 'yyyy/MM/dd', 'dd.MM.yyyy', 'shortDate'];\n            $scope.format = $scope.formats[0];\n\n            $scope.datePickerOptions = {\n                                        format: 'dd/MM/yyyy',\n                                        showWeeks: false\n                                    };\n\n           \n\n           $scope.remove_real_file = function(file){\n\n                //remove_file\n\n                vm.differences.images = $.grep(vm.differences.images, function(e){ \n                        return e.id != file.id; \n                    });\n\n                //no need to actually remove the file as it will be archived accordingly on the backend whilst it is missing! :)\n                \n\n          }\n\n\n          \n          $scope.remove_file = function(file, current_files){\n\n            //remove_file\n            var j = JSON.parse(file.file_return);\n            // //console.log(\"REMOVE: \", j);\n            // //console.log(\"REMOVE: \", j.saved_url);\n\n            //to delete the temp file created: j.saved_url\n            //tmp_rm.php POST tmp = filename\n            \n            LicenceService.DeleteTmp(j.saved_url)\n                .then(function (data) {\n                    //console.log(data);\n                    if(data.success){\n                        // //console.log(\"HUZZAH\", current_files);\n                        //then we need to remove this from the list of files...\n                        //clear files\n                        vm.licence_images = [];\n                        //and re-process available files\n                        $scope.processFiles(current_files);\n\n                    } else {\n                        // //console.log(\"WOOOPSIES...\");\n                        //this should be very very rare...\n                    }\n\n                });\n\n          }\n          \n\n            $scope.processFiles = function(files){\n                 // //console.log(\"files\", files);\n\n                for(var i=0; i<files.length; i++){\n                    // //console.log(\"JSON\", files[i].file_return);\n                    var j = JSON.parse(files[i].file_return);\n                    // //console.log(\"PARSED\", j);\n                    files[i].file.temp_path = j.saved_url;\n                    // //console.log(\"file\", files[i].file);\n                    vm.differences_images.push(files[i].file);\n                }\n\n                //    for(var i=0; i<files.length; i++){\n                //     // //console.log(\"JSON\", files[i].file_return);\n                //     var j = JSON.parse(files[i].file_return);\n                //     // //console.log(\"PARSED\", j);\n                //     files[i].file.temp_path = j.saved_url;\n                //     // //console.log(\"file\", files[i].file);\n                //     vm.poid_images.push(files[i].file);\n                // }\n\n               \n            }\n\n        \n        $scope.save_differences = function(){\n\n\n                if(vm.differences_images.length < 1 && vm.differences.images.length < 1){\n\n                    $(\".drop\").focus();\n                    alert(\"You must at least have 1 image of the differences page of your log book!\");\n\n                    return false;   \n                }\n\n\n                if(vm.differences.differences.length < 1){\n\n                    $(\"#differences\").focus();\n                    alert(\"You must at least have 1 differences to be able to save the image(s) above!\");\n                    \n                    return false;   \n                }\n\n\n\n\n                //compile the required elements YAY\n\n                // //console.log(\"differences GOOD TO GO \", vm.differences);\n\n\n                 //clean shizzle before sending\n                 //why keep sending back heavy data?\n\n\n                    for(var i=0;i<vm.differences.images.length;i++){\n                        delete vm.differences.images[i].data_uri;\n                    }\n                    vm.differences.user_id = vm.user.id;\n                    vm.differences.images = vm.differences.images.concat(vm.differences_images);\n\n                    // vm.licence.images = vm.licence_images;\n                   \n\n                    \n                    //then its an udpate\n                    //merge the images left?\n                    DifferencesService.Update(vm.differences)\n                        .then(function (data) {\n                            // //console.log(data);\n                            if(data.success){\n                               \n                                alert(\"Differences Saved!\");\n                                $state.go('dashboard.my_account', {}, { reload: true });\n\n\n                            } else {\n\n                                alert(\"Something went terribly wrong... \\n\\n \"+data.message);\n\n                            }\n                        });\n\n\n            };\n\n    }\n app.controller('ManageLicenceController', ManageLicenceController);\n\n    ManageLicenceController.$inject = ['UserService', 'MemberService', 'InstructorService', 'MembershipService', 'HolidayService', '$rootScope', '$location', '$scope', '$state', '$stateParams', '$uibModal', '$log', '$window', '$compile', '$timeout', 'uiCalendarConfig', 'BookingService', 'LicenceService', 'AuthenticationService'];\n    function ManageLicenceController(UserService, MemberService, InstructorService, MembershipService, HolidayService, $rootScope, $location, $scope, $state, $stateParams, $uibModal, $log, $window, $compile, $timeout, uiCalendarConfig, BookingService, LicenceService, AuthenticationService) {\n        \n        var vm = this;\n        vm.licence_images = [];\n        vm.licence = {\n                images: [],\n                ratings: []\n        };\n\n        vm.user = $rootScope.globals.currentUser;\n        vm.user_id = vm.user.id;\n\n        LicenceService.GetLicenceTypes()\n                .then(function (data) {\n                    vm.licence_types = data;\n                    // //console.log(\"licence_types: \", vm.licence_types);\n                });\n\n        LicenceService.GetRatings()\n            .then(function (data) {\n                vm.ratings = data;\n                // //console.log(\"ratings: \", vm.ratings);\n\n                if($state.current.data.action == \"add\"){\n\n                    vm.selected_rating = $.grep(vm.ratings, function(e){ return e.id == 7; })[0];\n                    $scope.add_rating();\n\n                    // for(var i=0;i<vm.ratings.length; i++){\n                    //     //console.log(\"LOOP\", vm.ratings[i]);\n                    //     if(vm.ratings[i].id == 7){\n                    //         vm.selected_rating = vm.ratings[i];\n                    //         //console.log(\"FOUND\", vm.selected_rating);\n                    //         $scope.add_rating();\n                    //         break;\n                    //     }\n                    // }\n                }\n               \n\n\n            });\n\n        LicenceService.GetAuthority()\n            .then(function (data) {\n                vm.authority = data;\n                // //console.log(\"authority: \", vm.authority);\n            });\n\n\n        switch($state.current.data.action){\n            case \"add\":\n\n                    //vm.selected_rating = vm.ratings[0];\n                    //vm.selected_rating = \n                    \n\n                    // //console.log(\"AA\", vm.selected_rating);\n\n            \n\n            break;\n            case \"edit\":\n\n            // //console.log(\"EDIT ONE\");\n            // //console.log(\"PARAMS: \", $stateParams);\n\n             LicenceService.GetById($stateParams.licence_id, 1, 0)\n                .then(function (data) {\n                    if(data.success){\n                        vm.licence = data.licence;\n                        vm.licence.licence_issue_date = new Date(vm.licence.licence_issue_date);\n                        vm.licence.licence_expiry_date = new Date(vm.licence.licence_expiry_date);\n                        // //console.log(\"licence\", vm.licence);\n\n                        vm.licence.licence_type = $.grep(vm.licence_types, function(e){ return e.id == vm.licence.licence_id; })[0];\n                        vm.licence.state_of_issue = $.grep(vm.authority, function(e){ return e.id == vm.licence.authority_id; })[0];\n                        // //console.log(\"SET\", vm.licence.state_of_issue);\n\n                        //pre-selection bits?\n                        // //console.log(\"NEW RATINGS\", vm.licence.ratings);\n                        for(var i=0;i<vm.licence.ratings.length;i++){\n                            delete vm.licence.ratings[i].id;\n                            vm.licence.ratings[i].id = vm.licence.ratings[i].rating_id;\n                            delete vm.licence.ratings[i].rating_id;\n                            vm.licence.ratings[i].test_date = new Date(vm.licence.ratings[i].test_date);\n                            vm.licence.ratings[i].expiry_date = new Date(vm.licence.ratings[i].expiry_date);\n\n                            //need to remove the rating from the ratings lists too :)\n                            vm.ratings = $.grep(vm.ratings, function(e){ \n                                return e.id != vm.licence.ratings[i].id; \n                            });\n\n                        }\n\n\n\n                    } else {\n                        //console.log(\"WOOOPSIES...\");\n                        //this should be very very rare...\n                    }\n\n                });\n\n\n\n            break;\n            case \"list\":\n\n                // //console.log(\"LIST ALL\");\n\n                 //1 get the user's licence...\n                 //list stuff\n\n                LicenceService.GetByUserId(vm.user.id)\n                .then(function (data) {\n                    // //console.log(data);\n                    if(data.success){\n                        vm.user_licences = data.licences;\n\n                    } else {\n                        //console.log(\"WOOOPSIES...\");\n                        //this should be very very rare...\n                    }\n\n                });\n\n\n            break;\n            default:\n                //console.log(\"none of the above... redirect somewhere?\");\n            break;\n        }  \n\n\n\n            $scope.add_rating = function(){\n\n                //remove from first array\n                vm.ratings = $.grep(vm.ratings, function(e){ \n                    return e.id != vm.selected_rating.id; \n                });\n\n                vm.licence.ratings.push(vm.selected_rating);\n\n                //clear selected\n                delete vm.selected_rating;\n                \n                //clean the array to show what we want to show :)\n                //delete $scope.formData.license.add_to[bit_type];\n\n            }\n\n            $scope.remove_rating = function(index){\n\n                //add to dropdown\n                vm.ratings.push(vm.licence.ratings[index]);\n                vm.licence.ratings.splice(index,1)\n\n                //$scope.formData.license[bit_type] = $scope.formData.license[bit_type].filter(Boolean);\n\n                //  //console.log($scope.formData.license[bit_type]);\n                //  $scope.formData.license[bit_type].push($scope.formData.license.add_to[bit_type]);\n            }\n\n            //default add the first rating required...\n            \n\n\n\n/*\n\nOLD VERSION FOR LEGACY PURPOSES\n\n  $scope.add_element = function(bit_type){\n\n                //remove from first array\n                $scope[bit_type][bit_type] = $.grep($scope[bit_type][bit_type], function(e){ \n                    return e.id != $scope.formData.license.add_to[bit_type].id; \n                });\n\n                if(bit_type == \"differences\"){\n                    $scope.formData.license.add_to[bit_type].day = true;\n                    $scope.formData.license.add_to[bit_type].vfr = true;\n                }\n                //console.log($scope.formData.license.add_to[bit_type]);\n\n                $scope.formData.license[bit_type].push($scope.formData.license.add_to[bit_type]);\n                \n                //clean the array to show what we want to show :)\n                delete $scope.formData.license.add_to[bit_type];\n\n            }\n\n\n            $scope.remove_element = function(bit_type, index){\n\n                //add to dropdown\n                $scope[bit_type][bit_type].push($scope.formData.license[bit_type][index]);\n            \n                $scope.formData.license[bit_type].splice(index,1)\n\n                $scope.formData.license[bit_type] = $scope.formData.license[bit_type].filter(Boolean);\n                //console.log($scope.formData.license[bit_type]);\n                //$scope.formData.license[bit_type].push($scope.formData.license.add_to[bit_type]);\n            }\n\n\n*/\n\n\n            //nice looking date pickers\n\n\n            $scope.popup = [];\n\n            $scope.open = function(id, $event) {\n                // //console.log(\"THIS\", id);\n                //this comment would allow the event not to be affect by clicking it again... not sure this is a good idea\n                if($scope.popup[id] && $scope.popup[id].opened == true){\n                    $event.preventDefault();\n                    $event.stopPropagation();\n                } else {\n                    $scope.popup[id] = {opened: true};\n                }\n            };\n\n            $scope.formats = ['dd/MM/yyyy', 'yyyy/MM/dd', 'dd.MM.yyyy', 'shortDate'];\n            $scope.format = $scope.formats[0];\n\n            $scope.datePickerOptions = {\n                                        format: 'dd/MM/yyyy',\n                                        showWeeks: false\n                                    };\n\n           \n\n           $scope.remove_real_file = function(file){\n\n                //remove_file\n\n                vm.licence.images = $.grep(vm.licence.images, function(e){ \n                        return e.id != file.id; \n                    });\n\n                //no need to actually remove the file as it will be archived accordingly on the backend whilst it is missing! :)\n                \n\n          }\n\n\n          \n          $scope.remove_file = function(file, current_files){\n\n            //remove_file\n            var j = JSON.parse(file.file_return);\n            // //console.log(\"REMOVE: \", j);\n            // //console.log(\"REMOVE: \", j.saved_url);\n\n            //to delete the temp file created: j.saved_url\n            //tmp_rm.php POST tmp = filename\n            \n            LicenceService.DeleteTmp(j.saved_url)\n                .then(function (data) {\n                    // //console.log(data);\n                    if(data.success){\n                        // //console.log(\"HUZZAH\", current_files);\n                        //then we need to remove this from the list of files...\n                        //clear files\n                        vm.licence_images = [];\n                        //and re-process available files\n                        $scope.processFiles(current_files);\n\n                    } else {\n                        // //console.log(\"WOOOPSIES...\");\n                        //this should be very very rare...\n                    }\n\n                });\n\n          }\n          \n\n            $scope.processFiles = function(files){\n                // //console.log(\"files\", files);\n\n                for(var i=0; i<files.length; i++){\n                    // //console.log(\"JSON\", files[i].file_return);\n                    var j = JSON.parse(files[i].file_return);\n                    // //console.log(\"PARSED\", j);\n                    files[i].file.temp_path = j.saved_url;\n                    // //console.log(\"file\", files[i].file);\n                    vm.licence_images.push(files[i].file);\n                }\n               \n            }\n\n\n\n            $scope.delete_licence = function(id){\n\n\n                var a = prompt(\"Are you sure you wish to delete this licence? \\n\\n This change is irreversible! To confirm please type YES in the box below.\");\n                if(a == \"YES\"){\n                    // //console.log(\"WE DELETE IT\");\n\n\n                    LicenceService.Delete(vm.user.id, id)\n                        .then(function (data) {\n                            // //console.log(data);\n                            if(data.success){\n                                // //console.log(\"HUZZAH\", data);\n                                //then we need to remove this from the list of files...\n                                vm.user_licences = $.grep(vm.user_licences, function(e){ \n                                    return e.id != id; \n                                });\n                                \n                                //refresh?\n                                $state.reload();\n                                $state.go('dashboard.my_account.licence');\n\n                            } else {\n\n                                alert(\"Something went terribly wrong... \\n\\n \"+data.message);\n\n                            }\n\n                        });\n\n\n\n                } else {\n                    //console.log(\"ignore\");\n                }\n\n\n            }\n\n\n\n\n            vm.show_loading = false;\n            vm.blurred = true;\n            vm.show_temp_login = false;\n\n              $scope.getDecrypted = function(){\n                  vm.show_loading = true;\n                  // LicenceService.GetById($stateParams.licence_id, 1, 1)\n                  //   .then(function (data) {\n\n                  //       if(data.success){\n                  //           vm.medical = data.medical;\n                  //           vm.medical.examination_date = new Date(vm.medical.examination_date);\n\n                  //           vm.medical.state_of_issue = $.grep(vm.authority, function(e){ return e.id == vm.medical.authority_id; })[0];\n                  //           ////console.log(\"SET\", vm.medical.state_of_issue);\n\n                  //           //pre-selection bits?\n                  //           ////console.log(\"NEW RATINGS\", vm.medical.components);\n                  //           for(var i=0;i<vm.medical.components.length;i++){\n                  //               delete vm.medical.components[i].id;\n                  //               vm.medical.components[i].id = vm.medical.components[i].component_id;\n                  //               delete vm.medical.components[i].component_id;\n                  //               vm.medical.components[i].expiry_date = new Date(vm.medical.components[i].expiry_date);\n\n                  //               //need to remove the component from the components lists too :)\n                  //               vm.components = $.grep(vm.components, function(e){ \n                  //                   return e.id != vm.medical.components[i].id; \n                  //               });\n\n                  //           }\n\n                  //           vm.blurred = false;\n                  //           vm.show_loading = false;\n                  //       } else {\n                  //           //console.log(\"WOOOPSIES...\");\n                  //           vm.show_loading = false;\n                  //           //this should be very very rare...\n                  //       }\n\n                  //   });\n\n\n\n\n                  LicenceService.GetById($stateParams.licence_id, 1, 1)\n                    .then(function (data) {\n                        if(data.success){\n                            vm.licence = data.licence;\n                            vm.licence.licence_issue_date = new Date(vm.licence.licence_issue_date);\n                            vm.licence.licence_expiry_date = new Date(vm.licence.licence_expiry_date);\n                            // //console.log(\"licence\", vm.licence);\n\n                            vm.licence.licence_type = $.grep(vm.licence_types, function(e){ return e.id == vm.licence.licence_id; })[0];\n                            vm.licence.state_of_issue = $.grep(vm.authority, function(e){ return e.id == vm.licence.authority_id; })[0];\n                            // //console.log(\"SET\", vm.licence.state_of_issue);\n\n                            //pre-selection bits?\n                            // //console.log(\"NEW RATINGS\", vm.licence.ratings);\n                            for(var i=0;i<vm.licence.ratings.length;i++){\n                                delete vm.licence.ratings[i].id;\n                                vm.licence.ratings[i].id = vm.licence.ratings[i].rating_id;\n                                delete vm.licence.ratings[i].rating_id;\n                                vm.licence.ratings[i].test_date = new Date(vm.licence.ratings[i].test_date);\n                                vm.licence.ratings[i].expiry_date = new Date(vm.licence.ratings[i].expiry_date);\n\n                                //need to remove the rating from the ratings lists too :)\n                                vm.ratings = $.grep(vm.ratings, function(e){ \n                                    return e.id != vm.licence.ratings[i].id; \n                                });\n\n                            }\n\n                            vm.show_loading = false;\n                            vm.blurred = false;\n\n                        } else {\n\n                                if(data.fail == \"templogin\"){\n                                    // //console.log(\"WOOOPSIES...\", data);\n                                    vm.show_temp_login = true;\n\n                                }\n\n                            vm.show_loading = false;\n                            //this should be very very rare...\n                        }\n\n                    });\n\n\n\n              }\n\n              function create_sample(length) {\n                   var result           = '';\n                   var characters       = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n                   var charactersLength = characters.length;\n                   for ( var i = 0; i < length; i++ ) {\n                      result += characters.charAt(Math.floor(Math.random() * charactersLength));\n                   }\n                   return result;\n                }\n\n\n                $scope.re_login = function(){\n\n\n                      ////console.log(\"CLICKED\", vm.re_login_pass);\n\n                      //now we use the token that has been assigned already to verify the login password\n\n                        AuthenticationService.Login3(vm.re_login_pass, create_sample(120), function (response) {\n                            //console.log(\"resp\", response);\n                            if (response.success) {\n\n\n                                //we now need to call the query that was called before (decryption)\n\n                                $scope.getDecrypted();\n\n\n\n\n                                vm.show_temp_login = false;\n                            } else {\n                                alert(\"This is the wrong password - please try again...\");\n                            }\n                        });\n\n\n\n                      //vm.show_temp_login = true;\n\n                  }\n\n\n\n            $scope.save_licence = function(isValid){\n                vm.show_loading = true;\n\n                if(vm.licence_images.length < 1 && vm.licence.images.length < 1){\n\n                    $(\".drop\").focus();\n                    alert(\"You must at least have 1 image of your licence!\");\n\n                    return false;   \n                }\n\n\n                if(!vm.licence.licence_type){\n                    $(\"#licence_type\").focus();\n                    alert(\"You must select a licence type\");\n\n                    return false;\n                }\n\n\n                if(!vm.licence.state_of_issue){\n                    $(\"#state_of_issue\").focus();\n                    alert(\"You must select a licence state of issue\");\n\n                    return false;\n                }\n\n\n                if(vm.licence.ratings.length < 1){\n\n                    $(\"#ratings\").focus();\n                    alert(\"You must at least have 1 rating!\");\n                    \n                    return false;   \n                }\n\n                // //console.log(\"FLOW: \", vm.licence_images);\n\n\n\n                //compile the required elements YAY\n\n                // //console.log(\"LICENCE GOOD TO GO \", vm.licence);\n\n\n                 //clean shizzle before sending\n                 //why keep sending back heavy data?\n\n                    for(var i=0;i<vm.licence.images.length;i++){\n                        delete vm.licence.images[i].data_uri;\n                    }\n\n                    // vm.licence.images = vm.licence_images;\n                    vm.licence.images = vm.licence.images.concat(vm.licence_images);\n\n                    vm.licence.licence_id = vm.licence.licence_type.id;\n                    vm.licence.authority_id = vm.licence.state_of_issue.id;\n                    vm.licence.user_id = vm.user.id;\n\n                    delete vm.licence.licence_type;\n                    delete vm.licence.state_of_issue;\n\n\n                if(vm.licence.id){\n                    //then its an udpate\n\n                    //merge the images left?\n                    LicenceService.Update(vm.licence)\n                        .then(function (data) {\n                            // //console.log(data);\n                            if(data.success){\n                                // //console.log(\"HUZZAH\", vm.licence);\n                                // //console.log(\"HUZZAH\", data);\n                                //then we need to remove this from the list of files...\n                                \n                                \n                                //move somewhere?\n                                $state.go('dashboard.my_account.licence', {}, { reload: true });\n\n                                vm.show_loading = false;\n\n\n\n\n                            } else {\n\n                                alert(\"Something went terribly wrong... \\n\\n \"+data.message);\n                                vm.show_loading = false;\n\n                            }\n\n                        });\n\n                } else {\n\n\n                   \n\n\n                    //then its a create\n                    // //console.log(vm.licence);\n\n                    LicenceService.Create(vm.licence)\n                        .then(function (data) {\n                            //console.log(data);\n                            if(data.success){\n                                // //console.log(\"HUZZAH\", vm.licence);\n                                // //console.log(\"HUZZAH\", data);\n                                //then we need to remove this from the list of files...\n                                \n                                \n                                //move somewhere?\n                                $state.reload();\n                                vm.show_loading = false;\n                                $state.go('dashboard.my_account.licence', {}, { reload: true });\n\n\n                            } else {\n\n                                alert(\"Something went terribly wrong... \\n\\n \"+data.message);\n                                vm.show_loading = false;\n\n                            }\n\n                        });\n\n\n                }\n\n\n\n            };\n\n\n        \n        \n\n\n    }\n app.controller('ManageMedicalController', ManageMedicalController);\n\n    ManageMedicalController.$inject = ['UserService', 'MemberService', 'AuthenticationService', 'InstructorService', 'MembershipService', 'HolidayService', '$rootScope', '$location', '$scope', '$state', '$stateParams', '$uibModal', '$log', '$window', '$compile', '$timeout', 'uiCalendarConfig', 'LicenceService', 'MedicalService'];\n    function ManageMedicalController(UserService, MemberService, AuthenticationService, InstructorService, MembershipService, HolidayService, $rootScope, $location, $scope, $state, $stateParams, $uibModal, $log, $window, $compile, $timeout, uiCalendarConfig, LicenceService, MedicalService) {\n        \n        var vm = this;        \n\n        vm.medical_images = [];\n        vm.medical = {\n                images: [],\n                components: []\n        };\n        vm.user = $rootScope.globals.currentUser;\n        vm.user_id = vm.user.id;\n\n\n        MedicalService.GetMedicalTypes()\n                .then(function (data) {\n                    vm.medical_types = data;\n                    // //console.log(\"medical_types: \", vm.medical_types);\n                });\n\n\n        MedicalService.GetAuthority()\n            .then(function (data) {\n                vm.authority = data;\n                // //console.log(\"authority: \", vm.authority);\n            });\n\n        MedicalService.GetComponents()\n            .then(function (data) {\n                vm.components = data;\n                // //console.log(\"authority: \", vm.authority);\n            });\n\n\n        switch($state.current.data.action){\n            case \"add\":\n\n                    //vm.selected_component = vm.components[0];\n                    //vm.selected_component = \n                    \n\n                    // //console.log(\"AA\", vm.selected_component);\n\n            \n\n            break;\n            case \"edit\":\n\n            // //console.log(\"EDIT ONE\");\n            // //console.log(\"PARAMS: \", $stateParams);\n\n             MedicalService.GetById($stateParams.medical_id, 1, 0)\n                .then(function (data) {\n                    if(data.success){\n                        vm.medical = data.medical;\n                        vm.medical.examination_date = new Date(vm.medical.examination_date);\n\n                        vm.medical.state_of_issue = $.grep(vm.authority, function(e){ return e.id == vm.medical.authority_id; })[0];\n                        // //console.log(\"SET\", vm.medical.state_of_issue);\n\n                        //pre-selection bits?\n                        // //console.log(\"NEW RATINGS\", vm.medical.components);\n                        for(var i=0;i<vm.medical.components.length;i++){\n                            delete vm.medical.components[i].id;\n                            vm.medical.components[i].id = vm.medical.components[i].component_id;\n                            delete vm.medical.components[i].component_id;\n                            vm.medical.components[i].expiry_date = new Date(vm.medical.components[i].expiry_date);\n\n                            //need to remove the component from the components lists too :)\n                            vm.components = $.grep(vm.components, function(e){ \n                                return e.id != vm.medical.components[i].id; \n                            });\n\n                        }\n\n\n\n                    } else {\n                        //console.log(\"WOOOPSIES...\");\n                        //this should be very very rare...\n                    }\n\n                });\n\n\n\n            break;\n            case \"list\":\n\n                //console.log(\"LIST ALL\");\n\n                 //1 get the user's medical...\n                 //list stuff\n\n                MedicalService.GetByUserId(vm.user.id)\n                .then(function (data) {\n                    //console.log(data);\n                    if(data.success){\n                        vm.user_medicals = data.medicals;\n\n                    } else {\n                        //console.log(\"WOOOPSIES...\");\n                        //this should be very very rare...\n                    }\n\n                });\n\n\n            break;\n            default:\n                //console.log(\"none of the above... redirect somewhere?\");\n            break;\n        }  \n\n\n\n            $scope.add_component = function(){\n\n                //remove from first array\n                vm.components = $.grep(vm.components, function(e){ \n                    return e.id != vm.selected_component.id; \n                });\n\n                vm.medical.components.push(vm.selected_component);\n\n                //clear selected\n                delete vm.selected_component;\n                \n                //clean the array to show what we want to show :)\n                //delete $scope.formData.license.add_to[bit_type];\n\n            }\n\n            $scope.remove_component = function(index){\n\n                //add to dropdown\n                vm.components.push(vm.medical.components[index]);\n                vm.medical.components.splice(index,1)\n\n                //$scope.formData.license[bit_type] = $scope.formData.license[bit_type].filter(Boolean);\n\n                //  //console.log($scope.formData.license[bit_type]);\n                //  $scope.formData.license[bit_type].push($scope.formData.license.add_to[bit_type]);\n            }\n\n            //default add the first component required...\n            \n\n\n\n/*\n\nOLD VERSION FOR LEGACY PURPOSES\n\n  $scope.add_element = function(bit_type){\n\n                //remove from first array\n                $scope[bit_type][bit_type] = $.grep($scope[bit_type][bit_type], function(e){ \n                    return e.id != $scope.formData.license.add_to[bit_type].id; \n                });\n\n                if(bit_type == \"differences\"){\n                    $scope.formData.license.add_to[bit_type].day = true;\n                    $scope.formData.license.add_to[bit_type].vfr = true;\n                }\n                //console.log($scope.formData.license.add_to[bit_type]);\n\n                $scope.formData.license[bit_type].push($scope.formData.license.add_to[bit_type]);\n                \n                //clean the array to show what we want to show :)\n                delete $scope.formData.license.add_to[bit_type];\n\n            }\n\n\n            $scope.remove_element = function(bit_type, index){\n\n                //add to dropdown\n                $scope[bit_type][bit_type].push($scope.formData.license[bit_type][index]);\n            \n                $scope.formData.license[bit_type].splice(index,1)\n\n                $scope.formData.license[bit_type] = $scope.formData.license[bit_type].filter(Boolean);\n                //console.log($scope.formData.license[bit_type]);\n                //$scope.formData.license[bit_type].push($scope.formData.license.add_to[bit_type]);\n            }\n\n\n*/\n\n\n            //nice looking date pickers\n\n\n            $scope.popup = [];\n\n            $scope.open = function(id, $event) {\n                // //console.log(\"THIS\", id);\n                //this comment would allow the event not to be affect by clicking it again... not sure this is a good idea\n                if($scope.popup[id] && $scope.popup[id].opened == true){\n                    $event.preventDefault();\n                    $event.stopPropagation();\n                } else {\n                    $scope.popup[id] = {opened: true};\n                }\n            };\n\n            $scope.formats = ['dd/MM/yyyy', 'yyyy/MM/dd', 'dd.MM.yyyy', 'shortDate'];\n            $scope.format = $scope.formats[0];\n\n            $scope.datePickerOptions = {\n                                        format: 'dd/MM/yyyy',\n                                        showWeeks: false\n                                    };\n\n           \n\n           $scope.remove_real_file = function(file){\n\n                //remove_file\n\n                vm.medical.images = $.grep(vm.medical.images, function(e){ \n                        return e.id != file.id; \n                    });\n\n                //no need to actually remove the file as it will be archived accordingly on the backend whilst it is missing! :)\n                \n\n          }\n\n\n\n          vm.show_loading = false;\n          vm.blurred = true;\n          vm.show_temp_login = false;\n\n          $scope.getDecrypted = function(){\n              vm.show_loading = true;\n              MedicalService.GetById($stateParams.medical_id, 1, 1)\n                .then(function (data) {\n\n                    if(data.success){\n                        vm.medical = data.medical;\n                        vm.medical.examination_date = new Date(vm.medical.examination_date);\n\n                        vm.medical.state_of_issue = $.grep(vm.authority, function(e){ return e.id == vm.medical.authority_id; })[0];\n                        ////console.log(\"SET\", vm.medical.state_of_issue);\n\n                        //pre-selection bits?\n                        ////console.log(\"NEW RATINGS\", vm.medical.components);\n                        for(var i=0;i<vm.medical.components.length;i++){\n                            delete vm.medical.components[i].id;\n                            vm.medical.components[i].id = vm.medical.components[i].component_id;\n                            delete vm.medical.components[i].component_id;\n                            vm.medical.components[i].expiry_date = new Date(vm.medical.components[i].expiry_date);\n\n                            //need to remove the component from the components lists too :)\n                            vm.components = $.grep(vm.components, function(e){ \n                                return e.id != vm.medical.components[i].id; \n                            });\n\n                        }\n\n                        vm.blurred = false;\n                        vm.show_loading = false;\n                    } else {\n\n                        if(data.fail == \"templogin\"){\n                            //console.log(\"WOOOPSIES...\", data);\n                            vm.show_temp_login = true;\n\n                        }\n\n\n\n                        vm.show_loading = false;\n                        //this should be very very rare...\n                    }\n\n                });\n          }\n\n        function create_sample(length) {\n           var result           = '';\n           var characters       = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n           var charactersLength = characters.length;\n           for ( var i = 0; i < length; i++ ) {\n              result += characters.charAt(Math.floor(Math.random() * charactersLength));\n           }\n           return result;\n        }\n\n\n          $scope.re_login = function(){\n\n\n              //console.log(\"CLICKED\", vm.re_login_pass);\n\n              //now we use the token that has been assigned already to verify the login password\n\n                AuthenticationService.Login3(vm.re_login_pass, create_sample(120), function (response) {\n                    //console.log(\"resp\", response);\n                    if (response.success) {\n\n\n                        //we now need to call the query that was called before (decryption)\n\n                        $scope.getDecrypted();\n\n\n\n\n                        vm.show_temp_login = false;\n                    } else {\n                        alert(\"This is the wrong password - please try again...\");\n                    }\n                });\n\n\n\n              //vm.show_temp_login = true;\n\n          }\n\n          \n          $scope.remove_file = function(file, current_files){\n\n            //remove_file\n            var j = JSON.parse(file.file_return);\n            // //console.log(\"REMOVE: \", j);\n            // //console.log(\"REMOVE: \", j.saved_url);\n\n            //to delete the temp file created: j.saved_url\n            //tmp_rm.php POST tmp = filename\n            \n            MedicalService.DeleteTmp(j.saved_url)\n                .then(function (data) {\n                    //console.log(data);\n                    if(data.success){\n                        // //console.log(\"HUZZAH\", current_files);\n                        //then we need to remove this from the list of files...\n                        //clear files\n                        vm.medical_images = [];\n                        //and re-process available files\n                        $scope.processFiles(current_files);\n\n                    } else {\n                        //console.log(\"WOOOPSIES...\");\n                        //this should be very very rare...\n                    }\n\n                });\n\n          }\n          \n\n            $scope.processFiles = function(files){\n                // //console.log(\"files\", files);\n\n                for(var i=0; i<files.length; i++){\n                    // //console.log(\"JSON\", files[i].file_return);\n                    var j = JSON.parse(files[i].file_return);\n                    // //console.log(\"PARSED\", j);\n                    files[i].file.temp_path = j.saved_url;\n                    // //console.log(\"file\", files[i].file);\n                    vm.medical_images.push(files[i].file);\n                }\n               \n            }\n\n\n\n            $scope.delete_medical = function(id){\n\n              \n                var a = prompt(\"Are you sure you wish to delete this medical? \\n\\n This change is irreversible! To confirm please type YES in the box below.\");\n                if(a == \"YES\"){\n\n\n                    //console.log(\"WE DELETE IT\");\n\n\n                    MedicalService.Delete(vm.user.id, id)\n                        .then(function (data) {\n                            //console.log(data);\n                            if(data.success){\n                                //console.log(\"HUZZAH\", data);\n                                //then we need to remove this from the list of files...\n                                vm.user_medicals = $.grep(vm.user_medicals, function(e){ \n                                    return e.id != id; \n                                });\n                                \n                                //refresh?\n                                $state.reload();\n                                $state.go('dashboard.my_account.medical');\n\n                            } else {\n\n                                alert(\"Something went terribly wrong... \\n\\n \"+data.message);\n\n                            }\n\n                        });\n\n\n\n                } else {\n                    //console.log(\"ignore123\");\n                }\n\n\n            }\n\n\n\n\n            $scope.save_medical = function(isValid){\n\n                vm.show_loading = true;\n\n                if(vm.medical_images.length < 1 && vm.medical.images.length < 1){\n\n                    $(\".drop\").focus();\n                    alert(\"You must at least have 1 image of your medical!\");\n\n                    vm.show_loading = false;\n                    return false;   \n                }\n\n\n                if(!vm.medical.state_of_issue){\n                    $(\"#state_of_issue\").focus();\n                    alert(\"You must select a medical state of issue\");\n                    vm.show_loading = false;\n                    return false;\n                }\n\n\n                if(vm.medical.components.length < 1){\n\n                    $(\"#components\").focus();\n                    alert(\"You must at least have 1 component!\");\n                    vm.show_loading = false;\n                    return false;   \n                }\n\n                //console.log(\"FLOW: \", vm.medical_images);\n\n\n\n                //compile the required elements YAY\n\n                //console.log(\"LICENCE GOOD TO GO \", vm.medical);\n\n\n                 //clean shizzle before sending\n                 //why keep sending back heavy data?\n\n                    for(var i=0;i<vm.medical.images.length;i++){\n                        delete vm.medical.images[i].data_uri;\n                    }\n\n                    // vm.medical.images = vm.medical_images;\n                    vm.medical.images = vm.medical.images.concat(vm.medical_images);\n                    vm.medical.authority_id = vm.medical.state_of_issue.id;\n                    vm.medical.user_id = vm.user.id;\n\n                    delete vm.medical.medical_type;\n                    delete vm.medical.state_of_issue;\n\n\n                if(vm.medical.id){\n                    //then its an udpate\n\n                    //merge the images left?\n                    MedicalService.Update(vm.medical)\n                        .then(function (data) {\n                            //console.log(data);\n                            if(data.success){\n                                //console.log(\"HUZZAH\", vm.medical);\n                                //console.log(\"HUZZAH\", data);\n                                //then we need to remove this from the list of files...\n                                \n                                \n                                //move somewhere?\n                                $state.go('dashboard.my_account.medical', {}, { reload: true });\n\n                                vm.show_loading = false;\n\n\n\n\n                            } else {\n\n                                alert(\"Something went terribly wrong... \\n\\n \"+data.message);\n                                vm.show_loading = false;\n\n                            }\n\n                        });\n\n                } else {\n\n\n                   \n\n\n                    //then its a create\n                    //console.log(vm.medical);\n\n                    MedicalService.Create(vm.medical)\n                        .then(function (data) {\n                            //console.log(data);\n                            if(data.success){\n                                //console.log(\"HUZZAH\", vm.medical);\n                                //console.log(\"HUZZAH\", data);\n                                vm.show_loading = false;\n                                //then we need to remove this from the list of files...\n                                $state.go('dashboard.my_account.medical', {}, { reload: true });\n                                \n                                //move somewhere?\n                               // $state.reload();\n                               // $state.go('dashboard.my_account.medical', {}, { reload: true });\n\n\n                            } else {\n\n                                alert(\"Something went terribly wrong... \\n\\n \"+data.message);\n                                vm.show_loading = false;\n\n                            }\n\n                        });\n\n\n                }\n\n\n\n            };\n\n\n\n        \n        \n\n\n    }\n app.controller('ManageMyMembershipsController', ManageMyMembershipsController);\n\n    ManageMyMembershipsController.$inject = ['UserService', 'MemberService', 'MembershipService', 'PaymentService', 'InstructorService', 'HolidayService', 'ClubService', '$rootScope', '$location', '$scope', '$state', '$stateParams', '$uibModal', '$log', '$window', '$compile', '$timeout', 'uiCalendarConfig', 'LicenceService', 'NokService', '$cookies', 'GoCardService', '$http'];\n    function ManageMyMembershipsController(UserService, MemberService, MembershipService, PaymentService, InstructorService, HolidayService, ClubService, $rootScope, $location, $scope, $state, $stateParams, $uibModal, $log, $window, $compile, $timeout, uiCalendarConfig, LicenceService, NokService, $cookies, GoCardService, $http) {\n        \n        var vm = this;        \n\n        vm.user = $rootScope.globals.currentUser;\n        vm.user_id = vm.user.id;        \n        vm.noks = [];\n        vm.requests = [];\n        vm.auto_renew = false;\n\n        \n    \n\n\n        switch($state.current.data.action){\n            case \"add\":\n\n                    //vm.selected_component = vm.components[0];\n                    //vm.selected_component = \n\n                    // //console.log(\"AA\", vm.selected_component);\n                ClubService.GetAll()\n                .then(function (data) {\n                    \n                    vm.clubs = data;\n\n                });\n            \n\n            break;\n            case \"edit\":\n\n            // //console.log(\"EDIT ONE\");\n             //console.log(\"PARAMS: \", $stateParams);\n\n            // PaymentService.GetByUserId(vm.user.id)\n            //     .then(function (data) {\n            //         //console.log(\"DATA HERE\", data);\n            //         vm.cards = data.cards;\n\n\n                    MemberService.GetOneForUser($stateParams.membership_id)\n                    .then(function (data) {\n                            //console.log(\"DATA HERE\", data);\n                            if(data.success){\n                                vm.membership_now = data.membership;\n                                vm.auto_renew = (data.membership.auto_renew == 1) ? true : false;\n\n                                //get_member_cards\n                                 var send = {\n                                   user_id: vm.user.id,\n                                   club_id: vm.membership_now.club_id,\n                                   membership_id: $stateParams.membership_id\n                               }\n                                PaymentService.GetMemberCards(send)\n                                .then(function (data) {\n\n                                    console.log(data);\n                                    vm.membership_now.cards = data.cards;\n                                    vm.membership_now.default_card = data.default_card;\n\n                                });\n\n\n\n                                //vm.payment_card = vm.cards.find(item => item.id === vm.membership_now.card_id);\n                            } else {\n                                //console.log(\"woops\");\n                            }\n                            \n                            \n\n\n                        });\n\n                // });\n\n\n\n\n\n            break;\n\n            case \"accept\":\n\n                // //console.log(\"EDIT ONE\");\n                //console.log(\"PARAMS: \", $stateParams);\n                //$stateParams.request_id\n                MembershipService.GetRequestsById($stateParams.request_id)\n                    .then(function (data) {\n                        if(data.success){\n                            vm.this_req = data.request;\n                            //console.log(\"REQ\", vm.this_req);\n\n\n\n\n\n                        } else {\n                            //console.log(\"WOOOPSIES...\");\n                            //this should be very very rare...\n                        }\n                    });\n\n\n                // PaymentService.GetByUserId(vm.user.id)\n                //     .then(function (data) {\n                //         //console.log(\"DATA HERE\", data);\n                //         vm.cards = data.cards;\n                //     });\n\n\n\n            break;\n            case \"list\":\n\n                //console.log(\"LIST ALL\");\n\n                 //1 get the user's nok...\n                 //list stuff\n\n                 MemberService.GetUserMemberships(vm.user.id)\n                .then(function (data) {\n                    if(data.success){\n                        vm.memberships = data.memberships;\n                        //console.log(\"memberships\", vm.memberships);\n\n                    } else {\n                        //console.log(\"WOOOPSIES...\");\n                        //this should be very very rare...\n                    }\n\n                });\n\n                update_requests();\n\n                //  MembershipService.GetRequestsByUser(vm.user.id)\n                // .then(function (data) {\n                //     if(data.success){\n                //         vm.requests = data.requests;\n                //         //console.log(\"memberships\", vm.memberships);\n\n                //     } else {\n                //         //console.log(\"WOOOPSIES...\");\n                //         //this should be very very rare...\n                //     }\n\n                // });\n\n\n            break;\n           \n            default:\n                //console.log(\"none of the above... redirect somewhere?\");\n            break;\n        }  \n\n\n\n        function update_requests(){\n            MembershipService.GetRequestsByUser(vm.user.id)\n                .then(function (data) {\n                    if(data.success){\n                        vm.requests = data.requests;\n                        //console.log(\"memberships\", vm.memberships);\n\n                    } else {\n                        //console.log(\"WOOOPSIES...\");\n                        //this should be very very rare...\n                    }\n\n                });\n        }\n\n\n            $scope.popup = [];\n\n            $scope.open = function(id, $event) {\n                //console.log(\"THIS\", id);\n                //this comment would allow the event not to be affect by clicking it again... not sure this is a good idea\n                if($scope.popup[id] && $scope.popup[id].opened == true){\n                    $event.preventDefault();\n                    $event.stopPropagation();\n                } else {\n                    $scope.popup[id] = {opened: true};\n                }\n            };\n\n            $scope.formats = ['dd/MM/yyyy', 'yyyy/MM/dd', 'dd.MM.yyyy', 'shortDate'];\n            $scope.format = $scope.formats[0];\n\n            $scope.datePickerOptions = {\n                                        format: 'dd/MM/yyyy',\n                                        showWeeks: false\n                                    };\n\n           \n\n            vm.show_memberships = false;\n\n            $scope.set_club = function(){\n\n                vm.show_memberships = true;\n                \n                MembershipService.GetAllByClubAvailable(vm.club.id)\n                .then(function (data) {\n                    //console.log(\"DATA HERE\", data);\n                    vm.memberships = data;\n                  \n                });\n\n            }\n\n            $scope.set_default_payment_method = function(name){\n\n                var obj = {\n                    default_payment_method: name\n                };\n\n                MemberService.UpdateOneByUser($stateParams.membership_id, obj)\n                .then(function (data) {\n                    //console.log(\"ACCEPT HERE\", data);\n\n\n                    MemberService.GetOneForUser($stateParams.membership_id)\n                    .then(function (data) {\n                            //console.log(\"DATA HERE\", data);\n                            if(data.success){\n                                vm.membership_now = data.membership;\n                                vm.auto_renew = (data.membership.auto_renew == 1) ? true : false;\n\n                                //get_member_cards\n                                 var send = {\n                                   user_id: vm.user.id,\n                                   club_id: vm.membership_now.club_id,\n                                   membership_id: $stateParams.membership_id\n                               }\n                                PaymentService.GetMemberCards(send)\n                                .then(function (data) {\n\n                                    console.log(data);\n                                    vm.membership_now.cards = data.cards;\n                                    vm.membership_now.default_card = data.default_card;\n\n                                });\n\n\n\n                                //vm.payment_card = vm.cards.find(item => item.id === vm.membership_now.card_id);\n                            } else {\n                                //console.log(\"woops\");\n                            }\n                            \n                            \n\n\n                        });\n\n\n\n                    //$state.go('dashboard.my_account.memberships', {}, {reload: true});\n                });\n\n            }\n\n            $scope.make_default_card = function(card){\n                var a = confirm(\"Are you sure you wish to make this card the default card?\");\n\n                if(a){\n                    var send = {user_id: vm.user.id, club_id: vm.membership_now.club_id, card_id: card.stripe_id};\n                    PaymentService.UpdateDefaultCard(send)\n                    .then(function (data) {\n                        console.log(\"DATA HERE\", data);\n                        if(data.success){\n                            //update the card list!\n                            vm.membership_now.cards = data.cards;\n                            vm.membership_now.default_card = data.default_card;\n                        }\n                      \n                    });\n                }\n            }\n\n            $scope.delete_member_card = function(card){\n\n                var a = confirm(\"Are you sure you wish to delete this card?\");\n\n                if(a){\n                    var send = {user_id: vm.user.id, club_id: vm.membership_now.club_id, card_id: card.stripe_id};\n                    PaymentService.DeleteMemberCard(send)\n                    .then(function (data) {\n                        console.log(\"DATA HERE\", data);\n                        if(data.success){\n                            //update the card list!\n                            PaymentService.GetMemberCards(send)\n                                    .then(function (data) {\n                                        // console.log(data);\n                                        vm.membership_now.cards = data.cards;\n\n                                    });\n                        }\n                      \n                    });\n                }\n\n                \n            }\n\n            $scope.delete_request = function(id){\n                MembershipService.DeleteRequest(id)\n                .then(function (data) {\n                    //console.log(\"DELETE HERE\", data);\n                    //vm.memberships = data;\n                    update_requests();\n                }); \n            }\n\n\n            $scope.set_membership = function(){\n\n                vm.show_confirmation = true;\n                \n                PaymentService.GetByUserId(vm.user.id)\n                .then(function (data) {\n                    //console.log(\"DATA HERE\", data);\n                    vm.cards = data.cards;\n                  \n                });\n\n            }\n\n\n            $scope.set_card = function(){\n\n              \n                \n\n            }\n\n\n            $scope.accept_it = function(){\n\n                if(!vm.club_tnc){\n                    alert(\"You need to access the terms of the flight organisation prior to continuing!\");\n                    return false;\n                }\n\n                //basic checks...\n                var obj = {\n                    club_id: vm.this_req.club_id,\n                    user_id: vm.user_id,\n                    request_id: vm.this_req.id\n                };\n\n                MembershipService.AcceptRequest(vm.this_req.id, obj)\n                .then(function (data) {\n                    ////console.log(\"ACCEPT HERE\", data);\n\n                    $cookies.put('gcl_sess', data.mandate.session);\n                    $cookies.put('gcl_member_accepted', true);\n\n                    window.location = data.mandate.link;\n\n                    //vm.memberships = data;\n                    // update_requests();\n                    //     $state.go('dashboard.my_account.memberships', {}, {reload: true});\n                }); \n\n            }\n\n            $scope.update_it = function(){\n\n                var obj = {\n                    auto_renew: (vm.auto_renew == true)? 1 : 0\n                };\n\n                MemberService.UpdateOneByUser($stateParams.membership_id, obj)\n                .then(function (data) {\n                    //console.log(\"ACCEPT HERE\", data);\n                    //vm.aut\n                    //$state.go('dashboard.my_account.memberships', {}, {reload: true});\n                });\n\n            }\n\n\n            $scope.edit_membership = function(id){\n\n                //console.log(\"update membership\");\n                $state.go('dashboard.my_account.memberships.edit', {membership_id: id});\n\n            }\n\n\n            $scope.create_direct_debit = function(){\n\n                \n\n\n            }\n\n            var update_request = false;\n            vm.change_direct_debit = function(){\n                if(!update_request){\n\n                   ////console.log(\"UPDATE\");\n\n                   var update_mandate_details = {\n                       user_id: vm.user.id,\n                       club_id: vm.membership_now.club_id,\n                       membership_id: $stateParams.membership_id\n                   }\n\n                   ////console.log(\"to send\", update_mandate_details);\n\n                   GoCardService.GenerateUpdateLink(update_mandate_details)\n                   .then(function (data) {\n                    ////console.log(\"ACCEPT HERE\", data);\n                    if(data.success){\n                        $cookies.put('gcl_sess', data.session);\n                        $cookies.put('gcl_member_accepted', true);\n\n                        window.location = data.link;\n                        \n                    } else {\n                        alert(\"An error occurred when generating the link to update your direct debit instructions - please contact support@toaviate.com\");\n                    }\n                   \n\n                    //vm.memberships = data;\n                    // update_requests();\n                    //     $state.go('dashboard.my_account.memberships', {}, {reload: true});\n                }); \n\n\n\n\n                } else {\n                    //console.log(\"putting the request on hold\");\n                }\n\n\n            }\n\n          \n            vm.show_add_card = false;\n\n            $scope.add_card = function(){\n\n                console.log(\"ADD A CARD HERE!!\");\n                var send = {\n                    club_id: vm.membership_now.club_id,\n                    user_id: vm.user.id\n                }\n\n                vm.show_add_card = true;\n\n                PaymentService.CreateNewCustomer(send)\n                .then(function (data) {\n                    console.log(\"DATA HERE\", data);\n                    // Initialize Stripe.js\n                    var stripe = Stripe('pk_test_51QttFFG8WiGSRCORyxkdZTO8oajcqz9OUsvcDJFpr9FB2PAdbzJc0tS7WNnfzKYsTiqHN1YDZi5UtXk4K52SeD4h00YWXuChNd');\n\n                    const options = {\n                      clientSecret: data.secret,\n                      // Fully customizable with appearance API.\n                      appearance: {/*...*/},\n                    };\n\n                    // Set up Stripe.js and Elements using the SetupIntent's client secret\n                    const elements = stripe.elements(options);\n\n                    // Create and mount the Payment Element\n                    const paymentElementOptions = { layout: 'tabs'};\n                    const paymentElement = elements.create('payment', paymentElementOptions);\n                    paymentElement.mount('#payment-element');\n\n\n\n                    const form = document.getElementById('payment-form');\n\n                    form.addEventListener('submit', async (event) => {\n                      event.preventDefault();\n\n                      const {error} = await stripe.confirmSetup({\n                        //`Elements` instance that was used to create the Payment Element\n                        elements,\n                        confirmParams: {\n                          return_url: window.location.href,\n                        }\n                      });\n\n                      if (error) {\n                        // This point will only be reached if there is an immediate error when\n                        // confirming the payment. Show error to your customer (for example, payment\n                        // details incomplete)\n                        const messageContainer = document.querySelector('#error-message');\n                        messageContainer.textContent = error.message;\n                      } else {\n                        // Your customer will be redirected to your `return_url`. For some payment\n                        // methods like iDEAL, your customer will be redirected to an intermediate\n                        // site first to authorize the payment, then redirected to the `return_url`.\n                      }\n                    });\n\n\n\n\n                });\n\n               //  //setup the js to show the card addition form\n               // PaymentService.CreatePaymentIntent(send)\n               //  .then(function (data) {\n               //      console.log(\"DATA HERE\", data);\n               //      vm.show_add_card = true;\n\n               //      var fetched_secret = data.clientSecret;\n               //      // Initialize Stripe.js\n               //      var stripe = Stripe('pk_test_51QttFFG8WiGSRCORyxkdZTO8oajcqz9OUsvcDJFpr9FB2PAdbzJc0tS7WNnfzKYsTiqHN1YDZi5UtXk4K52SeD4h00YWXuChNd');\n\n               //      // Initialize Checkout\n                     \n\n                    \n\n               //          var checkout = stripe.initEmbeddedCheckout({\n               //              clientSecret: fetched_secret,\n               //          }).then(function(checkout){\n               //                checkout.mount('#checkout');\n               //              //   const options = { layout: 'accordion', clientSecret: fetched_secret /* options */ };\n\n               //              //   const appearance = {\n               //              //       theme: 'flat',\n               //              //       variables: { colorPrimaryText: '#262626' },\n               //              //       clientSecret: fetched_secret\n               //              //     };\n               //              //   const elements = stripe.elements(appearance, {clientSecret: fetched_secret});\n               //              // const paymentElement = elements.create('payment', options);\n               //              // paymentElement.mount('#checkout');\n               //          });\n\n                         \n                            \n                         \n\n\n                   \n               //        // Mount Checkout\n               //        //checkout.mount('#checkout');\n\n               //      ///vm.cards = data.cards;\n                  \n               //  });\n                \n\n\n\n\n\n            }\n\n            vm.try_charge_default_card = function(){\n                alert(\"GO TIME\", vm.membership_now.cards[1].stripe_id);\n                var invoice_id = 55;\n                var send_me = {\n                    invoice_id: 55,\n                    card_id: vm.membership_now.cards[1].stripe_id,\n                    last4: vm.membership_now.cards[1].last4\n                }\n                PaymentService.CreatePaymentIntent(send_me).then(function (data) {\n                    console.log(\"DATA IS : \", data);\n\n                });\n\n            }\n\n            $scope.save_added_card = function(){\n\n                 var update_mandate_details = {\n                       user_id: vm.user.id,\n                       club_id: vm.membership_now.club_id,\n                       membership_id: $stateParams.membership_id\n                }\n\n                vm.show_add_card = false;\n\n            }\n\n\n             $scope.get_icon = function(file){\n\n                var ft;\n                if(file && file.name){\n                     ft = file.name;\n                } else {\n                    ft = file;\n                }\n\n                if(!ft){\n                    ft = \"other.other\";\n                }\n\n\n                ft = ft.split('.').pop();\n                var icon_name = \"\";\n\n                // //console.log(\"FILE:\", ft);\n                // //console.log(\"index : \", ft.indexOf(\"pdf\"));\n                switch(true){\n                    case (ft.indexOf(\"pdf\") > -1):\n                        icon_name = \"pdf.png\";\n                    break;\n                    case (ft.indexOf(\"doc\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"docx\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"xls\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"xlsx\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"ppt\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"pptx\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"jpg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"jpeg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"png\") > -1):\n                        icon_name = \"png.png\";\n                    break;\n                    case (ft.indexOf(\"gif\") > -1):\n                        icon_name = \"gif.png\";\n                    break;\n                    case (ft.indexOf(\"zip\") > -1):\n                        icon_name = \"zip.png\";\n                    break;\n                    case (ft.indexOf(\"avi\") > -1):\n                        icon_name = \"avi.png\";\n                    break;\n                    case (ft.indexOf(\"mp4\") > -1):\n                        icon_name = \"mp4.png\";\n                    break;\n                    default:\n                        icon_name = \"file.png\";\n                    break;\n                }\n\n                // //console.log(\"FILE:\", icon_name);\n\n                return \"images/file_icons/\"+icon_name;\n            }\n\n\n\n\n\n\n        $scope.downloadClubDocument = function(doc) {\n            var data = $.param({\n                id: doc\n            });\n            if(!doc){\n                alert(\"Sorry - it looks like this flight organisation hasn't yet uploaded their document - please contact them to upload it to ToAviate.\");\n                return false;\n            }\n            var ddd = doc.replace(/^.*[\\\\\\/]/, '');\n\n            $http.defaults.headers.common['Api-Key'] = \"eW91a25vd25vdGhpbmdqb25zbm93\";\n\n            $http.get('api/v1/term_documents/show_file/'+ddd, {\n                    responseType: 'arraybuffer'\n                })\n                .success(function(data, status, headers) {\n                    var zipName = processArrayBufferToBlob(data, headers);\n\n                    //Delete file from temp folder in server - file needs to remain open until blob is created\n                    //deleteFileFromServerTemp(zipName);\n                }).error(function(data, status) {\n                    alert(\"This file is not available at the moment - please contact the flight organisation.\");\n                })\n        };\n\n        function titlepath(path,name){\n\n        //In this path defined as your pdf url and name (your pdf name)\n            var prntWin = window.open();\n            prntWin.document.write(\"<html><head><title>\"+name+\"</title></head><body>\"\n                + '<embed width=\"100%\" height=\"100%\" name=\"plugin\" src=\"'+ path+ '\" '\n                + 'type=\"application/pdf\" internalinstanceid=\"21\"></body></html>');\n            prntWin.document.close();\n        }\n\n        function processArrayBufferToBlob(data, headers) {\n            var octetStreamMime = 'application/octet-stream';\n            var success = false;\n\n            // Get the headers\n            headers = headers();\n            //var ttt = title.toLowerCase().replace(/\\W/g, '_');\n            // Get the filename from the x-filename header or default to \"download.bin\"\n            var filename = headers['x-filename'] || 'download.zip';\n\n            // Determine the content type from the header or default to \"application/octet-stream\"\n            var contentType = headers['content-type'] || octetStreamMime;\n\n            try {\n                // Try using msSaveBlob if supported\n                var blob = new Blob([data], \n                    //type: contentType\n                    {type: 'application/pdf'}\n                //}\n                );\n\n\n                var fileURL = URL.createObjectURL(blob);\n                //window.open(fileURL);\n                titlepath(fileURL, \"Secure Documents\");\n\n                // if (navigator.msSaveBlob)\n                //     navigator.msSaveBlob(blob, filename);\n                // else {\n                //     // Try using other saveBlob implementations, if available\n                //     var saveBlob = navigator.webkitSaveBlob || navigator.mozSaveBlob || navigator.saveBlob;\n                //     if (saveBlob === undefined) throw \"Not supported\";\n                //     saveBlob(blob, filename);\n                // }\n                success = true;\n            } catch (ex) {\n                $log.info(\"saveBlob method failed with the following exception:\");\n                $log.info(ex);\n            }\n\n            if (!success) {\n                // Get the blob url creator\n                var urlCreator = window.URL || window.webkitURL || window.mozURL || window.msURL;\n                if (urlCreator) {\n                    // Try to use a download link\n                    var link = document.createElement('a');\n                    if ('download' in link) {\n                        // Try to simulate a click\n                        try {\n                            // Prepare a blob URL\n                            var blob = new Blob([data], {\n                                type: contentType\n                            });\n                            var url = urlCreator.createObjectURL(blob);\n                            link.setAttribute('href', url);\n\n                            // Set the download attribute (Supported in Chrome 14+ / Firefox 20+)\n                            link.setAttribute(\"download\", filename);\n\n                            // Simulate clicking the download link\n                            var event = document.createEvent('MouseEvents');\n                            event.initMouseEvent('click', true, true, window, 1, 0, 0, 0, 0, false, false, false, false, 0, null);\n                            link.dispatchEvent(event);\n                            success = true;\n\n                        } catch (ex) {\n                            $log.info(\"Download link method with simulated click failed with the following exception:\");\n                            $log.info(ex);\n                        }\n                    }\n\n                    if (!success) {\n                        // Fallback to window.location method\n                        try {\n                            // Prepare a blob URL\n                            // Use application/octet-stream when using window.location to force download\n                            var blob = new Blob([data], {\n                                type: octetStreamMime\n                            });\n                            var url = urlCreator.createObjectURL(blob);\n                            window.location = url;\n                            success = true;\n                        } catch (ex) {\n                            $log.info(\"Download link method with window.location failed with the following exception:\");\n                            $log.info(ex);\n                        }\n                    }\n                }\n            }\n\n            if (!success) {\n                // Fallback to window.open method\n                $log.info(\"No methods worked for saving the arraybuffer, using last resort window.open\");\n                window.open(httpPath, '_blank', '');\n            }\n            return filename;\n        };\n\n\n\n\n\n\n\n\n\n\n            $scope.request = function(){\n\n                //basic checks...\n          \n\n\n              if(vm.club_tnc && vm.card_tnc && vm.club.id && vm.membership.id){\n                alert(\"THANK YOU\");\n\n                var obj = {\n                    user_id: vm.user.id,\n                    club_id: vm.club.id,\n                    membership_id: vm.membership.id,\n                    requested_by: \"user\",\n                    paid: 0\n                    //,card_id: vm.payment_card.id\n                };\n\n                MembershipService.SendRequest(obj)\n                .then(function (data) {\n                    // //console.log(\"SENT HERE\", data);\n                    if(data.success){\n                        //$state.go('dashboard.my_account.memberships');\n\n                        // //console.log(\"DATA\", data);\n                        // //console.log(data.mandate.link);\n                        $cookies.put('gcl_sess', data.mandate.session);\n\n\n                        window.location = data.mandate.link;\n\n\n                    }\n\n                });\n\n\n\n\n              } else {\n                alert(\"Please fill all fields...\");\n              }\n\n            }\n\n\n\n\n\n        \n        \n\n\n    }\n app.controller('ManageMyMembershipsDirectDebitController', ManageMyMembershipsDirectDebitController);\n\n    ManageMyMembershipsDirectDebitController.$inject = ['UserService', 'MemberService', 'MembershipService', 'PaymentService', 'InstructorService', 'HolidayService', 'ClubService', '$rootScope', '$location', '$scope', '$state', '$stateParams', '$uibModal', '$log', '$window', '$compile', '$timeout', 'uiCalendarConfig', 'LicenceService', 'NokService', 'GoCardService', '$cookies'];\n    function ManageMyMembershipsDirectDebitController(UserService, MemberService, MembershipService, PaymentService, InstructorService, HolidayService, ClubService, $rootScope, $location, $scope, $state, $stateParams, $uibModal, $log, $window, $compile, $timeout, uiCalendarConfig, LicenceService, NokService, GoCardService, $cookies) {\n        \n        var vm = this;        \n\n        vm.user = $rootScope.globals.currentUser;\n        vm.user_id = vm.user.id;        \n      \n        vm.success = true;\n  \n\n        switch($state.current.data.action){\n          \n            case \"direct_debit\":\n\n                var mandate = $location.search().redirect_flow_id;\n                ////console.log(\"DIRECT DEBIT SORTING 444\", mandate);\n                //RE0002NPM29SQ1F4B57R8E3AT4YJAPZG\n                var session = $cookies.get('gcl_sess');\n\n                var object = {\n                    mandate: mandate,\n                    session: session,\n                    member_accepted: false\n\n                };\n\n                if($cookies.get(\"gcl_member_accepted\")){\n                    object[\"member_accepted\"] = true;\n                }\n\n\n\n                GoCardService.SetupMandate(object).then(function (data) {\n                    if(data.success){\n                        //vm.requests = data.requests;\n\n                        vm.club = data.club;\n                        // //console.log(\"memberships\", vm.memberships);\n                        vm.success = true;\n\n                    } else {\n                        // //console.log(\"WOOOPSIES...\");\n                        vm.success = false;\n                        //this should be very very rare...\n                    }\n\n                });\n                \n\n\n\n               \n\n\n            break;\n            default:\n                //console.log(\"none of the above... redirect somewhere?\");\n            break;\n        }  \n\n\n\n\n\n        \n        \n        \n\n\n    }\n app.controller('ManageNokController', ManageNokController);\n\n    ManageNokController.$inject = ['UserService', 'MemberService', 'InstructorService', 'MembershipService', 'HolidayService', '$rootScope', '$location', '$scope', '$state', '$stateParams', '$uibModal', '$log', '$window', '$compile', '$timeout', 'uiCalendarConfig', 'LicenceService', 'NokService'];\n    function ManageNokController(UserService, MemberService, InstructorService, MembershipService, HolidayService, $rootScope, $location, $scope, $state, $stateParams, $uibModal, $log, $window, $compile, $timeout, uiCalendarConfig, LicenceService, NokService) {\n        \n        var vm = this;        \n\n        vm.user = $rootScope.globals.currentUser;\n        vm.user_id = vm.user.id;        \n        vm.noks = [];\n\n        \n    \n\n\n        switch($state.current.data.action){\n            case \"add\":\n\n                    //vm.selected_component = vm.components[0];\n                    //vm.selected_component = \n                    \n\n                    // //console.log(\"AA\", vm.selected_component);\n\n            \n\n            break;\n            case \"edit\":\n\n            // //console.log(\"EDIT ONE\");\n             //console.log(\"PARAMS: \", $stateParams);\n\n             NokService.GetById($stateParams.nok_id)\n                .then(function (data) {\n                    if(data.success){\n                        vm.nok = data.nok;\n                        //console.log(\"NOK\", vm.nok);\n\n                    } else {\n                        //console.log(\"WOOOPSIES...\");\n                        //this should be very very rare...\n                    }\n\n                });\n\n\n\n            break;\n            case \"list\":\n\n                //console.log(\"LIST ALL\");\n\n                 //1 get the user's nok...\n                 //list stuff\n\n                NokService.GetByUserId(vm.user.id)\n                .then(function (data) {\n                    //console.log(data);\n                    if(data.success){\n                        vm.noks = data.noks;\n\n                    } else {\n                        //console.log(\"WOOOPSIES...\");\n                        //this should be very very rare...\n                    }\n\n                });\n\n\n            break;\n            default:\n                //console.log(\"none of the above... redirect somewhere?\");\n            break;\n        }  \n\n\n\n            $scope.popup = [];\n\n            $scope.open = function(id, $event) {\n                //console.log(\"THIS\", id);\n                //this comment would allow the event not to be affect by clicking it again... not sure this is a good idea\n                if($scope.popup[id] && $scope.popup[id].opened == true){\n                    $event.preventDefault();\n                    $event.stopPropagation();\n                } else {\n                    $scope.popup[id] = {opened: true};\n                }\n            };\n\n            $scope.formats = ['dd/MM/yyyy', 'yyyy/MM/dd', 'dd.MM.yyyy', 'shortDate'];\n            $scope.format = $scope.formats[0];\n\n            $scope.datePickerOptions = {\n                                        format: 'dd/MM/yyyy',\n                                        showWeeks: false\n                                    };\n\n           \n\n      \n\n          \n\n\n\n            $scope.delete_nok = function(id){\n\n              \n                var a = prompt(\"Are you sure you wish to delete this nok? \\n\\n This change is irreversible! To confirm please type YES in the box below.\");\n                if(a == \"YES\"){\n\n                    //console.log(\"WE DELETE IT\");\n\n                    NokService.Delete(vm.user.id, id)\n                        .then(function (data) {\n                            //console.log(data);\n                            if(data.success){\n                                //console.log(\"HUZZAH\", data);\n                                //then we need to remove this from the list of files...\n                                \n                                //refresh?\n                                $state.go('dashboard.my_account.nok', {}, { reload: true });\n\n                            } else {\n\n                                alert(\"Something went terribly wrong... \\n\\n \"+data.message);\n\n                            }\n\n                        });\n\n\n                } else {\n                    //console.log(\"ignore123\");\n                }\n\n\n            }\n\n\n\n\n            $scope.save_nok = function(isValid){\n\n                vm.nok.user_id = vm.user.id;\n\n                if(vm.nok.id){\n                    \n                    //then its an udpate\n                    //merge the images left?\n\n                    NokService.Update(vm.nok)\n                        .then(function (data) {\n                            //console.log(data);\n                            if(data.success){\n                                //console.log(\"HUZZAH\", vm.nok);\n                                //console.log(\"HUZZAH\", data);\n                                //then we need to remove this from the list of files...\n                                \n                                \n                                //move somewhere?\n                                $state.go('dashboard.my_account.nok', {}, { reload: true });\n\n\n                            } else {\n\n                                alert(\"Something went terribly wrong... \\n\\n \"+data.message);\n\n                            }\n\n                        });\n\n                } else {\n\n\n                \n\n                    NokService.Create(vm.nok)\n                        .then(function (data) {\n                            //console.log(data);\n                            if(data.success){\n                                //console.log(\"HUZZAH\", vm.nok);\n                                //console.log(\"HUZZAH\", data);\n                                //then we need to remove this from the list of files...\n                                \n                                \n                                //move somewhere?\n                               // $state.reload();\n                                $state.go('dashboard.my_account.nok', {}, { reload: true });\n\n\n                            } else {\n\n                                alert(\"Something went terribly wrong... \\n\\n \"+data.message);\n\n                            }\n\n                        });\n\n\n                }\n\n\n\n            };\n\n\n\n        \n        \n\n\n    }\n app.controller('ManagePaymentsAddController', ManagePaymentsAddController);\n\n    ManagePaymentsAddController.$inject = ['UserService', '$sce', 'MemberService', 'InstructorService', 'MembershipService', 'HolidayService', '$rootScope', '$location', '$scope', '$state', '$stateParams', '$uibModal', '$log', '$window', '$compile', '$timeout', 'uiCalendarConfig', 'PaymentService', 'PoidService'];\n    function ManagePaymentsAddController(UserService, $sce, MemberService, InstructorService, MembershipService, HolidayService, $rootScope, $location, $scope, $state, $stateParams, $uibModal, $log, $window, $compile, $timeout, uiCalendarConfig, PaymentService, PoidService) {\n        \n        var vm = this;        \n\n        vm.poid_images = [];\n        vm.poid = {\n                images: []\n        };\n\n\n        vm.user = $rootScope.globals.currentUser;\n        vm.user_id = vm.user.id;\n\n        vm.customer_token = \"\";\n        $scope.iframe_url = \"\";\n\n\n        // Create a token when the form is submitted.\n        \n        $scope.get_addresses = function(){\n\n            //  trial key\n            //  auth: api-key: BP-8KOdw8ka3F2eDU-Zz-g5865   \n            //  https://api.getAddress.io/v2/uk/{postcode}\n            // PaymentService.getAddress()\n\n            PaymentService.GetAddresses(vm.postcode)\n                .then(function (data) {\n                    if(data.success){\n\n                        //console.log(\"addresses: \"+data.addresses);\n                        vm.addresses = data.addresses;\n                        //fill the drop down menu\n\n                    } else {\n                        //console.log(\"WOOOPSIES...\");\n                        //this should be very very rare...\n\n                    }\n                });\n\n        }\n\n\n        function prefill_details(){\n\n            // UserService\n\n            document.getElementById('name').value = \"\";\n            document.getElementById('address-line1').value = \"\";\n            document.getElementById('address-line2').value = \"\";\n            document.getElementById('address-city').value = \"\";\n            document.getElementById('address-postcode').value = \"\";\n            document.getElementById('address-country').value = \"\";\n        }\n\n\n        $scope.add_card = function () {\n            \n\n            createToken();\n\n\n            // //console.log(\"CLICK\");   \n\n            //     var $form = $('#payment-form');\n            //     $form.submit(function(event) {\n            //     // Disable the submit button to prevent repeated clicks:\n            //     $form.find('.submit').prop('disabled', true);\n\n            //     // Request a token from Stripe:\n            //     //stripe.card.createToken($form, stripeResponseHandler);\n            //     //pk_test_Ers4ZfdIMZ59ac4wKy6FDAH2\n\n\n            //     stripe.createToken($form).then(function(result) {\n            //       // Handle result.error or result.token\n            //       //console.log(result);\n            //     });\n\n            //     // Prevent the form from being submitted:\n            //     return false;\n            //   });\n\n\n        };\n\n\n        $scope.delete_card = function(id){\n            //console.log(\"ID\", id);\n            var b = prompt(\"Please write YES to confirm you wish to delete the card\");\n            if(b == \"YES\"){\n                ////console.log(\"yes\");\n                PaymentService.Delete(id, vm.user.id)\n                .then(function (data) {\n\n                        ////console.log(\"delete: \", data);\n                        //fill the drop down menu\n                        PaymentService.GetByUserId(vm.user.id)\n                            .then(function (data) {\n                                //console.log(data);\n                                if(data.success){\n                                    vm.cards = data.cards;\n                                    ////console.log(\"CARDS\", vm.cards);\n                                } else {\n                                   // //console.log(\"WOOOPSIES...\");\n                                    //this should be very very rare...\n                                }\n                            });\n                  \n                });\n            }\n            \n        }\n\n\n\n\n\n\n                    //vm.selected_component = vm.components[0];\n                    //vm.selected_component = \n        function get_paybase_token(){\n\n\n                \n                    // //console.log(\"AA\", vm.selected_component);\n                PaymentService.GetUserForPayment(vm.user.id)\n                .then(function (data) {\n                    //console.log(data);\n                    if(data.success){\n                        //console.log(\"CAT DATA\", data);\n                        vm.cards = data.cards;\n                        vm.customer_token = data.token;\n\n                        $scope.iframe_url = $sce.trustAsResourceUrl(\"https://hosted.sandbox.paybase.io/card?t=\"+vm.customer_token);\n                        var i = 0;\n\n                        // alert(\"URL ADDED\");\n                        // $scope.$apply();\n\n                        //console.log(\"URL\", vm.iframe_url);\n\n                    } else {\n                        //console.log(\"WOOOPSIES...\");\n                        //this should be very very rare...\n                    }\n\n                });\n\n            }\n\n\n            //paybase integration\n\n              var errors = document.querySelector('.errors');\n              var success = document.querySelector('.success');\n\n              window.addEventListener('message', function(ev) {\n                var data = ev.data;\n                //console.log(\"received data\", data);\n\n                //angular.element(paybase_response(data));\n                switch (data.type) {\n                  case 'success': {\n                    ////console.log(\"received data\", data);\n                    //success.innerText = data.id;\n\n                    //add card into our own system....\n\n\n                    //the response is no longer the full card object that I require - so I will send the card_id and the customer_id to the backend for it to do its magic\n                    //and when it has querried Paybase, and added the card on our system, THEN we can throw them back onto the ALL CARDS page.\n\n                    PaymentService.Create2(vm.user.id, data.id)\n                    .then(function (data2) {\n\n                        if(data2.success){\n\n                            //card was successfully added to the system... Time to boot them back to the previous page...\n\n                            $state.go('dashboard.my_account.payment_methods', {}, { reload: true });\n\n\n\n\n\n                        } else {\n                            //console.log(\"There was a ToAviate error in adding your card into our system. Please try again later.\");\n                        }\n                           \n                      \n                    });\n\n\n\n\n\n                  }\n                  break;\n                  case 'error': {\n                    //errors.innerText = data.message;  \n                    //alert(data.message);\n\n\n                    // if(data.code == \"5002\"){\n                    //     alert(\"Please check your card details are correct and match your billing address.\");\n                    //     $scope.iframe_url = $sce.trustAsResourceUrl(\"https://hosted.sandbox.paybase.io/card?t=\"+vm.customer_token);\n                    // } else {\n                    // }\n\n\n                    switch(data.code){\n\n                        case \"5002\":\n                            //card declined / incorrect details\n                            alert(\"Your card was declined, please verify your details or contact your card provider. Should this problem persist, please contact: info@toaviate.com\");\n\n                        break;\n                        case \"4060\":\n                            //card used to exist....?\n                            alert(\"It appears that you are adding a card that has already been added to your account\");\n\n                        break;\n                        default:\n                            alert(\"Please check your card details are correct and match your billing address.\");\n\n                        break;\n\n\n\n                    }\n\n\n\n\n\n\n\n\n                    get_paybase_token();\n\n\n                    //location.reload();\n                  }\n                  break;\n                        }\n            });\n\n\n                            \n                \n          \n\n\n            get_paybase_token();\n\n\n    }\n app.controller('ManagePaymentsController', ManagePaymentsController);\n\n    ManagePaymentsController.$inject = ['UserService', '$sce', 'MemberService', 'InstructorService', 'MembershipService', 'HolidayService', '$rootScope', '$location', '$scope', '$state', '$stateParams', '$uibModal', '$log', '$window', '$compile', '$timeout', 'uiCalendarConfig', 'PaymentService', 'PoidService'];\n    function ManagePaymentsController(UserService, $sce, MemberService, InstructorService, MembershipService, HolidayService, $rootScope, $location, $scope, $state, $stateParams, $uibModal, $log, $window, $compile, $timeout, uiCalendarConfig, PaymentService, PoidService) {\n        \n        var vm = this;        \n\n        vm.poid_images = [];\n        vm.poid = {\n                images: []\n        };\n\n\n        vm.user = $rootScope.globals.currentUser;\n        vm.user_id = vm.user.id;\n\n        vm.customer_token = \"\";\n        $scope.iframe_url = \"\";\n\n        vm.change_address = false;\n\n\n        vm.billing_address = {\n            flatNumber: \"\",\n            houseNameNumber: \"\",\n            townCity: \"\",\n            region: \"\",\n            postalCode: \"\",\n            countryISO: \"\"\n        }\n\n\n\n\n\n        // var stripe = Stripe('pk_test_Ers4ZfdIMZ59ac4wKy6FDAH2');\n        // var elements = stripe.elements();\n\n        // var card_options = {\n        //       hidePostalCode: true,\n        //       style: {\n        //         base: {\n        //           iconColor: '#666EE8',\n        //           color: '#31325F',\n        //           lineHeight: '40px',\n        //           fontWeight: 300,\n        //           fontFamily: 'Helvetica Neue',\n        //           fontSize: '15px',\n        //           '::placeholder': {\n        //             color: '#CFD7E0',\n        //           },\n        //         },\n        //       }\n        //     };\n\n        // var card = elements.create('card', card_options);\n        // var form;\n\n\n        // var timeout;\n        // var run = false;\n        // var run2 = false;\n\n\n        // function setupStripe(){\n        //     clearTimeout(timeout);\n        //     if(run == false){\n        //         run = true;\n\n        //         card.mount('#card-element');\n            \n        //         form = document.getElementById('payment-form');\n        //         form.addEventListener('submit', function(e) {\n        //           e.preventDefault();\n        //           createToken();\n        //         });\n        //     } \n        // }   \n\n\n        // $scope.$on('$viewContentLoaded', function(){\n        //         clearTimeout(timeout);\n        //         if(run2 == false){\n        //             run2 = true;\n        //             timeout = setTimeout(function(){ setupStripe(); }, 1500); \n        //         }\n        // });\n\n     \n\n        // function stripeTokenHandler(token) {\n        //   // Insert the token ID into the form so it gets submitted to the server\n        //   var form = document.getElementById('payment-form');\n        //   var hiddenInput = document.createElement('input');\n        //   hiddenInput.setAttribute('type', 'hidden');\n        //   hiddenInput.setAttribute('name', 'stripeToken');\n        //   hiddenInput.setAttribute('value', token.id);\n        //   form.appendChild(hiddenInput);\n\n        //   // Submit the form\n        //   //console.log(\"TOKEN\", token);\n        //   //form.submit();\n        // }\n\n        // function createToken() {\n        //   //console.log(\"HELLO CREATE TOKEN? 1\");\n        //    var options = {\n        //     name: document.getElementById('name').value,\n        //      address_line1: document.getElementById('address-line1').value,\n        //     address_line2: document.getElementById('address-line2').value,\n        //     address_city: document.getElementById('address-city').value,\n        //     address_zip: document.getElementById('address-postcode').value,\n        //     address_country: document.getElementById('address-country').value,\n        //   };\n\n        //   stripe.createToken(card, options).then(function(result) {\n        //     if (result.error) {\n        //       // Inform the user if there was an error\n        //       var errorElement = document.getElementById('card-errors');\n        //       errorElement.textContent = result.error.message;\n        //     } else {\n        //       // Send the token to your server\n        //       //stripeTokenHandler(result.token);\n        //       ////console.log(\"RESULT\", result);\n\n        //       if(result.token.id){\n        //       ////console.log(\"STUFF\", result.token.id);\n\n        //         //prepare a basic object...\n        //         var obj = {\n        //             user_id: vm.user.id,\n        //             brand: result.token.card.brand,\n        //             last4: result.token.card.last4,\n        //             hash: result.token.card.id,\n        //             token: result.token.id,\n        //             exp_month: result.token.card.exp_month,\n        //             exp_year: result.token.card.exp_year,\n        //             funding: result.token.card.funding,\n        //             name: result.token.card.name,\n        //             address_postcode: result.token.card.address_zip,\n        //             client_ip: result.token.client_ip\n        //         };\n\n\n        //         PaymentService.Create(obj)\n        //         .then(function (data) {\n        //             if(data.success){\n\n        //                 //console.log(\"CARD: \"+data);\n        //                 //fill the drop down menu\n        //                 $state.go('dashboard.my_account.payment_methods', {}, { reload: true });\n\n        //             } else {\n        //                 //console.log(\"WOOOPSIES...\", data);\n        //                 //this should be very very rare...\n\n        //             }\n        //         });\n\n\n\n        //       }\n\n        //     }\n        //   });\n        // };\n\n        vm.change_address_for = \"\";\n\n\n        $scope.change_address = function(card_id){\n\n            vm.change_address_for = card_id;\n\n            PaymentService.GetCardDetails(card_id)\n                .then(function (data) {\n                    if(data){\n\n                        //console.log(\"addresses: \"+data.billingAddress);\n                        vm.billing_address = data.billingAddress;\n                        //fill the drop down menu\n                        vm.change_address = true;\n\n                    } else {\n                        //console.log(\"WOOOPSIES...\");\n                        //this should be very very rare...\n\n                    }\n                });\n\n            // const card_deets = await response.json();\n\n\n\n        }\n\n\n        $scope.save_address = function(){\n            //vm.change_address_for\n\n            //vm.billing_address\n\n\n            //update_address here to PHP which will do the rest :-D \n             PaymentService.UpdateCard(vm.change_address_for, vm.billing_address)\n                .then(function (data) {\n                    if(data){\n\n                        //console.log(\"addresses: \"+data);\n                        vm.billing_address = {\n                            flatNumber: \"\",\n                            houseNameNumber: \"\",\n                            townCity: \"\",\n                            region: \"\",\n                            postalCode: \"\",\n                            countryISO: \"\"\n                        }\n\n                        alert(\"address saved\");\n\n                        //fill the drop down menu\n                        vm.change_address = false;\n\n                    } else {\n                        //console.log(\"WOOOPSIES...\");\n                        //this should be very very rare...\n\n                    }\n                });\n\n\n        }\n\n\n        $scope.decline_change = function(){\n            vm.change_address = false;\n        }\n\n\n\n\n        // Create a token when the form is submitted.\n        \n        $scope.get_addresses = function(){\n\n            //  trial key\n            //  auth: api-key: BP-8KOdw8ka3F2eDU-Zz-g5865   \n            //  https://api.getAddress.io/v2/uk/{postcode}\n            // PaymentService.getAddress()\n\n            // PaymentService.GetAddresses(vm.postcode)\n            //     .then(function (data) {\n            //         if(data.success){\n\n            //             //console.log(\"addresses: \"+data.addresses);\n            //             vm.addresses = data.addresses;\n            //             //fill the drop down menu\n\n            //         } else {\n            //             //console.log(\"WOOOPSIES...\");\n            //             //this should be very very rare...\n\n            //         }\n            //     });GetCardDetails\n\n        }\n\n\n        function prefill_details(){\n\n            // UserService\n\n            document.getElementById('name').value = \"\";\n            document.getElementById('address-line1').value = \"\";\n            document.getElementById('address-line2').value = \"\";\n            document.getElementById('address-city').value = \"\";\n            document.getElementById('address-postcode').value = \"\";\n            document.getElementById('address-country').value = \"\";\n        }\n\n\n        $scope.changePrimary = function(card_id){\n\n\n            PaymentService.ChangePrimary(vm.user.id, card_id)\n                            .then(function (data) {\n                                //console.log(data);\n                                if(data.success){            \n\n                                    alert(\"Changed primary card!\");\n                                    \n                                    //vm.cards = data.cards;\n                                    ////console.log(\"CARDS\", vm.cards);\n                                } else {\n                                   // //console.log(\"WOOOPSIES...\");\n                                    //this should be very very rare...\n                                }\n                            });\n\n\n\n\n        }\n\n\n        $scope.add_card = function () {\n            \n\n            createToken();\n\n\n            // //console.log(\"CLICK\");   \n\n            //     var $form = $('#payment-form');\n            //     $form.submit(function(event) {\n            //     // Disable the submit button to prevent repeated clicks:\n            //     $form.find('.submit').prop('disabled', true);\n\n            //     // Request a token from Stripe:\n            //     //stripe.card.createToken($form, stripeResponseHandler);\n            //     //pk_test_Ers4ZfdIMZ59ac4wKy6FDAH2\n\n\n            //     stripe.createToken($form).then(function(result) {\n            //       // Handle result.error or result.token\n            //       //console.log(result);\n            //     });\n\n            //     // Prevent the form from being submitted:\n            //     return false;\n            //   });\n\n\n        };\n\n\n        $scope.delete_card = function(id){\n            //console.log(\"ID\", id);\n            var b = prompt(\"Please write YES to confirm you wish to delete the card\");\n            if(b == \"YES\"){\n                ////console.log(\"yes\");\n                PaymentService.Delete(id, vm.user.id)\n                .then(function (data) {\n\n                        ////console.log(\"delete: \", data);\n                        //fill the drop down menu\n                        PaymentService.GetByUserId(vm.user.id)\n                            .then(function (data) {\n                                //console.log(data);\n                                if(data.success){\n                                    vm.cards = data.cards;\n                                    ////console.log(\"CARDS\", vm.cards);\n                                } else {\n                                   // //console.log(\"WOOOPSIES...\");\n                                    //this should be very very rare...\n                                }\n                            });\n                  \n                });\n            }\n            \n        }\n\n      \n\n\n                PaymentService.GetByUserId(vm.user.id)\n                .then(function (data) {\n                    //console.log(data);\n                    if(data.success){\n                        vm.cards = data.cards;\n                        //console.log(\"CARDS\", vm.cards);\n\n                    } else {\n                        //console.log(\"WOOOPSIES...\");\n                        //this should be very very rare...\n                    }\n\n                });\n\n        \n\n\n    }\n app.controller('ManagePoidController', ManagePoidController);\n\n    ManagePoidController.$inject = ['UserService', 'MemberService', 'InstructorService', 'MembershipService', 'HolidayService', '$rootScope', '$location', '$scope', '$state', '$stateParams', '$uibModal', '$log', '$window', '$compile', '$timeout', 'uiCalendarConfig', 'LicenceService', 'PoidService', 'AuthenticationService'];\n    function ManagePoidController(UserService, MemberService, InstructorService, MembershipService, HolidayService, $rootScope, $location, $scope, $state, $stateParams, $uibModal, $log, $window, $compile, $timeout, uiCalendarConfig, LicenceService, PoidService, AuthenticationService) {\n        \n        var vm = this;        \n\n        vm.poid_images = [];\n        vm.poid = {\n                images: []\n        };\n\n\n        vm.user = $rootScope.globals.currentUser;\n        vm.user_id = vm.user.id;\n\n        //THIS MAY BE USED LATER WHEN WE SET REAL ID TYPES\n        // PoidService.GetPoidTypes()\n        //         .then(function (data) {\n        //             vm.poid_types = data;\n        //             //console.log(\"poid_types: \", vm.poid_types);\n        //         });\n\n    \n\n\n        switch($state.current.data.action){\n            case \"add\":\n\n                    //vm.selected_component = vm.components[0];\n                    //vm.selected_component = \n                    \n\n                    // //console.log(\"AA\", vm.selected_component);\n\n            \n\n            break;\n            case \"edit\":\n\n            // //console.log(\"EDIT ONE\");\n            // //console.log(\"PARAMS: \", $stateParams);\n\n             PoidService.GetById($stateParams.poid_id, 1, 0)\n                .then(function (data) {\n                    if(data.success){\n                        vm.poid = data.poid;\n                        vm.poid.expiry_date = new Date(vm.poid.expiry_date);\n\n                        \n                    } else {\n                        //console.log(\"WOOOPSIES...\");\n                        //this should be very very rare...\n                    }\n\n                });\n\n\n\n            break;\n            case \"list\":\n\n                //console.log(\"LIST ALL\");\n\n                 //1 get the user's poid...\n                 //list stuff\n\n                PoidService.GetByUserId(vm.user.id)\n                .then(function (data) {\n                    //console.log(data);\n                    if(data.success){\n                        vm.user_poids = data.poids;\n\n                    } else {\n                        //console.log(\"WOOOPSIES...\");\n                        //this should be very very rare...\n                    }\n\n                });\n\n\n            break;\n            default:\n                //console.log(\"none of the above... redirect somewhere?\");\n            break;\n        }  \n\n\n\n            // $scope.add_component = function(){\n\n            //     //remove from first array\n            //     vm.components = $.grep(vm.components, function(e){ \n            //         return e.id != vm.selected_component.id; \n            //     });\n\n            //     vm.poid.components.push(vm.selected_component);\n\n            //     //clear selected\n            //     delete vm.selected_component;\n                \n            //     //clean the array to show what we want to show :)\n            //     //delete $scope.formData.license.add_to[bit_type];\n\n            // }\n\n            // $scope.remove_component = function(index){\n\n            //     //add to dropdown\n            //     vm.components.push(vm.poid.components[index]);\n            //     vm.poid.components.splice(index,1)\n\n            //     //$scope.formData.license[bit_type] = $scope.formData.license[bit_type].filter(Boolean);\n\n            //     //  //console.log($scope.formData.license[bit_type]);\n            //     //  $scope.formData.license[bit_type].push($scope.formData.license.add_to[bit_type]);\n            // }\n\n            //default add the first component required...\n            \n\n\n\n/*\n\nOLD VERSION FOR LEGACY PURPOSES\n\n  $scope.add_element = function(bit_type){\n\n                //remove from first array\n                $scope[bit_type][bit_type] = $.grep($scope[bit_type][bit_type], function(e){ \n                    return e.id != $scope.formData.license.add_to[bit_type].id; \n                });\n\n                if(bit_type == \"differences\"){\n                    $scope.formData.license.add_to[bit_type].day = true;\n                    $scope.formData.license.add_to[bit_type].vfr = true;\n                }\n                //console.log($scope.formData.license.add_to[bit_type]);\n\n                $scope.formData.license[bit_type].push($scope.formData.license.add_to[bit_type]);\n                \n                //clean the array to show what we want to show :)\n                delete $scope.formData.license.add_to[bit_type];\n\n            }\n\n\n            $scope.remove_element = function(bit_type, index){\n\n                //add to dropdown\n                $scope[bit_type][bit_type].push($scope.formData.license[bit_type][index]);\n            \n                $scope.formData.license[bit_type].splice(index,1)\n\n                $scope.formData.license[bit_type] = $scope.formData.license[bit_type].filter(Boolean);\n                //console.log($scope.formData.license[bit_type]);\n                //$scope.formData.license[bit_type].push($scope.formData.license.add_to[bit_type]);\n            }\n\n\n*/\n\n\n            //nice looking date pickers\n\n\n            $scope.popup = [];\n\n            $scope.open = function(id, $event) {\n                //console.log(\"THIS\", id);\n                //this comment would allow the event not to be affect by clicking it again... not sure this is a good idea\n                if($scope.popup[id] && $scope.popup[id].opened == true){\n                    $event.preventDefault();\n                    $event.stopPropagation();\n                } else {\n                    $scope.popup[id] = {opened: true};\n                }\n            };\n\n            $scope.formats = ['dd/MM/yyyy', 'yyyy/MM/dd', 'dd.MM.yyyy', 'shortDate'];\n            $scope.format = $scope.formats[0];\n\n            $scope.datePickerOptions = {\n                                        format: 'dd/MM/yyyy',\n                                        showWeeks: false\n                                    };\n\n           \n\n           $scope.remove_real_file = function(file){\n\n                //remove_file\n\n                vm.poid.images = $.grep(vm.poid.images, function(e){ \n                        return e.id != file.id; \n                    });\n\n                //no need to actually remove the file as it will be archived accordingly on the backend whilst it is missing! :)\n                \n\n          }\n\n\n          \n          $scope.remove_file = function(file, current_files){\n\n            //remove_file\n            var j = JSON.parse(file.file_return);\n            //console.log(\"REMOVE: \", j);\n            //console.log(\"REMOVE: \", j.saved_url);\n\n            //to delete the temp file created: j.saved_url\n            //tmp_rm.php POST tmp = filename\n            \n            PoidService.DeleteTmp(j.saved_url)\n                .then(function (data) {\n                    //console.log(data);\n                    if(data.success){\n                        //console.log(\"HUZZAH\", current_files);\n                        //then we need to remove this from the list of files...\n                        //clear files\n                        vm.poid_images = [];\n                        //and re-process available files\n                        $scope.processFiles(current_files);\n\n                    } else {\n                        //console.log(\"WOOOPSIES...\");\n                        //this should be very very rare...\n                    }\n\n                });\n\n          }\n          \n\n            $scope.processFiles = function(files){\n                // //console.log(\"files\", files);\n\n                for(var i=0; i<files.length; i++){\n                    // //console.log(\"JSON\", files[i].file_return);\n                    var j = JSON.parse(files[i].file_return);\n                    // //console.log(\"PARSED\", j);\n                    files[i].file.temp_path = j.saved_url;\n                    // //console.log(\"file\", files[i].file);\n                    vm.poid_images.push(files[i].file);\n                }\n\n\n            }\n\n\n            vm.show_loading = false;\n            vm.blurred = true;\n            vm.show_temp_login = false;\n\n              $scope.getDecrypted = function(){\n                  vm.show_loading = true;\n                  // PoidService.GetById($stateParams.medical_id, 1, 1)\n                  //   .then(function (data) {\n\n                  //       if(data.success){\n                  //           vm.medical = data.medical;\n                  //           vm.medical.examination_date = new Date(vm.medical.examination_date);\n\n                  //           vm.medical.state_of_issue = $.grep(vm.authority, function(e){ return e.id == vm.medical.authority_id; })[0];\n                  //           ////console.log(\"SET\", vm.medical.state_of_issue);\n\n                  //           //pre-selection bits?\n                  //           ////console.log(\"NEW RATINGS\", vm.medical.components);\n                  //           for(var i=0;i<vm.medical.components.length;i++){\n                  //               delete vm.medical.components[i].id;\n                  //               vm.medical.components[i].id = vm.medical.components[i].component_id;\n                  //               delete vm.medical.components[i].component_id;\n                  //               vm.medical.components[i].expiry_date = new Date(vm.medical.components[i].expiry_date);\n\n                  //               //need to remove the component from the components lists too :)\n                  //               vm.components = $.grep(vm.components, function(e){ \n                  //                   return e.id != vm.medical.components[i].id; \n                  //               });\n\n                  //           }\n\n                  //           vm.blurred = false;\n                  //           vm.show_loading = false;\n                  //       } else {\n                  //           //console.log(\"WOOOPSIES...\");\n                  //           vm.show_loading = false;\n                  //           //this should be very very rare...\n                  //       }\n\n                  //   });\n\n                 PoidService.GetById($stateParams.poid_id, 1, 1)\n                .then(function (data) {\n                    if(data.success){\n                        vm.poid = data.poid;\n                        vm.poid.expiry_date = new Date(vm.poid.expiry_date);\n\n                        vm.blurred = false;\n                        vm.show_loading = false;\n                    } else {\n                        //console.log(\"WOOOPSIES...\");\n                        if(data.fail == \"templogin\"){\n                                    //console.log(\"WOOOPSIES...\", data);\n                                    vm.show_temp_login = true;\n\n                                }\n\n                        vm.show_loading = false;\n                        //this should be very very rare...\n                    }\n\n                });\n\n              }\n\n\n              function create_sample(length) {\n                   var result           = '';\n                   var characters       = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n                   var charactersLength = characters.length;\n                   for ( var i = 0; i < length; i++ ) {\n                      result += characters.charAt(Math.floor(Math.random() * charactersLength));\n                   }\n                   return result;\n                }\n\n\n                $scope.re_login = function(){\n\n\n                      ////console.log(\"CLICKED\", vm.re_login_pass);\n\n                      //now we use the token that has been assigned already to verify the login password\n\n                        AuthenticationService.Login3(vm.re_login_pass, create_sample(120), function (response) {\n                            //console.log(\"resp\", response);\n                            if (response.success) {\n\n\n                                //we now need to call the query that was called before (decryption)\n\n                                $scope.getDecrypted();\n\n\n\n\n                                vm.show_temp_login = false;\n                            } else {\n                                alert(\"This is the wrong password - please try again...\");\n                            }\n                        });\n\n\n\n                      //vm.show_temp_login = true;\n\n                  }\n\n\n\n            $scope.delete_poid = function(id){\n\n              \n                var a = prompt(\"Are you sure you wish to delete this poid? \\n\\n This change is irreversible! To confirm please type YES in the box below.\");\n                if(a == \"YES\"){\n\n\n                    //console.log(\"WE DELETE IT\");\n\n\n                    PoidService.Delete(vm.user.id, id)\n                        .then(function (data) {\n                            //console.log(data);\n                            if(data.success){\n                                //console.log(\"HUZZAH\", data);\n                                //then we need to remove this from the list of files...\n                                vm.user_poids = $.grep(vm.user_poids, function(e){ \n                                    return e.id != id; \n                                });\n                                \n                                //refresh?\n                                $state.reload();\n                                $state.go('dashboard.my_account.poid');\n\n                            } else {\n\n                                alert(\"Something went terribly wrong... \\n\\n \"+data.message);\n\n                            }\n\n                        });\n\n\n\n                } else {\n                    //console.log(\"ignore123\");\n                }\n\n\n            }\n\n\n\n\n            $scope.save_poid = function(){\n                \n                vm.show_loading = true;\n\n                if(vm.poid_images.length < 1 && vm.poid.images.length < 1){\n\n                    $(\".drop\").focus();\n                    alert(\"You must at least have 1 image of your poid!\");\n\n                    return false;   \n                }\n\n\n                if(!vm.poid.expiry_date){\n                    $(\"#expiry_date\").focus();\n                    alert(\"You must enter an expiry date for your ID\");\n                    return false;\n                }\n\n                 if(!vm.poid.title){\n                    $(\"#title\").focus();\n                    alert(\"You must enter an ID Type\");\n                    return false;\n                }\n\n\n              \n\n                // //console.log(\"FLOW: \", vm.poid_images);\n\n\n\n                //compile the required elements YAY\n\n                // //console.log(\"LICENCE GOOD TO GO \", vm.poid);\n\n\n                 //clean shizzle before sending\n                 //why keep sending back heavy data?\n\n                    for(var i=0;i<vm.poid.images.length;i++){\n                        delete vm.poid.images[i].data_uri;\n                    }\n\n                    // vm.poid.images = vm.poid_images;\n                    vm.poid.images = vm.poid.images.concat(vm.poid_images);\n                    vm.poid.user_id = vm.user.id;\n\n\n                if(vm.poid.id){\n                    //then its an udpate\n\n                    //merge the images left?\n                    PoidService.Update(vm.poid)\n                        .then(function (data) {\n                            // //console.log(data);\n                            if(data.success){\n                                // //console.log(\"HUZZAH\", vm.poid);\n                                // //console.log(\"HUZZAH\", data);\n                                //then we need to remove this from the list of files...\n                                \n                            vm.show_loading = false;\n                                //move somewhere?\n\n                                alert(\"Saved!\");\n                                $state.go('dashboard.my_account.poid', {}, { reload: true });\n\n\n\n\n\n                            } else {\n\n                                alert(\"Something went terribly wrong... \\n\\n \"+data.message);\n                            vm.show_loading = false;\n\n                            }\n\n                        });\n\n                } else {\n\n\n                   \n\n\n                    //then its a create\n                    // //console.log(vm.poid);\n\n                    PoidService.Create(vm.poid)\n                        .then(function (data) {\n                            // //console.log(data);\n                            if(data.success){\n                                // //console.log(\"HUZZAH\", vm.poid);\n                                // //console.log(\"HUZZAH\", data);\n                                //then we need to remove this from the list of files...\n                                vm.show_loading = false;\n    \n                                $state.go('dashboard.my_account.poid', {}, { reload: true });\n                                //move somewhere?\n                               // $state.reload();\n                               // $state.go('dashboard.my_account.poid', {}, { reload: true });\n\n\n                            } else {\n\n                                alert(\"Something went terribly wrong... \\n\\n \"+data.message);\n                                vm.show_loading = false;\n\n                            }\n\n                        });\n\n\n                }\n\n\n\n            };\n\n\n\n        \n        \n\n\n    }\n app.controller('ModalInstanceCtrl', ModalInstanceCtrl);\n\n    ModalInstanceCtrl.$inject = ['$scope', '$uibModalInstance', 'id', 'warning', 'params'];\n    function ModalInstanceCtrl($scope, $uibModalInstance, id, warning, params=null) {         \n\n            $scope.warning = warning;\n            $scope.params = params;\n            $scope.images = params.images;\n            //console.log(\"APARAMS\", params);\n\n          $scope.ok = function () {\n            $uibModalInstance.close(params);\n          };\n\n          $scope.cancel = function () {\n            $uibModalInstance.dismiss('cancel');\n          };\n\n          $scope.params = function(params){\n            return params;\n          }\n\n\n    }\n app.controller('MyAccountController', MyAccountController);\n\n    MyAccountController.$inject = ['UserService', 'MemberService', 'InstructorService', 'MembershipService', 'HolidayService', '$rootScope', '$location', '$scope', '$state', '$stateParams', '$uibModal', '$log', '$window', '$compile', '$timeout', 'uiCalendarConfig', 'BookingService'];\n    function MyAccountController(UserService, MemberService, InstructorService, MembershipService, HolidayService, $rootScope, $location, $scope, $state, $stateParams, $uibModal, $log, $window, $compile, $timeout, uiCalendarConfig, BookingService) {\n        \n        var vm = this;\n       \n\n        vm.user = $rootScope.globals.currentUser;\n        //console.log(\"USER HERE IS : \", vm.user);\n\n        \n        \n\n\n    }\n app.controller('MyJourneyLogsController', MyJourneyLogsController);\n\n    MyJourneyLogsController.$inject = ['UserService', 'MemberService', 'InstructorService', 'MembershipService', 'HolidayService', '$rootScope', '$location', '$scope', '$state', '$stateParams', '$uibModal', '$log', '$window', '$compile', '$timeout', 'uiCalendarConfig', 'BookingService', 'LicenceService', 'ClubDocumentService', 'PlaneDocumentService', '$http', 'PlaneService', '$sce'];\n    function MyJourneyLogsController(UserService, MemberService, InstructorService, MembershipService, HolidayService, $rootScope, $location, $scope, $state, $stateParams, $uibModal, $log, $window, $compile, $timeout, uiCalendarConfig, BookingService, LicenceService, ClubDocumentService, PlaneDocumentService, $http, PlaneService, $sce) {\n        \n        var vm = this;\n\n        vm.clubs = [];\n        vm.user = $rootScope.globals.currentUser;\n        vm.user_id = vm.user.id;\n\n\n        vm.looking_for = $stateParams.registration;\n        if(vm.looking_for){\n            $scope.my_search2 = vm.looking_for;\n        }\n\n\n        vm.defect_severity;\n        vm.defect_severities = [\n            { title: \"No Fly Item - Ground the plane\"},\n            { title: \"Flyable - needs to be checked at next maintenance\"},\n            { title: \"Not urgent - but needs noting\"},\n            { title: \"Unsure of severity\"}\n        ]; \n\n\n        // //console.log(\"MAIN PLANE id: \", $stateParams.plane_id);\n\n\n        ////console.log(\"REG: \"+$stateParams.registration);\n\n\n         PlaneService.GetMyJourneyLogs($stateParams.plane_id, 0, 25)\n            .then(function (data) {\n                    //console.log(\"ALL is : \", data);\n                   vm.logs = data.logs;\n                   vm.user_totals = data.user_totals;\n                   vm.aircraft = data.aircraft;\n\n\n                });\n\n            vm.current_offset = 0;\n            vm.loaded_per_batch = 25;\n            vm.all_loaded = false;\n\n            vm.load_more = function(){\n                vm.current_offset = vm.current_offset + vm.loaded_per_batch;\n                PlaneService.GetMyJourneyLogs($stateParams.plane_id, vm.current_offset, vm.loaded_per_batch)\n                .then(function (data) {\n                        //console.log(\"ALL is : \", data);\n                        if(data.logs.length > 0){\n                            data.logs.forEach(log => vm.logs.push(log));\n                        } else {\n                            vm.all_loaded = true;\n                        }\n                       //vm.logs = data.logs;\n\n\n                    });\n\n            }\n\n            vm.get_initial = function(text){\n                return text.charAt(0);\n            }\n\n\n            vm.clean_times = function(time){\n                if(time == \"00:00:00\"){\n                    return \" - \";\n                }\n                return time.substring(0,5);\n            }\n\n            vm.list_pilots = function(row){\n\n                var p1 = \"\";\n                var put = \"\";\n\n                // if(row.instructor_first_name && row.instructor_first_name !== null){\n                //     p1 = \"PIC: \"+row.instructor_first_name+\" \"+row.instructor_last_name;\n                //     put = \"<br />PUT: \"+row.first_name+\" \"+row.last_name;\n                // } else {\n                //     if(row.first_name && row.first_name !== null){\n                //         p1 = \"PIC: \"+row.first_name+\" \"+row.last_name;\n                //     } else {\n                //         p1 = \"PIC not yet set!\";\n                //     }\n                // }\n\n                p1 = \"PIC: \"+ vm.get_pic(row);\n                put = vm.get_put(row);\n                if(put && put !== \"\"){\n                    put = \"<br />PUT: \" + put;\n                }\n\n                if(p1 && p1 == \"\"){\n                    p1 = \"No PIC set yet!\";\n                }\n\n                return $sce.getTrustedHtml('<div>'+p1+' '+put+'</div>');\n\n            }\n\n            vm.get_pic = function(log){\n\n                var p1 = \"\";\n\n                if(log.pic_first_name && log.pic_first_name !== null){\n                    p1 = vm.get_initial(log.pic_first_name) + \". \" + log.pic_last_name;\n                } else if(log.instructor_first_name && log.instructor_first_name !== \"\"){\n                    p1 = vm.get_initial(log.instructor_first_name) + \". \" + log.instructor_last_name;\n                } else if(log.instructor_id == 0 && log.first_name && log.first_name !== \"\"){\n                    p1 = vm.get_initial(log.first_name) + \". \" + log.last_name;\n                }\n\n                return p1;\n\n            }\n\n            vm.get_put = function(log){\n\n                var put = \"\";\n\n                if(log.put_first_name && log.put_first_name !== null){\n                    put = vm.get_initial(log.put_first_name) + \". \" + log.put_last_name;\n                } else if(log.instructor_id > 0 && log.first_name && log.first_name !== \"\"){\n                    put = vm.get_initial(log.first_name) + \". \" + log.last_name;\n                } \n\n                return put;\n\n            }\n\n\n\n            $scope.filter_detail = function(show_all = 0){\n                return (show_all == 0) ? {status: \"open\"} : {};\n            }\n\n           \n          \n            $scope.get_icon = function(file){\n\n                var ft = file.name;\n                ft = ft.split('.').pop();\n                var icon_name = \"\";\n\n                // //console.log(\"FILE:\", ft);\n                // //console.log(\"index : \", ft.indexOf(\"pdf\"));\n                switch(true){\n                    case (ft.indexOf(\"pdf\") > -1):\n                        icon_name = \"pdf.png\";\n                    break;\n                    case (ft.indexOf(\"doc\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"docx\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"xls\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"xlsx\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"ppt\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"pptx\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"jpg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"jpeg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"png\") > -1):\n                        icon_name = \"png.png\";\n                    break;\n                    case (ft.indexOf(\"gif\") > -1):\n                        icon_name = \"gif.png\";\n                    break;\n                    case (ft.indexOf(\"zip\") > -1):\n                        icon_name = \"zip.png\";\n                    break;\n                    case (ft.indexOf(\"avi\") > -1):\n                        icon_name = \"avi.png\";\n                    break;\n                    case (ft.indexOf(\"mp4\") > -1):\n                        icon_name = \"mp4.png\";\n                    break;\n                    default:\n                        icon_name = \"file.png\";\n                    break;\n                }\n\n                // //console.log(\"FILE:\", icon_name);\n\n                return \"images/file_icons/\"+icon_name;\n            }\n\n\n            vm.get_icon2 = function(file){\n\n                var ft = file.split('.').pop();\n                // //console.log(\"ICON 2 : \", ft);\n                var icon_name = \"\";\n\n                // //console.log(\"FILE:\", ft);\n                // //console.log(\"index : \", ft.indexOf(\"pdf\"));\n                switch(true){\n                    case (ft.indexOf(\"pdf\") > -1):\n                        icon_name = \"pdf.png\";\n                    break;\n                    case (ft.indexOf(\"doc\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"docx\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"xls\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"xlsx\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"ppt\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"pptx\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"jpg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"jpeg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"png\") > -1):\n                        icon_name = \"png.png\";\n                    break;\n                    case (ft.indexOf(\"gif\") > -1):\n                        icon_name = \"gif.png\";\n                    break;\n                    case (ft.indexOf(\"zip\") > -1):\n                        icon_name = \"zip.png\";\n                    break;\n                    case (ft.indexOf(\"avi\") > -1):\n                        icon_name = \"avi.png\";\n                    break;\n                    case (ft.indexOf(\"mp4\") > -1):\n                        icon_name = \"mp4.png\";\n                    break;\n                    default:\n                        icon_name = \"file.png\";\n                    break;\n                }\n\n                // //console.log(\"FILE:\", icon_name);\n\n                return \"images/file_icons/\"+icon_name;\n            }\n\n        \n        $scope.search = function(row){\n            ////console.log(\"hi\", (angular.lowercase(row.title).indexOf(angular.lowercase($scope.my_search) || '') !== -1));\n            return (angular.lowercase(row.title).indexOf(angular.lowercase($scope.my_search) || '') !== -1);\n        };\n\n        function convert_string_to_date(date){\n            if(date && date.indexOf(\"/\") > -1){\n                //then we prob have a date:::\n                    var d = date.split(\"/\");\n                    var rtn = d[2]+\"-\"+d[1]+\"-\"+d[0];\n                    //console.log(\"D\", rtn);\n                    return rtn;\n            }\n        }\n\n        // function check_if_month(input) {\n        //     var months = [\"jan\", \"feb\", \"mar\", \"apr\", \"may\", \"jun\", \"jul\", \"aug\", \"sep\", \"oct\", \"nov\", \"dec\"];\n\n        //     var monthPartOfInput = input.substring(0, 3).toLowerCase();                         \n\n        //     // if (months.indexOf(monthPartOfInput) == -1){\n        //     //     // TODO: Show validation error\n        //     // }\n        // }\n\n        function test_date(search, date){\n\n\n            if(search.length < 2){\n                return false;\n            }\n\n            if(search && search.length <= 3){\n                if(date.indexOf(search) > -1){\n                    return true;\n                }\n            } else {\n                var parsed_date = \"\";\n                var b = moment(search);\n                if(b.isValid() && b.format(\"YYYY\") != \"2001\"){\n                    parsed_date = b.format(\"YYYY-MM-DD\");\n                } else if(b.isValid()){\n                    parsed_date = b.format(\"MM-DD\");\n                }\n\n\n                var search_type = 0;\n\n                if(parsed_date !== \"\" && date.indexOf(parsed_date) > -1){\n                    // //console.log(\"found\");\n                    return true;\n                } else {\n\n                    //backup in case of wrong parsing data::;\n                    //european method\n\n                    if(search.length <= 5 && search.length >= 4){\n\n                        var c = moment(search, \"DDMM\");\n                        // //console.log(\"C is : \", c);\n                        if(c.isValid()){\n                            var c2 = c.format(\"MM-DD\");\n                            if(date.indexOf(c2) > -1){\n                                return true;\n                            }\n                        }\n\n                    } else if(search.length == 8 || search.length == 10){\n                        \n                        var c = moment(search, \"DDMMYYYY\");\n                        // //console.log(\"C is : \", c);\n                        if(c.isValid()){\n                            var c2 = c.format(\"YYYY-MM-DD\");\n                            if(date.indexOf(c2) > -1){\n                                return true;\n                            }\n                        }\n\n                    }\n\n                    // //console.log(\"not found\");\n                    return false;\n                }\n            }\n\n        }\n\n\n        function test_name(fname, lname, search){\n\n            var search2 = search.toLowerCase();\n            var fullname = fname+\" \"+lname;\n            fullname = fullname.toLowerCase();    \n            // //console.log(\"fullname: \", fullname);\n            // //console.log(\"search: \", search2);\n            // //console.log(\"match: \", (fullname.indexOf(search2) > -1));\n            if(search.length > 2 && (fullname.indexOf(search2) > -1) ){\n                return true;\n            } else {\n                return false;\n            }\n\n        }\n\n        function test_aircraft(registration, search){\n\n            var search2 = search.toLowerCase().replace(\"-\", \"\");\n            var fullname = registration.replace(\"-\", \"\");\n            fullname = fullname.toLowerCase();    \n            //  //console.log(\"fullname: \", fullname);\n            // //console.log(\"search: \", search2);\n            // //console.log(\"match: \", (fullname.indexOf(search2) > -1));\n            if(search.length > 2 && (fullname.indexOf(search2) > -1) ){\n                return true;\n            } else {\n                return false;\n            }\n\n        }\n\n        function test_airfield(search, name, code){\n            var name2 = name.toLowerCase();\n            var code2 = code.toLowerCase();\n            var search2 = search.toLowerCase();\n\n            if(search2.length > 2 && (name2.indexOf(search2) > -1)){\n                return true;\n            } else if(search2.length > 2 && (code2.indexOf(search2) > -1)){\n                return true;\n            } else {\n                return false;\n            }\n\n\n\n        }\n\n        $scope.search2 = function(row){\n            //(angular.lowercase(row.first_name).indexOf(angular.lowercase($scope.my_search2) || '') !== -1)  || (angular.lowercase(row.last_name).indexOf(angular.lowercase($scope.my_search2) || '') !== -1)\n            ////console.log(\"answer\", (angular.lowercase(row.flight_date).indexOf(angular.lowercase($scope.my_search2) || '') !== -1));\n            // return ((angular.lowercase(row.flight_date).indexOf(angular.lowercase($scope.my_search2) || (angular.lowercase(row.flight_time).indexOf(angular.lowercase($scope.my_search2)) || '') !== -1)));\n            //(angular.lowercase(row.flight_date).indexOf(angular.lowercase($scope.my_search2) || '') !== -1)\n           \n            // if( (test_date($scope.my_search2, row.flight_date)) || (angular.lowercase(row.destination_airport).indexOf(angular.lowercase($scope.my_search2) || '') !== -1) || (angular.lowercase(row.departure_airport).indexOf(angular.lowercase($scope.my_search2) || '') !== -1) || (angular.lowercase(row.destination_airport_code).indexOf(angular.lowercase($scope.my_search2) || '') !== -1) || (angular.lowercase(row.departure_airport_code).indexOf(angular.lowercase($scope.my_search2) || '') !== -1)){\n            //     return true;\n            // } else {\n            //     return false;\n            // }\n            ////console.log($scope.my_search2);\n            if(!$scope.my_search2 || ($scope.my_search2 == \"\")){\n                return true;\n            }else if(test_date($scope.my_search2, row.flight_date)){\n                return true;\n            } else if(test_name(row.first_name, row.last_name, $scope.my_search2 )){\n                return true;\n            } else if(test_aircraft(row.aircraft.registration, $scope.my_search2 )){\n                return true;\n            } else if(test_airfield($scope.my_search2, row.departure_airport, row.departure_airport_code)){\n                return true;\n            } else if(test_airfield($scope.my_search2, row.destination_airport, row.destination_airport_code)){\n                return true;\n            }else {\n                return false;\n            }\n\n            // we are testing for the date, the pilot, the departure and destination.\n\n            // return (angular.lowercase(row.flight_date).indexOf(angular.lowercase($scope.my_search2) || '') !== -1); // ? (angular.lowercase(row.flight_date).indexOf(angular.lowercase($scope.my_search2) || '') !== -1) : (angular.lowercase(row.flight_time).indexOf(angular.lowercase($scope.my_search2) || '') !== -1);\n\n        };\n\n        $scope.getMySearchCount = function(str){\n            var docs = str.documents;\n            var total = 0;\n            for(var i=0;i<docs.length;i++){\n                if($scope.search(docs[i])){\n                    total++;\n                }\n            }\n            return total;\n        }\n\n        $scope.getMySearchCount2 = function(str){\n            var charges = str.charges;\n            var total = 0;\n            for(var i=0;i<charges.length;i++){\n                if($scope.search(charges[i])){\n                    total++;\n                }\n            }\n            return total;\n        }\n\n        //  $scope.get_hours_from_decimal = function(time){\n\n        //     if(time){\n        //         var n = new Date(0,0);\n        //         n.setMinutes(+time * 60);\n        //         return n.toTimeString().slice(0,5);\n        //     } else {\n        //         return \"N/A\";\n        //     }\n\n        // }\n\n        $scope.get_hours_from_decimal = function(time){\n\n            if(time){\n                 var sign = time < 0 ? \"-\" : \"\";\n                 var hour = Math.floor(Math.abs(time));\n                 var min = Math.round((Math.abs(time) * 60) % 60);\n                 if(min == 60){\n                     hour++;\n                     min = 0;\n                 }\n                 return sign + (hour < 10 ? \"0\" : \"\") + hour + \":\" + (min < 10 ? \"0\" : \"\") + min;\n             } else {\n                 return \"N/A\";\n             }\n        }\n\n\n\n\n\n        $scope.downloadDocument = function(doc, type) {\n            var data = $.param({\n                id: doc\n            });\n\n            //alert(\"type\", type);\n\n            var controller = \"plane_documents\";\n\n            switch(type){\n                 case \"radio\": \n                    controller = \"plane_radio_licence\";\n                break;\n                 case \"insurance\": \n                    controller = \"plane_insurance\";\n                break;\n                 case \"certificate\": \n                    controller = \"plane_certificate\";\n                break;\n                case \"noise\": \n                    controller = \"plane_documents\";\n                break;\n                case \"docs\": \n                    controller = \"plane_documents\";\n                break;\n                default:\n                    controller = \"plane_documents\";\n                break;\n            }\n\n            var ddd = doc.replace(/^.*[\\\\\\/]/, '');\n\n            $http.get('api/v1/'+controller+'/show_file/'+ddd, {\n                    responseType: 'arraybuffer'\n                })\n                .success(function(data, status, headers) {\n                    var zipName = processArrayBufferToBlob(data, headers);\n\n                    //Delete file from temp folder in server - file needs to remain open until blob is created\n                    //deleteFileFromServerTemp(zipName);\n                }).error(function(data, status) {\n                    alert(\"There was an error downloading the selected document(s).\");\n                })\n        };\n\n        $scope.downloadClubDocument = function(doc) {\n            var data = $.param({\n                id: doc\n            });\n\n            var ddd = doc.replace(/^.*[\\\\\\/]/, '');\n\n            $http.get('api/v1/club_documents/show_file/'+ddd, {\n                    responseType: 'arraybuffer'\n                })\n                .success(function(data, status, headers) {\n                    var zipName = processArrayBufferToBlob(data, headers);\n\n                    //Delete file from temp folder in server - file needs to remain open until blob is created\n                    //deleteFileFromServerTemp(zipName);\n                }).error(function(data, status) {\n                    alert(\"There was an error downloading the selected document(s).\");\n                })\n        };\n\n        // vm.list_pilots = function(row){\n\n        //     var p1 = \"\";\n        //     var put = \"\";\n\n        //     if(row.instructor_first_name && row.instructor_first_name !== null){\n        //         p1 = \"PIC: \"+row.instructor_first_name+\" \"+row.instructor_last_name;\n        //         put = \"<br />PUT: \"+row.first_name+\" \"+row.last_name;\n        //     } else {\n        //         p1 = \"PIC: \"+row.first_name+\" \"+row.last_name;\n        //     }\n\n        //     return $sce.getTrustedHtml('<div>'+p1+' '+put+'</div>');\n\n        // }\n\n        function processArrayBufferToBlob(data, headers) {\n            var octetStreamMime = 'application/octet-stream';\n            var success = false;\n\n            // Get the headers\n            headers = headers();\n            //var ttt = title.toLowerCase().replace(/\\W/g, '_');\n            // Get the filename from the x-filename header or default to \"download.bin\"\n            var filename = headers['x-filename'] || 'download.zip';\n\n            // Determine the content type from the header or default to \"application/octet-stream\"\n            var contentType = headers['content-type'] || octetStreamMime;\n\n            try {\n                // Try using msSaveBlob if supported\n                var blob = new Blob([data], {\n                    type: contentType\n                });\n                if (navigator.msSaveBlob)\n                    navigator.msSaveBlob(blob, filename);\n                else {\n                    // Try using other saveBlob implementations, if available\n                    var saveBlob = navigator.webkitSaveBlob || navigator.mozSaveBlob || navigator.saveBlob;\n                    if (saveBlob === undefined) throw \"Not supported\";\n                    saveBlob(blob, filename);\n                }\n                success = true;\n            } catch (ex) {\n                $log.info(\"saveBlob method failed with the following exception:\");\n                $log.info(ex);\n            }\n\n            if (!success) {\n                // Get the blob url creator\n                var urlCreator = window.URL || window.webkitURL || window.mozURL || window.msURL;\n                if (urlCreator) {\n                    // Try to use a download link\n                    var link = document.createElement('a');\n                    if ('download' in link) {\n                        // Try to simulate a click\n                        try {\n                            // Prepare a blob URL\n                            var blob = new Blob([data], {\n                                type: contentType\n                            });\n                            var url = urlCreator.createObjectURL(blob);\n                            link.setAttribute('href', url);\n\n                            // Set the download attribute (Supported in Chrome 14+ / Firefox 20+)\n                            link.setAttribute(\"download\", filename);\n\n                            // Simulate clicking the download link\n                            var event = document.createEvent('MouseEvents');\n                            event.initMouseEvent('click', true, true, window, 1, 0, 0, 0, 0, false, false, false, false, 0, null);\n                            link.dispatchEvent(event);\n                            success = true;\n\n                        } catch (ex) {\n                            $log.info(\"Download link method with simulated click failed with the following exception:\");\n                            $log.info(ex);\n                        }\n                    }\n\n                    if (!success) {\n                        // Fallback to window.location method\n                        try {\n                            // Prepare a blob URL\n                            // Use application/octet-stream when using window.location to force download\n                            var blob = new Blob([data], {\n                                type: octetStreamMime\n                            });\n                            var url = urlCreator.createObjectURL(blob);\n                            window.location = url;\n                            success = true;\n                        } catch (ex) {\n                            $log.info(\"Download link method with window.location failed with the following exception:\");\n                            $log.info(ex);\n                        }\n                    }\n                }\n            }\n\n            if (!success) {\n                // Fallback to window.open method\n                $log.info(\"No methods worked for saving the arraybuffer, using last resort window.open\");\n                window.open(httpPath, '_blank', '');\n            }\n            return filename;\n        };\n\n\n        $scope.get_icon2 = function(file){\n                //console.log(\"FILE\", file);\n                if(!file || file == \"\"){\n                    return \"\";\n                }\n                var ft = file.split('.').pop();\n                // //console.log(\"ICON 2 : \", ft);\n                var icon_name = \"\";\n\n                // //console.log(\"FILE:\", ft);\n                // //console.log(\"index : \", ft.indexOf(\"pdf\"));\n                switch(true){\n                    case (ft.indexOf(\"pdf\") > -1):\n                        icon_name = \"pdf.png\";\n                    break;\n                    case (ft.indexOf(\"doc\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"docx\") > -1):\n                        icon_name = \"doc.png\";\n                    break;\n                    case (ft.indexOf(\"xls\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"xlsx\") > -1):\n                        icon_name = \"xls.png\";\n                    break;\n                    case (ft.indexOf(\"ppt\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"pptx\") > -1):\n                        icon_name = \"ppt.png\";\n                    break;\n                    case (ft.indexOf(\"jpg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"jpeg\") > -1):\n                        icon_name = \"jpg.png\";\n                    break;\n                    case (ft.indexOf(\"png\") > -1):\n                        icon_name = \"png.png\";\n                    break;\n                    case (ft.indexOf(\"gif\") > -1):\n                        icon_name = \"gif.png\";\n                    break;\n                    case (ft.indexOf(\"zip\") > -1):\n                        icon_name = \"zip.png\";\n                    break;\n                    case (ft.indexOf(\"avi\") > -1):\n                        icon_name = \"avi.png\";\n                    break;\n                    case (ft.indexOf(\"mp4\") > -1):\n                        icon_name = \"mp4.png\";\n                    break;\n                    default:\n                        icon_name = \"file.png\";\n                    break;\n                }\n\n                // //console.log(\"FILE:\", icon_name);\n\n                return \"images/file_icons/\"+icon_name;\n            }\n      \n\n\n\n    }\n app.controller('NewChargeModalInstanceCtrl', NewChargeModalInstanceCtrl);\n\n    NewChargeModalInstanceCtrl.$inject = ['$scope', '$uibModalInstance', 'id', 'warning', 'MemberService', 'ClubService', '$rootScope', 'PaymentService', 'params'];\n    function NewChargeModalInstanceCtrl($scope, $uibModalInstance, id, warning, MemberService, ClubService, $rootScope, PaymentService, params=null) {         \n\n            $scope.warning = warning;\n            $scope.params = params;\n            //console.log(\"APARAMS\", params);\n\n            $scope.to_refund = 0;\n            $scope.reason = \"\";\n            $scope.club_id = $rootScope.globals.currentUser.current_club_admin.id;\n\n            $scope.club_settings = {};\n\n            $scope.new_client = {\n              first_name: \"\",\n              last_name: \"\",\n              email: \"\"\n            };\n\n            $scope.items = [];\n            $scope.item = {\n              title: \"\",\n              quantity: 0,\n              vat: 0,\n              price: 0\n            };\n\n            $scope.selected_client;\n            $scope.selected_card;\n\n            $scope.members = [];\n\n            $scope.show_direct_debit_details = false;\n\n            ClubService.GetById($scope.club_id)\n            .then(function(data){\n                $scope.club_settings = data;\n                $scope.item.vat = $scope.club_settings.vat_rate;\n                $scope.club_settings.vat_registered = ($scope.club_settings.vat_registered == 1)? true : false;\n                //console.log(\"settings\", $scope.club_settings);\n            });\n\n            MemberService.GetAllByClub($scope.club_id)\n                    .then(function(data){\n                        $scope.members = data;   \n                        $scope.members.unshift({id: -12, first_name: \"New\", last_name: \"Client\"});\n                        // $scope.item.title = \"hjel\";\n                        //console.log(\"members\",$scope.members);\n                    });\n\n\n            $scope.delete_receipt = function(number){\n\n                \n              $scope.items.splice(number, 1);\n           \n              calculate_charges();\n\n            }\n\n            $scope.card_selected = function(data){\n              $scope.selected_card = data;\n\n              if(data.id == -12){\n                 setTimeout(function(){\n                  setupStripe();\n                }, 1000);\n              }\n\n            }\n\n            $scope.member_selected = function(data){\n              //console.log(\"selected\", data);\n              \n              $scope.selected_client = data;\n\n              if(data && data.account_ending && data.account_ending !== ''){\n                  $scope.show_direct_debit_details = true;\n                } else {\n                  $scope.show_direct_debit_details = false;\n                   setTimeout(function(){\n                    setupStripe();\n                  }, 1000);\n\n\n                }\n\n              if(data && data.id == -12){\n                \n                setTimeout(function(){\n                  setupStripe();\n                }, 1000);\n\n              } \n            }\n\n            $scope.add_item = function(item_sent){\n                $scope.item = item_sent;\n\n                // //console.log(\"HELLO ADDING\", item_sent);\n                // //console.log(\"HELLO ADDING\", $scope.items);\n\n                $scope.items.push($scope.item);\n\n                // //console.log(\"OBJ TO SEND: \", $scope.item);\n\n               \n                $scope.item = {\n                            quantity: 0,\n                            price: 0,\n                            vat: $scope.club_settings.vat_rate,\n                            title: \"\"\n                          };\n\n                calculate_charges();\n\n            }\n\n\n            function calculate_charges(){\n\n\n              // //console.log(\"Calculate everything now...\");\n              var total = 0;\n              var the_vat = 0;\n              for(var i=0; i < $scope.items.length; i++){\n\n                $scope.items[i].total = ($scope.items[i].quantity * $scope.items[i].price);\n                if($scope.items[i].vat > 0){\n                  this_vat = ( $scope.items[i].total * ($scope.items[i].vat / 100) );\n                  the_vat = the_vat + this_vat;\n                }\n                total = total + $scope.items[i].total;\n\n              }\n\n              $scope.the_vat = the_vat;\n              $scope.the_total = total;\n\n            }\n\n\n\n\n\n\n          $scope.ok = function () {\n            var obj = params;\n            // obj.reason = $scope.reason;\n            // obj.to_refund = $scope.to_refund\n\n\n            //let's create all that is required to issue the invoice.\n            if($scope.selected_client.id == -12){\n\n\n              $scope.selected_client.first_name = $scope.new_client.first_name;\n              $scope.selected_client.last_name = $scope.new_client.last_name;\n              $scope.selected_client.email = $scope.new_client.email;\n\n            } else{\n\n               $scope.selected_client.first_name = $scope.selected_client.first_name;\n               $scope.selected_client.last_name = $scope.selected_client.last_name;\n               $scope.selected_client.email = $scope.selected_client.email;\n            \n            }\n\n            if($scope.selected_client.id == -12 || !$scope.show_direct_debit_details){\n              //if there is a custom card entered - then we continue here...\n\n              var options = {};\n              stripe.createToken(card, options).then(function(result) {\n                if (result.error) {\n                  // Inform the user if there was an error\n                  var errorElement = document.getElementById('card-errors');\n                  errorElement.textContent = result.error.message;\n                } else {\n\n                  //stripeTokenHandler(result.token);\n                  ////console.log(\"RESULT\", result);\n\n                  if(result.token.id){\n                    ////console.log(\"STUFF\", result.token.id);\n\n                    //prepare a basic object...\n                    var card_obj = {\n                        brand: result.token.card.brand,\n                        last4: result.token.card.last4,\n                        hash: result.token.card.id,\n                        token: result.token.id,\n                        funding: result.token.card.funding,\n                        name: result.token.card.name,\n                        client_ip: result.token.client_ip\n                    };\n\n\n                    var obj_to_send = {\n                      payment: card_obj,\n                      items: $scope.items,\n                      user: $scope.selected_client,\n                      club_id: $scope.club_id\n                    };\n\n\n                    // SAMPLE OF WHERE WE NEED TO SEND THE SHIZZLE....\n                    PaymentService.CreateCustom(obj_to_send)\n                    .then(function (data) {\n                        if(data.success){\n\n                            ////console.log(\"CARD: \"+data);\n                            //fill the drop down menu\n                            //$state.go('dashboard.my_account.payment_methods', {}, { reload: true });\n                            $uibModalInstance.close(data);\n                        } else {\n                            //console.log(\"WOOOPSIES...\", data);\n                            //this should be very very rare...\n\n                        }\n                    });\n                    \n\n\n                  }\n\n                }\n              });\n\n            } else {\n\n              //this should now be when we charge a saved card.\n\n              //create a new charge request? is that server side?\n\n\n              var obj_to_send = {\n                  payment: {},\n                  items: $scope.items,\n                  user: $scope.selected_client,\n                  club_id: $scope.club_id\n                };\n\n                if($scope.selected_client.account_ending !== \"\"){\n                  obj_to_send.payment.direct_debit = true;\n                }\n\n\n              PaymentService.CreateCustom(obj_to_send)\n                    .then(function (data) {\n                        if(data.success){\n\n                            ////console.log(\"CARD: \"+data);\n                            //fill the drop down menu\n                            //$state.go('dashboard.my_account.payment_methods', {}, { reload: true });\n                            $uibModalInstance.close(data);\n                        } else {\n                            //console.log(\"WOOOPSIES...\", data);\n                            //this should be very very rare...\n\n                        }\n                    });\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n              //then we don't need a stripe token...\n\n               // SAMPLE OF WHERE WE NEED TO SEND THE SHIZZLE....\n              // PaymentService.Create(obj)\n              // .then(function (data) {\n              //     if(data.success){\n\n              //         //console.log(\"CARD: \"+data);\n              //         //fill the drop down menu\n              //         $state.go('dashboard.my_account.payment_methods', {}, { reload: true });\n                //            $uibModalInstance.close(obj);\n\n              //     } else {\n              //         //console.log(\"WOOOPSIES...\", data);\n              //         //this should be very very rare...\n\n              //     }\n              // });\n\n\n\n\n\n            }\n            \n\n\n\n\n          };\n\n          $scope.cancel = function () {\n            $uibModalInstance.dismiss('cancel');\n          };\n\n          $scope.params = function(params){\n            return params;\n          }\n\n\n\n\n\n\n\n\n\n          //STRIPE STUFF HERE PLEASE!!! :-)\n\n\n        var stripe = Stripe('pk_test_Ers4ZfdIMZ59ac4wKy6FDAH2');\n        var elements = stripe.elements();\n\n        var card_options = {\n              hidePostalCode: true,\n              style: {\n                base: {\n                  iconColor: '#666EE8',\n                  color: '#31325F',\n                  lineHeight: '40px',\n                  fontWeight: 300,\n                  fontFamily: 'Helvetica Neue',\n                  fontSize: '15px',\n                  '::placeholder': {\n                    color: '#CFD7E0',\n                  },\n                },\n              }\n            };\n\n        var card = elements.create('card', card_options);\n\n        var run = false;\n        var timeout;\n\n        function setupStripe(){\n            clearTimeout(timeout);\n            if(run == false){\n                run = true;\n\n                card.mount('#card-element');\n            \n                form = document.getElementById('payment-form');\n                form.addEventListener('submit', function(e) {\n                  e.preventDefault();\n                  createToken();\n                });\n            } \n        }   \n\n\n        // $scope.$on('$viewContentLoaded', function(){\n        //         clearTimeout(timeout);\n        //         if(run2 == false){\n        //             run2 = true;\n        //             timeout = setTimeout(function(){ setupStripe(); }, 1500); \n        //         }\n        // });\n\n     \n\n        function stripeTokenHandler(token) {\n          // Insert the token ID into the form so it gets submitted to the server\n          var form = document.getElementById('payment-form');\n          var hiddenInput = document.createElement('input');\n          hiddenInput.setAttribute('type', 'hidden');\n          hiddenInput.setAttribute('name', 'stripeToken');\n          hiddenInput.setAttribute('value', token.id);\n          form.appendChild(hiddenInput);\n\n          // Submit the form\n          //console.log(\"TOKEN\", token);\n          //form.submit();\n        }\n\n        function create_invoice() {\n          //console.log(\"HELLO CREATE TOKEN? 1\");\n           var options = {\n            // name: document.getElementById('name').value,\n            //  address_line1: document.getElementById('address-line1').value,\n            // address_line2: document.getElementById('address-line2').value,\n            // address_city: document.getElementById('address-city').value,\n            // address_zip: document.getElementById('address-postcode').value,\n            // address_country: document.getElementById('address-country').value,\n          };\n\n          stripe.createToken(card, options).then(function(result) {\n            if (result.error) {\n              // Inform the user if there was an error\n              var errorElement = document.getElementById('card-errors');\n              errorElement.textContent = result.error.message;\n            } else {\n              // Send the token to your server\n              //stripeTokenHandler(result.token);\n              ////console.log(\"RESULT\", result);\n\n              if(result.token.id){\n              ////console.log(\"STUFF\", result.token.id);\n\n                //prepare a basic object...\n                var obj = {\n                    user_id: vm.user.id,\n                    brand: result.token.card.brand,\n                    last4: result.token.card.last4,\n                    hash: result.token.card.id,\n                    token: result.token.id,\n                    funding: result.token.card.funding,\n                    name: result.token.card.name,\n                    client_ip: result.token.client_ip\n                };\n\n\n                PaymentService.Create(obj)\n                .then(function (data) {\n                    if(data.success){\n\n                        //console.log(\"CARD: \"+data);\n                        //fill the drop down menu\n                        $state.go('dashboard.my_account.payment_methods', {}, { reload: true });\n\n                    } else {\n                        //console.log(\"WOOOPSIES...\", data);\n                        //this should be very very rare...\n\n                    }\n                });\n\n\n\n              }\n\n            }\n          });\n        };\n\n\n\n\n\n\n\n    }\n app.controller('PassengerSignupCompleteController', PassengerSignupCompleteController);\n\n    PassengerSignupCompleteController.$inject = ['UserService', '$rootScope', '$location', '$scope', '$state', '$stateParams'];\n    function PassengerSignupCompleteController(UserService, $rootScope, $location, $scope, $state, $stateParams) {\n        \t\n\n\t    \t ////console.log(\"HELLO\");\n\t\t    ////console.log($scope.membership);\n\n\n\t\t    var vm = this;\n\n\t\t    $scope.checked_identity = false;\n\t\t    $scope.is_already_user = false;\n\n\t\t    $scope.submit_button = \"SUBMIT INFORMATION\";\n\n\n        \t$scope.formData = {};\n\n\n        \tif($scope.formData.password && $scope.formData.password !== \"\" && $scope.formData.password == $scope.formData.password2){\n\n        \t\t$scope.submit_button = \"SUBMIT INFORMATION & CREATE YOUR ACCOUNT\";\n        \t\n        \t}\n\n\n\n\n         \t// we will store all of our form data in this object\n\t\t    if($stateParams.token){\n\n    \t\t\t\t////console.log(\"STATE\", $state.current.url);\n\n    \t\t\t\tif(!$scope.checked_identity && $state.current.url !== \"/check\"){\n    \t\t\t\t\t$state.go(\"passenger_signup_complete.check\");\n    \t\t\t\t}\n\n    \t\t\t// UserService.GetInvite($stateParams.token)\n       //          .then(function (data) {\n\t    \t\t// \t////console.log(\"GETTING TOKEN\", data);\n\n\n       //              if(data){\n\n       //              \t$scope.total_invite = data;\n                    \t\n       //              \t$scope.formData.first_name = data.first_name;\n\t\t    \t// \t\t$scope.formData.last_name = data.last_name;\n\t\t    \t// \t\t$scope.formData.email = data.email;\n\t\t    \t// \t\t$scope.formData.membership_id = data.membership_id;\n\t\t    \t// \t\t$scope.formData.club_id = data.club_id;\n\t\t    \t// \t\t$scope.formData.to_pay = data.to_pay;\n\t\t    \t// \t\t$scope.formData.token = data.invitation_token;\n\n\t\t    \t// \t\t//maybe?\n\t\t    \t// \t\t$scope.formData.invited_by = data.invited_by;\n\n\t\t    \t// \t\tif(data.user_id > 0){\n\t\t    \t// \t\t\t//console.log(\"UID set\", data.user_id);\n\t\t    \t// \t\t\t$cookies.put(\"uid\", data.user_id);\n\t\t    \t// \t\t}\n\n\t\t    \t// \t\t//$cookies.set(\"rid\", data.membership.request.membership_request_id);\n\t\t    \t// \t\t//other data::\n\n\t\t    \t// \t\t$scope.club = data.club;\n\t\t    \t// \t\t$scope.membership = data.membership;\n\n\t\t    \t// \t\t$scope.all = data;\n\n       //              \t////console.log(\"success\");\n       //              } else {\n       //              \talert(\"Sorry we were unable to find this invitation... Please try clicking the link again.\")\n       //              \t$state.go(\"login\");\n       //              }\n       //          });\n\n    \t\t} else {\n\n    \t\t\t$state.go(\"login\");\n    \t\t}\n\n\n\n    \t\t$scope.gotologin = function(){\n    \t\t\t$state.go(\"login\");\n    \t\t}\n\t\t    \n\t\t    // $scope.checkValid = function(uisref){\n\t\t    // \tif(!uisref){\n\t\t    // \t\tuisref = $(\".btn-info\").attr(\"one-ui-sref\");\n\t\t    // \t}\n\t\t    // \t//if less than 18 show the guardian form\n\t\t    // \tif(checking_validity()){\n\t\t\t   //  \tif($scope.formData.password == $scope.formData.password2){\n\t\t\t   //  \t\t$state.go(uisref);\n\t\t    // \t\t} else {\n\t\t\t   //  \t\t$(\"input[type='password']\").removeClass(\"ng-pristine\").addClass(\"ng-invalid\");\n\t\t    // \t\t\treturn false;\n\t\t    // \t\t}\n\t\t\t   //  \t//console.log($('#signup-form')[0].checkValidity());\n\t\t\t   //  } else {\n\t\t\t   //  \treturn false;\n\t\t\t   //  }\n\t\t    \t\n\t\t    // }\n\n\n\n\t\t    $scope.formcode = [];\n\t\t   $scope.checkedcode = 0;\n\t\t   $scope.goToNextInput = function(event, number) {\n\t\t   \t // //console.log(event.keyCode);\n\t\t   \t // //console.log(number);\n\t\t   \t var no_len = document.getElementById(\"index\"+(number - 1) ).value;\n\t\t   \t // //console.log(no_len.toString().length);\n\n\t\t   \t // //console.log(document.getElementById(\"index\"+(number - 1) ).value);\n\t\t   \t\n\n\n\t\t   \t if(number == 1 && (event.keyCode == 91 || event.keyCode == 17) && no_len.toString().length == 6){\n\t\t   \t \t// //console.log(\"MATCHINGS\", );\n\t\t   \t \tvar thecode = Array.from(no_len.toString());\n\t\t   \t \tfor(var i=0; i<6; i++){\n\t\t   \t \t\t$scope.formcode.push(parseInt(thecode[i]));\n\t\t   \t \t}\n\n\t\t   \t \tdocument.getElementById(\"index5\").focus();\n\t\t   \t \tnumber =6;\n\t\t   \t\t//return false;\n\t\t   \t } else {\n\t\t   \t \t\t//event.keyCode\n\t\t\t\t   \tif(event.keyCode == 37 && number > 0){\n\t\t\t\t   \t\tdocument.getElementById(\"index\"+(number - 2)).focus();\n\t\t\t\t   \t\treturn false;\n\t\t\t\t   \t}\n\t\t\t\t   \tif(event.keyCode == 39 && number < 6){\n\t\t\t\t   \t\tdocument.getElementById(\"index\"+(number)).focus();\n\t\t\t\t   \t\treturn false;\n\t\t\t\t   \t}\n\t\t\t\t   \tif(event.keyCode == 8 && number > 1 && document.getElementById(\"index\"+(number - 1) ).value == \"\"){\n\t\t\t\t   \t\t// //console.log(\"match\");\n\t\t\t\t   \t\t// //console.log(\"index\"+(number - 2));\n\t\t\t\t   \t\tdocument.getElementById(\"index\"+(number - 2)).focus();\n\t\t\t\t   \t\treturn false;\n\t\t\t\t   \t}\n\t\t   \t }\n\n\n\t\t   \n\n\n\t\t   \tif(number == 6 && $scope.formcode.length == 6){\n\t\t   \t\tvar combine = $scope.formcode.join(\"\");\n\t\t   \t\t// //console.log(\"COMPLETE\", combine);\n\t\t   \t\t$scope.checkedcode++;\n\t\t   \t\t// //console.log(\"tries\", $scope.checkedcode);\n\n\t\t   \t\tif($scope.checkedcode > 4){\n\t\t   \t\t\talert(\"Sorry - you have tried too many times, this code is now invalid and a new invitation will be sent to you.\");\n\n\t\t   \t\t\t//send another invitation code to the recipient \n\n\n\n\t\t   \t\t\treturn false;\n\t\t   \t\t} else {\n\n\t\t   \t\t\t//let's send this out for verification!!\n\t\t   \t\t\tUserService.GetPaxSecureInvite2($stateParams.token, combine)\n\t                .then(function (data) {\n\t                \t// //console.log(\"GET SECURE INVITE\", data);\n\t                \tif(data.success){\n\n\t                \t\tif(data.invitation.is_already_user){\n\n\t                \t\t\t$scope.formData.user_id = data.invitation.user_id;\n\t                \t\t\t$scope.formData.token = $stateParams.token;\n\t                \t\t\t$scope.checked_identity = true;\n\t                \t\t\t$state.go(\"passenger_signup_complete.your_profile\");\n\t                \t\t} else {\n\n\t                \t\t\t\n\t                \t\t\talert(\"We couldn't match your invitation with our records - if you think you have an account, please go to the login screen and click the forgotten password link.\");\n\t                \t\t\treturn false;\n\t                \t\t}\n\n\t                \t\t\n\n\t                \t} else {\n\t                \t\talert(data.message);\n\t                \t\treturn false;\n\t                \t}\n\n\t                });\n\n\n\t\t   \t\t}\n\n\n\t\t   \t\treturn false;\n\t\t   \t}\n\n\n\t\t    var entry = document.getElementById(\"index\"+(number - 1) ).value;\n\t\t    if(entry > -1 && entry < 10 && entry !== \"\"){\n\t\t    \tdocument.getElementById(\"index\"+number).focus();\n\t\t    } else {\n\t\t    \tdocument.getElementById(\"index\"+(number - 1) ).value = \"\";\n\t\t    \tdocument.getElementById(\"index\"+(number - 1)).focus();\n\t\t    \treturn false;\n\t\t    }\n\n\t\t  }\n\n\t\t    $scope.submit_user_for_signup = function(){\n\n\n\t\t    \tif($scope.formData.password !== $scope.formData.password2 || $scope.formData.password.length < 8){\n\t\t    \t\talert(\"Please ensure your password is at least 8 character and both of these match\");\n\t\t    \t\treturn false;\n\t\t    \t}\n\n\t\t    \t//prepare the items!!\n\t\t    \t////console.log($scope.formData);\n\n\t\t    \t//if we get here we have a fully completed form and are ready to send it to create a user.\n\t\t    \n\t\t    \tvar to_send = {\n\t\t    \t\tuser_id: $scope.formData.user_id,\n\t\t    \t\ttoken: $scope.formData.token,\n\t\t    \t\tpassword: $scope.formData.password\n\t\t    \t}\n\n\t\t    \t////console.log(\"SENDING\", to_send);\n\n\n\t    \t\tUserService.SignupUserFromPassenger($stateParams.token, to_send)\n                .then(function (data) {\n                \t// //console.log(\"GET SECURE INVITE\", data);\n                \tif(data.success){\n\t\t\t\t    \t\n                \t\t//this is successful - now let's clear the contents:\n                \t\t$scope.formData = {};\n                \t\t//and let's remove the top links\n                \t\t$scope.checked_identity = false;\n                \t\t$state.go(\"passenger_signup_complete.thank_you\");\n                \t\t\n                \t} else {\n                \t\talert(data.message);\n                \t\treturn false;\n                \t}\n\n                });\n\n\n\t\t    \t\n\n\n\t\t\t}\n\n\n\n\n\n}\n\n\n\n\n\n\n\n app.controller('PassengerSignupController', PassengerSignupController);\n\n    PassengerSignupController.$inject = ['UserService', '$rootScope', '$location', '$scope', '$state', '$stateParams', '$http'];\n    function PassengerSignupController(UserService, $rootScope, $location, $scope, $state, $stateParams, $http) {\n        \t\n\n\t    \t //console.log(\"HELLO\");\n\t\t    ////console.log($scope.membership);\n\n\n\t\t    var vm = this;\n\n\t\t    $scope.checked_identity = false;\n\t\t    $scope.is_already_user = false;\n\n\t\t    $scope.submit_button = \"SUBMIT INFORMATION\";\n\n\n        \t$scope.formData = {};\n\n\n        \tif($scope.formData.password && $scope.formData.password !== \"\" && $scope.formData.password == $scope.formData.password2){\n\n        \t\t$scope.submit_button = \"SUBMIT INFORMATION & CREATE YOUR ACCOUNT\";\n        \t\n        \t}\n\n\n\n\n         \t// we will store all of our form data in this object\n\t\t    if($stateParams.token){\n\n    \t\t\t\t////console.log(\"STATE\", $state.current.url);\n\n    \t\t\t\tif(!$scope.checked_identity && $state.current.url !== \"/check\"){\n    \t\t\t\t\t$state.go(\"passenger_signup.check\");\n    \t\t\t\t}\n\n    \t\t\t// UserService.GetInvite($stateParams.token)\n       //          .then(function (data) {\n\t    \t\t// \t////console.log(\"GETTING TOKEN\", data);\n\n\n       //              if(data){\n\n       //              \t$scope.total_invite = data;\n                    \t\n       //              \t$scope.formData.first_name = data.first_name;\n\t\t    \t// \t\t$scope.formData.last_name = data.last_name;\n\t\t    \t// \t\t$scope.formData.email = data.email;\n\t\t    \t// \t\t$scope.formData.membership_id = data.membership_id;\n\t\t    \t// \t\t$scope.formData.club_id = data.club_id;\n\t\t    \t// \t\t$scope.formData.to_pay = data.to_pay;\n\t\t    \t// \t\t$scope.formData.token = data.invitation_token;\n\n\t\t    \t// \t\t//maybe?\n\t\t    \t// \t\t$scope.formData.invited_by = data.invited_by;\n\n\t\t    \t// \t\tif(data.user_id > 0){\n\t\t    \t// \t\t\t//console.log(\"UID set\", data.user_id);\n\t\t    \t// \t\t\t$cookies.put(\"uid\", data.user_id);\n\t\t    \t// \t\t}\n\n\t\t    \t// \t\t//$cookies.set(\"rid\", data.membership.request.membership_request_id);\n\t\t    \t// \t\t//other data::\n\n\t\t    \t// \t\t$scope.club = data.club;\n\t\t    \t// \t\t$scope.membership = data.membership;\n\n\t\t    \t// \t\t$scope.all = data;\n\n       //              \t////console.log(\"success\");\n       //              } else {\n       //              \talert(\"Sorry we were unable to find this invitation... Please try clicking the link again.\")\n       //              \t$state.go(\"login\");\n       //              }\n       //          });\n\n    \t\t} else {\n\n    \t\t\t$state.go(\"login\");\n    \t\t}\n\n\n\n\n\t\t    var calculate_age = function(birthday) { // birthday is a date\n\t\t    \t//console.log(birthday);\n\t\t\t    var ageDifMs = Date.now() - birthday.getTime();\n\t\t\t    var ageDate = new Date(ageDifMs); // miliseconds from epoch\n\t\t\t    return Math.abs(ageDate.getUTCFullYear() - 1970);\n\t\t\t}\n\n\t\t\t$scope.guardian = false;\n\n\t\t\t$scope.validate_age = function(){\n\t\t\t\tif(checking_validity()){\n\t\t\t\t\t//console.log($scope.formData.passenger);\n\t\t\t\t\tvar age = calculate_age($scope.formData.dob);\n\t\t\t\t\t//console.log(\"age is : \"+age);\n\t\t\t\t\tif(age < 18){\n\t\t\t\t\t\t//$state.go(under);\n\t\t\t\t\t\t$scope.guardian = true;\n\t\t\t\t\t} else {\n\t\t\t\t\t\t//$state.go(over);\n\t\t\t\t\t\t$scope.guardian = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\n\n\n\t\t\t$scope.next_of_kin = function(){\n\t\t    \t if(! $('#signup-form')[0].checkValidity()){\n\t\t    \t\t$(\".ng-pristine\").not(\".ng-valid\").removeClass(\"ng-pristine\").addClass(\"ng-invalid\");\n\t\t    \t\t//console.log(\"STOP\");\n\t\t    \t\treturn false;\n\t\t    \t}\n\t\t\t\t$state.go('passenger_signup.next_of_kin');\n\t\t\t}\n\n\t\t\tvar checking_validity = function(){\n\t\t    \t// if(! $('#signup-form')[0].checkValidity()){\n\t\t    \t// \t$(\".ng-pristine\").not(\".ng-valid\").removeClass(\"ng-pristine\").addClass(\"ng-invalid\");\n\t\t    \t// \t//console.log(\"STOP\");\n\t\t    \t// \treturn false;\n\t\t    \t// } else {\n\t\t    \t// \tif(!$scope.formData.passenger){\n\t\t\t\t   //  \t\t$state.go(\"user_signup.your_profile\");\n\t\t    \t// \t}\n\t\t    \t// \t// if($scope.formData.user.password == $scope.formData.user.password2){\n\t\t\t    // \t// \t$state.go(uisref);\n\t\t    \t// \t// } else {\n\t\t\t    // \t// \t$(\"input[type='password']\").removeClass(\"ng-pristine\").addClass(\"ng-invalid\");\n\t\t    \t// \t// \treturn false;\n\t\t    \t// \t// }\n\t\t    \t// }\n\t\t    \treturn true;\n\t\t    }\n\n\t\t    $scope.check_nok = function(){\n\t\t    \tif(! $('#signup-form')[0].checkValidity()){\n\t\t    \t\t$(\".ng-pristine\").not(\".ng-valid\").removeClass(\"ng-pristine\").addClass(\"ng-invalid\");\n\t\t    \t\t//console.log(\"STOP\");\n\t\t    \t\treturn false;\n\t\t    \t}\n\t\t    \t$state.go(\"passenger_signup.tnc\");\n\t\t    }\n\t\t    \n\t\t    $scope.checkValid = function(uisref){\n\t\t    \tif(!uisref){\n\t\t    \t\tuisref = $(\".btn-info\").attr(\"one-ui-sref\");\n\t\t    \t}\n\t\t    \t//if less than 18 show the guardian form\n\t\t    \tif(checking_validity()){\n\t\t\t    \tif($scope.formData.password == $scope.formData.password2){\n\t\t\t    \t\t$state.go(uisref);\n\t\t    \t\t} else {\n\t\t\t    \t\t$(\"input[type='password']\").removeClass(\"ng-pristine\").addClass(\"ng-invalid\");\n\t\t    \t\t\treturn false;\n\t\t    \t\t}\n\t\t\t    \t//console.log($('#signup-form')[0].checkValidity());\n\t\t\t    } else {\n\t\t\t    \treturn false;\n\t\t\t    }\n\t\t    \t\n\t\t    }\n\n\t\t    $scope.submit_passenger = function(){\n\n\t\t    \t//prepare the items!!\n\t\t    \t//console.log($scope.formData);\n\n\n\t\t    \t//verification of the profile page\n\t\t    \tif(! $scope.formData.first_name || ! $scope.formData.last_name || ! $scope.formData.email || ! $scope.formData.dob){\n\t\t    \t\talert(\"Please complete your personal details\");\n\t\t    \t\t$state.go(\"passenger_signup.your_profile\");\n\t\t    \t\treturn false;\n\t\t    \t}\n\n\t\t    \tif(calculate_age($scope.formData.dob) < 18){\n\t\t    \t\t//need to confirm guardian information was filled out\n\t\t    \t\tif( !$scope.formData.guardian || ! $scope.formData.guardian.first_name || ! $scope.formData.guardian.last_name || ! $scope.formData.guardian.dob || ! $scope.formData.guardian.guardianship ){\n\t\t    \t\t\talert(\"As you are under the age of 18, your guardian needs to complete their details.\");\n\t\t\t    \t\t$state.go(\"passenger_signup.your_profile\");\n\t\t\t    \t\treturn false;\n\t\t    \t\t}\n\n\t\t    \t\tif(calculate_age($scope.formData.guardian.dob) < 18){\n\t\t    \t\t\talert(\"Your guardian needs to be over the age of 18 to legally enable you to go flying.\");\n\t\t    \t\t\t$state.go(\"passenger_signup.your_profile\");\n\t\t\t    \t\treturn false;\n\t\t    \t\t}\n\n\t\t    \t}\n\n\t\t    \t//this is the first page of verifications complete - now we need to do the NOK checks, and the TnC checks then we're good to go and create this.create\n\t\t    \tif(! $scope.formData.nok || ! $scope.formData.nok.first_name || ! $scope.formData.nok.last_name || ! $scope.formData.nok.email_address || ! $scope.formData.nok.relationship || ! $scope.formData.nok.phone_number  || ! $scope.formData.nok.address){\n\t\t    \t\t\talert(\"Your next of kin information needs to be complete - in case of an emergency, or an accident, we must be able to contact them.\");\n\t\t    \t\t\t$state.go(\"passenger_signup.next_of_kin\");\n\t\t\t    \t\treturn false;\n\t\t    \t}\n\n\t\t    \t//and now we verify the terms and conditions that have been agreed\n\n\t\t    \tif(! $scope.formData.tnc || ! $scope.formData.club_tnc){\n\t\t    \t\talert(\"Please tick to confirm that you have read, understood and agreed to the terms and conditions of both the software and the flight organisation.\");\n\t\t\t    \treturn false;\n\t\t    \t}\n\n\n\t\t    \t//if we get here we have a fully completed form and are ready to send it to create a user.\n\n\n\n\t\t    \t//let us prepare the content that needs to be sent back here:::\n\t\t    \tvar self_dob = new Date($scope.formData.dob);\n\n\t\t    \tif($scope.formData.guardian){\n\t\t\t    \t$scope.formData.guardian.dob = $scope.formData.guardian.dob.format(\"yyyy-MM-dd\")\n\t\t    \t}\n\n\t\t    \tvar to_send = {\n\t\t    \t\tuser_id: $scope.formData.user_id,\n\t\t    \t\tfirst_name: $scope.formData.first_name,\n\t\t    \t\tlast_name: $scope.formData.last_name,\n\t\t    \t\temail: $scope.formData.email,\n\t\t    \t\tdob: $scope.formData.dob.format(\"yyyy-MM-dd\"),\n\t\t    \t\tclub_id: $scope.formData.club_id,\n\t\t    \t\tclub_tnc: $scope.formData.club_tnc,\n\t\t    \t\ttnc: $scope.formData.tnc,\n\t\t    \t\tnok: $scope.formData.nok,\n\t\t    \t\tguardian: $scope.formData.guardian,\n\t\t    \t\tbooking_id: $scope.formData.booking_id,\n\t\t    \t\ttoken: $scope.formData.token,\n\t\t    \t\tmembership_id: 0,\n\t\t    \t\tinvited_by: $scope.formData.invited_by\n\t\t    \t}\n\n\t\t    \t////console.log(\"SENDING\", to_send);\n\n\n\t    \t\tUserService.ConfirmPaxInvite($stateParams.token, to_send)\n                .then(function (data) {\n                \t// //console.log(\"GET SECURE INVITE\", data);\n                \tif(data.success){\n\t\t\t\t    \t\n                \t\t//this is successful - now let's clear the contents:\n                \t\t$scope.formData = {};\n                \t\t//and let's remove the top links\n                \t\t$scope.checked_identity = false;\n\n\n                \t} else {\n                \t\talert(data.message);\n                \t\treturn false;\n                \t}\n\n                });\n\n\n\n\n\t\t    \t$state.go(\"passenger_signup.thank_you\");\n\n\n\n\n\n\n\n\t\t    }\n\n\n\n\n\n\t\t    $scope.downloadClubDocument = function(doc) {\n            var data = $.param({\n                id: doc\n            });\n\n            var ddd = doc.replace(/^.*[\\\\\\/]/, '');\n            $http.defaults.headers.common['Api-Key'] = \"eW91a25vd25vdGhpbmdqb25zbm93\";\n\n            $http.get('api/v1/term_documents/show_file/'+ddd, {\n                    responseType: 'arraybuffer'\n                })\n                .success(function(data, status, headers) {\n                    var zipName = processArrayBufferToBlob(data, headers);\n\n                    //Delete file from temp folder in server - file needs to remain open until blob is created\n                    //deleteFileFromServerTemp(zipName);\n                }).error(function(data, status) {\n                    alert(\"There was an error downloading the selected document(s).\");\n                })\n        };\n\n\n        function titlepath(path,name){\n\n        //In this path defined as your pdf url and name (your pdf name)\n            var prntWin = window.open();\n            prntWin.document.write(\"<html><head><title>\"+name+\"</title></head><body>\"\n                + '<embed width=\"100%\" height=\"100%\" name=\"plugin\" src=\"'+ path+ '\" '\n                + 'type=\"application/pdf\" internalinstanceid=\"21\"></body></html>');\n            prntWin.document.close();\n        }\n\n        function processArrayBufferToBlob(data, headers) {\n            var octetStreamMime = 'application/octet-stream';\n            var success = false;\n\n            // Get the headers\n            headers = headers();\n            //var ttt = title.toLowerCase().replace(/\\W/g, '_');\n            // Get the filename from the x-filename header or default to \"download.bin\"\n            var filename = headers['x-filename'] || 'download.zip';\n\n            // Determine the content type from the header or default to \"application/octet-stream\"\n            var contentType = headers['content-type'] || octetStreamMime;\n\n            try {\n                // Try using msSaveBlob if supported\n                var blob = new Blob([data], {\n                    //type: contentType\n                    type: 'application/pdf'\n                });\n\n                var fileURL = URL.createObjectURL(blob);\n                titlepath(fileURL, \"Secure Documents\");\n\n                // if (navigator.msSaveBlob)\n                //     navigator.msSaveBlob(blob, filename);\n                // else {\n                //     // Try using other saveBlob implementations, if available\n                //     var saveBlob = navigator.webkitSaveBlob || navigator.mozSaveBlob || navigator.saveBlob;\n                //     if (saveBlob === undefined) throw \"Not supported\";\n                //     saveBlob(blob, filename);\n                // }\n                success = true;\n            } catch (ex) {\n                $log.info(\"saveBlob method failed with the following exception:\");\n                $log.info(ex);\n            }\n\n            if (!success) {\n                // Get the blob url creator\n                var urlCreator = window.URL || window.webkitURL || window.mozURL || window.msURL;\n                if (urlCreator) {\n                    // Try to use a download link\n                    var link = document.createElement('a');\n                    if ('download' in link) {\n                        // Try to simulate a click\n                        try {\n                            // Prepare a blob URL\n                            var blob = new Blob([data], {\n                                type: contentType\n                            });\n                            var url = urlCreator.createObjectURL(blob);\n                            link.setAttribute('href', url);\n\n                            // Set the download attribute (Supported in Chrome 14+ / Firefox 20+)\n                            link.setAttribute(\"download\", filename);\n\n                            // Simulate clicking the download link\n                            var event = document.createEvent('MouseEvents');\n                            event.initMouseEvent('click', true, true, window, 1, 0, 0, 0, 0, false, false, false, false, 0, null);\n                            link.dispatchEvent(event);\n                            success = true;\n\n                        } catch (ex) {\n                            $log.info(\"Download link method with simulated click failed with the following exception:\");\n                            $log.info(ex);\n                        }\n                    }\n\n                    if (!success) {\n                        // Fallback to window.location method\n                        try {\n                            // Prepare a blob URL\n                            // Use application/octet-stream when using window.location to force download\n                            var blob = new Blob([data], {\n                                type: octetStreamMime\n                            });\n                            var url = urlCreator.createObjectURL(blob);\n                            window.location = url;\n                            success = true;\n                        } catch (ex) {\n                            $log.info(\"Download link method with window.location failed with the following exception:\");\n                            $log.info(ex);\n                        }\n                    }\n                }\n            }\n\n            if (!success) {\n                // Fallback to window.open method\n                $log.info(\"No methods worked for saving the arraybuffer, using last resort window.open\");\n                window.open(httpPath, '_blank', '');\n            }\n            return filename;\n        };\n\n\n\n\n\n\n\n\n\n\n\t\t   $scope.formcode = [];\n\t\t   $scope.checkedcode = 0;\n\t\t   $scope.goToNextInput = function(event, number) {\n\t\t   \t // //console.log(event.keyCode);\n\t\t   \t // //console.log(number);\n\t\t   \t var no_len = document.getElementById(\"index\"+(number - 1) ).value;\n\t\t   \t // //console.log(no_len.toString().length);\n\n\t\t   \t // //console.log(document.getElementById(\"index\"+(number - 1) ).value);\n\t\t   \t\n\n\n\t\t   \t if(number == 1 && (event.keyCode == 91 || event.keyCode == 17) && no_len.toString().length == 6){\n\t\t   \t \t// //console.log(\"MATCHINGS\", );\n\t\t   \t \tvar thecode = Array.from(no_len.toString());\n\t\t   \t \tfor(var i=0; i<6; i++){\n\t\t   \t \t\t$scope.formcode.push(parseInt(thecode[i]));\n\t\t   \t \t}\n\n\t\t   \t \tdocument.getElementById(\"index5\").focus();\n\t\t   \t \tnumber =6;\n\t\t   \t\t//return false;\n\t\t   \t } else {\n\t\t   \t \t\t//event.keyCode\n\t\t\t\t   \tif(event.keyCode == 37 && number > 0){\n\t\t\t\t   \t\tdocument.getElementById(\"index\"+(number - 2)).focus();\n\t\t\t\t   \t\treturn false;\n\t\t\t\t   \t}\n\t\t\t\t   \tif(event.keyCode == 39 && number < 6){\n\t\t\t\t   \t\tdocument.getElementById(\"index\"+(number)).focus();\n\t\t\t\t   \t\treturn false;\n\t\t\t\t   \t}\n\t\t\t\t   \tif(event.keyCode == 8 && number > 1 && document.getElementById(\"index\"+(number - 1) ).value == \"\"){\n\t\t\t\t   \t\t// //console.log(\"match\");\n\t\t\t\t   \t\t// //console.log(\"index\"+(number - 2));\n\t\t\t\t   \t\tdocument.getElementById(\"index\"+(number - 2)).focus();\n\t\t\t\t   \t\treturn false;\n\t\t\t\t   \t}\n\t\t   \t }\n\n\n\t\t   \n\n\n\t\t   \tif(number == 6 && $scope.formcode.length == 6){\n\t\t   \t\tvar combine = $scope.formcode.join(\"\");\n\t\t   \t\t// //console.log(\"COMPLETE\", combine);\n\t\t   \t\t$scope.checkedcode++;\n\t\t   \t\t// //console.log(\"tries\", $scope.checkedcode);\n\n\t\t   \t\tif($scope.checkedcode > 4){\n\t\t   \t\t\talert(\"Sorry - you have tried too many times, this code is now invalid and a new invitation will be sent to you.\");\n\n\t\t   \t\t\t//send another invitation code to the recipient \n\n\n\n\t\t   \t\t\treturn false;\n\t\t   \t\t} else {\n\n\t\t   \t\t\t//let's send this out for verification!!\n\t\t   \t\t\tUserService.GetPaxSecureInvite($stateParams.token, combine)\n\t                .then(function (data) {\n\t                \t// //console.log(\"GET SECURE INVITE\", data);\n\t                \tif(data.success){\n\n\t                \t\tif(data.invitation.is_already_user){\n\n\t                \t\t\t$scope.is_already_user = true;\n\n\t\t\t\t\t\t\t\t$scope.formData.user_id = data.invitation.user_id;\n\t\t\t\t\t\t\t\t// //console.log(\"UID\", $scope.formData.user_id);\n\t\t\t\t\t\t\t\t$scope.formData.first_name = data.invitation.user.first_name;\n\t                \t\t\t$scope.formData.last_name = data.invitation.user.last_name;\n\t                \t\t\t$scope.formData.email = data.invitation.user.email;\n\t                \t\t\t$scope.formData.dob = new Date(data.invitation.user.dob);\n\t                \t\t\t$scope.formData.club = data.invitation.club;\n\t                \t\t\t$scope.formData.guardian = data.invitation.user.guardian;\n\t                \t\t\t$scope.formData.nok = data.invitation.user.nok;\n\t                \t\t\t$scope.formData.membership_id = data.invitation.membership_id;\n\t                \t\t\t$scope.formData.club_id = data.invitation.club_id;\n\t                \t\t\t$scope.formData.token = data.invitation.invitation_token;\n\t                \t\t\t$scope.formData.status = data.invitation.status;\n\t                \t\t\t$scope.formData.invited_by = data.invitation.invited_by;\n\t                \t\t\t$scope.formData.booking_id = data.invitation.booking_id;\n\n\t                \t\t\tif(data.invitation.user.guardian && data.invitation.user.guardian.first_name !== \"\"){\n\t                \t\t\t\t$scope.guardian = true;\n\t                \t\t\t}\n\n\t                \t\t} else {\n\n\t                \t\t\t$scope.formData.first_name = data.invitation.first_name;\n\t                \t\t\t$scope.formData.last_name = data.invitation.last_name;\n\t                \t\t\t$scope.formData.email = data.invitation.email;\n\t                \t\t\t$scope.formData.membership_id = data.invitation.membership_id;\n\t                \t\t\t$scope.formData.club_id = data.invitation.club_id;\n\t                \t\t\t$scope.formData.token = data.invitation.invitation_token;\n\t                \t\t\t$scope.formData.status = data.invitation.status;\n\t                \t\t\t$scope.formData.invited_by = data.invitation.invited_by;\n\t                \t\t\t$scope.formData.booking_id = data.invitation.booking_id;\n\t                \t\t\t$scope.formData.club = data.invitation.club;\n\n\t                \t\t}\n\n\t                \t\t$scope.checked_identity = true;\n\t                \t\t$state.go(\"passenger_signup.your_profile\");\n\n\t                \t} else {\n\t                \t\talert(data.message);\n\t                \t\treturn false;\n\t                \t}\n\n\t                });\n\n\n\t\t   \t\t}\n\n\n\t\t   \t\treturn false;\n\t\t   \t}\n\n\n\t\t    var entry = document.getElementById(\"index\"+(number - 1) ).value;\n\t\t    if(entry > -1 && entry < 10 && entry !== \"\"){\n\t\t    \tdocument.getElementById(\"index\"+number).focus();\n\t\t    } else {\n\t\t    \tdocument.getElementById(\"index\"+(number - 1) ).value = \"\";\n\t\t    \tdocument.getElementById(\"index\"+(number - 1)).focus();\n\t\t    \treturn false;\n\t\t    }\n\n\t\t  }\n\n\t\t\n\n\n\n\n\n\t\t    // $scope.submit_button_data = function(){\n\t\t    // \tif($scope.formData.password && $scope.formData.password !== \"\" && $scope.formData.password == $scope.formData.password2){\n\n\t     //    \t\t$scope.submit_button = \"SUBMIT INFORMATION & CREATE YOUR ACCOUNT\";\n\t        \t\n\t     //    \t} else {\n\t     //    \t\t$scope.submit_button = \"SUBMIT INFORMATION & GO FLYING\";\n\t     //    \t}\n\t\t    // }\n\n\n\n\n\n\n\n\n\n\n\n   //       \t$scope.clubs = { clubs: [\n\t\t\t//     \t{\n\t\t\t//     \t\tid: 1,\n\t\t\t//     \t\ttitle: \"Alouette Flying Club\"\n\t\t\t//     \t},\n\t\t\t//     \t{\n\t\t\t//     \t\tid: 2,\n\t\t\t//     \t\ttitle: \"EFG Flying Club\"\n\t\t\t//     \t},\n\t\t\t//     \t{\n\t\t\t//     \t\tid: 3,\n\t\t\t//     \t\ttitle: \"Surrey & Kent Flying Club\"\n\t\t\t//     \t},\n\t\t\t//     \t{\n\t\t\t//     \t\tid: 4,\n\t\t\t//     \t\ttitle: \"Arrow Flight Club\"\n\t\t\t//     \t},\n\t\t\t//     \t{\n\t\t\t//     \t\tid: 5,\n\t\t\t//     \t\ttitle: \"Cirrus Flying Club\"\n\t\t\t//     \t}\n\t\t //    \t]\t\t    \t\n\t\t //    };\n\n\n\t\t //    $scope.memberships = { memberships: [\n\t\t\t//     \t{\n\t\t\t//     \t\tid: 1,\n\t\t\t//     \t\ttitle: \"honory membership\"\n\t\t\t//     \t},\n\t\t\t//     \t{\n\t\t\t//     \t\tid: 2,\n\t\t\t//     \t\ttitle: \"day membership\"\n\t\t\t//     \t},\n\t\t\t//     \t{\n\t\t\t//     \t\tid: 3,\n\t\t\t//     \t\ttitle: \"social membership\"\n\t\t\t//     \t},\n\t\t\t//     \t{\n\t\t\t//     \t\tid: 4,\n\t\t\t//     \t\ttitle: \"full flying membership\"\n\t\t\t//     \t},\n\t\t\t//     \t{\n\t\t\t//     \t\tid: 5,\n\t\t\t//     \t\ttitle: \"temporary flying membership\"\n\t\t\t//     \t}\n\t\t //    \t]\t\t    \t\n\t\t //    };\n\n\t\t //    $scope.state = { state: [\n\t\t\t//     \t{\n\t\t\t//     \t\tid: 2,\n\t\t\t//     \t\ttitle: \"France\"\n\t\t\t//     \t},\n\t\t\t//     \t{\n\t\t\t//     \t\tid: 3,\n\t\t\t//     \t\ttitle: \"Netherlands\"\n\t\t\t//     \t},\n\t\t\t//     \t{\n\t\t\t//     \t\tid: 4,\n\t\t\t//     \t\ttitle: \"Germany\"\n\t\t\t//     \t},\n\t\t\t//     \t{\n\t\t\t//     \t\tid: 5,\n\t\t\t//     \t\ttitle: \"Spain\"\n\t\t\t//     \t}\n\t\t //    \t]\t\t    \t\n\t\t //    };\n\n\t\t //    $scope.licenses = { licenses: [\n\t\t\t//     \t{\n\t\t\t//     \t\tid: 1,\n\t\t\t//     \t\ttitle: \"EASA PPL\"\n\t\t\t//     \t},\n\t\t\t//     \t{\n\t\t\t//     \t\tid: 2,\n\t\t\t//     \t\ttitle: \"EASA CPL\"\n\t\t\t//     \t},\n\t\t\t//     \t{\n\t\t\t//     \t\tid: 3,\n\t\t\t//     \t\ttitle: \"EASA ATPL\"\n\t\t\t//     \t},\n\t\t\t//     \t{\n\t\t\t//     \t\tid: 4,\n\t\t\t//     \t\ttitle: \"UK NPPL\"\n\t\t\t//     \t},\n\t\t\t//     \t{\n\t\t\t//     \t\tid: 5,\n\t\t\t//     \t\ttitle: \"FAA SPL\"\n\t\t\t//     \t}\n\t\t //    \t]\t\t    \t\n\t\t //    };\n\n\t\t //    $scope.medicals = { medicals: [\n\t\t\t//     \t{\n\t\t\t//     \t\tid: 1,\n\t\t\t//     \t\ttitle: \"EASA MEDICAL\"\n\t\t\t//     \t},\n\t\t\t//     \t{\n\t\t\t//     \t\tid: 2,\n\t\t\t//     \t\ttitle: \"UK MEDICAL EXAMINATION\"\n\t\t\t//     \t},\n\t\t\t//     \t{\n\t\t\t//     \t\tid: 3,\n\t\t\t//     \t\ttitle: \"FAA MEDICAL\"\n\t\t\t//     \t},\n\t\t\t//     \t{\n\t\t\t//     \t\tid: 4,\n\t\t\t//     \t\ttitle: \"NZ CAA MEDICAL\"\n\t\t\t//     \t},\n\t\t\t//     \t{\n\t\t\t//     \t\tid: 5,\n\t\t\t//     \t\ttitle: \"FAA SPL MEDICAL\"\n\t\t\t//     \t}\n\t\t //    \t]\t\t    \t\n\t\t //    };\n\n\t\t //    $scope.person = {};\n\n\t\t //    $scope.person.selectedSingle = 'Samantha';\n\t\t //  \t$scope.person.selectedSingleKey = '5';\n\n\t\t //  \t$scope.people = [\n\t\t\t//     { name: 'Adam',      email: 'adam@email.com',      age: 12, country: 'United States' },\n\t\t\t//     { name: 'Amalie',    email: 'amalie@email.com',    age: 12, country: 'Argentina' },\n\t\t\t//     { name: 'Estefana', email: 'estefania@email.com', age: 21, country: 'Argentina' },\n\t\t\t//     { name: 'Adrian',    email: 'adrian@email.com',    age: 21, country: 'Ecuador' },\n\t\t\t//     { name: 'Wladimir',  email: 'wladimir@email.com',  age: 30, country: 'Ecuador' },\n\t\t\t//     { name: 'Samantha',  email: 'samantha@email.com',  age: 30, country: 'United States' },\n\t\t\t//     { name: 'Nicole',    email: 'nicole@email.com',    age: 43, country: 'Colombia' },\n\t\t\t//     { name: 'Natasha',   email: 'natasha@email.com',   age: 54, country: 'Ecuador' },\n\t\t\t//     { name: 'Michael',   email: 'michael@email.com',   age: 15, country: 'Colombia' },\n\t\t\t//     { name: 'Nicols',   email: 'nicolas@email.com',    age: 43, country: 'Colombia' }\n\t\t //  \t];\n\n\n\n\n\n\t\t //    $scope.ratings = { ratings: [\n\t\t\t    \t\n\t\t\t// \t\t{\n\t\t\t//     \t\tid: 1,\n\t\t\t//     \t\ttitle: \"SEP (land)\"\n\t\t\t//     \t},\n\t\t\t//     \t{\n\t\t\t//     \t\tid: 2,\n\t\t\t//     \t\ttitle: \"SEP (sea)\"\n\t\t\t//     \t},\n\t\t\t//     \t{\n\t\t\t//     \t\tid: 3,\n\t\t\t//     \t\ttitle: \"MEP (land)\"\n\t\t\t//     \t},\n\t\t\t//     \t{\n\t\t\t//     \t\tid: 4,\n\t\t\t//     \t\ttitle: \"MEP (sea)\"\n\t\t\t//     \t},\n\t\t\t    \t\n\t\t\t//     \t{\n\t\t\t//     \t\tid: 1,\n\t\t\t//     \t\ttitle: \"Night Rating\"\n\t\t\t//     \t},\n\t\t\t//     \t{\n\t\t\t//     \t\tid: 2,\n\t\t\t//     \t\ttitle: \"Instrument Rating Restricted IR(r)\"\n\t\t\t//     \t},\n\t\t\t//     \t{\n\t\t\t//     \t\tid: 3,\n\t\t\t//     \t\ttitle: \"Instrument Rating\"\n\t\t\t//     \t},\n\t\t\t//     \t{\n\t\t\t//     \t\tid: 4,\n\t\t\t//     \t\ttitle: \"Aerobatics Rating\"\n\t\t\t//     \t},\n\t\t\t//     \t{\n\t\t\t//     \t\tid: 5,\n\t\t\t//     \t\ttitle: \"High Performance Aircraft Rating\"\n\t\t\t//     \t}\n\t\t //    \t]\t\t    \t\n\t\t //    };\n\n\t\t //    $scope.differences = { differences: [\n\t\t\t//     \t{\n\t\t\t//     \t\tid: 1,\n\t\t\t//     \t\ttitle: \"Variable Pitch\"\n\t\t\t//     \t},\n\t\t\t//     \t{\n\t\t\t//     \t\tid: 2,\n\t\t\t//     \t\ttitle: \"Retractable Gear\"\n\t\t\t//     \t},\n\t\t\t//     \t{\n\t\t\t//     \t\tid: 3,\n\t\t\t//     \t\ttitle: \"Turbo Differences Training\"\n\t\t\t//     \t},\n\t\t\t//     \t{\n\t\t\t//     \t\tid: 4,\n\t\t\t//     \t\ttitle: \"EFIS Differences Training\"\n\t\t\t//     \t}\n\t\t //    \t]\t\t    \t\n\t\t //    };\n\n\n\t\t //    //may need to alter this one to reflect most common one depending on\n\t\t //    //the license type\n\t\t //    $scope.formData = {\n\t\t //    \tpassenger: {}\n\t\t //    };\n\n\t\t //    var calculate_age = function(birthday) { // birthday is a date\n\t\t //    \t//console.log(birthday);\n\t\t\t//     var ageDifMs = Date.now() - birthday.getTime();\n\t\t\t//     var ageDate = new Date(ageDifMs); // miliseconds from epoch\n\t\t\t//     return Math.abs(ageDate.getUTCFullYear() - 1970);\n\t\t\t// }\n\n\t\t\t// $scope.validate_age = function(under, over){\n\t\t\t// \tif(checking_validity()){\n\t\t\t// \t\t//console.log($scope.formData.passenger);\n\t\t\t// \t\tvar age = calculate_age($scope.formData.passenger.dob);\n\t\t\t// \t\t//console.log(\"age is : \"+age);\n\t\t\t// \t\tif(age < 18){\n\t\t\t// \t\t\t$state.go(under);\n\t\t\t// \t\t} else {\n\t\t\t// \t\t\t$state.go(over);\n\t\t\t// \t\t}\n\t\t\t// \t}\n\t\t\t// }\n\n\t\t //    $scope.add_element = function(bit_type){\n\n\t\t //    \t//remove from first array\n\t\t //    \t$scope[bit_type][bit_type] = $.grep($scope[bit_type][bit_type], function(e){ \n\t\t\t// \t\treturn e.id != $scope.formData.license.add_to[bit_type].id; \n\t\t\t// \t});\n\n\t\t //    \tif(bit_type == \"differences\"){\n\t\t //    \t\t$scope.formData.license.add_to[bit_type].day = true;\n\t\t //    \t\t$scope.formData.license.add_to[bit_type].vfr = true;\n\t\t //    \t}\n\t\t //    \t//console.log($scope.formData.license.add_to[bit_type]);\n\n\t\t //    \t$scope.formData.license[bit_type].push($scope.formData.license.add_to[bit_type]);\n\t\t    \t\n\t\t //    \t//clean the array to show what we want to show :)\n\t\t //    \tdelete $scope.formData.license.add_to[bit_type];\n\n\t\t //    }\n\n\n\t\t //    $scope.remove_element = function(bit_type, index){\n\n\t\t \n \t\t// \t\t//add to dropdown\n\t\t\t// \t$scope[bit_type][bit_type].push($scope.formData.license[bit_type][index]);\n\n\t\t    \n\t\t\t// \t$scope.formData.license[bit_type].splice(index,1)\n\n\t\t //    \t$scope.formData.license[bit_type] = $scope.formData.license[bit_type].filter(Boolean);\n\t\t //    \t//console.log($scope.formData.license[bit_type]);\n\t\t //    \t//$scope.formData.license[bit_type].push($scope.formData.license.add_to[bit_type]);\n\n\t\t //    }\n\n\t\t //    var checking_validity = function(){\n\t\t //    \tif(! $('#signup-form')[0].checkValidity()){\n\t\t //    \t\t$(\".ng-pristine\").not(\".ng-valid\").removeClass(\"ng-pristine\").addClass(\"ng-invalid\");\n\t\t //    \t\t//console.log(\"STOP\");\n\t\t //    \t\treturn false;\n\t\t //    \t} else {\n\t\t //    \t\tif(!$scope.formData.passenger){\n\t\t\t// \t    \t\t$state.go(\"user_signup.your_profile\");\n\t\t //    \t\t}\n\t\t //    \t\t// if($scope.formData.user.password == $scope.formData.user.password2){\n\t\t\t//     \t// \t$state.go(uisref);\n\t\t //    \t\t// } else {\n\t\t\t//     \t// \t$(\"input[type='password']\").removeClass(\"ng-pristine\").addClass(\"ng-invalid\");\n\t\t //    \t\t// \treturn false;\n\t\t //    \t\t// }\n\t\t //    \t}\n\t\t //    \treturn true;\n\t\t //    }\n\t\t    \n\t\t //    $scope.checkValid = function(uisref){\n\t\t //    \tif(!uisref){\n\t\t //    \t\tuisref = $(\".btn-info\").attr(\"one-ui-sref\");\n\t\t //    \t}\n\t\t //    \t//if less than 18 show the guardian form\n\t\t //    \tif(checking_validity()){\n\t\t\t//     \tif($scope.formData.passenger.password == $scope.formData.passenger.password2){\n\t\t\t//     \t\t$state.go(uisref);\n\t\t //    \t\t} else {\n\t\t\t//     \t\t$(\"input[type='password']\").removeClass(\"ng-pristine\").addClass(\"ng-invalid\");\n\t\t //    \t\t\treturn false;\n\t\t //    \t\t}\n\t\t\t//     \t//console.log($('#signup-form')[0].checkValidity());\n\t\t\t//     } else {\n\t\t\t//     \treturn false;\n\t\t\t//     }\n\t\t    \t\n\t\t //    }\n\n\n\t\t //    // function to process the form\n\t\t //    $scope.processForm = function() {\n\t\t //         if ($scope.formData.$valid) {\n\t  //               alert('our form is amazing');\n\t  //           } \n\t\t //    };\n\n    }\n\n\n\n\n\n\n\n app.controller('PasswordResetController', PasswordResetController);\n\n    PasswordResetController.$inject = ['UserService', '$rootScope', '$location', '$scope', '$state', '$stateParams', '$uibModal', '$log', '$window', 'PoidService',  'LicenceService', 'MedicalService', 'DifferencesService', 'AuthenticationService'];\n    function PasswordResetController(UserService, $rootScope, $location, $scope, $state, $stateParams, $uibModal, $log, $window, PoidService,  LicenceService, MedicalService, DifferencesService, AuthenticationService) {\n        var vm = this;\n\n       \n        vm.show_error = false;\n        vm.show_error2 = false;\n\n        vm.show_thankyou = false;\n\n        $scope.password_reset = function(){\n\n\n\n\n\n            if (/^\\w+([\\.-]?\\w+)*@\\w+([\\.-]?\\w+)*(\\.\\w{2,3})+$/.test(vm.email)){\n\n                  AuthenticationService.ResetPassword(vm.email, function(data){\n                        ////console.log(data);\n                        vm.show_thankyou = true;\n                        vm.show_error = false;\n\n                    });\n\n            } else {\n\n                vm.show_error = true;\n\n            }\n\n          \n        }\n\n        $scope.go_login = function(){\n            $location.path(\"/login\");\n        }\n\n        $scope.password_reset2 = function(){\n\n            if(vm.password == \"\"){\n                vm.show_error = true;\n                return false;\n            }\n\n            if(vm.password.length < 8){\n                vm.show_error2 = true;\n                return false;\n\n            }\n\n            var strongPassword = new RegExp('(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[^A-Za-z0-9])(?=.{8,})')\n            if(strongPassword.test(vm.password)) {\n              //console.log(\"password strength OK\");\n            } else {\n              vm.show_error = true;\n              alert(\"Your password must be at least 8 characters in length, contain 1 uppercase, 1 lowercase, 1 number, and 1 special character\");\n              return false;\n            }\n\n                AuthenticationService.ResetPassword2(vm.password, $stateParams.token, function(data){\n                        ////console.log(data);\n                        vm.show_thankyou = true;\n                        vm.show_error = false;\n                        vm.show_error2 = false;\n\n                        vm.thank_you = data.message;\n\n\n                    });\n\n        }\n\n    \n\n         \n\n\n    }\n app.controller('RefundModalInstanceCtrl', RefundModalInstanceCtrl);\n\n    RefundModalInstanceCtrl.$inject = ['$scope', '$uibModalInstance', 'id', 'warning', 'params'];\n    function RefundModalInstanceCtrl($scope, $uibModalInstance, id, warning, params=null) {         \n\n            $scope.warning = warning;\n            $scope.params = params;\n            //console.log(\"APARAMS\", params);\n\n            $scope.to_refund = 0;\n            $scope.reason = \"\";\n            $scope.remaining = (params.amount - params.amount_refunded);\n\n\n\n          $scope.ok = function () {\n            var obj = params;\n            obj.reason = $scope.reason;\n            obj.to_refund = $scope.to_refund\n            $uibModalInstance.close(obj);\n          };\n\n          $scope.cancel = function () {\n            $uibModalInstance.dismiss('cancel');\n          };\n\n          $scope.params = function(params){\n            return params;\n          }\n\n\n    }\napp.controller('RegisterController', RegisterController);\n \n    RegisterController.$inject = ['UserService', '$location', '$rootScope', 'FlashService', '$stateParams'];\n    function RegisterController(UserService, $location, $rootScope, FlashService, $stateParams) {\n        var vm = this;\n        vm.verify_status = \"\";\n \n        vm.register = register;\n \n        function register() {\n            vm.dataLoading = true;\n            UserService.Create(vm.user)\n                .then(function (response) {\n                    if (response.success) {\n                        FlashService.Success('Registration successful', true);\n                        $location.path('/registration_success');\n                    } else {\n                        FlashService.Error(response.error);\n                        vm.dataLoading = false;\n                    }\n                });\n        }\n\n\n        if($stateParams.token && $stateParams.userId){\n\n            //console.log(\"THIS IS A VERIFY TOKEN\");\n\n             UserService.Verify($stateParams.userId, $stateParams.token)\n                .then(function (response) {\n                    if (response.success) {\n                        vm.title = \"Thank You!\";\n                        vm.verify_status = \"Your email address has been verified.\";\n                    } else {\n                        vm.title = \"Sorry!\";\n                        vm.verify_status = \"Sorry - something went wrong here! Please try clicking the link your email again. Should this still be a problem, please contact support.\";\n                    }\n                });\n\n        }            \n\n\n           \n\n\n    \n\n\n\n\n\n\n\n    }\n\n app.controller('ReviewBookingsController', ReviewBookingsController);\n\n    ReviewBookingsController.$inject = ['UserService','$cookieStore', 'BookingService', 'BookoutService', '$rootScope','$scope',  '$location', 'AuthenticationService'];\n    function ReviewBookingsController(UserService, $cookieStore, BookingService, BookoutService, $rootScope, $scope, $location, AuthenticationService) {\n        var vm = this;\n\n        if(!$rootScope.globals.currentUser){\n            AuthenticationService.CheckLoggedIn()\n            .then(function(data){\n                //console.log(\"DATA : \", data);\n            });\n        }\n\n        vm.user = $rootScope.globals.currentUser;\n        // //console.log(\"ROOTSCOPE\", $rootScope.globals);\n\n         //CheckLoggedIn\n\n        vm.bookings = [];\n        \n        // //console.log(\"vmuser\", vm.user);\n        vm.allUsers = [];\n\n        vm.clubs = [];\n\n        var defaultStartTime = 480;\n        var defaultEndTime = 1080;\n        //calendar dates setup\n        var newDate = new Date();\n        var h_start = Math.floor( defaultStartTime / 60 );          \n        var i_start = defaultStartTime % 60;\n        var h_end = Math.floor( defaultEndTime / 60 );          \n        var i_end = defaultEndTime % 60;\n        var defaultStart = new Date(newDate.getFullYear(), newDate.getMonth(), newDate.getDate(), h_start, i_start, 0);\n        var defaultEnd = new Date(newDate.getFullYear(), newDate.getMonth(), newDate.getDate(), h_end, i_end, 0);\n        vm.default_date =  new Date();\n\n        initController();\n\n        function initController() {\n           //console.log(\"check if access is okay\");\n        }\n\n\n\n\n        //vm.default_date\n\n        function get_the_approval_list(){\n            BookingService.GetBookingsToReview(vm.user.id)\n                    .then(function(data){\n\n                        vm.bookings = data.bookings;   \n                        \n                    });\n        }\n        get_the_approval_list();\n\n        $scope.all_events = [];\n        $scope.all_resources = [];\n\n        // BookingService.GetAllInstructor(vm.user.id, moment().format(\"Y-M-D\"), \"\")\n        //     .then(function(data){\n        //         $scope.all_events = data.events;\n        //         $scope.all_resources = data.resources;\n\n        //         $('#calendar').fullCalendar('refetchEvents');\n        //         $('#calendar').fullCalendar('removeEvents');\n        //         $('#calendar').fullCalendar('addEventSource', $scope.all_events);\n\n        //     });\n\n\n\n\n        $scope.approve_booking = function(id){\n\n            //approve me pleaseeeee\n            BookingService.AcceptBooking(id, vm.user.id)\n            .then(function(data){\n                // //console.log(data);\n                // //console.log(\"This has been approved...\");\n                get_the_approval_list();\n\n            });\n        }\n\n        $scope.decline_booking = function(id){\n\n            //decline me pleaseeeee\n            BookingService.DeclineBooking(id, vm.user.id, {})\n            .then(function(data){\n                // //console.log(data);\n                // //console.log(\"This has been decline...\");\n                get_the_approval_list();\n                \n            });\n\n        }\n\n        $scope.view_booking = function(id, start){\n\n            //decline me pleaseeeee\n            BookingService.GetAllInstructor(vm.user.id, start, \"\")\n            .then(function(data){\n                //console.log(data);\n\n                // vm.default_date = new Date(start);\n                // //console.log(\"DATE\", vm.default_date);\n                $(\"#calendar\").fullCalendar(\"gotoDate\", vm.default_date);\n\n\n                //VERY hacky... not good - but it scrolls to the right place... maybe add a \n\n                var w = parseInt($('a.fc-timeline-event.booking'+id).css(\"left\"));\n                var b = parseInt($('a.fc-timeline-event.booking'+id).width());\n                 let offsetEvent = w + (b/2) - ($('tbody .fc-time-area .fc-scroller').width()  / 2);\n\n                $('tbody .fc-time-area .fc-scroller').animate({\n                    scrollLeft:  offsetEvent\n                }, 600);\n\n\n                $scope.all_events = data.events;\n                $scope.all_resources = data.resources;\n\n                //animate the colour change\n                $('a.fc-timeline-event.booking'+id).removeClass(\"highlight_item\");\n                setTimeout(function(){\n                    $('a.fc-timeline-event.booking'+id).addClass(\"highlight_item\");\n                }, 200);\n\n                // //console.log(\"hello\", $scope.all_events);\n                // //console.log(\"hello\", $scope.all_resources);\n\n                return data;\n\n            });\n\n        }\n\n\n\n        //copy from the bookignsController\n        $scope.updateEvents = function(start, end){\n        ////console.log(\"start\", start, \"end\", end);\n\n        BookingService.GetAllInstructor(vm.user.id, start, end)\n        .then(function(data){\n            //console.log(data);\n\n            $scope.all_events = data.events;\n            $scope.all_resources = data.resources;\n\n            // //console.log(\"hello\", $scope.all_events);\n            // //console.log(\"hello\", $scope.all_resources);\n\n            return data;\n\n        });\n    }\n\n    /* Render Tooltip */\n    $scope.eventRender = function( event, element, view ) {\n        element.attr({'tooltip': event.title,\n                      'tooltip-append-to-body': true});\n        $compile(element)($scope);\n    };\n\n    \n    $scope.alertOnClicked = function(calEvent, jsEvent, view){\n            \n            vm.see_booking = calEvent;\n\n            vm.see_booking.start_date = moment(vm.see_booking.start).format(\"DD/MM/YYYY\");\n            vm.see_booking.end_date = moment(vm.see_booking.end).format(\"DD/MM/YYYY\");\n            vm.see_booking.start_time = moment(vm.see_booking.start).format(\"HH:mm\");\n            vm.see_booking.end_time = moment(vm.see_booking.end).format(\"HH:mm\");\n\n            vm.see_booking.start_datetime = new Date(new Date(vm.see_booking.start).toUTCString());\n            vm.see_booking.end_datetime = new Date(vm.see_booking.end);\n            vm.see_booking.visible = 1;\n            vm.see_booking.can_be_edited = moment().isAfter(moment(vm.see_booking.end));\n\n            $scope.$apply();\n    };\n\n    $scope.changeLang = function() {\n    \n        $scope.uiConfig.calendar.dayNames = [\"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\"];\n        $scope.uiConfig.calendar.dayNamesShort = [\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"];\n      \n    };\n\n    $scope.changed = function () {\n        $log.log('Time changed to: ' + $scope.mytime);\n        $scope.check_plane_availability();\n    };\n\n    $scope.check_plane_availability = function(){\n       \n        generate_datetimes();\n\n        //getALL?\n        var getA = (vm.new_booking.edit_booking == 1)? 1 : 0;\n        var plane_id = (vm.new_booking.plane_id > 0)? vm.new_booking.plane_id : 0;\n        if(vm.new_booking.plane && vm.new_booking.plane.id){\n            plane_id = vm.new_booking.plane.id;\n        }\n\n        // //console.log(\"START\", vm.new_booking.start_datetime);\n        console.log(\"START REVIEWBOOKINGS\", new Date(vm.new_booking.start_datetime).toIsoString());\n        // //console.log(\"END\", vm.new_booking.end_datetime);\n\n        BookingService.GetAllPlanes(vm.user.id, vm.new_booking.start_datetime, vm.new_booking.end_datetime, 0, plane_id)\n        .then(function(data){\n           \n            //this gets the events and bookings for the period checked here...\n            // var events = data.events;\n            vm.planes = data;\n            \n\n            if(getA == 1){\n                //then I just want to iterate through these and return the plane already selected as \"available...\"\n\n                ////console.log(\"PLANE\", vm.new_booking.plane);\n\n                for(var i = 0; i<vm.planes.length; i++){\n                    if(vm.planes[i].id == vm.new_booking.plane.id){\n                        reset_chosen = 0;\n                        vm.new_booking.plane = vm.planes[i];\n                        //chosen is still available WOOOO\n                        $scope.check_rental_items();\n                    }\n                }\n\n\n\n            } else {\n\n                 //check if anything was already selected...\n                var reset_chosen = 1;\n                if(vm.new_booking.plane){\n                    for(var i = 0; i<vm.planes.length; i++){\n                        if(vm.planes[i].id == vm.new_booking.plane.id){\n                            reset_chosen = 0;\n                            //chosen is still available WOOOO\n                            $scope.check_rental_items();\n                        }\n                    }\n                    if(reset_chosen == 1){\n                        //then we just need to clear currently selected plane\n                        vm.new_booking.plane = {};\n                        delete(vm.new_booking.plane);\n                    }\n                    //otherwise we can leave that we've already done! :)\n                }\n\n\n            }\n\n        });\n\n    }\n\n    $scope.events = [];\n\n    function getDayClass(data) {\n        var date = data.date,\n          mode = data.mode;\n        if (mode === 'day') {\n          var dayToCheck = new Date(date).setHours(0,0,0,0);\n\n          for (var i = 0; i < $scope.events.length; i++) {\n            var currentDay = new Date($scope.events[i].date).setHours(0,0,0,0);\n\n            if (dayToCheck === currentDay) {\n              return $scope.events[i].status;\n            }\n          }\n        }\n\n        return '';\n      }\n\n\n    $scope.addOne = function(){\n        $state.go('dashboard.bookings.add');\n    }\n\n    $scope.cancel_changes = function(){\n        //$state.go('dashboard.bookings');\n    }\n\n    $scope.check_rental_items = function(){\n        generate_datetimes();\n\n        vm.rental_items = [];\n\n        if(vm.new_booking.plane){\n\n            var club_id = (vm.new_booking.edit_booking == 1) ? vm.new_booking.club_id : vm.new_booking.plane.club_id;\n\n            BookingService.GetRentalItems(club_id, moment(vm.new_booking.start_datetime).format(\"Y-M-D HH:mm\"), moment(vm.new_booking.end_datetime).format(\"Y-M-D HH:mm\"), 0)\n            .then(function(data){\n           \n                vm.rental_items = data;\n\n                if(vm.new_booking.rental_items){\n                    //then we may have shizzle to check / update\n                    for(var i=0;i<vm.new_booking.rental_items;i++){\n                        //first and foremost we need to check the available bits....\n                        var found = 0;\n                        for(var j=0;j<vm.rental_items.length;j++){\n                            if(vm.rental_items[j][\"id\"] == vm.new_booking.rental_items[i][\"id\"]){\n                                //then we need to check that the current numbers available are still the same as before...\n                                if(parseInt(vm.new_booking.rental_items[i][\"number_to_book\"]) > parseInt(vm.rental_items[j][\"number_available\"])){\n                                    vm.new_booking.rental_items[i][\"number_to_book\"] = parseInt(vm.rental_items[j][\"number_available\"]);\n                                }\n                                vm.new_booking.rental_items[i][\"number_available\"] = parseInt(vm.rental_items[j][\"number_available\"]);\n                                found = 1;\n                                break;\n                            }\n                        }\n                        if(found == 0){\n                            //then we need to remove it...\n                            delete vm.new_booking.rental_items[i];\n                        }\n\n                    }\n\n                }\n\n\n                for(var k=0; k<vm.rental_items.length;k++){\n                    vm.rental_items[k].number = 0;\n                }\n\n                //if there is one already selected?\n                //check if anything was already selected...\n                if(vm.new_booking.rental_items){\n                    for(var j=0; j<vm.new_booking.rental_items; j++){\n                        var reset_chosen = 1;\n                        for(var i = 0; i<vm.rental_items.length; i++){\n                            if(vm.rental_items[i].id == vm.new_booking.rental_items[j].id){\n                                reset_chosen = 0;\n                                //chosen is still available WOOOO\n                            }\n                        }\n                        if(reset_chosen == 1){\n                            //then we just need to clear currently selected plane\n                            delete vm.new_booking.rental_items[j];\n                        }\n                    }\n                    //otherwise we can leave that we've already done! :)\n                }\n\n\n\n\n            });\n\n        }\n    }\n\n\n    $scope.update_booking = function(valid){\n        generate_datetimes();\n\n        if(valid){\n\n                // //console.log(\"VALID SUBMISSION\");\n                // //console.log(\"START\", vm.new_booking.start_datetime);\n                // //console.log(\"END\", vm.new_booking.end_datetime);\n\n                var booking = {};\n                var booking = jQuery.extend(true, {}, vm.new_booking); \n                // //console.log(booking);\n                delete booking.options;\n                delete booking.instructor;\n                delete booking.plane;\n                delete booking.start_date;\n                delete booking.start_time;\n                delete booking.end_date;\n                delete booking.end_time;\n                delete booking.start_datetime;\n                delete booking.end_datetime;\n                delete booking.tuition_required;\n                // //console.log(booking);\n                // //console.log(vm.new_booking);\n                booking.free_seats = (vm.new_booking.free_seats.constructor === Array) ? 0 : vm.new_booking.free_seats;\n                booking.start = vm.new_booking.start_datetime;\n                booking.end = vm.new_booking.end_datetime;\n                booking.tuition_id = vm.new_booking.tuition_required.id;\n\n                // //console.log(\"START\", booking.start);\n                // //console.log(\"END\", booking.end);\n\n                booking.user_id = vm.user.id;\n                booking.instructor_id = (vm.new_booking.instructor) ? vm.new_booking.instructor.id : 0;\n                booking.plane_id = vm.new_booking.plane.id;\n                booking.override = (vm.new_booking.override) ? vm.new_booking.override : 0;\n                booking.club_id = vm.new_booking.plane.club_id;\n\n                // //console.log(\"====> booking to be sent = \", booking);\n\n                check_before_changing_event(booking);\n\n        }\n\n    }\n\n    $scope.update_club = function(){\n            // //console.log(\"we changed club here\");\n            vm.club_id = vm.change_club.id;\n            //now we need to update the planes the user can see on the calendar! \n            update_bookings();\n\n    }\n\n    function update_bookings(){\n         BookingService.GetAllUserClub(vm.user.id,vm.club_id, moment().format(\"Y-M-D\"), \"\")\n                .then(function(data){\n                   \n                    $scope.all_events = data.events;\n                    $scope.all_resources = data.resources;\n\n                });\n    }\n\n    /* alert on eventClick */\n    $scope.alertOnEventClick = function( date, jsEvent, view){\n        $scope.alertMessage = (date.title + ' was clicked ');\n        // //console.log(event);\n        //show event details\n\n    };\n\n    /* alert on Drop */\n     $scope.alertOnDrop = function(event, delta, revertFunc, jsEvent, ui, view){\n  \n\n        check_before_changing_event(event);\n       \n    };\n\n\n    /* alert on Resize */\n    $scope.alertOnResize = function(event, delta, revertFunc, jsEvent, ui, view ){\n        \n        check_before_changing_event(event);\n\n    };\n\n\n\n    $scope.override_booking_change = function(override){\n\n        vm.error_event[override] = true;\n        check_before_changing_event(vm.error_event);\n\n\n    }\n\n    $scope.decline_booking_change = function(){\n\n        vm.booking_errors = {};\n        vm.error_event = {};\n        $('#calendar').fullCalendar('removeEvents');\n        $('#calendar').fullCalendar('addEventSource', all_events);\n\n    }\n\n\n    function check_before_changing_event(event){\n        //the important bit is the eventID \n\n\n        var evnt = jQuery.extend({}, event);\n\n\n        \n\n        // evnt.start = moment(evnt.start).format(\"YYYY-MM-DD HH:mm\");\n        // evnt.end = moment(evnt.end).format(\"YYYY-MM-DD HH:mm\");\n        \n        //this covers the change of plane for the booking...\n        evnt.plane_id = event.resourceId;\n        if(event.instructor_id !== \"\"){\n            evnt.instructor_id = event.instructor_id;\n                    if(event.tuition_required){\n                        evnt.tuition_id = event.tuition_required.id;\n                    }\n\n        } else {\n            evnt.instructor_id = \"0\";\n        }\n\n\n        // //console.log(\"evnt : \", evnt);\n        // return false;\n\n        //updatable bits:\n\n        delete evnt._start;\n        delete evnt._end;\n        delete evnt._id;\n        delete evnt.source;\n        delete evnt._allDay;\n        delete evnt.allDay;\n        delete evnt.className;\n        delete evnt.plane;\n        delete evnt.title;\n        delete evnt.editable;\n        delete evnt.resourceIds;\n        evnt.update_rental_items = true;\n\n        // //console.log(\"UPDATE CONTENT BEFORE\", evnt);\n\n        BookingService.updateBooking(evnt, vm.user.id)\n        .then(function(data){\n            //console.log(data);\n\n            if(data.success == true){\n                //console.log(\"the booking did not need to be altered = and has been updated successfully.\", evnt);\n\n                //only if the edition is being made from the \"edit\" otherwise the changes are already reflected appropriately.\n                if(evnt.edit_booking == 1){\n                    $scope.$parent.updateEvents(evnt.start, evnt.end);\n                }\n                \n                alert(\"Your changes were saved successfully\");\n                \n                // if(vm.return_to == \"bookout\") {\n                //     //console.log(\"WE ARE AT THE BOOKOUT BIT - SO RETURN THERE!!!\");\n                //     $state.go('dashboard.my_account.bookout_with_booking', { \"booking_id\": event.id });\n                // } else {\n                //     //console.log(\"NORMAL booking\");\n                //     $state.go('dashboard.bookings');\n                // }\n\n\n\n            } else {\n                //display the error\n                //console.log(\"The booking cannot remain the same due to : \"+data.message);\n\n                //hollow :::     $(\"#calendar\").fullCalendar('refetchEvents');\n\n\n                //I have decided to do this as a sequential check / accept / decline as opposed to combined\n                //this can be altered at a later date to be combined, with accept / decline on each error\n                //but this is more work than i can do right now!\n\n                var errors = [];\n                if(data.instructor !== true){\n                    errors.push({\n                        type: \"instructor\",\n                        message: \"It looks like your instructor is not available on the updated date and time\",\n                        api: data.instructor,\n                        override: \"instructor_override\" \n                    });\n                } else if(data.check_user !== true){\n                    errors.push({\n                        type: \"check_user\",\n                        message: \"It looks like your user account does not allow this booking to happen\",\n                        api: data.check_user,\n                        override: \"currency_override\" \n                    });\n                } else if(data.rental_items !== true){\n                    errors.push({\n                        type: \"rental_items\",\n                        message: \"It looks like some of the rental items are not available\",\n                        api: data.rental_items,\n                        override: \"update_rental_items\" \n                    });\n                }\n\n\n                //show the errors:::\n\n                //console.log(\"ERRORS ARE : \", errors);\n                alert(\"ERROR FOUND IN ALTERING THE BOOKING\");\n\n                vm.booking_errors = errors;\n                vm.error_event = evnt;\n\n                //on GO--> check_before_changing_event(evnt)    \n\n\n                //if CANCEL?\n                //this would reset the change... do we want this?\n                //$(\"#calendar\").fullCalendar('refetchEvents');\n\n\n\n            }\n\n            return data;\n\n        });\n\n    }\n\n    $scope.wholeDay = function(){\n\n       if($scope.whole_day_booking == true){\n            $scope.whole_day_booking = false;\n            $scope.myDatetimeRange.time.from = defaultStartTime;\n            $scope.myDatetimeRange.time.to = defaultEndTime;\n       } else {\n            $scope.whole_day_booking = true;\n            $scope.myDatetimeRange.time.from = 0;\n            $scope.myDatetimeRange.time.to = 1440;\n       }\n       \n\n    }\n\n    //Changing the view of the calendar\n    $scope.changeView = function(view,calendar) {\n      uiCalendarConfig.calendars[calendar].fullCalendar('changeView',view);\n    };\n\n    /* Change View */\n    $scope.renderCalender = function(calendar) {\n      $timeout(function() {\n        if(uiCalendarConfig.calendars[calendar]){\n          uiCalendarConfig.calendars[calendar].fullCalendar('render');\n        }\n      });\n    };\n\n\n        // BookoutService.GetBookoutsToComplete(vm.user.id)\n        //             .then(function(data){\n\n        //                 vm.bookouts = data.bookouts;   \n                        \n        //             });\n\n\n\n    }\napp.controller('ShowGalleryController', ShowGalleryController);\n \n    ShowGalleryController.$inject = ['UserService', 'ArtpiecesService', 'ImagesService', 'KeywordsService', 'CategoryService', '$location', '$rootScope', 'FlashService', '$routeParams', '$scope', 'LocalDataService', 'GalleryService'];\n    function ShowGalleryController(UserService, ArtpiecesService, ImagesService, KeywordsService, CategoryService, $location, $rootScope, FlashService, $routeParams, $scope, LocalDataService, GalleryService) {\n        var vm = this;\n\n        vm.gallery = {\n            is_protected: \"false\",\n            download_low: \"false\",\n            download_medium: \"false\",\n            download_high: \"false\",\n            gallery_link: \"\",\n            fullscreen: \"false\"\n        };\n\n        vm.current = {\n            image: {\n                link: \"\",\n                description: \"hi\"\n            },\n            artpiece: {\n                title: \"\",\n                description: \"\"\n            },\n            index: 0\n        };\n\n        //get all galleries to check if name is already in use...\n        GalleryService.GetByUrl({gallery_link: $routeParams.gallery_link})\n                .then(function(data){\n                    //console.log(data);\n                     vm.gallery = data;\n                     //routeParams\n                     if(data.images.length > 0){\n                        if(data.is_disabled == \"true\"){\n                            //console.log(\"ERROR disabled\");\n                            $location.path(\"/disabled\");\n                        }\n\n                        //console.log(\"HELLO\");\n                        //console.log(vm.gallery.is_disabled);\n                        vm.current.image.link = vm.gallery.images[0].link;\n                        vm.current.image.description = vm.gallery.images[0].description;\n                        vm.current.artpiece.title = vm.gallery.images[0].artpiece.title;\n                        vm.current.artpiece.description = vm.gallery.images[0].artpiece.description;\n                        vm.current.index = 0;\n                    } else {\n                            //console.log(\"Couldn't find the page\");\n                            $location.path(\"/disabled\");\n                    }\n\n\n                });\n\n\n\n        $scope.login = function(){\n            if(vm.password_protected == vm.gallery.password){\n                //console.log(\"YAY\");\n                vm.gallery.is_protected = \"false\";\n            } else {\n                //console.log(\"FAIL\");\n                return false;\n            }\n        }\n\n        var load_image = function(index){\n            // $(\".show_gallery_big_image img\").removeClass(\"ng-hide-add\");\n            // $(\".show_gallery_big_image img\").addClass(\"ng-hide-remove\");\n            vm.current.image.link = vm.gallery.images[index].link;\n            vm.current.image.description = vm.gallery.images[index].description;\n            vm.current.artpiece.title = vm.gallery.images[index].artpiece.title;\n            vm.current.artpiece.description = vm.gallery.images[index].artpiece.description;\n            vm.current.index = index;\n           \n        }\n\n        $scope.change_image = function(index){\n            load_image(index);\n        }\n\n        $scope.show_fullscreen = function(){\n            $(\"#fullscreen\").fadeIn();\n            $(\"p.viewport\").hide();\n        }\n\n        $scope.hide_fullscreen = function(){\n            $(\"#fullscreen\").fadeOut();\n            $(\"p.viewport\").show();\n\n        }\n\n        $scope.fullscreen_next = function(){\n            var next = vm.current.index + 1;\n            if(next > (vm.gallery.images.length - 1)){ next = 0; } \n            //load the next one\n            load_image(next);\n        }\n\n        $scope.fullscreen_previous = function(){\n            var prev = vm.current.index - 1;\n            if(prev < 0){ prev = (vm.gallery.images.length - 1); } \n            //load the next one\n            load_image(prev);\n        }\n\n        $scope.download = function(value){\n            //download low / medium / high definition image ZIP\n            GalleryService.DownloadZip({gallery_id: vm.gallery.id, quality: value})\n                            .then(function(data){\n                                //console.log(data);\n                                    var link = document.createElement(\"a\");\n                                    link.download = data.zip_url;\n                                    link.href = data.zip_url;\n                                    link.click();\n                            });\n\n            //window.saveAs(blob, filename) ? WTF?\n        }\n\n        //this is where we do the selection of images\n        $scope.remove_image = function(image){\n            //check if set selected\n            //well its selected - so we deselect right?\n            vm.images = $.grep(vm.images, function(e){ \n                return e.id != image.id; \n            });\n            //console.log(vm.images);\n            LocalDataService.SetSelectedImages(vm.images);\n        }\n\n        $scope.check_link_unique = function(){\n            for(var i = 0; i < vm.all_galleries.length; i++){\n                if(vm.all_galleries[i].link===vm.gallery.link){\n                    return false;\n                }\n            }\n        }\n\n\n        $scope.generate_gallery = function(){\n            //console.log(\"CLICKED GALLERY BIT\");\n            //console.log(LocalDataService.data.selected_images);\n            //we need to set the ORDER as organise in the vm.images\n            var organise = 0;\n            for(var i = 0; i < vm.images.length; i++){\n                vm.images[i].organise = i;\n            }\n            //console.log(\"ORGANISE BELOW?\");\n            //console.log(vm.images);\n\n            vm.gallery.images = vm.images;\n            //console.log(vm.gallery);\n            GalleryService.Create(vm.gallery)\n                .then(function(data){\n                    //console.log(data);\n                    //$location.path(\"/gallery/\"+data.link);\n                });\n        }\n\n       \n\n\n\n    }\n app.controller('UpdateMyMembershipDirectDebitController', UpdateMyMembershipDirectDebitController);\n\n    UpdateMyMembershipDirectDebitController.$inject = ['UserService', 'MemberService', 'MembershipService', 'PaymentService', 'InstructorService', 'HolidayService', 'ClubService', '$rootScope', '$location', '$scope', '$state', '$stateParams', '$uibModal', '$log', '$window', '$compile', '$timeout', 'uiCalendarConfig', 'LicenceService', 'NokService', 'GoCardService', '$cookies'];\n    function UpdateMyMembershipDirectDebitController(UserService, MemberService, MembershipService, PaymentService, InstructorService, HolidayService, ClubService, $rootScope, $location, $scope, $state, $stateParams, $uibModal, $log, $window, $compile, $timeout, uiCalendarConfig, LicenceService, NokService, GoCardService, $cookies) {\n        \n        var vm = this;        \n\n        vm.user = $rootScope.globals.currentUser;\n        vm.user_id = vm.user.id;        \n      \n        vm.success = true;\n\n        vm.return_id = $stateParams.membership_id;\n  \n\n        switch($state.current.data.action){\n          \n            case \"direct_debit2\":\n\n                var mandate = $location.search().redirect_flow_id;\n                ////console.log(\"DIRECT DEBIT SORTING 444\", mandate);\n                //RE0002NPM29SQ1F4B57R8E3AT4YJAPZG\n                var session = $cookies.get('gcl_sess');\n\n                var object = {\n                    mandate: mandate,\n                    session: session,\n                    membership_id: $stateParams.membership_id\n                };\n                //console.log(\"THE TOTALS:::\", object);\n\n                if($cookies.get(\"gcl_member_accepted\")){\n                    object[\"member_accepted\"] = true;\n                }\n\n\n\n                GoCardService.UpdateMandate(object).then(function (data) {\n                    if(data.error){\n                        //vm.requests = data.requests;\n                        //vm.club = data.club;\n                        // //console.log(\"memberships\", vm.memberships);\n                        // vm.success = true;\n                        vm.success = false;\n                        //console.log(\"There was an error: \", data);\n                        //now that this is saved... we should do something about it?\n                        //window.location = \"\";\n\n                    } else {\n\n                        //console.log(\"HAPPY RESPONSE: \", data);\n                        vm.success = true;\n\n                        //window.location = \"\";\n                        $state.go('dashboard.my_account.memberships.edit', {membership_id: vm.return_id}, {reload: true});\n\n                        // //console.log(\"WOOOPSIES...\");\n                        // vm.success = false;\n                        //this should be very very rare...\n                    }\n\n                });\n                \n\n\n\n               \n\n\n            break;\n            default:\n                //console.log(\"none of the above... redirect somewhere?\");\n            break;\n        }  \n\n\n\n\n\n\n        \n        \n\n\n    }\napp.controller('UploadController', UploadController);\n \n    UploadController.$inject = ['KeywordsService', 'ArtpiecesService', 'ImageUploadService', '$scope', '$http', '$location'];\n    function UploadController(KeywordsService, ArtpiecesService, ImageUploadService, $scope, $http, $location) {\n            \n\n\n        var vm = this;\n        \n        //current tags\n        $scope.tags = [];\n\n        KeywordsService.GetAll()\n                .then(function (data) {\n                    vm.all_keywords = data;\n                    //console.log(vm.all_keywords);\n                });\n\n        ArtpiecesService.GetAll()\n                .then(function(data){\n                    vm.artpieces = data;\n                });\n        \n        $scope.loadTags = function(query) {\n        \n            var first = $.grep(vm.all_keywords, function(e){ var ab = e.keyword; var ab = ab.toLowerCase(); if(ab.startsWith(query.toLowerCase())){ return true; } });\n            var second = [];\n            for(var i = 0; i < first.length; i++){\n                var text_to_lower = first[i].keyword;\n                text_to_lower = text_to_lower.toLowerCase();\n                second.push({id: first[i].id, text: text_to_lower});\n            }\n            return second;\n\n        };\n\n          $scope.CheckData = function(content){\n            // //console.log(\"BELOW\");\n            // //console.log(content);\n            var images_array = [];\n            var images = content; //JSON.parse(content.file_return);\n            for(var i = 0; i < images.length; i++){\n                //var image = JSON.parse(images[i].f);\n                // //console.log(\"file_return\"+images[i].file_return);\n                var image = images[i].file_return;\n                var image = JSON.parse(image);\n                // //console.log(image.files.file.tmp_name);\n                images_array.push(image.files.file.tmp_name);\n            }\n            // //console.log(content.file_return);\n            // //console.log(images_array); // all the images\n            // //console.log($scope.tags); //all the tags objects\n            // //console.log(vm.artme); //this is the artpiece id\n            var compiled_send = {\n                images: images_array,\n                keywords: $scope.tags,\n                artpiece_id: vm.artme\n            };\n\n            //console.log(compiled_send);\n\n            ImageUploadService.Create(compiled_send)\n                .then(function(data){\n                    //console.log(data);\n                    $location.path(\"/\");\n                });\n\n\n          }\n         \n       \n\n    }\napp.controller('UsersController', UsersController);\n \n    UsersController.$inject = ['UserService', '$location', '$rootScope', 'FlashService', '$routeParams'];\n    function UsersController(UserService, $location, $rootScope, FlashService, $routeParams) {\n        var vm = this;\n        var this_user;\n        vm.update = update;\n \t\tvm.dataLoading = false;\n\n \t\tvm.default_pwd = \"password\";\n\n        UserService.GetById($routeParams.userId)\n                .then(function (data) {\n                    vm.user = data.user;\n                });\n\n        function update(id){\n            //vm.dataLoading = true;\n            if(vm.user.password == \"password\"){\n                vm.user.password = \"\";\n            }\n            //console.log(vm.user)\n            UserService.Update(vm.user)\n                .then(function (response) {\n                    if (response.success) {\n                        FlashService.Success('Update successful', true);\n                        $location.path('/');\n                    } else {\n                        console.log(\"response\");\n                        console.log(response);\n                        if(response.message == \"Password entered failed\") {\n                            alert(\"The password entered was incorrect\");\n                            vm.dataLoading = false;\n                        } else {\n                            FlashService.Error(response.error);\n                            vm.dataLoading = false;\n                        }\n                        \n                    }\n                });\n        }\n    }\n app.controller('UserSignupController', UserSignupController);\n\n    UserSignupController.$inject = ['UserService', '$http', '$rootScope', '$location', '$scope', '$state', '$stateParams'];\n    function UserSignupController(UserService, $http, $rootScope, $location, $scope, $state, $stateParams) {\n        \t\n    \t\t\n    \t\t//automatically sort stuff out! :)\n    \t\tif($state.params.verify){\n    \t\t\t// //console.log(\"SEND VERIFICATION\");\n    \t\t\tUserService.Verify($state.params.user_id, $state.params.verify)\n                .then(function (data) {\n\t    \t\t\t// //console.log(\"SENT VERIFICATION\");\n                \t// //console.log(data);\n                    if(data.success){\n                    \t$state.go(\"verified\");\n                    } else {\n                    \talert(data.message);\n                    \t$state.go(\"login\");\n                    }\n                });\n    \t\t}\n\n\n\n\t    \t// //console.log(\"HELLO\");\n\t\t    ////console.log($scope.membership);\n\n         \t// we will store all of our form data in this object\n\t\t    \n\n         \t$scope.clubs = { clubs: [\n\t\t\t    \t{\n\t\t\t    \t\tid: 1,\n\t\t\t    \t\ttitle: \"Alouette Flying Club\"\n\t\t\t    \t},\n\t\t\t    \t{\n\t\t\t    \t\tid: 2,\n\t\t\t    \t\ttitle: \"EFG Flying Club\"\n\t\t\t    \t},\n\t\t\t    \t{\n\t\t\t    \t\tid: 3,\n\t\t\t    \t\ttitle: \"Surrey & Kent Flying Club\"\n\t\t\t    \t},\n\t\t\t    \t{\n\t\t\t    \t\tid: 4,\n\t\t\t    \t\ttitle: \"Arrow Flight Club\"\n\t\t\t    \t},\n\t\t\t    \t{\n\t\t\t    \t\tid: 5,\n\t\t\t    \t\ttitle: \"Cirrus Flying Club\"\n\t\t\t    \t}\n\t\t    \t]\t\t    \t\n\t\t    };\n\n\n\t\t    $scope.memberships = { memberships: [\n\t\t\t    \t{\n\t\t\t    \t\tid: 1,\n\t\t\t    \t\ttitle: \"honory membership\"\n\t\t\t    \t},\n\t\t\t    \t{\n\t\t\t    \t\tid: 2,\n\t\t\t    \t\ttitle: \"day membership\"\n\t\t\t    \t},\n\t\t\t    \t{\n\t\t\t    \t\tid: 3,\n\t\t\t    \t\ttitle: \"social membership\"\n\t\t\t    \t},\n\t\t\t    \t{\n\t\t\t    \t\tid: 4,\n\t\t\t    \t\ttitle: \"full flying membership\"\n\t\t\t    \t},\n\t\t\t    \t{\n\t\t\t    \t\tid: 5,\n\t\t\t    \t\ttitle: \"temporary flying membership\"\n\t\t\t    \t}\n\t\t    \t]\t\t    \t\n\t\t    };\n\n\t\t    $scope.state = { state: [\n\t\t\t    \t{\n\t\t\t    \t\tid: 2,\n\t\t\t    \t\ttitle: \"France\"\n\t\t\t    \t},\n\t\t\t    \t{\n\t\t\t    \t\tid: 3,\n\t\t\t    \t\ttitle: \"Netherlands\"\n\t\t\t    \t},\n\t\t\t    \t{\n\t\t\t    \t\tid: 4,\n\t\t\t    \t\ttitle: \"Germany\"\n\t\t\t    \t},\n\t\t\t    \t{\n\t\t\t    \t\tid: 5,\n\t\t\t    \t\ttitle: \"Spain\"\n\t\t\t    \t}\n\t\t    \t]\t\t    \t\n\t\t    };\n\n\t\t    $scope.licenses = { licenses: [\n\t\t\t    \t{\n\t\t\t    \t\tid: 1,\n\t\t\t    \t\ttitle: \"EASA PPL\"\n\t\t\t    \t},\n\t\t\t    \t{\n\t\t\t    \t\tid: 2,\n\t\t\t    \t\ttitle: \"EASA CPL\"\n\t\t\t    \t},\n\t\t\t    \t{\n\t\t\t    \t\tid: 3,\n\t\t\t    \t\ttitle: \"EASA ATPL\"\n\t\t\t    \t},\n\t\t\t    \t{\n\t\t\t    \t\tid: 4,\n\t\t\t    \t\ttitle: \"UK NPPL\"\n\t\t\t    \t},\n\t\t\t    \t{\n\t\t\t    \t\tid: 5,\n\t\t\t    \t\ttitle: \"FAA SPL\"\n\t\t\t    \t}\n\t\t    \t]\t\t    \t\n\t\t    };\n\n\t\t    $scope.medicals = { medicals: [\n\t\t\t    \t{\n\t\t\t    \t\tid: 1,\n\t\t\t    \t\ttitle: \"EASA MEDICAL\"\n\t\t\t    \t},\n\t\t\t    \t{\n\t\t\t    \t\tid: 2,\n\t\t\t    \t\ttitle: \"UK MEDICAL EXAMINATION\"\n\t\t\t    \t},\n\t\t\t    \t{\n\t\t\t    \t\tid: 3,\n\t\t\t    \t\ttitle: \"FAA MEDICAL\"\n\t\t\t    \t},\n\t\t\t    \t{\n\t\t\t    \t\tid: 4,\n\t\t\t    \t\ttitle: \"NZ CAA MEDICAL\"\n\t\t\t    \t},\n\t\t\t    \t{\n\t\t\t    \t\tid: 5,\n\t\t\t    \t\ttitle: \"FAA SPL MEDICAL\"\n\t\t\t    \t}\n\t\t    \t]\t\t    \t\n\t\t    };\n\n\t\t    $scope.person = {};\n\n\t\t    $scope.person.selectedSingle = 'Samantha';\n\t\t  \t$scope.person.selectedSingleKey = '5';\n\n\t\t  \t$scope.people = [\n\t\t\t    { name: 'Adam',      email: 'adam@email.com',      age: 12, country: 'United States' },\n\t\t\t    { name: 'Amalie',    email: 'amalie@email.com',    age: 12, country: 'Argentina' },\n\t\t\t    { name: 'Estefana', email: 'estefania@email.com', age: 21, country: 'Argentina' },\n\t\t\t    { name: 'Adrian',    email: 'adrian@email.com',    age: 21, country: 'Ecuador' },\n\t\t\t    { name: 'Wladimir',  email: 'wladimir@email.com',  age: 30, country: 'Ecuador' },\n\t\t\t    { name: 'Samantha',  email: 'samantha@email.com',  age: 30, country: 'United States' },\n\t\t\t    { name: 'Nicole',    email: 'nicole@email.com',    age: 43, country: 'Colombia' },\n\t\t\t    { name: 'Natasha',   email: 'natasha@email.com',   age: 54, country: 'Ecuador' },\n\t\t\t    { name: 'Michael',   email: 'michael@email.com',   age: 15, country: 'Colombia' },\n\t\t\t    { name: 'Nicols',   email: 'nicolas@email.com',    age: 43, country: 'Colombia' }\n\t\t  \t];\n\n\n\n\n\n\t\t    $scope.ratings = { ratings: [\n\t\t\t    \t\n\t\t\t\t\t{\n\t\t\t    \t\tid: 1,\n\t\t\t    \t\ttitle: \"SEP (land)\"\n\t\t\t    \t},\n\t\t\t    \t{\n\t\t\t    \t\tid: 2,\n\t\t\t    \t\ttitle: \"SEP (sea)\"\n\t\t\t    \t},\n\t\t\t    \t{\n\t\t\t    \t\tid: 3,\n\t\t\t    \t\ttitle: \"MEP (land)\"\n\t\t\t    \t},\n\t\t\t    \t{\n\t\t\t    \t\tid: 4,\n\t\t\t    \t\ttitle: \"MEP (sea)\"\n\t\t\t    \t},\n\t\t\t    \t{\n\t\t\t    \t\tid: 1,\n\t\t\t    \t\ttitle: \"Night Rating\"\n\t\t\t    \t},\n\t\t\t    \t{\n\t\t\t    \t\tid: 2,\n\t\t\t    \t\ttitle: \"Instrument Rating Restricted IR(r)\"\n\t\t\t    \t},\n\t\t\t    \t{\n\t\t\t    \t\tid: 3,\n\t\t\t    \t\ttitle: \"Instrument Rating\"\n\t\t\t    \t},\n\t\t\t    \t{\n\t\t\t    \t\tid: 4,\n\t\t\t    \t\ttitle: \"Aerobatics Rating\"\n\t\t\t    \t},\n\t\t\t    \t{\n\t\t\t    \t\tid: 5,\n\t\t\t    \t\ttitle: \"High Performance Aircraft Rating\"\n\t\t\t    \t}\n\t\t    \t]\t\t    \t\n\t\t    };\n\n\t\t    $scope.differences = { differences: [\n\t\t\t    \t{\n\t\t\t    \t\tid: 1,\n\t\t\t    \t\ttitle: \"Variable Pitch\"\n\t\t\t    \t},\n\t\t\t    \t{\n\t\t\t    \t\tid: 2,\n\t\t\t    \t\ttitle: \"Retractable Gear\"\n\t\t\t    \t},\n\t\t\t    \t{\n\t\t\t    \t\tid: 3,\n\t\t\t    \t\ttitle: \"Turbo Differences Training\"\n\t\t\t    \t},\n\t\t\t    \t{\n\t\t\t    \t\tid: 4,\n\t\t\t    \t\ttitle: \"EFIS Differences Training\"\n\t\t\t    \t}\n\t\t    \t]\t\t    \t\n\t\t    };\n\n\n\t\t    //may need to alter this one to reflect most common one depending on\n\t\t    //the license type\n\t\t    $scope.formData = {\n\t\t    \tlicense: {\n\t\t    \t\tdifferences: [],\n\t\t    \t\tratings: [$scope.ratings.ratings[0]],\n\t\t    \t\tadd_to: {\n\t\t\t    \t}\n\t\t    \t},\n\t\t    \tmedical: {}\n\t\t    \t\n\t\t    };\n\n\t\t    $scope.add_element = function(bit_type){\n\n\t\t    \t//remove from first array\n\t\t    \t$scope[bit_type][bit_type] = $.grep($scope[bit_type][bit_type], function(e){ \n\t\t\t\t\treturn e.id != $scope.formData.license.add_to[bit_type].id; \n\t\t\t\t});\n\n\t\t    \tif(bit_type == \"differences\"){\n\t\t    \t\t$scope.formData.license.add_to[bit_type].day = true;\n\t\t    \t\t$scope.formData.license.add_to[bit_type].vfr = true;\n\t\t    \t}\n\t\t    \t//console.log($scope.formData.license.add_to[bit_type]);\n\n\t\t    \t$scope.formData.license[bit_type].push($scope.formData.license.add_to[bit_type]);\n\t\t    \t\n\t\t    \t//clean the array to show what we want to show :)\n\t\t    \tdelete $scope.formData.license.add_to[bit_type];\n\n\t\t    }\n\n\n\t\t    $scope.remove_element = function(bit_type, index){\n\n\t\t \n \t\t\t\t//add to dropdown\n\t\t\t\t$scope[bit_type][bit_type].push($scope.formData.license[bit_type][index]);\n\n\t\t    \n\t\t\t\t$scope.formData.license[bit_type].splice(index,1)\n\n\t\t    \t$scope.formData.license[bit_type] = $scope.formData.license[bit_type].filter(Boolean);\n\t\t    \t//console.log($scope.formData.license[bit_type]);\n\t\t    \t//$scope.formData.license[bit_type].push($scope.formData.license.add_to[bit_type]);\n\n\t\t    }\n\n\t\t    \n\t\t    $scope.checkValid = function(uisref){\n\t\t    \tif(!uisref || uisref == \"\"){\n\t\t    \t\t//console.log(\"here\");\n\t\t    \t\tuisref = $(\".btn-info\").attr(\"one-ui-sref\");\n\t\t    \t}\n\n\n\t\t    \t//let's check the passwords match first...\n\t            if($scope.formData.user.password !== $scope.formData.user.password2){\n\t              $(\"input[type='password']\").removeClass(\"ng-pristine\").addClass(\"ng-invalid\");\n\t              alert(\"Your passwords do not match\");\n\t              return false;\n\t            }\n\n\t            //check the password length > 8 characters\n\t            var strongPassword = new RegExp('(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[^A-Za-z0-9])(?=.{8,})')\n\t            if(strongPassword.test($scope.formData.user.password)) {\n\t              //console.log(\"password strength OK\");\n\t            } else {\n\t              $(\"input[type='password']\").removeClass(\"ng-pristine\").addClass(\"ng-invalid\");\n\t              alert(\"Your password must be at least 8 characters in length, contain 1 uppercase, 1 lowercase, 1 number, and 1 special character\");\n\t              return false;\n\t            }\n\n\n\n\t\t    \t//console.log($('#signup-form')[0].checkValidity());\n\t\t    \tif(! $('#signup-form')[0].checkValidity()){\n\t\t    \t\t$(\".ng-pristine\").not(\".ng-valid\").removeClass(\"ng-pristine\").addClass(\"ng-invalid\");\n\t\t    \t\t$(\"input:checkbox:not(:checked):required\").addClass(\"ng-checkbox-unchecked\");\n\t\t    \t\t//console.log(\"STOP\");\n\t\t    \t\treturn false;\n\t\t    \t} else {\n\n\t\t    \t\t//console.log(\"HERE\");\n\t\t    \t\t\n\t\t    \t\tif(!$scope.formData.user){\n\t\t    \t\t\t//console.log(\"missing first bit...\");\n\t\t\t\t    \t$state.go(\"user_signup.your_details\");\n\t\t    \t\t\treturn false;\n\t\t    \t\t}\n\t\t    \t\tif(!$scope.formData.user.nok){\n\t\t    \t\t\t//console.log(\"missing second bit...\");\n\t\t\t\t    \t$state.go(\"user_signup.next_of_kin\");\n\t\t    \t\t\treturn false;\n\t\t    \t\t}\n\t\t    \t\tif(!$scope.formData.club){\n\t\t    \t\t\t//console.log(\"missing second bit...\");\n\t\t\t\t    \t$state.go(\"user_signup.your_club\");\n\t\t    \t\t\treturn false;\n\t\t    \t\t}\n\t\t    \t\tif(!$scope.formData.tnc){\n\t\t\t    \t\t$(\"input:checkbox:not(:checked)\").addClass(\"ng-checkbox-unchecked\");\n\t\t    \t\t} else {\n\t\t    \t\t\t$(\"input:checkbox:not(:checked)\").removeClass(\"ng-checkbox-unchecked\");\n\t\t    \t\t}\n\t\t    \t\tif($scope.formData.user.password == $scope.formData.user.password2){\n\t\t\t    \t\tvar next = uisref;\n\t\t\t    \t\tif(next == \"verify_account\"){\n\t\t\t    \t\t\t//console.log(\"verifying account\");\n\t\t\t    \t\t\t$scope.processForm();\n\t\t\t    \t\t} else {\n\t\t\t\t    \t\t$state.go(next);\n\t\t\t    \t\t}\n\t\t    \t\t} else {\n\t\t\t    \t\t$(\"input[type='password']\").removeClass(\"ng-pristine\").addClass(\"ng-invalid\");\n\t\t    \t\t\treturn false;\n\t\t    \t\t}\n\n\t\t    \t\t// if(!$scope.formData.user){\n\t\t\t\t    // \t\t$state.go(\"user_signup.your_details\");\n\t\t    \t\t// }\n\t\t    \t\t// if($scope.formData.user.password == $scope.formData.user.password2){\n\t\t    \t\t// \t//console.log(uisref);\n\t\t\t    \t// \t$state.go(uisref);\n\t\t    \t\t// } else {\n\t\t\t    \t// \t$(\"input[type='password']\").removeClass(\"ng-pristine\").addClass(\"ng-invalid\");\n\t\t    \t\t// \treturn false;\n\t\t    \t\t// }\n\t\t    \t}\n\t\t    }\n\n\n\t\t    // function to process the form\n\t\t    $scope.processForm = function() {\n\t\t         if ($scope.formData.$valid) {\n\t                alert('our form is valid');\n\t            } \n\t\t    };\n\n\n\n\n\n\n\t\t$scope.downloadClubDocument = function(doc) {\n            var data = $.param({\n                id: doc\n            });\n\n            var ddd = doc.replace(/^.*[\\\\\\/]/, '');\n            $http.defaults.headers.common['Api-Key'] = \"eW91a25vd25vdGhpbmdqb25zbm93\";\n\n            $http.get('api/v1/term_documents/show_file/'+ddd, {\n                    responseType: 'arraybuffer'\n                })\n                .success(function(data, status, headers) {\n                    var zipName = processArrayBufferToBlob(data, headers);\n\n                    //Delete file from temp folder in server - file needs to remain open until blob is created\n                    //deleteFileFromServerTemp(zipName);\n                }).error(function(data, status) {\n                    alert(\"There was an error downloading the selected document(s).\");\n                })\n        };\n\n\n        function titlepath(path,name){\n\n        //In this path defined as your pdf url and name (your pdf name)\n            var prntWin = window.open();\n            prntWin.document.write(\"<html><head><title>\"+name+\"</title></head><body>\"\n                + '<embed width=\"100%\" height=\"100%\" name=\"plugin\" src=\"'+ path+ '\" '\n                + 'type=\"application/pdf\" internalinstanceid=\"21\"></body></html>');\n            prntWin.document.close();\n        }\n\n        function processArrayBufferToBlob(data, headers) {\n            var octetStreamMime = 'application/octet-stream';\n            var success = false;\n\n            // Get the headers\n            headers = headers();\n            //var ttt = title.toLowerCase().replace(/\\W/g, '_');\n            // Get the filename from the x-filename header or default to \"download.bin\"\n            var filename = headers['x-filename'] || 'download.zip';\n\n            // Determine the content type from the header or default to \"application/octet-stream\"\n            var contentType = headers['content-type'] || octetStreamMime;\n\n            try {\n                // Try using msSaveBlob if supported\n                var blob = new Blob([data], {\n                    //type: contentType\n                    type: 'application/pdf'\n                });\n\n                var fileURL = URL.createObjectURL(blob);\n                titlepath(fileURL, \"Secure Documents\");\n\n                // if (navigator.msSaveBlob)\n                //     navigator.msSaveBlob(blob, filename);\n                // else {\n                //     // Try using other saveBlob implementations, if available\n                //     var saveBlob = navigator.webkitSaveBlob || navigator.mozSaveBlob || navigator.saveBlob;\n                //     if (saveBlob === undefined) throw \"Not supported\";\n                //     saveBlob(blob, filename);\n                // }\n                success = true;\n            } catch (ex) {\n                $log.info(\"saveBlob method failed with the following exception:\");\n                $log.info(ex);\n            }\n\n            if (!success) {\n                // Get the blob url creator\n                var urlCreator = window.URL || window.webkitURL || window.mozURL || window.msURL;\n                if (urlCreator) {\n                    // Try to use a download link\n                    var link = document.createElement('a');\n                    if ('download' in link) {\n                        // Try to simulate a click\n                        try {\n                            // Prepare a blob URL\n                            var blob = new Blob([data], {\n                                type: contentType\n                            });\n                            var url = urlCreator.createObjectURL(blob);\n                            link.setAttribute('href', url);\n\n                            // Set the download attribute (Supported in Chrome 14+ / Firefox 20+)\n                            link.setAttribute(\"download\", filename);\n\n                            // Simulate clicking the download link\n                            var event = document.createEvent('MouseEvents');\n                            event.initMouseEvent('click', true, true, window, 1, 0, 0, 0, 0, false, false, false, false, 0, null);\n                            link.dispatchEvent(event);\n                            success = true;\n\n                        } catch (ex) {\n                            $log.info(\"Download link method with simulated click failed with the following exception:\");\n                            $log.info(ex);\n                        }\n                    }\n\n                    if (!success) {\n                        // Fallback to window.location method\n                        try {\n                            // Prepare a blob URL\n                            // Use application/octet-stream when using window.location to force download\n                            var blob = new Blob([data], {\n                                type: octetStreamMime\n                            });\n                            var url = urlCreator.createObjectURL(blob);\n                            window.location = url;\n                            success = true;\n                        } catch (ex) {\n                            $log.info(\"Download link method with window.location failed with the following exception:\");\n                            $log.info(ex);\n                        }\n                    }\n                }\n            }\n\n            if (!success) {\n                // Fallback to window.open method\n                $log.info(\"No methods worked for saving the arraybuffer, using last resort window.open\");\n                window.open(httpPath, '_blank', '');\n            }\n            return filename;\n        };\n\n    }"],"file":"controllers.ann.js"}